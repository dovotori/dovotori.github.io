{"version":3,"file":"CategoriesFilters-stories.f79afd3c.iframe.bundle.js","mappings":";;;;;;AASA;;;AAGA;;;AAGA;;;AAKA;AACA;AAGA;;;;;;AAQA;;;;ACxBA;;;;;;;;;ACOA;AAGA;;;AAGA;AACA;;;;;AAKA;;AAEA;AACA;;;;;;AAQA;;;AAKA","sources":["webpack://dovotori/./src/components/TypingMessage.jsx","webpack://dovotori/./src/components/Cross.jsx","webpack://dovotori/./src/components/CategoriesFilters.jsx"],"sourcesContent":["import { useCallback, useEffect, useRef } from \"react\";\nimport styled from \"styled-components\";\n\nconst Wrap = styled.div`\n  position: relative;\n\n  p {\n    display: flex;\n    flex-wrap: wrap;\n    flex-direction: ${(p) => (p.$isVertical ? \"column\" : \"row\")};\n    line-height: 1;\n    align-items: center;\n    justify-content: ${(p) => (p.$isCenter ? \"center\" : \"flex-start\")};\n\n    span {\n      margin: 0 ${(p) => (p.$isVertical ? 0 : \"0.2em\")} 0 0;\n    }\n  }\n`;\n\nconst Hidden = styled.p`\n  visibility: ${(p) => (p.$isVisible ? \"visible\" : \"hidden\")};\n`;\n\nconst Anim = styled.p`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  transition: color 500ms linear;\n`;\n\nconst CHARS = \"!<>-_\\\\/[]{}â€”=+*^?#\";\nconst Modes = {\n  DISAPPEAR: -1,\n  APPEAR: 1,\n  STOP: 0,\n};\n\nconst TypingMessage = ({\n  message = \"\",\n  isDisabled = false,\n  isVertical = false,\n  isCenter = false,\n  firstMessage = \"\",\n  className,\n  isLoop = false,\n  delayLoop = 5000, // en ms\n  delayLetter = 100, // en ms\n  trigger = 0, // increment to replay animation\n  triggerDebounce = 500, // debounce delay for trigger in ms\n}) => {\n  const count = useRef(0);\n  const lastFrame = useRef(Date.now());\n  const req = useRef(null);\n  const timeout = useRef(null);\n  const fromMessage = useRef(firstMessage);\n  const toMessage = useRef(message);\n  const mode = useRef(Modes.STOP);\n  const lastTriggerTime = useRef(0);\n  const displayMessage = useRef(firstMessage);\n  const animRef = useRef(null);\n\n  const randomChar = useCallback(\n    () => CHARS[Math.floor(Math.random() * CHARS.length)],\n    [],\n  );\n  const randomStr = useCallback(\n    (length) => new Array(length).fill(0).map(randomChar).join(\"\"),\n    [randomChar],\n  );\n  const randomCurrentStr = useCallback(\n    (str) =>\n      str\n        .split(\"\")\n        .map((car) => {\n          if (car === \" \") return car;\n          if (Math.random() > 0.5) return randomChar();\n          return car;\n        })\n        .join(\"\"),\n    [randomChar],\n  );\n\n  // Direct DOM update - no React re-render\n  const updateDOM = useCallback((text) => {\n    displayMessage.current = text;\n    if (animRef.current) {\n      animRef.current.innerHTML = text\n        .split(\"\")\n        .map((letter) => `<span>${letter === \" \" ? \"_\" : letter}</span>`)\n        .join(\"\");\n    }\n  }, []);\n\n  const update = useCallback(() => {\n    const now = Date.now();\n    const milli = now - lastFrame.current;\n    if (milli < delayLetter) {\n      req.current = requestAnimationFrame(update);\n      return;\n    }\n\n    let text = \"\";\n    switch (mode.current) {\n      case Modes.APPEAR: {\n        if (count.current < toMessage.current.length) {\n          count.current++;\n          text = toMessage.current.substring(0, count.current);\n          text = randomCurrentStr(text);\n        } else {\n          text = toMessage.current;\n          fromMessage.current = toMessage.current;\n          mode.current = Modes.STOP;\n        }\n        break;\n      }\n      case Modes.DISAPPEAR: {\n        if (count.current > 0) {\n          count.current--;\n          text = fromMessage.current.substring(0, count.current);\n          text = randomCurrentStr(text);\n        } else {\n          count.current++;\n          mode.current = Modes.APPEAR;\n          text = randomStr(count.current);\n        }\n        break;\n      }\n      default:\n        break;\n    }\n\n    updateDOM(text);\n    lastFrame.current = now;\n\n    if (mode.current !== Modes.STOP) {\n      req.current = requestAnimationFrame(update);\n    } else if (mode.current === Modes.STOP && isLoop) {\n      if (timeout.current) {\n        clearTimeout(timeout.current);\n      }\n      timeout.current = setTimeout(() => {\n        mode.current = Modes.DISAPPEAR;\n        req.current = requestAnimationFrame(update);\n      }, delayLoop);\n    }\n  }, [isLoop, delayLoop, delayLetter, randomStr, randomCurrentStr, updateDOM]);\n\n  useEffect(() => {\n    if (timeout.current) {\n      clearTimeout(timeout.current);\n    }\n\n    if (!isDisabled) {\n      const old = displayMessage.current;\n      let nextMode = Modes.STOP;\n\n      // determine le mode\n      if (old.length === 0 && message.length > 0) {\n        nextMode = Modes.APPEAR;\n        count.current = 0;\n      } else if (old.length > 0 && message.length > 0) {\n        nextMode = Modes.DISAPPEAR;\n        count.current = old.length;\n      } else {\n        nextMode = Modes.STOP;\n      }\n\n      if (req.current) {\n        cancelAnimationFrame(req.current);\n      }\n      if (nextMode !== Modes.STOP) {\n        fromMessage.current = old;\n        toMessage.current = message;\n        lastFrame.current = Date.now();\n        mode.current = nextMode;\n        req.current = requestAnimationFrame(update);\n      }\n    }\n    return () => {\n      if (req.current) {\n        cancelAnimationFrame(req.current);\n      }\n    };\n  }, [message, isDisabled, update]);\n\n  useEffect(() => {\n    if (timeout.current) {\n      clearTimeout(timeout.current);\n    }\n    if (isLoop) {\n      timeout.current = setTimeout(() => {\n        mode.current = Modes.DISAPPEAR;\n        req.current = requestAnimationFrame(update);\n      }, delayLoop);\n    }\n    return () => {\n      if (timeout.current) {\n        clearTimeout(timeout.current);\n      }\n    };\n  }, [isLoop, delayLoop, update]);\n\n  useEffect(\n    () => () => {\n      if (req.current) {\n        cancelAnimationFrame(req.current);\n      }\n      if (timeout.current) {\n        clearTimeout(timeout.current);\n      }\n    },\n    [],\n  );\n\n  // Replay animation when trigger changes (with throttle)\n  // biome-ignore lint/correctness/useExhaustiveDependencies: only trigger on trigger change\n  useEffect(() => {\n    if (trigger > 0 && !isDisabled) {\n      const now = Date.now();\n      if (now - lastTriggerTime.current < triggerDebounce) return;\n      lastTriggerTime.current = now;\n\n      if (req.current) {\n        cancelAnimationFrame(req.current);\n      }\n      if (timeout.current) {\n        clearTimeout(timeout.current);\n      }\n      count.current = displayMessage.current.length;\n      fromMessage.current = displayMessage.current;\n      toMessage.current = message;\n      mode.current = Modes.DISAPPEAR;\n      lastFrame.current = now;\n      req.current = requestAnimationFrame(update);\n    }\n  }, [trigger]);\n\n  // Initialize DOM on mount\n  useEffect(() => {\n    updateDOM(firstMessage);\n  }, [firstMessage, updateDOM]);\n\n  return (\n    <Wrap className={className} $isVertical={isVertical} $isCenter={isCenter}>\n      <Hidden $isVisible={isDisabled}>\n        {message.split(\"\").map((letter, index) => {\n          const key = `${message}${letter}${index}`;\n          return <span key={key}>{letter === \" \" ? `_` : letter}</span>;\n        })}\n      </Hidden>\n      <Anim ref={animRef} />\n    </Wrap>\n  );\n};\n\nexport default TypingMessage;\n","import styled from \"styled-components\";\n\nimport { ReactComponent as CrossSvg } from \"Assets/svg/cross.svg\";\n\nexport default styled(CrossSvg)`\n  width: 0.5em;\n  height: 0.5em;\n  min-width: 0.5em;\n  stroke: ${(p) => p.theme.getColor};\n  fill: none;\n`;\n","import { Fragment, useRef, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport styled from \"styled-components\";\n\nimport { getColorType } from \"../utils\";\nimport Cross from \"./Cross\";\nimport TypingMessage from \"./TypingMessage\";\n\nconst Wrap = styled.div`\n  text-align: center;\n  max-width: 1400px;\n  margin: 4em auto;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  ${(p) => p.theme.media.mobile`flex-direction: column;`}\n`;\n\nconst StyledLink = styled(Link)`\n  position: relative;\n  padding: 1em 2em;\n  opacity: ${(p) => (p.selected ? 1 : 0.5)};\n  font-weight: ${(p) => (p.selected ? 800 : 400)};\n  transition:\n    color 100ms ease-out,\n    background-color 100ms ease-out,\n    box-shadow 100ms ease-out;\n  color: ${(p) => p.theme.text};\n  text-transform: uppercase;\n  ${(p) => p.theme.monospace}\n  ${(p) => p.theme.active}\n  letter-spacing: 0.5em;\n  white-space: nowrap;\n  &:hover {\n    opacity: 1;\n  }\n`;\n\nconst StyledTypingMessage = styled(TypingMessage)`\n  text-transform: uppercase;\n  letter-spacing: 0.5em;\n`;\n\nconst CategoriesFilters = ({\n  selected,\n  className,\n  categories,\n  onClickCategory = () => {},\n}) => {\n  const triggers = useRef({});\n  const [, forceUpdate] = useState(0);\n\n  const handleMouseEnter = (categoryId) => {\n    triggers.current[categoryId] = (triggers.current[categoryId] || 0) + 1;\n    forceUpdate((n) => n + 1);\n  };\n\n  return (\n    <Wrap className={className}>\n      {Object.keys(categories).map((categoryId, index) => {\n        const isLinkSelected = selected === parseInt(categoryId, 10);\n        return (\n          <Fragment key={categories[categoryId].slug}>\n            {index !== 0 && <Cross $colorType={0} />}\n            <StyledLink\n              to={\n                isLinkSelected\n                  ? \"/\"\n                  : `/category/${categories[categoryId].slug}`\n              }\n              selected={isLinkSelected}\n              $colorType={getColorType(parseInt(categoryId, 10))}\n              onClick={onClickCategory(categoryId)}\n              onMouseEnter={() => handleMouseEnter(categoryId)}\n            >\n              <StyledTypingMessage\n                message={categories[categoryId].label}\n                firstMessage={categories[categoryId].label}\n                delayLetter={30}\n                trigger={triggers.current[categoryId] || 0}\n              />\n            </StyledLink>\n          </Fragment>\n        );\n      })}\n    </Wrap>\n  );\n};\n\nexport default CategoriesFilters;\n"],"names":[],"ignoreList":[],"sourceRoot":""}