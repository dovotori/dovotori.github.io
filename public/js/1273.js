"use strict";(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[1273],{83883:(t,e,i)=>{i.d(e,{Z:()=>T});var s=i(85487),n=i(94806),r=i(37195),o=i(28641),a=i(62369),h=i(33983);const c=class{constructor(t,e,i,s,n,r){this.sourceProj_=t,this.targetProj_=e;let h={};const c=(0,a.Ck)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return h[e]||(h[e]=c(t)),h[e]},this.maxSourceExtent_=s,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&(0,o.dz)(s)==(0,o.dz)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,o.dz)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,o.dz)(this.targetProj_.getExtent()):null;const u=(0,o.rL)(i),l=(0,o.Xv)(i),d=(0,o.w$)(i),g=(0,o.hC)(i),_=this.transformInv_(u),f=this.transformInv_(l),m=this.transformInv_(d),v=this.transformInv_(g),E=10+(r?Math.max(0,Math.ceil(Math.log2((0,o.bg)(i)/(r*r*256*256)))):0);if(this.addQuad_(u,l,d,g,_,f,m,v,E),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,s){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach(function(e){if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const s=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-s<this.sourceWorldWidth_/2&&(e.source=i)}}.bind(this))}h={}}addTriangle_(t,e,i,s,n,r){this.triangles_.push({source:[s,n,r],target:[t,e,i]})}addQuad_(t,e,i,s,n,r,a,c,u){const l=(0,o.hI)([n,r,a,c]),d=this.sourceWorldWidth_?(0,o.dz)(l)/this.sourceWorldWidth_:null,g=this.sourceWorldWidth_,_=this.sourceProj_.canWrapX()&&d>.5&&d<1;let f=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const n=(0,o.hI)([t,e,i,s]);f=(0,o.dz)(n)/this.targetWorldWidth_>.25||f}!_&&this.sourceProj_.isGlobal()&&d&&(f=d>.25||f)}if(!f&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!(0,o.kK)(l,this.maxSourceExtent_))return;let m=0;if(!(f||isFinite(n[0])&&isFinite(n[1])&&isFinite(r[0])&&isFinite(r[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(c[0])&&isFinite(c[1])))if(u>0)f=!0;else if(m=(isFinite(n[0])&&isFinite(n[1])?0:8)+(isFinite(r[0])&&isFinite(r[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(c[0])&&isFinite(c[1])?0:1),1!=m&&2!=m&&4!=m&&8!=m)return;if(u>0){if(!f){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],s=this.transformInv_(e);let r;if(_){r=((0,h.$W)(n[0],g)+(0,h.$W)(a[0],g))/2-(0,h.$W)(s[0],g)}else r=(n[0]+a[0])/2-s[0];const o=(n[1]+a[1])/2-s[1];f=r*r+o*o>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const o=[(e[0]+i[0])/2,(e[1]+i[1])/2],h=this.transformInv_(o),l=[(s[0]+t[0])/2,(s[1]+t[1])/2],d=this.transformInv_(l);this.addQuad_(t,e,o,l,n,r,h,d,u-1),this.addQuad_(l,o,i,s,d,h,a,c,u-1)}else{const o=[(t[0]+e[0])/2,(t[1]+e[1])/2],h=this.transformInv_(o),l=[(i[0]+s[0])/2,(i[1]+s[1])/2],d=this.transformInv_(l);this.addQuad_(t,o,l,s,n,h,d,c,u-1),this.addQuad_(o,e,i,l,h,r,a,d,u-1)}return}}if(_){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&m)&&this.addTriangle_(t,i,s,n,a,c),0==(14&m)&&this.addTriangle_(t,i,e,n,a,r),m&&(0==(13&m)&&this.addTriangle_(e,s,t,r,c,n),0==(7&m)&&this.addTriangle_(e,s,i,r,c,a))}calculateSourceExtent(){const t=(0,o.lJ)();return this.triangles_.forEach((function(e,i,s){const n=e.source;(0,o.Wj)(t,n[0]),(0,o.Wj)(t,n[1]),(0,o.Wj)(t,n[2])})),t}getTriangles(){return this.triangles_}};var u=i(68326);let l;const d=[];function g(t,e,i,s,n){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(s,n),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,s)+1,Math.max(i,n)),t.restore()}function _(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function f(t,e,i,s){const n=(0,a.vs)(i,e,t);let r=(0,a._Q)(e,s,i);const h=e.getMetersPerUnit();void 0!==h&&(r*=h);const c=t.getMetersPerUnit();void 0!==c&&(r/=c);const u=t.getExtent();if(!u||(0,o.b8)(u,n)){const e=(0,a._Q)(t,r,n)/r;isFinite(e)&&e>0&&(r/=e)}return r}function m(t,e,i,s,n,r,a,c,f,m,v,E){const T=(0,u.E4)(Math.round(i*t),Math.round(i*e),d);if(E||(T.imageSmoothingEnabled=!1),0===f.length)return T.canvas;function M(t){return Math.round(t*i)/i}T.scale(i,i),T.globalCompositeOperation="lighter";const p=(0,o.lJ)();f.forEach((function(t,e,i){(0,o.l7)(p,t.extent)}));const x=(0,o.dz)(p),W=(0,o.Cr)(p),Z=(0,u.E4)(Math.round(i*x/s),Math.round(i*W/s));E||(Z.imageSmoothingEnabled=!1);const b=i/s;f.forEach((function(t,e,i){const s=t.extent[0]-p[0],n=-(t.extent[3]-p[3]),r=(0,o.dz)(t.extent),a=(0,o.Cr)(t.extent);t.image.width>0&&t.image.height>0&&Z.drawImage(t.image,m,m,t.image.width-2*m,t.image.height-2*m,s*b,n*b,r*b,a*b)}));const I=(0,o.rL)(a);return c.getTriangles().forEach((function(t,e,n){const o=t.source,a=t.target;let c=o[0][0],u=o[0][1],d=o[1][0],f=o[1][1],m=o[2][0],v=o[2][1];const x=M((a[0][0]-I[0])/r),W=M(-(a[0][1]-I[1])/r),b=M((a[1][0]-I[0])/r),P=M(-(a[1][1]-I[1])/r),F=M((a[2][0]-I[0])/r),S=M(-(a[2][1]-I[1])/r),C=c,j=u;c=0,u=0,d-=C,f-=j,m-=C,v-=j;const w=[[d,f,0,0,b-x],[m,v,0,0,F-x],[0,0,d,f,P-W],[0,0,m,v,S-W]],L=(0,h.SV)(w);if(L){if(T.save(),T.beginPath(),function(){if(void 0===l){const t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",g(t,4,5,4,0),g(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;l=_(e,0)||_(e,4)||_(e,8)}return l}()||!E){T.moveTo(b,P);const t=4,e=x-b,i=W-P;for(let s=0;s<t;s++)T.lineTo(b+M((s+1)*e/t),P+M(s*i/(t-1))),s!=t-1&&T.lineTo(b+M((s+1)*e/t),P+M((s+1)*i/(t-1)));T.lineTo(F,S)}else T.moveTo(b,P),T.lineTo(x,W),T.lineTo(F,S);T.clip(),T.transform(L[0],L[2],L[1],L[3],x,W),T.translate(p[0]-C,p[3]-j),T.scale(s/i,-s/i),T.drawImage(Z.canvas,0,0),T.restore()}})),v&&(T.save(),T.globalCompositeOperation="source-over",T.strokeStyle="black",T.lineWidth=1,c.getTriangles().forEach((function(t,e,i){const s=t.target,n=(s[0][0]-I[0])/r,o=-(s[0][1]-I[1])/r,a=(s[1][0]-I[0])/r,h=-(s[1][1]-I[1])/r,c=(s[2][0]-I[0])/r,u=-(s[2][1]-I[1])/r;T.beginPath(),T.moveTo(a,h),T.lineTo(n,o),T.lineTo(c,u),T.closePath(),T.stroke()})),T.restore()),T.canvas}var v=i(65818);class E extends n.Z{constructor(t,e,i,s,n,a,u,l,d,g,_,m){super(n,r.Z.IDLE,{interpolate:!!m}),this.renderEdges_=void 0!==_&&_,this.pixelRatio_=u,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=a||n,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const v=s.getTileCoordExtent(this.wrappedTileCoord_),E=this.targetTileGrid_.getExtent();let T=this.sourceTileGrid_.getExtent();const M=E?(0,o.Ed)(v,E):v;if(0===(0,o.bg)(M))return void(this.state=r.Z.EMPTY);const p=t.getExtent();p&&(T=T?(0,o.Ed)(T,p):p);const x=s.getResolution(this.wrappedTileCoord_[0]),W=function(t,e,i,s){const n=(0,o.qg)(i);let r=f(t,e,n,s);return(!isFinite(r)||r<=0)&&(0,o.H6)(i,(function(i){return r=f(t,e,i,s),isFinite(r)&&r>0})),r}(t,i,M,x);if(!isFinite(W)||W<=0)return void(this.state=r.Z.EMPTY);const Z=void 0!==g?g:.5;if(this.triangulation_=new c(t,i,M,T,W*Z,x),0===this.triangulation_.getTriangles().length)return void(this.state=r.Z.EMPTY);this.sourceZ_=e.getZForResolution(W);let b=this.triangulation_.calculateSourceExtent();if(T&&(t.canWrapX()?(b[1]=(0,h.uZ)(b[1],T[1],T[3]),b[3]=(0,h.uZ)(b[3],T[1],T[3])):b=(0,o.Ed)(b,T)),(0,o.bg)(b)){const t=e.getTileRangeForExtentAndZ(b,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=d(this.sourceZ_,e,i,u);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=r.Z.EMPTY)}else this.state=r.Z.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(function(e,i,s){e&&e.getState()==r.Z.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=r.Z.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],n="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=m(s,n,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,h,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=r.Z.LOADED}this.changed()}load(){if(this.state==r.Z.IDLE){this.state=r.Z.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){const o=e.getState();if(o==r.Z.IDLE||o==r.Z.LOADING){t++;const i=(0,v.oL)(e,s.Z.CHANGE,(function(s){const n=e.getState();n!=r.Z.LOADED&&n!=r.Z.ERROR&&n!=r.Z.EMPTY||((0,v.bN)(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}}.bind(this)),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){t.getState()==r.Z.IDLE&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(v.bN),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,u.jy)(this.canvas_.getContext("2d")),d.push(this.canvas_),this.canvas_=null),super.release()}}const T=E},19307:(t,e,i)=>{i.d(e,{Is:()=>u,cA:()=>c,gn:()=>h});var s=i(33983),n=i(28641),r=i(65537);function o(t,e,i,s){const r=(0,n.dz)(e)/i[0],o=(0,n.Cr)(e)/i[1];return s?Math.min(t,Math.max(r,o)):Math.min(t,Math.min(r,o))}function a(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),(0,s.uZ)(n,i/2,2*e)}function h(t,e,i,n){return e=void 0===e||e,function(h,c,u,l){if(void 0!==h){const d=t[0],g=t[t.length-1],_=i?o(d,i,u,n):d;if(l)return e?a(h,_,g):(0,s.uZ)(h,g,_);const f=Math.min(_,h),m=Math.floor((0,r.h7)(t,f,c));return t[m]>_&&m<t.length-1?t[m+1]:t[m]}}}function c(t,e,i,n,r,h){return n=void 0===n||n,i=void 0!==i?i:0,function(c,u,l,d){if(void 0!==c){const g=r?o(e,r,l,h):e;if(d)return n?a(c,g,i):(0,s.uZ)(c,i,g);const _=1e-9,f=Math.ceil(Math.log(e/g)/Math.log(t)-_),m=-u*(.5-_)+.5,v=Math.min(g,c),E=Math.floor(Math.log(e/v)/Math.log(t)+m),T=Math.max(f,E),M=e/Math.pow(t,T);return(0,s.uZ)(M,i,g)}}}function u(t,e,i,n,r){return i=void 0===i||i,function(h,c,u,l){if(void 0!==h){const c=n?o(t,n,u,r):t;return i&&l?a(h,c,e):(0,s.uZ)(h,e,c)}}}},60828:(t,e,i)=>{i.d(e,{Gw:()=>a,YP:()=>r,gE:()=>o,h$:()=>n});var s=i(33983);function n(t){return void 0!==t?0:void 0}function r(t){return void 0!==t?t:void 0}function o(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}function a(t){return t=t||(0,s.Yr)(5),function(e,i){return i?e:void 0!==e?Math.abs(e)<=t?0:e:void 0}}},4307:(t,e,i)=>{function s(t){return t[0]>0&&t[1]>0}function n(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function r(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}i.d(e,{Pq:()=>r,bA:()=>n,py:()=>s})}}]);