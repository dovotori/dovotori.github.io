"use strict";(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[6717],{7820(t,e,s){s.d(e,{NU:()=>o,bz:()=>i});const i=(t,e,s)=>{const i=document.querySelector(e);i.download=`${s}${Date.now()}.svg`;let o=(new XMLSerializer).serializeToString(t);o=`<?xml version="1.0" standalone="no"?>\r\n${o}`;const r=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(o)}`;i.href=r},o=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return new Promise((e=>{setTimeout(e,t)}))}},10334(t,e,s){s.d(e,{A:()=>o});var i=s(65525);const o=class extends i.A{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=((t,e)=>Object.keys(e).reduce(((s,i)=>{const o=e[i];let r,h,n,l;switch(i){case"color":h="VEC4",n=4,r=t.FLOAT,l=new Float32Array(o);break;case"texture":h="VEC2",n=2,r=t.FLOAT,l=new Float32Array(o);break;case"indices":h="SCALAR",n=1,r=t.UNSIGNED_SHORT,l=new Uint16Array(o);break;case"side":case"index":case"random":h="FLOAT",n=1,r=t.FLOAT,l=new Float32Array(o);break;default:h="VEC3",n=3,r=t.FLOAT,l=new Float32Array(o)}return s[i]={locationKey:i,type:h,values:l,count:o.length/n,componentType:r,size:n},s}),{}))(t,e);super(t,i,s)}}},12911(t,e,s){s.d(e,{A:()=>r});var i=s(20226),o=s(10334);const r=class{constructor(t){this.gl=t,this.objet=new o.A(t,i.A)}render(t){this.gl.disable(this.gl.CULL_FACE),this.objet.render(t),this.gl.enable(this.gl.CULL_FACE)}}},20226(t,e,s){s.d(e,{A:()=>i});const i={position:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],indices:[0,1,2,1,3,2],texture:[0,0,1,0,0,1,1,1]}},32099(t,e,s){s.d(e,{A:()=>i});const i=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64;this.gl=t,this.size={width:e,height:s},this.texture=t.createTexture(),this.filter=t.NEAREST,this.setup()}setup(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.create(),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}create(){const t=new ArrayBuffer(this.size.width*this.size.height),e=new Uint8Array(t);let s=0;for(let t=0;t<this.size.height;t+=1)for(let t=0;t<this.size.width;t+=1)e[s]=255*Math.random(),s+=1;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.ALPHA,this.size.width,this.size.height,0,this.gl.ALPHA,this.gl.UNSIGNED_BYTE,e)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}get(){return this.texture}setFiltre(t){this.filter=t}delete(){this.gl.deleteTexture(this.texture)}}},55179(t,e,s){s.d(e,{A:()=>i});const i=class{constructor(t,e){this.gl=t;const s=Math.sqrt(e.length/4);this.size={width:s,height:s},this.texture=t.createTexture(),this.filter=t.NEAREST,this.setup(e)}setup(t){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}get(){return this.texture}}},65525(t,e,s){s.d(e,{A:()=>r});var i=s(54705);const o=class{constructor(t,e){this.gl=t,e&&this.create(e),this.extension=t.getExtension("ANGLE_instanced_arrays")}create(t){const{locationKey:e,type:s,values:i,count:o,componentType:r,size:h,modeCalcul:n,isInstancing:l=!1}=t,a="SCALAR"!==s?this.gl.ARRAY_BUFFER:this.gl.ELEMENT_ARRAY_BUFFER;this.vbo=this.gl.createBuffer(),this.gl.bindBuffer(a,this.vbo),this.gl.bufferData(a,i,n),this.gl.bindBuffer(a,null),this.size=h,this.count=o,this.componentType=r,this.bufferType=a,this.locationKey=e,this.isInstancing=l}enable(t){const{locationKey:e,vbo:s,componentType:i,size:o,bufferType:r,isInstancing:h=!1}=this;if("indices"===e)this.gl.bindBuffer(r,s);else{const n=t.locations[e];void 0!==n&&-1!==n&&(this.gl.bindBuffer(r,s),this.gl.enableVertexAttribArray(n),this.gl.vertexAttribPointer(n,o,i,!1,0,0),h&&this.extension.vertexAttribDivisorANGLE(n,1))}}start(t){this.gl.useProgram(t)}end(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}update(t){this.gl.bindBuffer(this.bufferType,this.vbo),this.gl.bufferSubData(this.bufferType,0,new Float32Array(t)),this.gl.bindBuffer(this.bufferType,null)}render(t,e){"indices"===this.locationKey?this.gl.drawElements(e,this.count,this.componentType,0):this.gl.drawArrays(e,0,this.count)}renderInstancing(t,e,s){"indices"===this.locationKey?this.extension.drawElementsInstancedANGLE(e,this.count,this.gl.UNSIGNED_SHORT,0,s):this.extension.drawArraysInstancedANGLE(e,0,this.count,s)}getCount(){return this.count}},r=class{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,i.A)(this,"getActiveVbo",(()=>this.vbos.indices||this.vbos.position||this.vbos.texture||this.vbos.index)),this.gl=t,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=s?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,this.vbos=Object.keys(e).reduce(((s,i)=>(s[i]=new o(t,{locationKey:i,modeCalcul:this.modeCalcul,...e[i]}),s)),{}),this.instanceCount=-1}addInstancingVbos(t,e){const s=Object.keys(e).reduce(((t,s)=>(t[s]=new o(this.gl,{locationKey:s,modeCalcul:this.modeCalcul,isInstancing:!0,...e[s]}),t)),{});this.vbos={...this.vbos,...s},this.instanceCount=t}enable(t){this.gl.useProgram(t),Object.keys(this.vbos).forEach((e=>{this.vbos[e].enable(t)}))}update(t){Object.keys(t).forEach((e=>{this.vbos[e].update(t[e])}))}render(t){this.enable(t);const e=this.getActiveVbo();-1!==this.instanceCount?e.renderInstancing(t,this.modeDessin,this.instanceCount):e.render(t,this.modeDessin),e.end()}setModeDessin(t){this.modeDessin=t}setModeCalcul(t){this.modeCalcul=t}}},76717(t,e,s){s.d(e,{A:()=>O});var i=s(54705),o=s(67269),r=s(7567),h=s(55179),n=s(65525);const l=class{constructor(t,e){let{vbos:s,material:o={}}=e;(0,i.A)(this,"addInstancing",((t,e)=>{this.vbos.addInstancingVbos(t,e)})),this.material=o,this.vbos=new n.A(t,s),o.normalMap&&(this.normalMap=new h.A(t,o.normalMap.data))}render(t){const{color:e,metal:s,rough:i,ao:o}=this.material;t.setVector("color",e||[1,1,1,1]),t.setFloat("metal",void 0!==s?s:0),t.setFloat("rough",void 0!==i?i:.5),t.setFloat("ao",void 0!==o?o:1),this.vbos.render(t.get())}setModeDessin(t){this.vbos.setModeDessin(t)}setModeCalcul(t){this.vbos.setModeCalcul(t)}};class a{constructor(t,e){(0,i.A)(this,"renderNodesAndChildren",((t,e,s)=>{Object.keys(t).forEach((i=>{const o=t[i];this.renderNodeAndChildren(o,e,s)}))})),(0,i.A)(this,"renderNodeAndChildren",((t,e,s)=>{let i=s;"joint"!==t.customType&&(i=this.setNodeModel(t,e,s),this.renderNode(t,e)),t.children&&this.renderNodesAndChildren(t.children,e,i)})),(0,i.A)(this,"setNodeModel",((t,e,s)=>{const i=this.handleLocalTransform(t);i.multiply(s),e.setMatrix("model",i.get());const o=i.getMatrice3x3();return o.inverse(),o.transpose(),e.setMatrix("normalMatrix",o.get()),i})),(0,i.A)(this,"handleLocalTransform",(t=>{const{translation:e,rotation:s,scale:i,matrix:h}=t,n=new o.A;return n.identity(),i&&n.scale(...i),s&&n.multiply(new r.A(...s).toMatrix4()),e&&n.translate(...e),h&&n.multiplyArray(h),n}));const{nodes:s,meshes:h,materials:n}=e;this.meshes=h.map((e=>{let{primitives:s,name:i="",weights:o}=e;const r=s.map((t=>void 0!==t.material?{...t,material:n[t.material]}:t));return{name:i,primitives:a.formatPrimitives(t,r),weights:o}})),this.nodes=s}addInstancingVbos(t,e){Object.keys(this.nodes).forEach((s=>{const i=this.nodes[s],{mesh:o}=i,{primitives:r}=this.meshes[o];r.forEach((s=>{s.addInstancing(t,e)}))}))}render(t,e){this.renderNodesAndChildren(this.nodes,t,e)}renderOnly(t,e,s){t.forEach((t=>{const i=this.nodes[t];this.renderNodeAndChildren(i,e,s)}))}renderExcept(t,e,s){Object.keys(this.nodes).forEach((i=>{if(-1===t.indexOf(i)){const t=this.nodes[i];this.renderNodeAndChildren(t,e,s)}}))}renderNode(t,e){if(void 0!==t.mesh){const{mesh:s}=t,{primitives:i}=this.meshes[s];i.forEach((t=>{t.render(e)}))}}}(0,i.A)(a,"formatPrimitives",((t,e)=>e.map((e=>{const{vbos:s,material:i}=e;return new l(t,{vbos:s,material:i})}))));const g=a;var c=s(67470),u=s(40117),d=s(4689);class p extends g{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(t,e),(0,i.A)(this,"addAllAnimations",((t,e)=>Object.keys(t).reduce(((s,i)=>{let o=s;const{animations:r,name:h,children:n}=t[i];return r&&(o[h]=this.addAnimations(r,e)),n&&(o={...s,...this.addAllAnimations(n,e)}),o}),{}))),(0,i.A)(this,"addAnimations",((t,e)=>{const s={};return t.forEach((t=>{let{path:i,times:o,output:h,interpolation:n}=t,l=null!==e?h[e]:h[0];"rotation"===i&&(l=new r.A(...l).toMatrix4()),this.animationInterval[1]=Math.max(...o,this.animationInterval[1]),s[i]={output:h,sample:new u.A(o,n,this.speedAnimation),customStep:e,value:l}})),s})),(0,i.A)(this,"removeNodesAnimations",(t=>Object.keys(t).reduce(((e,s)=>{let i=e;const o=t[s];return i[o.name]=p.removeNodeAnim(o),o.children&&(i={...i,...this.removeNodesAnimations(o.children)}),e}),{}))),(0,i.A)(this,"update",(t=>{const e=t-this.lastFrame;e>this.animationInterval[1]*this.speedAnimation&&(this.lastFrame=t),this.updateAnimations(e)})),(0,i.A)(this,"updateAnimations",(t=>{Object.keys(this.animations).forEach((e=>{const s=this.animations[e];Object.keys(s).forEach((e=>{s[e]="rotation"===e?p.updateQuat(s[e],t):p.updateVector(s[e],t)}))}))})),(0,i.A)(this,"handleLocalTransform",(t=>{const{translation:e,rotation:s,scale:i,matrix:r,name:h}=t,n=this.animations[h],l=n?.rotation||null,a=n?.translation||null,g=n?.scale||null,c=new o.A;return c.identity(),(i||g)&&c.scale(...p.getVector(i,g)),(s||l)&&c.multiply(p.getRotationMat(s,l)),(e||a)&&c.translate(...p.getVector(e,a)),r&&c.multiplyArray(r),c})),(0,i.A)(this,"setAnimationStep",((t,e,s)=>{const i=this.animations[t][e],o=i.output.length,r=(0,d.cy)(s,0,1,0,o-1);i.customStep=Math.round(r)})),(0,i.A)(this,"setAnimationSpeed",((t,e,s)=>{this.animations[t][e].sample.setSpeed(s)}));const{nodes:h}=e;this.speedAnimation=2e3,this.animationInterval=[0,0],this.animations=this.addAllAnimations(h,s),this.nodes=this.removeNodesAnimations(h),this.lastFrame=0}}(0,i.A)(p,"removeNodeAnim",(t=>{const{animations:e,...s}=t;return s})),(0,i.A)(p,"getAnimationInterval",(t=>{let e=0;return t.forEach((t=>{const{animations:s}=t;s&&s.forEach((t=>{const{times:s}=t;e=Math.max(...s,e)}))})),[0,e]})),(0,i.A)(p,"updateVector",((t,e)=>{const s=t,{sample:i,customStep:o,output:r}=s;if(null===o){i.update(e);const t=i.getIndex();if(0===t)[s.value]=r;else if(t>r.length-1)s.value=r[r.length-1];else{const e=r[t-1],o=r[t],h=i.get();s.value=e.map(((t,e)=>(0,c.Cc)(h,t,o[e])))}}else s.value=r[o];return s})),(0,i.A)(p,"updateQuat",((t,e)=>{const s=t,{sample:i,customStep:o,output:h}=s;if(null===o){i.update(e);const t=i.getIndex();if(0===t)s.value=new r.A(...h[0]).toMatrix4();else if(t>h.length-1)s.value=new r.A(...h[h.length-1]).toMatrix4();else{const e=h[t-1],o=h[t],n=i.get();s.value=r.A.slerpArray(e,o,n).toMatrix4()}}else s.value=new r.A(...h[o]).toMatrix4();return s})),(0,i.A)(p,"getVector",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?.value?e.value:t})),(0,i.A)(p,"getRotationMat",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,1],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e?.value?e.value:new r.A(...t).toMatrix4()}));const m=p;const T=class extends m{constructor(t,e){var s;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(t,e),s=this,(0,i.A)(this,"removeAnimations",(t=>t.map((t=>{const e=t;return e.children&&(e.children=this.removeAnimations(e.children)),m.removeNodeAnim(e)})))),(0,i.A)(this,"addJointsAnimations",((t,e)=>{t.forEach((t=>{const{animations:s,name:i,children:o}=t;s&&(this.animations[i]=this.addAnimations(s,e)),o&&this.addJointsAnimations(o,e)}))})),(0,i.A)(this,"setProgramSkin",((t,e)=>{if(void 0!==t){const s=new o.A;s.identity();const{joints:i}=this.skins[t];this.setProgramJoints(i,e,s)}})),(0,i.A)(this,"setProgramJoints",(function(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t.forEach((t=>{const{invMatrix:h,children:n}=t,l=s.handleLocalTransform(t);l.multiply(i);const a=new o.A;a.identity();const g=new o.A;g.setFromArray(h),a.multiply(g),a.multiply(l),e.setMatrix(`jointMat[${r}]`,a.get()),n&&s.setProgramJoints(n,e,l,r+1)}))}));const{skins:h}=e;h&&(h.forEach((t=>{let{joints:e}=t;this.addJointsAnimations(e,r)})),this.skins=h.map((t=>{let{joints:e}=t;return{joints:this.removeAnimations(e)}})))}renderNode(t,e,s){const{skin:i}=t;void 0!==i&&this.setProgramSkin(i,e),super.renderNode(t,e,s)}},E=class{constructor(t,e){(0,i.A)(this,"hasAnimation",(t=>{let e=!1;return Object.keys(t).forEach((s=>{const i=t[s];!e&&i.animations&&(e=!0)})),e})),this.gltfs={},Object.keys(e).forEach((s=>{e[s].skins?this.gltfs[s]=new T(t,e[s]):this.hasAnimation(e[s].nodes)?this.gltfs[s]=new m(t,e[s]):this.gltfs[s]=new g(t,e[s])}))}get(t){return this.gltfs[t]}},A={ambiant:[0,0,0],diffuse:[.5,.5,.5],specular:[1,1,1],emissive:[0,0,0],specDensity:[1],opacity:1},f=class{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.gl=t,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=this.gl.STATIC_DRAW,this.materialProps={},this.steps=this.getSteps(e,s);const i=this.getPoints(e,s);this.stride=0,Object.entries(this.steps).forEach((t=>{null!==t[1]&&(this.stride+=t[1])})),this.vbo=this.gl.createBuffer(),this.count=i.length/this.stride,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(i),this.modeCalcul),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}enable(t){this.gl.useProgram(t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo);let e=0;Object.entries(this.steps).forEach((s=>{const[i,o]=s;void 0!==t.locations[i]&&-1!==t.locations[i]&&(this.gl.enableVertexAttribArray(t.locations[i]),this.gl.vertexAttribPointer(t.locations[i],o,this.gl.FLOAT,!1,4*this.stride,4*e)),null!==this.steps[i]&&(e+=this.steps[i])}))}render(t){this.enable(t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.drawArrays(this.modeDessin,0,this.count),this.end()}end(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}setModeDessin(t){this.modeDessin=t}setModeCalcul(t){this.modeCalcul=t}getSteps(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s={position:3};return t.vt.indices.length>0&&(s.texture=2),t.vn.indices.length>0&&(s.normale=3),e&&t.mat&&Object.keys(t.mat).forEach((s=>{const i=t.mat[s],o=e[i];o&&Object.keys(o).forEach((t=>{void 0===this.materialProps[t]&&(this.materialProps[t]=o[t].length)}))})),{...s,...this.materialProps}}getPoints(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=[];return t.v.indices.forEach(((i,o)=>{const r=3*i;if(s.push(t.v.points[r]),s.push(t.v.points[r+1]),s.push(t.v.points[r+2]),t.vt.indices.length>0){const e=2*t.vt.indices[o];s.push(t.vt.points[e]),s.push(t.vt.points[e+1])}if(t.vn.indices.length>0){const e=3*t.vn.indices[o];s.push(t.vn.points[e]),s.push(t.vn.points[e+1]),s.push(t.vn.points[e+2])}if(e&&t.mat){const i=Object.keys(t.mat).findIndex(((e,s)=>{const i=Object.keys(t.mat)[s+1];return!i||o>=e&&o<i})),r=t.mat[Object.keys(t.mat)[i]];Object.keys(this.materialProps).forEach((t=>{(e[r]?.[t]||A[t]).forEach((t=>{s.push(t)}))}))}})),s}},v=class{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.objets={},Object.keys(e).forEach((i=>{this.objets[i]=new f(t,e[i],s?.[i])}))}get(t){return this.objets[t]}};var b=s(7820);const P=class{constructor(t,e){(0,i.A)(this,"getLocation",(t=>this.program.locations[t]||null)),this.gl=t,this.program=this.gl.createProgram(),this.setup(e)}setup(t){this.creerShader("vertex",t.vertex),this.creerShader("fragment",t.fragment),this.gl.linkProgram(this.program),this.gl.useProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)?(this.createLocations(t),this.gl.useProgram(null)):this.gl.deleteProgram(this.program)}creerShader(t,e){const s=this.gl.createShader("vertex"===t?this.gl.VERTEX_SHADER:this.gl.FRAGMENT_SHADER);this.gl.shaderSource(s,e),this.gl.compileShader(s),this.gl.getShaderParameter(s,this.gl.COMPILE_STATUS)?(this.gl.attachShader(this.program,s),this.gl.deleteShader(s)):this.gl.deleteShader(s)}createLocations(t){this.program.locations={},t.uniforms.forEach((t=>{this.program.locations[t]=this.gl.getUniformLocation(this.program,t)})),t.attributes.forEach((t=>{this.program.locations[t]=this.gl.getAttribLocation(this.program,t)}))}setProjectionView(t){this.setMatrix("projection",t.getProjection().get()),this.setMatrix("view",t.getView().get())}setMatrix(t,e){const s=this.getLocation(t);null!==s&&(this.gl.useProgram(this.program),16===e.length?this.gl.uniformMatrix4fv(s,!1,e):this.gl.uniformMatrix3fv(s,!1,e),this.gl.useProgram(null))}setInt(t,e){const s=this.getLocation(t);null!==s&&(this.gl.useProgram(this.program),this.gl.uniform1i(s,e),this.gl.useProgram(null))}setTexture(t,e,s){const i=this.getLocation(s);null!==i&&(this.gl.useProgram(this.program),this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(i,t),this.gl.useProgram(null))}setFloat(t,e){const s=this.getLocation(t);null!==s&&(this.gl.useProgram(this.program),this.gl.uniform1f(s,e),this.gl.useProgram(null))}setVector(t,e){const s=this.getLocation(t);if(null!==s){switch(this.gl.useProgram(this.program),e.length){case 3:this.gl.uniform3fv(s,e);break;case 4:this.gl.uniform4fv(s,e);break;default:this.gl.uniform2fv(s,e)}this.gl.useProgram(null)}}enable(){this.gl.useProgram(this.program)}disable(){this.gl.useProgram(null)}get(){return this.program}getLocations(){return this.program.locations}},x=class{constructor(){(0,i.A)(this,"updateResolution",((t,e)=>{Object.keys(this.programs).forEach((s=>{this.programs[s].setVector("resolution",[t,e])}))})),(0,i.A)(this,"getAll",(()=>this.programs)),this.programs={}}async setup(t,e,s){performance.now();const i=function*(){const s=Object.keys(e);for(let i=0;i<s.length;i++){const o=s[i],r=e[o];yield{prog:new P(t,r),name:o}}}();for(const t of i)await(0,b.NU)(),this.programs[t.name]=t.prog;this.updateResolution(s.width,s.height)}setCameraMatrix(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(this.programs).forEach((s=>{this.programs[s].setMatrix("view",t.getView().get());const i=e?t.getOrtho():t.getProjection();this.programs[s].setMatrix("projection",i.get())}))}get(t){return this.programs[t]}},y=class{constructor(t){(0,i.A)(this,"saveData",(t=>{this.audioData=t})),(0,i.A)(this,"togglePause",(()=>{this.isPlaying?this.isPause?(this.audioContext.resume(),this.isPause=!1):(this.audioContext.suspend(),this.isPause=!0):(this.play(),this.isPause=!1)})),(0,i.A)(this,"stop",(()=>{this.clearAnalyse(),this.sourceNode&&(this.sourceNode.removeEventListener("ended",this.stop,!1),this.sourceNode.disconnect(),this.sourceNode.stop(0)),this.isPlaying=!1})),(0,i.A)(this,"toggle",(()=>{this.isPlaying?this.stop():this.play()})),(0,i.A)(this,"clearAnalyse",(()=>{this.amplitudeArray.fill(0),this.javascriptNode&&(this.analyserNode.disconnect(),this.javascriptNode.disconnect(),this.javascriptNode.removeEventListener("audioprocess",this.onAnalyse,!1))})),(0,i.A)(this,"onAnalyse",(()=>{this.analyserNode.getByteFrequencyData(this.amplitudeArray)})),(0,i.A)(this,"onError",(t=>{})),(0,i.A)(this,"setPlaybackRate",(t=>{this.playbackRate=t,this.sourceNode&&(this.sourceNode.playbackRate.value=this.playbackRate)})),(0,i.A)(this,"setVolume",(t=>{this.volume=t,this.gainNode&&(this.gainNode.gain.value=this.volume)})),(0,i.A)(this,"getAmplitudes",(()=>this.amplitudeArray)),(0,i.A)(this,"getFrequencyLength",(()=>this.analyserNode.frequencyBinCount)),(0,i.A)(this,"getIsPlaying",(()=>this.isPlaying)),(0,i.A)(this,"getIsPause",(()=>this.isPause));const e=window.AudioContext||window.webkitAudioContext;this.support=!!e;try{this.audioContext=new e}catch(t){this.support=!1}this.audioData=null,this.playbackRate=1,this.playMultiple=!1,this.isPlaying=!1,this.isPause=!0,this.isMute=!0,this.isLoop=!0,this.volume=.5,this.setup(t)}setup(t){this.support&&(this.audioContext.decodeAudioData(t,this.saveData,this.onError),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=this.volume,this.gainNode.connect(this.audioContext.destination),this.sampleSize=2048,this.javascriptNode=this.audioContext.createScriptProcessor(this.sampleSize,1,1),this.analyserNode=this.audioContext.createAnalyser(),this.analyserNode.minDecibels=-90,this.analyserNode.maxDecibels=-30,this.analyserNode.fftSize=this.sampleSize,this.amplitudeArray=new Uint8Array(this.analyserNode.frequencyBinCount))}play(){this.audioData&&(!this.playMultiple&&this.isPlaying&&this.stop(),this.sourceNode=this.audioContext.createBufferSource(),this.sourceNode.playbackRate.value=this.playbackRate,this.sourceNode.buffer=this.audioData,this.sourceNode.loop=this.isLoop,this.sourceNode.connect(this.gainNode),this.setupAnalyse(),this.sourceNode.addEventListener("ended",this.stop,!1),this.sourceNode.start(0),this.isPlaying=!0)}setupAnalyse(){this.sourceNode.connect(this.analyserNode),this.analyserNode.connect(this.javascriptNode),this.javascriptNode.connect(this.audioContext.destination),this.javascriptNode.addEventListener("audioprocess",this.onAnalyse,!1)}getSupport(){return this.support}},R=class{constructor(t){this.audios={},Object.keys(t).forEach((e=>{this.audios[e]=new y(t[e])}))}get(t){return this.audios[t]}},w=class{constructor(t,e,s){this.gl=t,this.texture=t.createTexture(),this.filter=s?t[s]:t.NEAREST,this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}get(){return this.texture}},F=class{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.textures={},Object.keys(e).forEach((i=>{this.textures[i]=new w(t,e[i],s[i])}))}get(t){return this.textures[t]}};var _=s(12911),N=s(82669);const D=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.fbos=[],this.currentFbo=0,this.fbos[0]=new N.A(t,e,s,i,0),this.fbos[1]=new N.A(t,e,s,i,1)}start(){this.fbos[this.currentFbo].start()}end(){this.fbos[this.currentFbo].end()}swap(){this.currentFbo=0===this.currentFbo?1:0}resize(t){this.fbos[0].resize(t),this.fbos[1].resize(t)}getTexture(){return this.fbos[this.currentFbo].getTexture()}getDepthTexture(){return this.fbos[this.currentFbo].getDepthTexture()}},U=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.gl=t;const{width:i=1024,height:o=1024,useDepth:r=!1}=e;this.ppb=new D(t,i,o,r),this.screen=new _.A(t),this.passCount=0,this.programs=s,this.viewportSize={width:i,height:o}}start(){this.ppb.start(),this.passCount=0}end(){this.ppb.end()}resize(t){this.ppb.resize(t),this.viewportSize=t}applyTexToProg(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=null===e;this.passCount=s?this.passCount+1:0;const i=this.passCount+1,o=s?this.ppb.getTexture().get():e;return t.setTexture(i,o,"textureMap"),t.setFloat("flipY",-1),t}setBrightContrast(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.applyTexToProg(this.programs.brightcontrast,s);i.setFloat("brightness",t),i.setFloat("contrast",e),this.renderToPingPong(i)}setFxaa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.applyTexToProg(this.programs.fxaa,t);this.renderToPingPong(e)}setFxaa2(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.applyTexToProg(this.programs.fxaa2,t);this.renderToPingPong(e)}renderToPingPong(t){this.ppb.swap(),this.ppb.start(),this.screen.render(t.get()),this.ppb.end()}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=this.applyTexToProg(this.programs[e?"debug":"screen"],t);this.gl.viewport(0,0,this.viewportSize.width,this.viewportSize.height),this.screen.render(s.get())}renderInverse(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=this.applyTexToProg(this.programs[e?"debug":"screen"],t);s.setFloat("flipY",1),this.gl.viewport(0,0,this.viewportSize.width,this.viewportSize.height),this.screen.render(s.get())}getTexture(){return this.ppb.getTexture()}},S=class extends U{constructor(t,e){super(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),(0,i.A)(this,"setBlurIntensity",(t=>{this.blurIntensity=t})),(0,i.A)(this,"setBlurSize",(t=>{this.blurSize=t}));const s=e.blur||{};this.blurSize=void 0!==s.size?s.size:.6,this.blurIntensity=void 0!==s.intensity?s.intensity:1}setBlur(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.applyTexToProg(this.programs.blurOnePass,t);e.setFloat("size",this.blurSize),e.setFloat("intensity",this.blurIntensity),this.renderToPingPong(e)}},M=class extends S{constructor(t,e){super(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),(0,i.A)(this,"setNbPass",(t=>{this.blurNbPass=t})),this.scale=void 0!==e.scale?e.scale:1,this.threshold=void 0!==e.threshold?e.threshold:.1}end(){super.end(),this.process()}process(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.applyTexToProg(this.programs.bloom,t);e.setFloat("scale",this.scale),e.setFloat("threshold",this.threshold),this.renderToPingPong(e),this.setBlur()}};var C=s(32099);const I=class extends C.A{create(){const t=new ArrayBuffer(this.size.width*this.size.height*4),e=new Uint8Array(t);let s=0;for(let t=0;t<this.size.height;t+=1)for(let t=0;t<this.size.width;t+=1)e[s]=255*Math.random(),e[s+1]=255*Math.random(),e[s+2]=0,e[s+3]=255,s+=4;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.height,this.size.width,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}},L=class extends U{constructor(t,e){super(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.textures={},Object.keys(this.programs).forEach((t=>{switch(t){case"watercolor2":case"watercolor3":this.textures[t]=new I(this.gl,512,512)}}))}setDOF(t,e,s,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const r=this.applyTexToProg(this.programs.dof,o);r.setFloat("focusDistance",s),r.setFloat("blur",e),r.setFloat("ppm",i),r.setVector("range",t),r.setTexture(2,this.ppb.getDepthTexture().get(),"depthMap"),this.renderToPingPong(r)}mergeBloom(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.applyTexToProg(this.programs.mergeBloom,i);o.setFloat("gamma",e),o.setFloat("exposure",s),o.setTexture(3,t.get(),"bloomMap"),this.renderToPingPong(o)}setKuwahara(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.applyTexToProg(this.programs.kuwahara,t);this.renderToPingPong(e)}setWatercolor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.applyTexToProg(this.programs.watercolor,t);this.renderToPingPong(e)}setWatercolor2(t,e,s,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const r=this.applyTexToProg(this.programs.watercolor2,o);r.setFloat("gradientStep",t),r.setFloat("advectStep",e),r.setFloat("flipHeightMap",s),r.setFloat("time",i),r.setTexture(2,this.textures.watercolor2.get(),"heightMap"),this.renderToPingPong(r)}setWatercolor3(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.applyTexToProg(this.programs.watercolor3,t);e.setTexture(2,this.textures.watercolor3.get(),"noiseMap"),this.renderToPingPong(e)}setWatercolorMoving(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.applyTexToProg(this.programs.watercolorMoving,i);o.setFloat("time",t),o.setVector("mouse",e),o.setFloat("scale",s),this.renderToPingPong(o)}setSobel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const e=this.applyTexToProg(this.programs.sobel,t);this.renderToPingPong(e)}setGamma(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.applyTexToProg(this.programs.gamma,e);s.setFloat("gamma",t),this.renderToPingPong(s)}setRGB(t,e,s,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const r=this.applyTexToProg(this.programs.rgb,o);r.setVector("center",[s,i]),r.setVector("delta",[t,e]),this.renderToPingPong(r)}setVortex(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.applyTexToProg(this.programs.vortex,i);o.setVector("center",t),o.setFloat("radius",e),o.setFloat("angle",s),this.renderToPingPong(o)}setOil(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.applyTexToProg(this.programs.oil,e);s.setFloat("radius",t),this.renderToPingPong(s)}setSketch(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.applyTexToProg(this.programs.sketch,e);s.setFloat("delta",t),this.renderToPingPong(s)}setPixel(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.applyTexToProg(this.programs.pixel,s);i.setVector("delta",[t,e]),this.renderToPingPong(i)}setWave(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.applyTexToProg(this.programs.wave,i);o.setFloat("time",t),o.setFloat("radius",e),o.setVector("center",s),this.renderToPingPong(o)}setSepia(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.applyTexToProg(this.programs.sepia,e);s.setFloat("delta",t),this.renderToPingPong(s)}setGlitch(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.applyTexToProg(this.programs.glitch,i);o.setFloat("delta",e),o.setFloat("time",t),o.setFloat("speed",s),this.renderToPingPong(o)}setGlitch2(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.applyTexToProg(this.programs.glitch2,i);o.setFloat("delta",e),o.setFloat("time",t),o.setFloat("speed",s),this.renderToPingPong(o)}setGlitch3(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.applyTexToProg(this.programs.glitch3,s);i.setFloat("delta",e),i.setFloat("time",t),this.renderToPingPong(i)}setGlitch4(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.applyTexToProg(this.programs.glitch4,i);o.setFloat("delta",e),o.setFloat("time",t),o.setFloat("rate",s),this.renderToPingPong(o)}setSignature(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.applyTexToProg(this.programs.signature,s);i.setFloat("delta",e),i.setFloat("time",t),this.renderToPingPong(i)}setCompose(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.applyTexToProg(this.programs.compose,i);o.setTexture(6,t,"ssaoMap"),o.setTexture(7,e,"shadowMap"),o.setTexture(4,s,"depthMap"),this.renderToPingPong(o)}setComposeShadow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.applyTexToProg(this.programs.composeShadow,e);s.setTexture(4,t,"shadowMap"),this.renderToPingPong(s)}},B=class extends S{constructor(t,e){super(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),(0,i.A)(this,"getProgram",(()=>this.programs.shadow));const s=this.programs.shadow;s.setFloat("shadowEpsilon",e.epsilon||.01),s.setFloat("lighten",e.lighten||0)}start(t){const e=this.programs.shadow;t.setShadowProgram(e),super.start()}};var X=s(54096);const z=class extends S{constructor(t,e){super(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.near=e.near||1,this.far=e.far||100,this.radius=e.radius||5,this.strength=e.strength||1;const s=this.programs.ssao;s.setFloat("radius",this.radius),s.setFloat("near",this.near),s.setFloat("far",this.far),s.setFloat("strength",this.strength)}generateSsaoSamples(t,e){for(let s=0;s<e;s+=1){let i=s/e;i=(0,c.Cc)(i*i,.1,1);const o=new X.A((0,d.yT)(-1,1),(0,d.yT)(-1,1),(0,d.yT)(0,1)).normalise().multiplyNumber((0,d.yT)(0,1)).multiplyNumber(i);this.programs[t].setVector(`samples[${s}]`,o.get())}}compute(t){const e=this.applyTexToProg(this.programs.ssao,t);e.setFloat("flipY",-1),this.renderToPingPong(e)}},O=class{constructor(t,e){this.gl=t,this.config=e,this.time=0;const{width:s,height:i}=this.config.canvas;this.containerSize={width:s,height:i}}async setupAssets(t){const{config:e,gl:s}=this,{width:i,height:o}=e.canvas;if(t?.shaders&&(this.mngProg=new x,await this.mngProg.setup(s,t.shaders,e.canvas),e.postprocess)){const t={width:i,height:o,useDepth:this.canUseDepth()},r=this.mngProg.getAll();this.postProcess=new L(s,t,r),e.postprocess.bloom&&(this.bloom=new M(s,{...t,...e.postprocess.bloom},r)),e.postprocess.ssao&&(this.ssao=new z(s,{...t,...e.postprocess.ssao,near:e.camera.near,far:e.camera.far},r)),e.postprocess.shadow&&(this.shadow=new B(s,{...t,...e.postprocess.shadow},r))}t?.textures&&(this.mngTex=new F(s,t.textures,e.textures)),t?.objets&&(this.mngObj=new v(s,t.objets,t.materials)),t?.gltfs&&(this.mngGltf=new E(s,t.gltfs)),t?.sounds&&(this.mngSound=new R(t.sounds)),this.resizeViewport()}canUseDepth(){return this.config.useDepthTexture&&this.config.support.depthTexture||!1}resize(t){this.containerSize=t,this.postProcess&&this.postProcess.resize(t),this.bloom&&this.bloom.resize(t),this.ssao&&this.ssao.resize(t),this.shadow&&this.shadow.resize(t),this.mngProg.updateResolution(this.containerSize.width,this.containerSize.height),this.resizeViewport()}update(t){this.time=t}render(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}resizeViewport(){this.gl.viewport(0,0,this.containerSize.width,this.containerSize.height)}getColorPixel(t,e){const s=new Uint8Array(4);return this.gl.readPixels(t,e,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),s}}},82669(t,e,s){s.d(e,{A:()=>h});var i=s(32099);const o=class extends i.A{create(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.DEPTH_COMPONENT,this.size.width,this.size.height,0,this.gl.DEPTH_COMPONENT,this.gl.UNSIGNED_INT,null)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}},r=class extends i.A{create(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}},h=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.gl=t,this.buffer=this.gl.createFramebuffer(),this.buffer.width=e,this.buffer.height=s,this.clearColor=[0,0,0,0],this.useDepth=i,this.setup(o)}setup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer);const e=this.gl.getExtension("WEBGL_draw_buffers")||this.gl.getExtension("GL_EXT_draw_buffers")||this.gl.getExtension("EXT_draw_buffers"),s=null!==e?e.COLOR_ATTACHMENT0_WEBGL+t:this.gl.COLOR_ATTACHMENT0;this.texture=new r(this.gl,this.buffer.width,this.buffer.height),this.texture.setup(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,s,this.gl.TEXTURE_2D,this.texture.get(),0),this.useDepth&&(this.depthTexture=new o(this.gl,this.buffer.width,this.buffer.height),this.depthTexture.setup(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.get(),0)),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}resize(t){this.end(),this.texture&&this.texture.delete(),this.depthTexture&&this.depthTexture.delete(),this.destroy(),this.buffer=this.gl.createFramebuffer(),this.buffer.width=t.width,this.buffer.height=t.height,this.setup()}start(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer),this.gl.viewport(0,0,this.buffer.width,this.buffer.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}end(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}get(){return this.buffer}getTexture(){return this.texture}getDepthTexture(){return this.depthTexture}setClearColor(t,e,s,i){this.clearColor=[t,e,s,i]}destroy(){this.buffer&&this.gl.deleteFramebuffer(this.buffer)}}}}]);