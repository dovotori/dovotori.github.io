"use strict";(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[4246],{54246:(t,e,n)=>{n.r(e),n.d(e,{default:()=>S,destroy:()=>T});var r=n(48926),i=n.n(r),o=n(87757),u=n.n(o),s=n(35466),a=n(63038),h=n.n(a),l=n(34575),c=n.n(l),f=n(93913),v=n.n(f),d=n(16525),p=n.n(d),x=n(2205),y=n.n(x),g=n(78585),m=n.n(g),k=n(29754),Z=n.n(k),w=n(9187),z=n.n(w),M={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},b=/([astvzqmhlc])([^astvzqmhlc]*)/gi,R=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,P=function(t){var e=[];return t.replace(b,(function(t,n,r){var i=n,o=n.toLowerCase(),u=function(t){var e=t.match(R);return e?e.map(Number):[]}(r);for("m"===o&&u.length>2&&(e.push([i].concat(u.splice(0,2))),o="l",i="m"===i?"l":"L");u.length;){if(u.length===M[o])return u.unshift(i),e.push(u);if(u.length<M[o])throw new Error("malformed path data");e.push([i].concat(u.splice(0,M[o])))}return e})),e};var X=n(40487),A=n(80602),Y=n(21969),j=n(77505);function B(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Z()(t);if(e){var i=Z()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var q=function(t){y()(n,t);var e=B(n);function n(){return c()(this,n),e.apply(this,arguments)}return v()(n,[{key:"setup",value:function(){var t=this.gl,e=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={x:0,y:0},r=P(t),i=e?-1:1;return r.reduce((function(t,e){return"L"!==e[0]&&"M"!==e[0]||3!==e.length?"m"!==e[0]&&"l"!==e[0]||3!==e.length?"v"===e[0]&&2===e.length?(n.y+=e[1]*i,t.push([n.x,n.y])):"h"===e[0]&&2===e.length?(n.x+=e[1],t.push([n.x,n.y])):"z"===e[0]&&(n.x=0,n.y=0):(n.x+=e[1],n.y+=e[2]*i,t.push([n.x,n.y])):t.push([e[1],e[2]*i]),t}),[])}("m-10-20-2 2 8 12-18 18v5l7 7v-10l5-5 5 5h10l5-5 5 5v10l7-7v-5l-18-18 8-12-2-2-10 10z",!0),n=z()(e.flat()),r=n.reduce((function(t,n){var r=h()(e[n],2),i=[r[0],r[1],5*Math.random()];return t.concat(i)}),[]),i=n.length/3,o=Array.from({length:i},(function(){var t=(0,j.ve)(150+100*Math.random(),50,60);return[t.r/255,t.g/255,t.b/255,1]})),u=n.reduce((function(t,e,n){var r=Math.floor(n/3);return t.concat(o[r])}),[]);this.vbo=new A.Z(t,{position:r,color:u}),this.model=new Y.Z}},{key:"render",value:function(){p()(Z()(n.prototype),"render",this).call(this),this.model.identity(),this.model.rotate(50*Math.cos(.001*this.time),0,1,0),this.mngProg.get("vertexColor").setMatrix("model",this.model.get()),this.bloom.start(),this.vbo.render(this.mngProg.get("vertexColor").get()),this.bloom.end(),this.bloom.render()}}]),n}(X.Z);const I={slug:"fragment",shaders:["/camera/vertexColor.js","/screen/blurOnePass.js","/screen/bloom.js","/screen/screen.js"],postprocess:{bloom:{scale:.7,threshold:.1,blur:{size:.1,intensity:1.2}}},useDepthTexture:!0,canvas:{width:1024,height:1024},camera:{position:{x:0,y:0,z:100},target:{x:0,y:0,z:0},near:1,far:200,angle:60},controls:{fullscreen:{buttonId:"fullscreen-toggle-btn"}}};var N=null;const S=i()(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return N=new s.Z,t.next=3,N.setup(q,I);case 3:case"end":return t.stop()}}),t)})));var T=function(){N&&N.destroy&&N.destroy()}},44254:(t,e,n)=>{n.d(e,{Z:()=>h});var r=n(34575),i=n.n(r),o=n(93913),u=n.n(o),s=n(25773),a=n(21969),h=function(){function t(e){if(i()(this,t),this.position=new s.Z(e.position.x,e.position.y,e.position.z),this.target=new s.Z(0,0,0),this.view=new a.Z,e.ortho){var n=e.ortho,r=n.left,o=n.right,u=n.bottom,h=n.top,l=e.near,c=e.far;this.ortho=new a.Z,this.ortho.ortho(r,o,u,h,l,c)}}return u()(t,[{key:"lookAt",value:function(){this.view.identity().lookAt(this.position.getX(),this.position.getY(),this.position.getZ(),this.target.getX(),this.target.getY(),this.target.getZ(),0,1,0)}},{key:"getView",value:function(){return this.view}},{key:"getPosition",value:function(){return this.position.get()}},{key:"getPositionVec3",value:function(){return this.position}},{key:"getTarget",value:function(){return this.target.get()}},{key:"getModel",value:function(){return this.repere.getModel()}},{key:"getOrtho",value:function(){return this.ortho}},{key:"addToPosition",value:function(t,e,n){this.position.addXYZ(t,e,n),this.lookAt()}},{key:"setPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!==t?t:this.position.getX(),i=null!==e?e:this.position.getY(),o=null!==n?n:this.position.getZ();this.position.set(r,i,o),this.lookAt()}},{key:"setTarget",value:function(t,e,n){this.target.set(t,e,n)}},{key:"setTargetVec3",value:function(t){this.target.equal(t)}}]),t}()},47313:(t,e,n)=>{n.d(e,{Z:()=>s});var r=n(34575),i=n.n(r),o=n(93913),u=n.n(o),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.04;i()(this,t),this.value=e,this.target=e,this.sampling=n,this.threshold=1e-6}return u()(t,[{key:"update",value:function(){Math.abs(this.value-this.target)>this.threshold?this.value+=(this.target-this.value)*this.sampling:this.value=this.target}},{key:"get",value:function(){return this.value}},{key:"set",value:function(t){this.target=t}},{key:"setDirect",value:function(t){this.value=t}}]),t}()},40487:(t,e,n)=>{n.d(e,{Z:()=>P});var r=n(34575),i=n.n(r),o=n(93913),u=n.n(o),s=n(16525),a=n.n(s),h=n(2205),l=n.n(h),c=n(78585),f=n.n(c),v=n(29754),d=n.n(v),p=n(40480),x=n(25773),y=n(21969);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var m=function(t){l()(n,t);var e=g(n);function n(t){var r;return i()(this,n),(r=e.call(this,t)).target=new x.Z(t.target.x,t.target.y,t.target.z),r.matIdentity=new y.Z,r.projection=new y.Z,r.projection.identity(),r.near=t.near||1,r.far=t.far||100,r.angle=t.angle||50,r.matIdentity.identity(),r.lookAt(),r}return u()(n,[{key:"update",value:function(){this.lookAt()}},{key:"perspective",value:function(t,e){this.projection.identity().perspective(this.angle,t/e,this.near,this.far)}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.position.set(this.position.getX(),Math.sin(.02*t)*(2+e),this.position.getZ()),this.lookAt()}},{key:"setNearFar",value:function(t,e){this.near=t,this.far=e}},{key:"setAngle",value:function(t){this.angle=t}},{key:"getProjection",value:function(){return this.projection}},{key:"getIdentity",value:function(){return this.matIdentity}},{key:"getNearFar",value:function(){return[this.near,this.far]}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getAngle",value:function(){return this.angle}},{key:"getReflectViewMatrix",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=2*(this.position.getY()-t);return(new y.Z).identity().lookAt(this.position.getX(),this.position.getY()-e,this.position.getZ(),this.target.getX(),this.target.getY(),this.target.getZ(),0,1,0)}}]),n}(n(44254).Z);const k=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;i()(this,t),this.d=[0,0,0,0],this.set(e,n,r,o)}return u()(t,[{key:"normalise",value:function(){var t=this.length();return 0!==t&&(this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this.d[3]/=t),this}},{key:"get",value:function(){return this.d}},{key:"getX",value:function(){return this.d[0]}},{key:"getY",value:function(){return this.d[1]}},{key:"getZ",value:function(){return this.d[2]}},{key:"getW",value:function(){return this.d[3]}},{key:"length",value:function(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2]+this.d[3]*this.d[3])}},{key:"set",value:function(t,e,n,r){return null!=t&&(this.d[0]=t),null!=e?this.d[1]=e:null!=t&&(this.d[1]=t),null!=n?this.d[2]=n:null!=t&&(this.d[2]=t),null!=r?this.d[3]=r:null!=t&&(this.d[3]=t),this}},{key:"equal",value:function(t){return this.d=[t.d[0],t.d[1],t.d[2],t.d[3]],this}},{key:"add",value:function(t){return this.d[0]+=t.d[0],this.d[1]+=t.d[1],this.d[2]+=t.d[2],this.d[3]+=t.d[3],this}},{key:"addNumber",value:function(t){return this.d[0]+=t,this.d[1]+=t,this.d[2]+=t,this.d[3]+=t,this}},{key:"minus",value:function(t){return this.d[0]-=t.d[0],this.d[1]-=t.d[1],this.d[2]-=t.d[2],this.d[3]-=t.d[3],this}},{key:"minusNumber",value:function(t){return this.d[0]-=t,this.d[1]-=t,this.d[2]-=t,this.d[3]-=t,this}},{key:"multiplyNumber",value:function(t){return this.d[0]*=t,this.d[1]*=t,this.d[2]*=t,this.d[3]*=t,this}},{key:"multiplyMatrix",value:function(t){var e=this.d[0],n=this.d[1],r=this.d[2],i=this.d[3];return this.d[0]=t.d[0]*e+t.d[4]*n+t.d[8]*r+t.d[12]*i,this.d[1]=t.d[1]*e+t.d[5]*n+t.d[9]*r+t.d[13]*i,this.d[2]=t.d[2]*e+t.d[6]*n+t.d[10]*r+t.d[14]*i,this.d[3]=t.d[3]*e+t.d[7]*n+t.d[11]*r+t.d[15]*i,this}},{key:"multiply",value:function(t){return this.d[0]*=t.d[0],this.d[1]*=t.d[1],this.d[2]*=t.d[2],this.d[3]*=t.d[3],this}},{key:"divideNumber",value:function(t){return this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this.d[3]/=t,this}},{key:"divide",value:function(t){return this.d[0]/=t.d[0],this.d[1]/=t.d[1],this.d[2]/=t.d[2],this.d[3]/=t.d[3],this}},{key:"distance",value:function(t){return Math.sqrt((t.d[0]-this.d[0])*(t.d[0]-this.d[0])+(t.d[1]-this.d[1])*(t.d[1]-this.d[1])+(t.d[2]-this.d[2])*(t.d[2]-this.d[2])+(t.d[3]-this.d[3])*(t.d[3]-this.d[3]))}}]),t}();function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var w=function(t){l()(n,t);var e=Z(n);function n(){return i()(this,n),e.apply(this,arguments)}return u()(n,[{key:"get2dTexturePoint",value:function(t){var e=t.getX(),n=t.getY(),r=t.getZ(),i=new k(e,n,r,1),o=new y.Z;o.equal(this.view).multiply(this.projection),i.multiplyMatrix(o);var u=i.getX()/i.getW(),s=i.getY()/i.getW();return[u=.5*(u+1),s=.5*(s+1)]}},{key:"get2dScreenPoint",value:function(t,e){var n=this.get2dTexturePoint(t);return[n[0]*e.width,n[1]*e.height]}}]),n}(m),z=n(47313);function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var b=function(t){l()(n,t);var e=M(n);function n(t){var r;return i()(this,n),(r=e.call(this,t)).options=t,r.rotationX=new z.Z,r.targetX=new z.Z,r.zoomZ=new z.Z(.7,.1),r}return u()(n,[{key:"update",value:function(){a()(d()(n.prototype),"update",this).call(this),this.rotationX.update(),this.zoomZ.update(),this.targetX.update(),this.position.set(this.options.position.x+this.targetX.get()+Math.sin(this.rotationX.get())*(this.options.position.z*this.zoomZ.get()),this.options.position.y,Math.cos(this.rotationX.get())*(this.options.position.z*this.zoomZ.get())),this.target.set(this.options.target.x,this.options.target.y,this.options.target.z)}},{key:"setSmoothTarget",value:function(t){this.targetX.set(t)}},{key:"setSmoothRotation",value:function(t){this.rotationX.set(t)}},{key:"setSmoothZoom",value:function(t){this.zoomZ.set(t)}},{key:"getZoom",value:function(){return this.zoomZ.get()}},{key:"followPos2D",value:function(t,e){this.options.position.x=t,this.options.position.y=e,this.options.target.x=t,this.options.target.y=e}},{key:"followPosY",value:function(t){this.options.position.y=t,this.options.target.y=t}}]),n}(w);function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var P=function(t){l()(n,t);var e=R(n);function n(t,r){var o;return i()(this,n),(o=e.call(this,t,r)).camera=new b(r.camera),o.camera.perspective(o.containerSize.width,o.containerSize.height),o}return u()(n,[{key:"resize",value:function(t){a()(d()(n.prototype),"resize",this).call(this,t),this.camera.perspective(this.containerSize.width,this.containerSize.height)}},{key:"update",value:function(t){a()(d()(n.prototype),"update",this).call(this,t),this.camera.update(),this.mngProg.setCameraMatrix(this.camera,!!this.config.camera.ortho)}}]),n}(p.Z)},77505:(t,e,n)=>{n.d(e,{oo:()=>o,ve:()=>i});var r=function(t,e,n){var r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t},i=function(t,e,n){var i,o,u,s=t/360,a=e/100,h=n/100;if(0===a)i=h,o=h,u=h;else{var l=h<.5?h*(1+a):h+a-h*a,c=2*h-l;i=r(c,l,s+1/3),o=r(c,l,s),u=r(c,l,s-1/3)}return{r:Math.round(255*i),g:Math.round(255*o),b:Math.round(255*u)}},o=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}},9187:t=>{function e(t,e,r){r=r||2;var o,u,s,a,c,f,d,p=e&&e.length,x=p?e[0]*r:t.length,y=n(t,0,x,r,!0),g=[];if(!y||y.next===y.prev)return g;if(p&&(y=function(t,e,r,i){var o,u,s,a=[];for(o=0,u=e.length;o<u;o++)(s=n(t,e[o]*i,o<u-1?e[o+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(v(s));for(a.sort(h),o=0;o<a.length;o++)r=l(a[o],r);return r}(t,e,y,r)),t.length>80*r){o=s=t[0],u=a=t[1];for(var m=r;m<x;m+=r)(c=t[m])<o&&(o=c),(f=t[m+1])<u&&(u=f),c>s&&(s=c),f>a&&(a=f);d=0!==(d=Math.max(s-o,a-u))?32767/d:0}return i(y,g,r,o,u,d,0),g}function n(t,e,n,r,i){var o,u;if(i===R(t,e,n,r)>0)for(o=e;o<n;o+=r)u=z(o,t[o],t[o+1],u);else for(o=n-r;o>=e;o-=r)u=z(o,t[o],t[o+1],u);return u&&y(u,u.next)&&(M(u),u=u.next),u}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!y(r,r.next)&&0!==x(r.prev,r,r.next))r=r.next;else{if(M(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,h,l,c,v){if(t){!v&&c&&function(t,e,n,r){var i=t;do{0===i.z&&(i.z=f(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,u,s,a,h=1;do{for(n=t,t=null,o=null,u=0;n;){for(u++,r=n,s=0,e=0;e<h&&(s++,r=r.nextZ);e++);for(a=h;s>0||a>0&&r;)0!==s&&(0===a||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,a--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,h*=2}while(u>1)}(i)}(t,h,l,c);for(var d,p,x=t;t.prev!==t.next;)if(d=t.prev,p=t.next,c?u(t,h,l,c):o(t))e.push(d.i/n|0),e.push(t.i/n|0),e.push(p.i/n|0),M(t),t=p.next,x=p.next;else if((t=p)===x){v?1===v?i(t=s(r(t),e,n),e,n,h,l,c,2):2===v&&a(t,e,n,h,l,c):i(r(t),e,n,h,l,c,1);break}}}function o(t){var e=t.prev,n=t,r=t.next;if(x(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,u=r.x,s=e.y,a=n.y,h=r.y,l=i<o?i<u?i:u:o<u?o:u,c=s<a?s<h?s:h:a<h?a:h,f=i>o?i>u?i:u:o>u?o:u,v=s>a?s>h?s:h:a>h?a:h,p=r.next;p!==e;){if(p.x>=l&&p.x<=f&&p.y>=c&&p.y<=v&&d(i,s,o,a,u,h,p.x,p.y)&&x(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,u=t.next;if(x(i,o,u)>=0)return!1;for(var s=i.x,a=o.x,h=u.x,l=i.y,c=o.y,v=u.y,p=s<a?s<h?s:h:a<h?a:h,y=l<c?l<v?l:v:c<v?c:v,g=s>a?s>h?s:h:a>h?a:h,m=l>c?l>v?l:v:c>v?c:v,k=f(p,y,e,n,r),Z=f(g,m,e,n,r),w=t.prevZ,z=t.nextZ;w&&w.z>=k&&z&&z.z<=Z;){if(w.x>=p&&w.x<=g&&w.y>=y&&w.y<=m&&w!==i&&w!==u&&d(s,l,a,c,h,v,w.x,w.y)&&x(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,z.x>=p&&z.x<=g&&z.y>=y&&z.y<=m&&z!==i&&z!==u&&d(s,l,a,c,h,v,z.x,z.y)&&x(z.prev,z,z.next)>=0)return!1;z=z.nextZ}for(;w&&w.z>=k;){if(w.x>=p&&w.x<=g&&w.y>=y&&w.y<=m&&w!==i&&w!==u&&d(s,l,a,c,h,v,w.x,w.y)&&x(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;z&&z.z<=Z;){if(z.x>=p&&z.x<=g&&z.y>=y&&z.y<=m&&z!==i&&z!==u&&d(s,l,a,c,h,v,z.x,z.y)&&x(z.prev,z,z.next)>=0)return!1;z=z.nextZ}return!0}function s(t,e,n){var i=t;do{var o=i.prev,u=i.next.next;!y(o,u)&&g(o,i,i.next,u)&&Z(o,u)&&Z(u,o)&&(e.push(o.i/n|0),e.push(i.i/n|0),e.push(u.i/n|0),M(i),M(i.next),i=t=u),i=i.next}while(i!==t);return r(i)}function a(t,e,n,o,u,s){var a=t;do{for(var h=a.next.next;h!==a.prev;){if(a.i!==h.i&&p(a,h)){var l=w(a,h);return a=r(a,a.next),l=r(l,l.next),i(a,e,n,o,u,s,0),void i(l,e,n,o,u,s,0)}h=h.next}a=a.next}while(a!==t)}function h(t,e){return t.x-e.x}function l(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,u=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>u&&(u=s,n=r.x<r.next.x?r:r.next,s===i))return n}r=r.next}while(r!==e);if(!n)return null;var a,h=n,l=n.x,f=n.y,v=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&d(o<f?i:u,o,l,f,o<f?u:i,o,r.x,r.y)&&(a=Math.abs(o-r.y)/(i-r.x),Z(r,t)&&(a<v||a===v&&(r.x>n.x||r.x===n.x&&c(n,r)))&&(n=r,v=a)),r=r.next}while(r!==h);return n}(t,e);if(!n)return e;var i=w(n,t);return r(i,i.next),r(n,n.next)}function c(t,e){return x(t.prev,t,e.prev)<0&&x(e.next,t,t.next)<0}function f(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function d(t,e,n,r,i,o,u,s){return(i-u)*(e-s)>=(t-u)*(o-s)&&(t-u)*(r-s)>=(n-u)*(e-s)&&(n-u)*(o-s)>=(i-u)*(r-s)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&g(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Z(t,e)&&Z(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(x(t.prev,t,e.prev)||x(t,e.prev,e))||y(t,e)&&x(t.prev,t,t.next)>0&&x(e.prev,e,e.next)>0)}function x(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function g(t,e,n,r){var i=k(x(t,e,n)),o=k(x(t,e,r)),u=k(x(n,r,t)),s=k(x(n,r,e));return i!==o&&u!==s||(!(0!==i||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==u||!m(n,t,r))||!(0!==s||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function k(t){return t>0?1:t<0?-1:0}function Z(t,e){return x(t.prev,t,t.next)<0?x(t,e,t.next)>=0&&x(t,t.prev,e)>=0:x(t,e,t.prev)<0||x(t,t.next,e)<0}function w(t,e){var n=new b(t.i,t.x,t.y),r=new b(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function z(t,e,n,r){var i=new b(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function M(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function b(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(t,e,n,r){for(var i=0,o=e,u=n-r;o<n;o+=r)i+=(t[u]-t[o])*(t[o+1]+t[u+1]),u=o;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,u=Math.abs(R(t,0,o,n));if(i)for(var s=0,a=e.length;s<a;s++){var h=e[s]*n,l=s<a-1?e[s+1]*n:t.length;u-=Math.abs(R(t,h,l,n))}var c=0;for(s=0;s<r.length;s+=3){var f=r[s]*n,v=r[s+1]*n,d=r[s+2]*n;c+=Math.abs((t[f]-t[d])*(t[v+1]-t[f+1])-(t[f]-t[v])*(t[d+1]-t[f+1]))}return 0===u&&0===c?0:Math.abs((c-u)/u)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var u=0;u<e;u++)n.vertices.push(t[i][o][u]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}}}]);