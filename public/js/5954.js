"use strict";(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[5954],{32963:(t,e,i)=>{i.d(e,{A:()=>E});var s=i(6837),r=i(8143),n=i(11078),o=i(70915),a=i(9687),h=i(61597);const c=class{constructor(t,e,i,s,r,n){this.sourceProj_=t,this.targetProj_=e;let h={};const c=(0,a.RG)(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return h[e]||(h[e]=c(t)),h[e]},this.maxSourceExtent_=s,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&(0,o.RG)(s)>=(0,o.RG)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,o.RG)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,o.RG)(this.targetProj_.getExtent()):null;const u=(0,o.Py)(i),l=(0,o.WU)(i),d=(0,o.k_)(i),_=(0,o.R)(i),g=this.transformInv_(u),f=this.transformInv_(l),m=this.transformInv_(d),T=this.transformInv_(_),v=10+(n?Math.max(0,Math.ceil(Math.log2((0,o.UG)(i)/(n*n*256*256)))):0);if(this.addQuad_(u,l,d,_,g,f,m,T,v),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,s){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const s=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-s<this.sourceWorldWidth_/2&&(e.source=i)}}))}h={}}addTriangle_(t,e,i,s,r,n){this.triangles_.push({source:[s,r,n],target:[t,e,i]})}addQuad_(t,e,i,s,r,n,a,c,u){const l=(0,o.Tr)([r,n,a,c]),d=this.sourceWorldWidth_?(0,o.RG)(l)/this.sourceWorldWidth_:null,_=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&d>.5&&d<1;let f=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const r=(0,o.Tr)([t,e,i,s]);f=(0,o.RG)(r)/this.targetWorldWidth_>.25||f}!g&&this.sourceProj_.isGlobal()&&d&&(f=d>.25||f)}if(!f&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!(0,o.HY)(l,this.maxSourceExtent_))return;let m=0;if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(n[0])&&isFinite(n[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(c[0])&&isFinite(c[1])))if(u>0)f=!0;else if(m=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(n[0])&&isFinite(n[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(c[0])&&isFinite(c[1])?0:1),1!=m&&2!=m&&4!=m&&8!=m)return;if(u>0){if(!f){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],s=this.transformInv_(e);let n;if(g){n=((0,h.xP)(r[0],_)+(0,h.xP)(a[0],_))/2-(0,h.xP)(s[0],_)}else n=(r[0]+a[0])/2-s[0];const o=(r[1]+a[1])/2-s[1];f=n*n+o*o>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const o=[(e[0]+i[0])/2,(e[1]+i[1])/2],h=this.transformInv_(o),l=[(s[0]+t[0])/2,(s[1]+t[1])/2],d=this.transformInv_(l);this.addQuad_(t,e,o,l,r,n,h,d,u-1),this.addQuad_(l,o,i,s,d,h,a,c,u-1)}else{const o=[(t[0]+e[0])/2,(t[1]+e[1])/2],h=this.transformInv_(o),l=[(i[0]+s[0])/2,(i[1]+s[1])/2],d=this.transformInv_(l);this.addQuad_(t,o,l,s,r,h,d,c,u-1),this.addQuad_(o,e,i,l,h,n,a,d,u-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&m||this.addTriangle_(t,i,s,r,a,c),14&m||this.addTriangle_(t,i,e,r,a,n),m&&(13&m||this.addTriangle_(e,s,t,n,c,r),7&m||this.addTriangle_(e,s,i,n,c,a))}calculateSourceExtent(){const t=(0,o.S5)();return this.triangles_.forEach((function(e,i,s){const r=e.source;(0,o.$C)(t,r[0]),(0,o.$C)(t,r[1]),(0,o.$C)(t,r[2])})),t}getTriangles(){return this.triangles_}};var u=i(68711);let l;const d=[];function _(t,e,i,s,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(s,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,s)+1,Math.max(i,r)),t.restore()}function g(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function f(t,e,i,s){const r=(0,a.pd)(i,e,t);let n=(0,a.hO)(e,s,i);const h=e.getMetersPerUnit();void 0!==h&&(n*=h);const c=t.getMetersPerUnit();void 0!==c&&(n/=c);const u=t.getExtent();if(!u||(0,o.Ym)(u,r)){const e=(0,a.hO)(t,n,r)/n;isFinite(e)&&e>0&&(n/=e)}return n}function m(t,e,i,s,r,n,a,c,f,m,T,v,E,M){const p=(0,u.Y)(Math.round(i*t),Math.round(i*e),d);if(v||(p.imageSmoothingEnabled=!1),0===f.length)return p.canvas;function x(t){return Math.round(t*i)/i}p.scale(i,i),p.globalCompositeOperation="lighter";const W=(0,o.S5)();let P;f.forEach((function(t,e,i){(0,o.X$)(W,t.extent)}));const G=i/s,A=(v?1:1+Math.pow(2,-24))/G;if(!E||1!==f.length||0!==m){if(P=(0,u.Y)(Math.round((0,o.RG)(W)*G),Math.round((0,o.Oq)(W)*G),d),v||(P.imageSmoothingEnabled=!1),r&&M){const t=(r[0]-W[0])*G,e=-(r[3]-W[3])*G,i=(0,o.RG)(r)*G,s=(0,o.Oq)(r)*G;P.rect(t,e,i,s),P.clip()}f.forEach((function(t,e,i){const s=(t.extent[0]-W[0])*G,r=-(t.extent[3]-W[3])*G,n=(0,o.RG)(t.extent)*G,a=(0,o.Oq)(t.extent)*G;t.image.width>0&&t.image.height>0&&P.drawImage(t.image,m,m,t.image.width-2*m,t.image.height-2*m,v?s:Math.round(s),v?r:Math.round(r),v?n:Math.round(s+n)-Math.round(s),v?a:Math.round(r+a)-Math.round(r))}))}const I=(0,o.Py)(a);return c.getTriangles().forEach((function(t,e,i){const s=t.source,r=t.target;let a=s[0][0],c=s[0][1],m=s[1][0],T=s[1][1],E=s[2][0],M=s[2][1];const G=x((r[0][0]-I[0])/n),F=x(-(r[0][1]-I[1])/n),R=x((r[1][0]-I[0])/n),S=x(-(r[1][1]-I[1])/n),b=x((r[2][0]-I[0])/n),C=x(-(r[2][1]-I[1])/n),w=a,j=c;a=0,c=0,m-=w,T-=j,E-=w,M-=j;const q=[[m,T,0,0,R-G],[E,M,0,0,b-G],[0,0,m,T,S-F],[0,0,E,M,C-F]],O=(0,h.KU)(q);if(!O)return;if(p.save(),p.beginPath(),function(){if(void 0===l){const t=(0,u.Y)(6,6,d);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",_(t,4,5,4,0),_(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;l=g(e,0)||g(e,4)||g(e,8),(0,u.Yg)(t),d.push(t.canvas)}return l}()||!v){p.moveTo(R,S);const t=4,e=G-R,i=F-S;for(let s=0;s<t;s++)p.lineTo(R+x((s+1)*e/t),S+x(s*i/(t-1))),s!=t-1&&p.lineTo(R+x((s+1)*e/t),S+x((s+1)*i/(t-1)));p.lineTo(b,C)}else p.moveTo(R,S),p.lineTo(G,F),p.lineTo(b,C);let Y;if(p.clip(),p.transform(O[0],O[2],O[1],O[3],G,F),p.translate(W[0]-w,W[3]-j),P)Y=P.canvas,p.scale(A,-A);else{const t=f[0],e=t.extent;Y=t.image,p.scale((0,o.RG)(e)/Y.width,-(0,o.Oq)(e)/Y.height)}p.drawImage(Y,0,0),p.restore()})),P&&((0,u.Yg)(P),d.push(P.canvas)),T&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,c.getTriangles().forEach((function(t,e,i){const s=t.target,r=(s[0][0]-I[0])/n,o=-(s[0][1]-I[1])/n,a=(s[1][0]-I[0])/n,h=-(s[1][1]-I[1])/n,c=(s[2][0]-I[0])/n,u=-(s[2][1]-I[1])/n;p.beginPath(),p.moveTo(a,h),p.lineTo(r,o),p.lineTo(c,u),p.closePath(),p.stroke()})),p.restore()),p.canvas}var T=i(9438);class v extends r.A{constructor(t,e,i,s,r,a,u,l,d,_,g,m){super(r,n.A.IDLE,m),this.renderEdges_=void 0!==g&&g,this.pixelRatio_=u,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=a||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const T=s.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let E=this.sourceTileGrid_.getExtent();const M=v?(0,o._N)(T,v):T;if(0===(0,o.UG)(M))return void(this.state=n.A.EMPTY);const p=t.getExtent();p&&(E=E?(0,o._N)(E,p):p);const x=s.getResolution(this.wrappedTileCoord_[0]),W=function(t,e,i,s){const r=(0,o.q1)(i);let n=f(t,e,r,s);return(!isFinite(n)||n<=0)&&(0,o.sB)(i,(function(i){return n=f(t,e,i,s),isFinite(n)&&n>0})),n}(t,i,M,x);if(!isFinite(W)||W<=0)return void(this.state=n.A.EMPTY);const P=void 0!==_?_:.5;if(this.triangulation_=new c(t,i,M,E,W*P,x),0===this.triangulation_.getTriangles().length)return void(this.state=n.A.EMPTY);this.sourceZ_=e.getZForResolution(W);let G=this.triangulation_.calculateSourceExtent();if(E&&(t.canWrapX()?(G[1]=(0,h.qE)(G[1],E[1],E[3]),G[3]=(0,h.qE)(G[3],E[1],E[3])):G=(0,o._N)(G,E)),(0,o.UG)(G)){const t=e.getTileRangeForExtentAndZ(G,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=d(this.sourceZ_,e,i,u);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=n.A.EMPTY)}else this.state=n.A.EMPTY}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&e.getState()==n.A.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=n.A.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),s="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=m(s,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,h,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=n.A.LOADED}this.changed()}load(){if(this.state==n.A.IDLE){this.state=n.A.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(i==n.A.IDLE||i==n.A.LOADING){t++;const i=(0,T.KT)(e,s.A.CHANGE,(function(s){const r=e.getState();r!=n.A.LOADED&&r!=n.A.ERROR&&r!=n.A.EMPTY||((0,T.JH)(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){t.getState()==n.A.IDLE&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(T.JH),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,u.Yg)(this.canvas_.getContext("2d")),d.push(this.canvas_),this.canvas_=null),super.release()}}const E=v},68430:(t,e,i)=>{i.d(e,{JJ:()=>h,Nm:()=>u,Zo:()=>c});var s=i(61597),r=i(70915),n=i(66514);function o(t,e,i,s){const n=(0,r.RG)(e)/i[0],o=(0,r.Oq)(e)/i[1];return s?Math.min(t,Math.max(n,o)):Math.min(t,Math.min(n,o))}function a(t,e,i){let r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(r=Math.max(r,i),r/=Math.log(1+50*Math.max(0,i/t-1))/50+1),(0,s.qE)(r,i/2,2*e)}function h(t,e,i,r){return e=void 0===e||e,function(h,c,u,l){if(void 0!==h){const d=t[0],_=t[t.length-1],g=i?o(d,i,u,r):d;if(l)return e?a(h,g,_):(0,s.qE)(h,_,g);const f=Math.min(g,h),m=Math.floor((0,n.FT)(t,f,c));return t[m]>g&&m<t.length-1?t[m+1]:t[m]}}}function c(t,e,i,r,n,h){return r=void 0===r||r,i=void 0!==i?i:0,function(c,u,l,d){if(void 0!==c){const _=n?o(e,n,l,h):e;if(d)return r?a(c,_,i):(0,s.qE)(c,i,_);const g=1e-9,f=Math.ceil(Math.log(e/_)/Math.log(t)-g),m=-u*(.5-g)+.5,T=Math.min(_,c),v=Math.floor(Math.log(e/T)/Math.log(t)+m),E=Math.max(f,v),M=e/Math.pow(t,E);return(0,s.qE)(M,i,_)}}}function u(t,e,i,r,n){return i=void 0===i||i,function(h,c,u,l){if(void 0!==h){const c=r?o(t,r,u,n):t;return i&&l?a(h,c,e):(0,s.qE)(h,e,c)}}}},24498:(t,e,i)=>{i.d(e,{a$:()=>o,b8:()=>r,cq:()=>a,dv:()=>n});var s=i(61597);function r(t){if(void 0!==t)return 0}function n(t){if(void 0!==t)return t}function o(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}function a(t){const e=void 0===t?(0,s.eh)(5):t;return function(t,i){return i||void 0===t?t:Math.abs(t)<=e?0:t}}},6782:(t,e,i)=>{function s(t){return t[0]>0&&t[1]>0}function r(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function n(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}i.d(e,{Ie:()=>s,hs:()=>r,xq:()=>n})}}]);