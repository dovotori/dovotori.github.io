(window.webpackJsonp=window.webpackJsonp||[]).push([[116,174],{117:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(25),u=function(){function t(){n()(this,t),this.d=new Array(9),this.sauvegardePrecedente=[],this.empilement=0,this.init()}return o()(t,[{key:"init",value:function(){for(var t=0;t<9;t+=1)this.d[t]=0;return this.sauvegardePrecedente=[],this.empilement=0,this}},{key:"get",value:function(){return this.d}},{key:"set",value:function(t,e,i,s,n,r,o,a,u){return this.d[0]=t,this.d[1]=e,this.d[2]=i,this.d[3]=s,this.d[4]=n,this.d[5]=r,this.d[6]=o,this.d[7]=a,this.d[8]=u,this}},{key:"setFromArray",value:function(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}},{key:"setOneValue",value:function(t){for(var e=0;e<9;e+=1)this.d[e]=t[e]}},{key:"multiply",value:function(e){for(var i=new t,s=0;s<3;s+=1)for(var n=0;n<3;n+=1)for(var r=0;r<3;r+=1)i.d[3*n+s]+=this.d[3*n+r]*e.d[3*r+s];for(var o=0;o<9;o+=1)this.d[o]=i.d[o];return this}},{key:"equal",value:function(t){for(var e=0;e<9;e+=1)this.d[e]=t.d[e],this.sauvegardePrecedente[e]=t.sauvegardePrecedente[e];return this}},{key:"push",value:function(){this.empilement+=1;for(var t=0,e=9*(this.empilement-1);e<9*this.empilement;e+=1)this.sauvegardePrecedente[e]=this.d[t],t+=1;return this}},{key:"pop",value:function(){if(this.empilement>0){for(var t=0,e=9*(this.empilement-1);e<9*this.empilement;e+=1)this.d[t]=this.sauvegardePrecedente[e],this.sauvegardePrecedente[e]=null,t+=1;this.empilement-=1}return this}},{key:"identity",value:function(){return this.init(),this.d[0]=1,this.d[4]=1,this.d[8]=1,this}},{key:"transpose",value:function(){return this.setFromArray(t.transpose(this.d))}},{key:"inverse",value:function(){var t=new Array(9),e=this.getDeterminant();if(0===e)return this.identity(),null;t[0]=this.d[4]*this.d[8]-this.d[5]*this.d[7]/e,t[1]=-(this.d[1]*this.d[8]-this.d[7]*this.d[2])/e,t[2]=this.d[1]*this.d[5]-this.d[4]*this.d[2]/e,t[3]=-(this.d[3]*this.d[8]-this.d[5]*this.d[6])/e,t[4]=this.d[0]*this.d[8]-this.d[6]*this.d[2]/e,t[5]=-(this.d[0]*this.d[5]-this.d[3]*this.d[2])/e,t[6]=this.d[3]*this.d[7]-this.d[6]*this.d[4]/e,t[7]=-(this.d[0]*this.d[7]-this.d[6]*this.d[1])/e,t[8]=this.d[0]*this.d[4]-this.d[1]*this.d[3]/e;for(var i=0;i<9;i+=1)this.d[i]=t[i];return this}},{key:"getDeterminant",value:function(){return this.d[0]*(this.d[4]*this.d[8]-this.d[7]*this.d[5])+this.d[1]*(this.d[5]*this.d[6]-this.d[3]*this.d[8])+this.d[2]*(this.d[3]*this.d[7]-this.d[6]*this.d[4])}},{key:"rotate",value:function(e,i,s,n){var r=new t,o=e*(Math.PI/180),u=new a.a(i,s,n);return u.normalise(),r.d[0]=u.x*u.x*(1-Math.cos(o))+Math.cos(o),r.d[1]=u.x*u.y*(1-Math.cos(o))-u.z*Math.sin(o),r.d[2]=u.x*u.z*(1-Math.cos(o))+u.y*Math.sin(o),r.d[3]=u.x*u.y*(1-Math.cos(o))+u.z*Math.sin(o),r.d[4]=u.y*u.y*(1-Math.cos(o))+Math.cos(o),r.d[5]=u.y*u.z*(1-Math.cos(o))-u.x*Math.sin(o),r.d[6]=u.x*u.z*(1-Math.cos(o))-u.y*Math.sin(o),r.d[7]=u.y*u.z*(1-Math.cos(o))+u.x*Math.sin(o),r.d[8]=u.z*u.z*(1-Math.cos(o))+Math.cos(o),this.multiply(r),this}}],[{key:"transpose",value:function(t){for(var e=new Float32Array(9),i=0,s=0;s<3;s+=1)for(var n=0;n<3;n+=1)e[i]=t[3*n+s],i+=1;return e}}]),t}();e.a=u},118:function(t,e,i){"use strict";e.a={position:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],indices:[0,1,2,1,3,2],texture:[0,0,1,0,0,1,1,1]}},121:function(t,e,i){"use strict";e.a={position:[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],texture:[1,1,0,1,0,0,1,0,0,0,1,0,1,1,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1]}},132:function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(22),u=i.n(a),h=i(7),c=i.n(h),l=i(8),d=i.n(l),f=i(3),v=i.n(f),g=i(134),p=i(149);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=v()(t);if(e){var n=v()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return d()(this,i)}}var m=function(t){c()(i,t);var e=y(i);function i(t,s,r){var o;n()(this,i);var a=(o=e.call(this,t,s,r)).canUseDepth(),u=s.canvas,h=u.width,c=u.height;o.lampes=s.lampes&&s.lampes.map((function(t){return new p.a(o.gl,t,h,c,a)}))||[];var l=o.mngProg.getAll();return Object.keys(l).forEach((function(t){var e=l[t];e.getLocations().numLights&&o.setLampeInfos(e)})),o}return o()(i,[{key:"renderReperes",value:function(){var t=this;this.lampes.forEach((function(e){return e.renderRepere(t.camera)}))}},{key:"randomLampesPositions",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.lampes.forEach((function(s,n){(null===i||null!==i&&n===i)&&s.move(t.time*e,n)}))}},{key:"setLampeInfos",value:function(t){var e=this;t.setVector("posEye",this.camera.getPosition()),t.setInt("numLights",this.lampes.length),this.config.lampes.forEach((function(i,s){var n=i.type,r=i.ambiant,o=i.diffuse,a=i.specular,u=i.brillance,h=i.radius,c=i.direction,l=i.strength;t.setInt("lights[".concat(s,"].type"),n),t.setVector("lights[".concat(s,"].position"),e.lampes[s].getPosition()),t.setVector("lights[".concat(s,"].ambiant"),r),t.setVector("lights[".concat(s,"].diffuse"),o),t.setVector("lights[".concat(s,"].specular"),a),u&&t.setFloat("lights[".concat(s,"].brillance"),u),h&&t.setFloat("lights[".concat(s,"].radius"),h),c&&t.setVector("lights[".concat(s,"].direction"),c),t.setFloat("lights[".concat(s,"].strength"),l||1)}))}},{key:"computeLampesDepthTexture",value:function(){if("function"==typeof this.renderBasiqueForShadow)for(var t=0;t<1;t+=1){var e=this.getLampe(t);e.start();var i=this.mngProg.get("basique3d");i.setMatrix("projection",e.getOrtho().get()),i.setMatrix("view",e.getView().get()),this.renderBasiqueForShadow(i),e.end()}}},{key:"render",value:function(){u()(v()(i.prototype),"render",this).call(this),this.computeLampesDepthTexture(),this.mngProg.setCameraMatrix(this.camera,!!this.config.camera.ortho)}},{key:"getLampe",value:function(t){return this.lampes[t]?this.lampes[t]:null}}]),i}(g.a)},134:function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(22),u=i.n(a),h=i(7),c=i.n(h),l=i(8),d=i.n(l),f=i(3),v=i.n(f),g=i(136),p=i(137);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=v()(t);if(e){var n=v()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return d()(this,i)}}var m=function(t){c()(i,t);var e=y(i);function i(t,s,r){var o;return n()(this,i),(o=e.call(this,t,s,r)).camera=new p.a(s.camera),o.camera.perspective(o.containerSize.width,o.containerSize.height),o}return o()(i,[{key:"resize",value:function(t){u()(v()(i.prototype),"resize",this).call(this,t),this.camera.perspective(this.containerSize.width,this.containerSize.height)}},{key:"update",value:function(t){u()(v()(i.prototype),"update",this).call(this,t),this.camera.update(),this.mngProg.setCameraMatrix(this.camera,!!this.config.camera.ortho)}}]),i}(g.a)},135:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n()(this,t),this.d=[0,0,0,0],this.set(e,i,s,r)}return o()(t,[{key:"normalise",value:function(){var t=this.length();return 0!==t&&(this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this.d[3]/=t),this}},{key:"get",value:function(){return this.d}},{key:"getX",value:function(){return this.d[0]}},{key:"getY",value:function(){return this.d[1]}},{key:"getZ",value:function(){return this.d[2]}},{key:"getW",value:function(){return this.d[3]}},{key:"length",value:function(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2]+this.d[3]*this.d[3])}},{key:"set",value:function(t,e,i,s){return null!=t&&(this.d[0]=t),null!=e?this.d[1]=e:null!=t&&(this.d[1]=t),null!=i?this.d[2]=i:null!=t&&(this.d[2]=t),null!=s?this.d[3]=s:null!=t&&(this.d[3]=t),this}},{key:"equal",value:function(t){return this.d=[t.d[0],t.d[1],t.d[2],t.d[3]],this}},{key:"add",value:function(t){return this.d[0]+=t.d[0],this.d[1]+=t.d[1],this.d[2]+=t.d[2],this.d[3]+=t.d[3],this}},{key:"addNumber",value:function(t){return this.d[0]+=t,this.d[1]+=t,this.d[2]+=t,this.d[3]+=t,this}},{key:"minus",value:function(t){return this.d[0]-=t.d[0],this.d[1]-=t.d[1],this.d[2]-=t.d[2],this.d[3]-=t.d[3],this}},{key:"minusNumber",value:function(t){return this.d[0]-=t,this.d[1]-=t,this.d[2]-=t,this.d[3]-=t,this}},{key:"multiplyNumber",value:function(t){return this.d[0]*=t,this.d[1]*=t,this.d[2]*=t,this.d[3]*=t,this}},{key:"multiplyMatrix",value:function(t){var e=this.d[0],i=this.d[1],s=this.d[2],n=this.d[3];return this.d[0]=t.d[0]*e+t.d[4]*i+t.d[8]*s+t.d[12]*n,this.d[1]=t.d[1]*e+t.d[5]*i+t.d[9]*s+t.d[13]*n,this.d[2]=t.d[2]*e+t.d[6]*i+t.d[10]*s+t.d[14]*n,this.d[3]=t.d[3]*e+t.d[7]*i+t.d[11]*s+t.d[15]*n,this}},{key:"multiply",value:function(t){return this.d[0]*=t.d[0],this.d[1]*=t.d[1],this.d[2]*=t.d[2],this.d[3]*=t.d[3],this}},{key:"divideNumber",value:function(t){return this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this.d[3]/=t,this}},{key:"divide",value:function(t){return this.d[0]/=t.d[0],this.d[1]/=t.d[1],this.d[2]/=t.d[2],this.d[3]/=t.d[3],this}},{key:"distance",value:function(t){return Math.sqrt((t.d[0]-this.d[0])*(t.d[0]-this.d[0])+(t.d[1]-this.d[1])*(t.d[1]-this.d[1])+(t.d[2]-this.d[2])*(t.d[2]-this.d[2])+(t.d[3]-this.d[3])*(t.d[3]-this.d[3]))}}]),t}();e.a=a},136:function(t,e,i){"use strict";i.d(e,"a",(function(){return Q}));var s=i(0),n=i.n(s),r=i(1),o=i.n(r),a=i(2),u=i.n(a),h=function(){function t(e,i,s){o()(this,t),this.gl=e,this.texture=e.createTexture(),this.filter=s?e[s]:e.NEAREST,this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}return u()(t,[{key:"get",value:function(){return this.texture}}]),t}(),c=function(){function t(e,i){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o()(this,t),this.textures={},Object.keys(i).forEach((function(t){s.textures[t]=new h(e,i[t],n[t])}))}return u()(t,[{key:"get",value:function(t){return this.textures[t]}}]),t}(),l=i(143),d=function(){function t(e,i){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o()(this,t),this.objets={},Object.keys(i).forEach((function(t){s.objets[t]=new l.a(e,i[t],n&&n[t])}))}return u()(t,[{key:"get",value:function(t){return this.objets[t]}}]),t}(),f=i(144),v=function(){function t(e,i,s){var r=this;o()(this,t),n()(this,"getAll",(function(){return r.programs})),this.programs={},Object.keys(i).forEach((function(t){var n=i[t];r.programs[t]=new f.a(e,n),-1!==n.uniforms.indexOf("resolution")&&r.programs[t].setVector("resolution",[s.width,s.height])}))}return u()(t,[{key:"setCameraMatrix",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(this.programs).forEach((function(s){e.programs[s].setMatrix("view",t.getView().get());var n=i?t.getOrtho():t.getProjection();e.programs[s].setMatrix("projection",n.get())}))}},{key:"get",value:function(t){return this.programs[t]}}]),t}(),g=i(89),p=i(86),y=i(146),m=function(){function t(e,i){var s=this;o()(this,t),n()(this,"hasAnimation",(function(t){var e=!1;return t.forEach((function(t){!e&&t.animations&&(e=!0)})),e})),this.gltfs={},Object.keys(i).forEach((function(t){i[t].skins?s.gltfs[t]=new y.a(e,i[t]):s.hasAnimation(i[t].nodes)?s.gltfs[t]=new p.a(e,i[t]):s.gltfs[t]=new g.a(e,i[t])}))}return u()(t,[{key:"get",value:function(t){return this.gltfs[t]}}]),t}(),k=function(){function t(e){var i=this;o()(this,t),n()(this,"saveData",(function(t){i.audioData=t})),n()(this,"togglePause",(function(){i.isPlaying?i.isPause?(i.audioContext.resume(),i.isPause=!1):(i.audioContext.suspend(),i.isPause=!0):(i.play(),i.isPause=!1)})),n()(this,"stop",(function(){i.clearAnalyse(),i.sourceNode&&(i.sourceNode.removeEventListener("ended",i.stop,!1),i.sourceNode.disconnect(),i.sourceNode.stop(0)),i.isPlaying=!1})),n()(this,"toggle",(function(){i.isPlaying?i.stop():i.play()})),n()(this,"clearAnalyse",(function(){i.amplitudeArray.fill(0),i.javascriptNode&&(i.analyserNode.disconnect(),i.javascriptNode.disconnect(),i.javascriptNode.removeEventListener("audioprocess",i.onAnalyse,!1))})),n()(this,"onAnalyse",(function(){i.analyserNode.getByteFrequencyData(i.amplitudeArray)})),n()(this,"onError",(function(t){})),n()(this,"setPlaybackRate",(function(t){i.playbackRate=t,i.sourceNode&&(i.sourceNode.playbackRate.value=i.playbackRate)})),n()(this,"setVolume",(function(t){i.volume=t,i.gainNode&&(i.gainNode.gain.value=i.volume)})),n()(this,"getAmplitudes",(function(){return i.amplitudeArray})),n()(this,"getFrequencyLength",(function(){return i.analyserNode.frequencyBinCount})),n()(this,"getIsPlaying",(function(){return i.isPlaying})),n()(this,"getIsPause",(function(){return i.isPause}));var s=window.AudioContext||window.webkitAudioContext;this.support=!!s;try{this.audioContext=new s}catch(t){this.support=!1}this.audioData=null,this.playbackRate=1,this.playMultiple=!1,this.isPlaying=!1,this.isPause=!0,this.isMute=!0,this.isLoop=!0,this.volume=.5,this.setup(e)}return u()(t,[{key:"setup",value:function(t){this.support&&(this.audioContext.decodeAudioData(t,this.saveData,this.onError),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=this.volume,this.gainNode.connect(this.audioContext.destination),this.sampleSize=1024,this.javascriptNode=this.audioContext.createScriptProcessor(this.sampleSize,1,1),this.analyserNode=this.audioContext.createAnalyser(),this.amplitudeArray=new Uint8Array(this.analyserNode.frequencyBinCount))}},{key:"play",value:function(){this.audioData&&(!this.playMultiple&&this.isPlaying&&this.stop(),this.sourceNode=this.audioContext.createBufferSource(),this.sourceNode.playbackRate.value=this.playbackRate,this.sourceNode.buffer=this.audioData,this.sourceNode.loop=this.isLoop,this.sourceNode.connect(this.gainNode),this.setupAnalyse(),this.sourceNode.addEventListener("ended",this.stop,!1),this.sourceNode.start(0),this.isPlaying=!0)}},{key:"setupAnalyse",value:function(){this.sourceNode.connect(this.analyserNode),this.analyserNode.connect(this.javascriptNode),this.javascriptNode.connect(this.audioContext.destination),this.javascriptNode.addEventListener("audioprocess",this.onAnalyse,!1)}},{key:"getSupport",value:function(){return this.support}}]),t}(),b=function(){function t(e){var i=this;o()(this,t),this.audios={},Object.keys(e).forEach((function(t){i.audios[t]=new k(e[t])}))}return u()(t,[{key:"get",value:function(t){return this.audios[t]}}]),t}(),x=i(7),P=i.n(x),w=i(8),T=i.n(w),E=i(3),R=i.n(E),S=i(65),D=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o()(this,t),this.fbos=[],this.currentFbo=0;var r=null;this.fbos[0]=new S.a(e,i,s,n,r,0),this.fbos[1]=new S.a(e,i,s,n,r,1)}return u()(t,[{key:"start",value:function(){this.fbos[this.currentFbo].start()}},{key:"end",value:function(){this.fbos[this.currentFbo].end()}},{key:"swap",value:function(){this.currentFbo=0===this.currentFbo?1:0}},{key:"resize",value:function(t){this.fbos[0].resize(t),this.fbos[1].resize(t)}},{key:"getTexture",value:function(){return this.fbos[this.currentFbo].getTexture()}},{key:"getDepthTexture",value:function(){return this.fbos[this.currentFbo].getDepthTexture()}}]),t}(),O=i(116),M=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;o()(this,t),this.gl=e;var n=i.width,r=void 0===n?1024:n,a=i.height,u=void 0===a?1024:a,h=i.useDepth,c=void 0!==h&&h;this.ppb=new D(e,r,u,c),this.screen=new O.a(e),this.width=r,this.height=u,this.passCount=0,this.programs=s}return u()(t,[{key:"start",value:function(){this.ppb.start(),this.passCount=0}},{key:"end",value:function(){this.ppb.end()}},{key:"resize",value:function(t){this.ppb.resize(t)}},{key:"applyTexToProg",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=null===e;this.passCount=i?this.passCount+1:0;var s=this.passCount+1,n=i?this.ppb.getTexture().get():e;return t.setTexture(s,n,"textureMap"),t.setFloat("flipY",-1),t}},{key:"setBrightContrast",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.brightcontrast,i);s.setFloat("brightness",t),s.setFloat("contrast",e),this.renderToPingPong(s)}},{key:"setFxaa",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.fxaa,t);this.renderToPingPong(e)}},{key:"setBloom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.bloom,i);s.setFloat("scale",t),s.setFloat("threshold",e),this.renderToPingPong(s)}},{key:"setFxaa2",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.fxaa2,t);this.renderToPingPong(e)}},{key:"renderToPingPong",value:function(t){this.ppb.swap(),this.ppb.start(),this.screen.render(t.get()),this.ppb.end()}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.applyTexToProg(this.programs[e?"debug":"screen"],t);this.screen.render(i.get())}},{key:"renderInverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.applyTexToProg(this.programs[e?"debug":"screen"],t);i.setFloat("flipY",1),this.screen.render(i.get())}},{key:"getTexture",value:function(){return this.ppb.getTexture()}}]),t}();function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=R()(t);if(e){var n=R()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return T()(this,i)}}var F=function(t){P()(i,t);var e=A(i);function i(){return o()(this,i),e.apply(this,arguments)}return u()(i,[{key:"create",value:function(){for(var t=new ArrayBuffer(this.size.width*this.size.height*4),e=new Uint8Array(t),i=0,s=0;s<this.size.height;s+=1)for(var n=0;n<this.size.width;n+=1)e[i]=255*Math.random(),e[i+1]=255*Math.random(),e[i+2]=0,e[i+3]=255,i+=4;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.height,this.size.width,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}}]),i}(i(57).a);function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=R()(t);if(e){var n=R()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return T()(this,i)}}var z=function(t){P()(i,t);var e=j(i);function i(t,s){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o()(this,i),(n=e.call(this,t,s,r)).textures={},Object.keys(n.programs).forEach((function(t){switch(t){case"watercolor2":case"watercolor3":n.textures[t]=new F(n.gl,512,512)}})),n}return u()(i,[{key:"setDOF",value:function(t,e,i,s){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=this.applyTexToProg(this.programs.dof,n);r.setFloat("focusDistance",i),r.setFloat("blur",e),r.setFloat("ppm",s),r.setVector("range",t),r.setTexture(2,this.ppb.getDepthTexture().get(),"depthMap"),this.renderToPingPong(r)}},{key:"mergeBloom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.mergeBloom,s);n.setFloat("gamma",e),n.setFloat("exposure",i),n.setTexture(3,t.get(),"bloomMap"),this.renderToPingPong(n)}},{key:"setKuwahara",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.kuwahara,t);this.renderToPingPong(e)}},{key:"setWatercolor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.watercolor,t);this.renderToPingPong(e)}},{key:"setWatercolor2",value:function(t,e,i,s){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=this.applyTexToProg(this.programs.watercolor2,n);r.setFloat("gradientStep",t),r.setFloat("advectStep",e),r.setFloat("flipHeightMap",i),r.setFloat("time",s),r.setTexture(2,this.textures.watercolor2.get(),"heightMap"),this.renderToPingPong(r)}},{key:"setWatercolor3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.watercolor3,t);e.setTexture(2,this.textures.watercolor3.get(),"noiseMap"),this.renderToPingPong(e)}},{key:"setWatercolorMoving",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.watercolorMoving,s);n.setFloat("time",t),n.setVector("mouse",e),n.setFloat("scale",i),this.renderToPingPong(n)}},{key:"setSobel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.sobel,t);this.renderToPingPong(e)}},{key:"setGamma",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.applyTexToProg(this.programs.gamma,e);i.setFloat("gamma",t),this.renderToPingPong(i)}},{key:"setRGB",value:function(t,e,i,s){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=this.applyTexToProg(this.programs.rgb,n);r.setVector("center",[i,s]),r.setVector("delta",[t,e]),this.renderToPingPong(r)}},{key:"setVortex",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.vortex,s);n.setVector("center",t),n.setFloat("radius",e),n.setFloat("angle",i),this.renderToPingPong(n)}},{key:"setOil",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.applyTexToProg(this.programs.oil,e);i.setFloat("radius",t),this.renderToPingPong(i)}},{key:"setSketch",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.applyTexToProg(this.programs.sketch,e);i.setFloat("delta",t),this.renderToPingPong(i)}},{key:"setPixel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.pixel,i);s.setVector("delta",[t,e]),this.renderToPingPong(s)}},{key:"setWave",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.wave,s);n.setFloat("time",t),n.setFloat("radius",e),n.setVector("center",i),this.renderToPingPong(n)}},{key:"setSepia",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.applyTexToProg(this.programs.sepia,e);i.setFloat("delta",t),this.renderToPingPong(i)}},{key:"setGlitch",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.glitch,s);n.setFloat("delta",e),n.setFloat("time",t),n.setFloat("speed",i),this.renderToPingPong(n)}},{key:"setGlitch2",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.glitch2,s);n.setFloat("delta",e),n.setFloat("time",t),n.setFloat("speed",i),this.renderToPingPong(n)}},{key:"setGlitch3",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.glitch3,i);s.setFloat("delta",e),s.setFloat("time",t),this.renderToPingPong(s)}},{key:"setGlitch4",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.glitch4,s);n.setFloat("delta",e),n.setFloat("time",t),n.setFloat("rate",i),this.renderToPingPong(n)}},{key:"setSignature",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.signature,i);s.setFloat("delta",e),s.setFloat("time",t),this.renderToPingPong(s)}},{key:"setCompose",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.compose,s);n.setTexture(6,t,"ssaoMap"),n.setTexture(7,e,"shadowMap"),n.setTexture(4,i,"depthMap"),this.renderToPingPong(n)}}]),i}(M),C=i(10),I=i.n(C);function B(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=R()(t);if(e){var n=R()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return T()(this,i)}}var _=function(t){P()(i,t);var e=B(i);function i(t,s){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o()(this,i),r=e.call(this,t,s,a),n()(I()(r),"setBlurIntensity",(function(t){r.blurIntensity=t})),n()(I()(r),"setBlurSize",(function(t){r.blurSize=t}));var u=s.blur||{};return r.blurSize=void 0!==u.size?u.size:.6,r.blurIntensity=void 0!==u.intensity?u.intensity:1,r}return u()(i,[{key:"setBlur",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.blurOnePass,t);e.setFloat("size",this.blurSize),e.setFloat("intensity",this.blurIntensity),this.renderToPingPong(e)}}]),i}(M);function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=R()(t);if(e){var n=R()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return T()(this,i)}}var U=function(t){P()(i,t);var e=L(i);function i(t,s){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o()(this,i),r=e.call(this,t,s,a),n()(I()(r),"setNbPass",(function(t){r.blurNbPass=t})),r}return i}(_),N=i(25),X=i(87),V=i(29);function G(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=R()(t);if(e){var n=R()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return T()(this,i)}}var q=function(t){P()(i,t);var e=G(i);function i(t,s){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o()(this,i),(n=e.call(this,t,s,r)).near=s.near||1,n.far=s.far||100,n.radius=s.radius||5,n.strength=s.strength||1;var a=n.programs.ssao;return a.setFloat("radius",n.radius),a.setFloat("near",n.near),a.setFloat("far",n.far),a.setFloat("strength",n.strength),n}return u()(i,[{key:"generateSsaoSamples",value:function(t,e){for(var i=0;i<e;i+=1){var s=i/e;s=Object(X.a)(s*s,.1,1);var n=new N.a(Object(V.c)(-1,1),Object(V.c)(-1,1),Object(V.c)(0,1)).normalise().multiplyNumber(Object(V.c)(0,1)).multiplyNumber(s);this.programs[t].setVector("samples[".concat(i,"]"),n.get())}}},{key:"compute",value:function(t){var e=this.applyTexToProg(this.programs.ssao,t);e.setFloat("flipY",-1),this.renderToPingPong(e)}}]),i}(_),W=i(22),Y=i.n(W);function K(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=R()(t);if(e){var n=R()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return T()(this,i)}}var Z=function(t){P()(i,t);var e=K(i);function i(t,s){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o()(this,i),r=e.call(this,t,s,a),n()(I()(r),"getProgram",(function(){return r.programs.shadow}));var u=r.programs.shadow;return u.setFloat("shadowEpsilon",s.epsilon||.01),u.setFloat("lighten",s.lighten||0),r}return u()(i,[{key:"start",value:function(t){Y()(R()(i.prototype),"start",this).call(this);var e=this.programs.shadow;e.setTexture(2,t.getDepthTexture().get(),"shadowMap"),e.setMatrix("shadowView",t.getView().get()),e.setMatrix("shadowProjection",t.getOrtho().get()),e.setVector("posLum",t.getPosition())}}]),i}(_);function H(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function J(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?H(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Q=function(){function t(e,i,s){o()(this,t),this.gl=e,this.config=i,this.time=0;var n=this.config.canvas,r=n.width,a=n.height;if(this.containerSize={width:r,height:a},s){if(s.shaders&&(this.mngProg=new v(this.gl,s.shaders,i.canvas),i.postprocess)){var u={width:r,height:a,useDepth:this.canUseDepth()},h=this.mngProg.getAll();this.postProcess=new z(this.gl,u,h),i.postprocess.bloom&&(this.bloom=new U(this.gl,J(J({},u),i.postprocess.bloom),h)),i.postprocess.ssao&&(this.ssao=new q(this.gl,J(J(J({},u),i.postprocess.ssao),{},{near:i.camera.near,far:i.camera.far}),h)),i.postprocess.shadow&&(this.shadow=new Z(this.gl,J(J({},u),i.postprocess.shadow),h))}s.textures&&(this.mngTex=new c(this.gl,s.textures,i.textures)),s.objets&&(this.mngObj=new d(this.gl,s.objets,s.materials)),s.gltfs&&(this.mngGltf=new m(this.gl,s.gltfs)),s.sounds&&(this.mngSound=new b(s.sounds))}this.resizeViewport()}return u()(t,[{key:"canUseDepth",value:function(){return this.config.useDepthTexture&&this.config.support.depthTexture}},{key:"resize",value:function(t){this.containerSize=t,this.resizeViewport()}},{key:"update",value:function(t){this.time=t}},{key:"render",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"resizeViewport",value:function(){this.gl.viewport(0,0,this.containerSize.width,this.containerSize.height)}},{key:"getColorPixel",value:function(t,e){var i=new Uint8Array(4);return this.gl.readPixels(t,e,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),i}}]),t}()},138:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=function(){function t(e,i){n()(this,t),this.gl=e;var s=Math.sqrt(i.length/4);this.size={width:s,height:s},this.texture=e.createTexture(),this.filter=e.NEAREST,this.setup(i)}return o()(t,[{key:"setup",value:function(t){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}},{key:"get",value:function(){return this.texture}}]),t}()},139:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(0),u=i.n(a),h=function(){function t(){var e=this;n()(this,t),u()(this,"start",(function(){var t=(new Date).getTime(),i=t-e.lastFrame;e.callbackNoFps&&e.callbackNoFps(),i>e.fps&&(e.callback(t-e.firstFrame),e.lastFrame=t),e.ref=window.requestAnimationFrame(e.start)})),this.fps=25,this.firstFrame=(new Date).getTime(),this.lastFrame=this.firstFrame,this.ref=null}return o()(t,[{key:"setCallback",value:function(t){this.callback=t}},{key:"setCallbackNoFps",value:function(t){this.callbackNoFps=t}},{key:"setFps",value:function(t){this.fps=t}},{key:"stop",value:function(){window.cancelAnimationFrame(this.ref)}}]),t}()},140:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=function(){function t(){n()(this,t),this.shaders={}}return o()(t,[{key:"get",value:function(e){var s=this,n=e.map((function(e){var s={},n=t.getInfos(e).name;try{s=i(282)("./shaders".concat(e)).then((function(t){return{name:n,js:t}}))}catch(t){}return s}));return Promise.all(n).then((function(t){return t.forEach((function(t){var e=t.name,i=t.js;s.shaders[e]=i.default})),s.shaders}))}}],[{key:"getInfos",value:function(t){var e=t.substring(t.lastIndexOf("/")+1,t.length).split(".");return{name:e[0],ext:e[1].toLowerCase()}}}]),t}();e.a=a},141:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(0),u=i.n(a),h=function(){function t(e){var i=this;n()(this,t),u()(this,"onKeyPress",(function(t){void 0!==i.keysPressed[t.keyCode]&&(t.preventDefault(),i.keysPressed[t.keyCode]=!0,i.oneKeysPressed[t.keyCode]=!0)})),u()(this,"onKeyUp",(function(t){void 0!==i.keysPressed[t.keyCode]&&(t.preventDefault(),i.keysUp[t.keyCode]=!0)})),this.keys=e,this.oneKeysPressed={},this.keysPressed={},this.keysUp={},this.charges={},Object.keys(this.keys).forEach((function(t){i.keysPressed[i.keys[t]]=!1,i.keysUp[i.keys[t]]=!1,i.oneKeysPressed[i.keys[t]]=!1,i.charges[i.keys[t]]=0})),document.addEventListener("keydown",this.onKeyPress,!1),document.addEventListener("keyup",this.onKeyUp,!1)}return o()(t,[{key:"cancel",value:function(){document.removeEventListener("keydown",this.onKeyPress,!1),document.removeEventListener("keyup",this.onKeyUp,!1)}},{key:"start",value:function(){var t=this;Object.keys(this.keys).forEach((function(e){t.keysPressed[t.keys[e]]&&(t.charges[t.keys[e]]+=1)}))}},{key:"end",value:function(){var t=this;Object.keys(this.keys).forEach((function(e){t.keysPressed[t.keys[e]]&&t.keysUp[t.keys[e]]&&(t.charges[t.keys[e]]=0,t.keysPressed[t.keys[e]]=!1,t.keysUp[t.keys[e]]=!1)}))}},{key:"getCharge",value:function(t){return this.charges[t]}},{key:"resetCharge",value:function(t){this.charges[t]=0}},{key:"isPressed",value:function(t){return this.charges[t]>0}},{key:"isPressedOne",value:function(t){return 1===this.charges[t]}},{key:"isUp",value:function(t){return this.keysUp[t]}}]),t}()},142:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(0),u=i.n(a),h=i(29),c=function(){function t(e,i){var s=this,r=i.callbackDrag,o=i.callbackDown,a=i.callbackUp,h=i.callbackMove,c=i.callbackWheel,l=i.callbackClick;n()(this,t),u()(this,"onMove",(function(e){var i=s.computeInfos(e);s.oldPos=t.getPos(e),null!==s.callbackMove&&s.callbackMove(i),s.isDragging&&null!==s.callbackDrag&&s.callbackDrag(i)})),u()(this,"onDown",(function(e){if(s.isDragging=!0,s.startDraggingMousePos=t.getPos(e),null!==s.callbackDown){var i=s.computeInfos(e);s.callbackDown(i),s.oldPos=t.getPos(e)}})),u()(this,"onUp",(function(t){if(s.onMove(t),s.isDragging=!1,null!==s.callbackUp){var e=s.computeInfos(t);s.callbackUp(e)}})),u()(this,"onWheel",(function(t){var e=t.deltaY;null!==s.callbackWheel&&s.callbackWheel({deltaY:e})})),u()(this,"onClick",(function(t){null!==s.callbackClick&&s.callbackClick(s.computeInfos(t))})),this.div=e,this.callbackDrag=r||null,this.callbackDown=o||null,this.callbackUp=a||null,this.callbackMove=h||null,this.callbackWheel=c||null,this.callbackClick=l||null,this.isDragging=!1,this.startDraggingMousePos={x:0,y:0},this.oldPos={x:0,y:0},this.options={capture:!1,passive:!0},this.setup()}return o()(t,[{key:"setup",value:function(){this.callbackClick&&this.div.addEventListener("click",this.onClick,!1),(this.callbackDrag||this.callbackMove)&&(this.div.addEventListener("mousemove",this.onMove,this.options),this.div.addEventListener("touchmove",this.onMove,this.options)),(this.callbackDrag||this.callbackDown||this.callbackUp)&&(window.addEventListener("mouseup",this.onUp,this.options),this.div.addEventListener("mousedown",this.onDown,this.options),this.div.addEventListener("touchstart",this.onDown,this.options),this.div.addEventListener("touchend",this.onUp,this.options)),this.callbackWheel&&this.div.addEventListener("wheel",this.onWheel,this.options)}},{key:"cancel",value:function(){this.callbackClick&&this.div.removeEventListener("click",this.onClick,!1),(this.callbackDrag||this.callbackMove)&&(this.div.removeEventListener("mousemove",this.onMove,this.options),this.div.removeEventListener("touchmove",this.onMove,this.options)),this.callbackDrag&&(window.removeEventListener("mouseup",this.onUp,this.options),this.div.removeEventListener("mousedown",this.onDown,this.options),this.div.removeEventListener("touchstart",this.onDown,this.options),this.div.removeEventListener("touchend",this.onUp,this.options)),this.callbackWheel&&this.div.removeEventListener("wheel",this.onWheel,this.options)}},{key:"computeInfos",value:function(e){var i=t.getPos(e),s=this.div.getBoundingClientRect(),n=i.x-s.x,r=i.y-s.y,o={x:this.oldPos.x-i.x,y:this.oldPos.y-i.y};return{size:s,pos:{x:n,y:r},rel:{x:Object(h.b)(n,0,s.width,-1,1),y:Object(h.b)(r,0,s.height,1,-1)},relScroll:{x:e.pageX-s.left+window.scrollX,y:e.pageY-s.top+window.scrollY},relDown:{x:this.startDraggingMousePos.x-i.x,y:this.startDraggingMousePos.y-i.y},relPrevious:o,speed:Math.max(Math.abs(o.x),Math.abs(o.x))}}},{key:"get",value:function(){return this.infos}}],[{key:"getPos",value:function(t){return t.touches?{x:t.touches[0].clientX,y:t.touches[0].clientY}:{x:t.clientX,y:t.clientY}}}]),t}();e.a=c},145:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(0),u=i.n(a),h=function(){function t(e){var i=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LINEAR",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;n()(this,t),u()(this,"findIndex",(function(t){var e=0,s=i.timeSteps[e];for(0===s&&(e++,s=i.timeSteps[e]);s&&t>s;)e++,s=i.timeSteps[e];i.index=e})),u()(this,"setTimes",(function(t){i.timeSteps=i.times.map((function(e){return e*t})),i.index=0,i.interpolationValue=0})),this.times=e,this.setTimes(r),this.interpolationType=s}return o()(t,[{key:"update",value:function(t){if(this.findIndex(t),0===this.index)this.interpolationValue=0;else if(this.index===this.times.length)this.interpolationValue=this.timeSteps[this.times.length-1];else{var e=this.timeSteps[this.index],i=this.timeSteps[this.index-1];this.interpolationValue=(t-i)/(e-i)}}},{key:"setSpeed",value:function(t){this.setTimes(t)}},{key:"getIndex",value:function(){return this.index}},{key:"get",value:function(){return this.interpolationValue}}]),t}()},147:function(t,e,i){"use strict";i.d(e,"a",(function(){return v}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(7),u=i.n(a),h=i(8),c=i.n(h),l=i(3),d=i.n(l);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=d()(t);if(e){var n=d()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return c()(this,i)}}var v=function(t){u()(i,t);var e=f(i);function i(){return n()(this,i),e.apply(this,arguments)}return o()(i,[{key:"create",value:function(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}}]),i}(i(57).a)},148:function(t,e,i){"use strict";i.d(e,"a",(function(){return v}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(7),u=i.n(a),h=i(8),c=i.n(h),l=i(3),d=i.n(l);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=d()(t);if(e){var n=d()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return c()(this,i)}}var v=function(t){u()(i,t);var e=f(i);function i(){return n()(this,i),e.apply(this,arguments)}return o()(i,[{key:"create",value:function(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.DEPTH_COMPONENT,this.size.width,this.size.height,0,this.gl.DEPTH_COMPONENT,this.gl.UNSIGNED_INT,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}}]),i}(i(57).a)},150:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(73),u=i(19),h=i(121),c=function(){function t(e){n()(this,t),this.gl=e,this.objet=new a.a(this.gl,h.a),this.model=new u.a,this.model.identity()}return o()(t,[{key:"render",value:function(t){t.setMatrix("model",this.model.get()),this.objet.render(t.get())}},{key:"update",value:function(t,e){this.model.identity().scale(e.getX(),e.getY(),e.getZ()).translate(t.getX(),t.getY(),t.getZ())}},{key:"getModel",value:function(){return this.model}}]),t}()},151:function(t,e,i){"use strict";i(43),i(61);var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(0),u=i.n(a);function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){u()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}for(var l=function(){function t(e){var i=this;n()(this,t),u()(this,"addFaceIndex",(function(t){var e=t.split("/");e[0]&&""!==e[0]&&i.obj.v.indices.push(parseInt(e[0],10)-1),e[1]&&""!==e[1]&&i.obj.vt.indices.push(parseInt(e[1],10)-1),e[2]&&""!==e[2]&&i.obj.vn.indices.push(parseInt(e[2],10)-1)})),this.obj={v:{indices:[],points:[]},vt:{indices:[],points:[]},vn:{indices:[],points:[]}},this.mat={},this.faceCount=0,this.readLines(e)}return o()(t,[{key:"readLines",value:function(t){var e=this;t.split("\n").forEach((function(t){var i=t.split(" "),s=i[0];switch(s){case"f":e.addFace(i.slice(1));break;case"v":case"vn":case"vt":e.addPoints(s,i.slice(1));break;case"usemtl":e.addNewMaterial(i.slice(1)[0])}}))}},{key:"addFace",value:function(t){t.forEach(this.addFaceIndex),this.faceCount+=1}},{key:"addPoints",value:function(t,e){var i=this;("vt"===t&&3===e.length?e.slice(0,2):e).forEach((function(e){return i.obj[t].points.push(parseFloat(e,10))}))}},{key:"addNewMaterial",value:function(t){this.mat[3*this.faceCount]=t}},{key:"get",value:function(){return c(c({},this.obj),{},{mat:this.mat})}}]),t}(),d=function(){function t(e){n()(this,t),this.materials={},this.current="",this.readLines(e)}return o()(t,[{key:"readLines",value:function(t){var e=this;t.split("\n").forEach((function(t){var i=t.split(" "),s=i[0];switch(s){case"newmtl":e.createMaterial(i.slice(1));break;case"Ns":case"Ka":case"Kd":case"Ks":case"Ke":case"Ni":case"d":case"illum":e.addInfoToMaterial(s,i.slice(1))}}))}},{key:"createMaterial",value:function(t){this.current=t,this.materials[this.current]={}}},{key:"addInfoToMaterial",value:function(t,e){var i="";switch(t){case"Ka":i="ambiant";break;case"Kd":i="diffuse";break;case"Ks":i="specular";break;case"Ke":i="emissive";break;case"Ns":i="specDensity";break;case"d":i="opacity"}""!==i&&(this.materials[this.current][i]=e.map((function(t){return parseFloat(t,10)})))}},{key:"get",value:function(){return this.materials}}]),t}(),f=i(27),v=i.n(f),g=i(49),p=i.n(g),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=new Uint8Array(256),k=0;k<y.length;k++)m[y.charCodeAt(k)]=k;var b=function(t,e,i,s,n){for(var r=new Float32Array(e),o=n||Float32Array.BYTES_PER_ELEMENT*s,a=0,u=0,h=0;h<i;h++){for(var c=0;c<s;c++){var l=a+c*Float32Array.BYTES_PER_ELEMENT;r[u]=t.getFloat32(l,!0),u++}a+=o}return r},x=function(t,e,i,s,n){for(var r=new Uint16Array(e),o=n||Uint16Array.BYTES_PER_ELEMENT*s,a=0,u=0,h=0;h<i;h++){for(var c=0;c<s;c++){var l=a+c*Uint16Array.BYTES_PER_ELEMENT;r[u]=t.getUint16(l,!0),u++}a+=o}return r},P=i(54);function w(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function T(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?w(Object(i),!0).forEach((function(e){u()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):w(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var E="SCALAR",R="VEC2",S="VEC3",D="VEC4",O="MAT2",M="MAT3",A="MAT4",F=function(t){switch(t){default:case E:return 1;case R:return 2;case S:return 3;case D:case O:return 4;case M:return 9;case A:return 16}},j=function(t,e,i){var s=i.bufferView,n=i.componentType,r=i.count,o=i.type,a=i.byteOffset,u=void 0===a?0:a,h=e[s],c=h.buffer,l=h.byteLength,d=h.byteOffset,f=void 0===d?0:d,v=h.byteStride,g=new DataView(t[c],f+u,l-u),p=F(o),y=function(t,e){return F(t)*e}(o,r),m=function(t){switch(t){case 5123:return x;case 5126:return b;case 5120:case 5121:case 5122:case 5125:default:return null}}(n);return m?m(g,y,r,p,v):null},z=function(t,e){var i=e.buffer,s=e.byteOffset,n=e.byteLength;return function(t,e){for(var i=new Uint8Array(e),s=0;s<e;s++)i[s]=t.getUint8(s,!0);return i}(new DataView(t[i],s,n),n)},C=function(t){switch(t){case"normal":return"normale";case"texcoord_0":return"texture";case"baseColorFactor":return"color";case"metallicFactor":return"metal";case"roughnessFactor":return"rough";case"joints_0":return"joint";case"weights_0":return"weight";default:return t}},I=["position","normale","texture","joint","weight","tangent"],B=function(t,e){var i,s={};if(t&&(s=T(T({},(i=t.pbrMetallicRoughness,Object.keys(i).reduce((function(t,e){var s=C(e);return T(T({},t),{},u()({},s,i[e]))}),[]))),{},{name:t.name}),t.normalTexture)){var n=e[t.normalTexture.index];s.normalMap=n||void 0}return Object.keys(s).length>0?s:void 0},_=function(t,e){return t.map((function(t){var i=t.attributes,s=t.indices,n=t.material,r=t.targets,o={vbos:function(t,e,i,s){var n=e[i],r={indices:T(T({},n),{},{size:F(n.type)})},o=s&&s.map((function(t){return Object.keys(t).reduce((function(i,s){var n=e[t[s]];return T(T({},i),{},u()({},s,T(T({},n),{},{size:F(n.type)})))}),{})}));return o&&(o=o.reduce((function(t,e,i){var s=Object.keys(e).reduce((function(t,s){var n=C(s.toLowerCase());return T(T({},t),{},u()({},"target".concat(n).concat(i),e[s]))}),{});return T(T({},t),s)}),{}),r=T(T({},o),r)),Object.keys(t).reduce((function(i,s){var n=C(s.toLowerCase());if(-1===I.indexOf(n))return i;var r=t[s],o=e[r];return T(T({},i),{},u()({},n,T(T({},o),{},{size:F(o.type)})))}),r)}(i,e,s,r)};return void 0!==n&&(o=T({material:n},o)),o}))},L=function t(e,i){return e.map((function(e){var s=i.findIndex((function(t){return t.id===e})),n=i.splice(s,1)[0];n.children&&(n.children=t(n.children,i));n.id;return p()(n,["id"])}))},U=function(){function t(e){n()(this,t);var i=JSON.parse(e),s=i.animations,r=i.buffers,o=i.bufferViews,a=i.accessors,u=i.skins,h=i.nodes,c=i.meshes,l=i.materials,d=i.images,f=r&&r.map((function(t){return function(t){var e,i,s,n,r,o=t.split(",")[1],a=.75*o.length,u=o.length,h=0;"="===o[o.length-1]&&(a--,"="===o[o.length-2]&&a--);var c=new ArrayBuffer(a),l=new Uint8Array(c);for(e=0;e<u;e+=4)i=m[o.charCodeAt(e)],s=m[o.charCodeAt(e+1)],n=m[o.charCodeAt(e+2)],r=m[o.charCodeAt(e+3)],l[h++]=i<<2|s>>4,l[h++]=(15&s)<<4|n>>2,l[h++]=(3&n)<<6|63&r;return c}(t.uri)})),g=a&&a.map((function(t){return T(T({},t),{},{values:j(f,o,t)})})),y=function(t,e,i,s){var n={};return t&&t.forEach((function(t){var r=t.channels,o=t.samplers;r.forEach((function(t){var r=t.target,a=t.sampler,u=o[a],h=u.input,c=u.output,l=u.interpolation,d=i[h],f=i[c],g=r.node,p=r.path,y=e[g],m=F(f.type);y[p]?m=y[p].length:y.mesh&&s[y.mesh][p]?m=s[y.mesh][p].length:"scale"===p&&(m=3);var k=Object(P.chunkArray)(f.values,m),b={path:p,times:d.values,output:k,interpolation:l};n[g]=n[g]?[].concat(v()(n[g]),[b]):[b]}))})),n}(s,h,g,c);Object.keys(y).forEach((function(t){h[t].animations=y[t]}));var k=function(t,e,i){var s=null;if(t){var n=e.map((function(t,e){return T(T({},t),{},{id:e})}));s=t.map((function(t){var e=t.inverseBindMatrices,s=t.joints,r=[];if(e){var o=i[e].values;r=Object(P.chunkArray)(o,16)}if(s){for(var a=s.map((function(t,e){return T(T({},n[t]),{},{invMatrix:r[e]})})).slice(),u=[];0!==a.length;){var h=a.shift();h.children&&(h.children=L(h.children,a)),h.id;var c=p()(h,["id"]);u.push(c)}return{joints:u}}return null})).filter((function(t){return t}))}return s}(u,h,g),b=c.map((function(t){var e=t.primitives,i=t.weights,s={primitives:_(e,g)};return i&&(s=T({weights:i},s)),s})),x=function(t,e,i,s){return t?t.map((function(t){var e=t.bufferView,n=t.mimeType,r=t.name,o=s[e];return{mimeType:n,name:r,data:z(i,o)}})):null}(d,0,f,o),w=l&&l.map((function(t){return B(t,x)}));this.data={},b&&(this.data.meshes=b),h&&(this.data.nodes=h.filter((function(t){return void 0!==t.mesh}))),k&&(this.data.skins=k),w&&(this.data.materials=w)}return o()(t,[{key:"get",value:function(){return this.data}}]),t}(),N=function(){function t(){n()(this,t),this.assets={textures:{},objets:{},materials:{},levels:{},gltfs:{},sounds:{}}}return o()(t,[{key:"get",value:function(e){var i=this,s=e.map((function(e){var i=t.getInfo(e);switch(i.ext){case"jpg":case"jpeg":case"png":case"bmp":return t.loadImage(e,i);case"obj":return t.load3dObj(e,i);case"gltf":return t.load3dGltf(e,i);case"mtl":return t.loadMaterial(e,i);case"mp3":return t.loadSound(e,i);default:return null}}));return Promise.all(s).then((function(t){return t.forEach((function(t){switch(t.info.ext){case"jpg":case"jpeg":case"png":i.assets.textures[t.info.name]=t.data;break;case"bmp":i.assets.levels[t.info.name]=t.data;break;case"obj":i.assets.objets[t.info.name]=t.data;break;case"gltf":i.assets.gltfs[t.info.name]=t.data;break;case"mtl":i.assets.materials[t.info.name]=t.data;break;case"mp3":i.assets.sounds[t.info.name]=t.data}})),i.assets}))}}],[{key:"getInfo",value:function(t){var e=t.substring(t.lastIndexOf("/")+1,t.length).split(".");return{name:e[0],ext:e[1].toLowerCase()}}},{key:"loadMaterial",value:function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new d(t).get(),info:e}}))}},{key:"loadImage",value:function(t,e){return new Promise((function(i,s){var n=new Image;n.onload=function(){return i({data:n,info:e})},n.onerror=s,n.src=t}))}},{key:"loadSound",value:function(t,e){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,info:e}}))}}]),t}();u()(N,"load3dObj",(function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new l(t).get(),info:e}}))})),u()(N,"load3dGltf",(function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new U(t).get(),info:e}}))}));e.a=N},153:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(0),u=i.n(a),h=function(){function t(e){var i=this;n()(this,t),u()(this,"enter",(function(){i.support&&(i.isFullscreen=!0,i.domItem.requestFullscreen?i.domItem.requestFullscreen():i.domItem.msRequestFullscreen?i.domItem.msRequestFullscreen():i.domItem.mozRequestFullScreen?i.domItem.mozRequestFullScreen():i.domItem.webkitRequestFullscreen&&i.domItem.webkitRequestFullscreen())})),u()(this,"exit",(function(){i.support&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())})),u()(this,"listen",(function(){i.support&&(document.exitFullscreen?document.addEventListener("fullscreenchange",i.onChange,!1):document.msExitFullscreen?document.addEventListener("MSFullscreenChange",i.onChange,!1):document.mozCancelFullScreen?document.addEventListener("mozfullscreenchange",i.onChange,!1):document.webkitExitFullscreen&&document.addEventListener("webkitfullscreenchange",i.onChange,!1))})),u()(this,"onChange",(function(){i.domItem&&(i.isOnFullscreen()?(i.domItem.setAttribute("data-fullscreen",!0),i.isFullscreen=!0):(i.domItem.removeAttribute("data-fullscreen"),i.isFullscreen=!1))})),u()(this,"isOnFullscreen",(function(){return!!document.fullscreenElement})),u()(this,"toggle",(function(){i.isFullscreen?i.exit():i.enter()})),u()(this,"getButton",(function(){return i.button})),this.domItem=e,this.isFullscreen=!1,this.support=!!(document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen),this.button=document.createElement("button"),this.button.id="fullscreen-toggle-btn",this.button.innerHTML='\n<svg viewbox="0 0 100 100">\n  <path d="M 0 40 L 0 0 L 40 0 L 40 10 L 10 10 L 10 40 Z"></path>\n  <path d="M 60 100 L 100 100 L 100 60 L 90 60 L 90 90 L 60 90 Z"></path>\n</svg>\n    ',this.button.addEventListener("click",this.toggle,!1),this.listen()}return o()(t,[{key:"destroy",value:function(){this.button&&this.button.removeEventListener("click",this.toggle,!1),this.support&&(document.exitFullscreen?document.removeEventListener("fullscreenchange",this.onExit,!1):document.msExitFullscreen?document.removeEventListener("MSFullscreenChange",this.onExit,!1):document.mozCancelFullScreen?document.removeEventListener("mozfullscreenchange",this.onExit,!1):document.webkitExitFullscreen&&document.removeEventListener("webkitfullscreenchange",this.onExit,!1))}},{key:"get",value:function(){return this.isFullscreen}},{key:"getSupport",value:function(){return this.support}}]),t}();function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){u()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var d=function(){function t(e,i){var s=this;n()(this,t),u()(this,"getDomItem",(function(){return s.controlsDomItem})),u()(this,"getRanges",(function(){return s.ranges})),this.controlsDomItem=document.createElement("div"),this.controlsDomItem.id="controls",this.controlsDomItem.style.opacity=0;var r=i.fullscreen,o=i.ranges;o&&(this.ranges=Object.keys(o).reduce((function(t,e){var i=o[e],n=i.min,r=void 0===n?0:n,a=i.max,h=void 0===a?100:a,c=i.value,d=void 0===c?0:c,f=document.createElement("input");return f.setAttribute("type","range"),f.setAttribute("id",e),f.setAttribute("min",r),f.setAttribute("max",h),f.setAttribute("value",d),s.controlsDomItem.appendChild(f),l(l({},t),{},u()({},e,{id:e,min:r,max:h,value:d,dom:f}))}),{})),r&&(this.fullscreen=new h(e),this.controlsDomItem.appendChild(this.fullscreen.getButton()))}return o()(t,[{key:"destroy",value:function(){this.fullscreen&&this.fullscreen.destroy()}}]),t}()},19:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(53),u=i(25),h=i(117),c=function(){function t(){n()(this,t),this.d=new Array(16),this.sauvegardePrecedente=[],this.empilement=0,this.init()}return o()(t,[{key:"init",value:function(){return this.reset(),this.sauvegardePrecedente=[],this.empilement=0,this}},{key:"reset",value:function(){for(var t=0;t<16;t+=1)this.d[t]=0;return this}},{key:"get",value:function(){return this.d}},{key:"setRaw",value:function(t){this.d=t}},{key:"set",value:function(t,e,i,s,n,r,o,a,u,h,c,l,d,f,v,g){return this.d[0]=t,this.d[1]=e,this.d[2]=i,this.d[3]=s,this.d[4]=n,this.d[5]=r,this.d[6]=o,this.d[7]=a,this.d[8]=u,this.d[9]=h,this.d[10]=c,this.d[11]=l,this.d[12]=d,this.d[13]=f,this.d[14]=v,this.d[15]=g,this}},{key:"setFromArray",value:function(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}},{key:"getMatrice3x3",value:function(){var t=new h.a;return t.set(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),t}},{key:"multiplyArray",value:function(e){var i=new t;return i.setFromArray(e),this.multiply(i)}},{key:"multiply",value:function(e){for(var i=new t,s=0;s<4;s+=1)for(var n=0;n<4;n+=1)for(var r=0;r<4;r+=1)i.d[4*n+s]+=this.d[4*n+r]*e.d[4*r+s];return this.d=i.d,this}},{key:"equal",value:function(t){for(var e=0;e<16;e+=1)this.d[e]=t.d[e],this.sauvegardePrecedente[e]=t.sauvegardePrecedente[e];return this}},{key:"push",value:function(){this.empilement+=1;for(var t=0,e=16*(this.empilement-1);e<16*this.empilement;e+=1)this.sauvegardePrecedente[e]=this.d[t],t+=1;return this}},{key:"pop",value:function(){if(this.empilement>0){for(var t=0,e=16*(this.empilement-1);e<16*this.empilement;e+=1)this.d[t]=this.sauvegardePrecedente[e],this.sauvegardePrecedente[e]=null,t+=1;this.empilement-=1}return this}},{key:"translate",value:function(e,i,s){var n=new t;return n.identity(),n.d[12]=e,n.d[13]=i,n.d[14]=s,this.multiply(n),this}},{key:"scale",value:function(e,i,s){var n=new t;return n.d[0]=e,n.d[5]=void 0===i?e:i,n.d[10]=void 0===s?e:s,n.d[15]=1,this.multiply(n),this}},{key:"resetScale",value:function(){return this.d[0]=1,this.d[5]=1,this.d[10]=1,this}},{key:"resetTranslate",value:function(){return this.d[12]=0,this.d[13]=0,this.d[14]=0,this}},{key:"rotate",value:function(e,i,s,n){var r=new t,o=e*(Math.PI/180),a=new u.a(i,s,n);return a.normalise(),r.d[0]=a.d[0]*a.d[0]*(1-Math.cos(o))+Math.cos(o),r.d[1]=a.d[0]*a.d[1]*(1-Math.cos(o))-a.d[2]*Math.sin(o),r.d[2]=a.d[0]*a.d[2]*(1-Math.cos(o))+a.d[1]*Math.sin(o),r.d[4]=a.d[0]*a.d[1]*(1-Math.cos(o))+a.d[2]*Math.sin(o),r.d[5]=a.d[1]*a.d[1]*(1-Math.cos(o))+Math.cos(o),r.d[6]=a.d[1]*a.d[2]*(1-Math.cos(o))-a.d[0]*Math.sin(o),r.d[8]=a.d[0]*a.d[2]*(1-Math.cos(o))-a.d[1]*Math.sin(o),r.d[9]=a.d[1]*a.d[2]*(1-Math.cos(o))+a.d[0]*Math.sin(o),r.d[10]=a.d[2]*a.d[2]*(1-Math.cos(o))+Math.cos(o),r.d[15]=1,this.multiply(r),this}},{key:"identity",value:function(){return this.init(),this.d[0]=1,this.d[5]=1,this.d[10]=1,this.d[15]=1,this}},{key:"perspective",value:function(t,e,i,s){var n=t*(Math.PI/180),r=1/Math.tan(n/2),o=1/(i-s);return this.set(r/e,0,0,0,0,r,0,0,0,0,(i+s)*o,-1,0,0,i*s*o*2,0),this}},{key:"ortho",value:function(t,e,i,s,n,r){return this.set(2/(e-t),0,0,0,0,2/(s-i),0,0,0,0,-2/(r-n),0,-(e+t)/(e-t),-(s+i)/(s-i),-(r+n)/(r-n),1),this}},{key:"lookAt",value:function(t,e,i,s,n,r,o,u,h){var c,l,d,f,v,g,p,y,m,k,b=t,x=e,P=i,w=o,T=u,E=h,R=s,S=n,D=r;return Math.abs(b-R)<a.a&&Math.abs(x-S)<a.a&&Math.abs(P-D)<a.a?(this.identity(),this):(p=b-R,y=x-S,m=P-D,c=T*(m*=k=1/Math.sqrt(p*p+y*y+m*m))-E*(y*=k),l=E*(p*=k)-w*m,d=w*y-T*p,(k=Math.sqrt(c*c+l*l+d*d))?(c*=k=1/k,l*=k,d*=k):(c=0,l=0,d=0),f=y*d-m*l,v=m*c-p*d,g=p*l-y*c,(k=Math.sqrt(f*f+v*v+g*g))?(f*=k=1/k,v*=k,g*=k):(f=0,v=0,g=0),this.set(c,f,p,0,l,v,y,0,d,g,m,0,-(c*b+l*x+d*P),-(f*b+v*x+g*P),-(p*b+y*x+m*P),1),this)}},{key:"transpose",value:function(){return this.setFromArray(t.transpose(this.d))}},{key:"inverse",value:function(){var e=t.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),i=t.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),s=t.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),n=t.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),r=this.d[0]*e-this.d[1]*i+this.d[2]*s-this.d[3]*n,o=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),a=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),u=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),h=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),c=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[13],this.d[14],this.d[15]),l=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[12],this.d[14],this.d[15]),d=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[12],this.d[13],this.d[15]),f=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[12],this.d[13],this.d[14]),v=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11]),g=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11]),p=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11]),y=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),m=1/r;return this.d[0]=m*e,this.d[1]=-m*o,this.d[2]=m*c,this.d[3]=-m*v,this.d[4]=-m*i,this.d[5]=m*a,this.d[6]=-m*l,this.d[7]=m*g,this.d[8]=m*s,this.d[9]=-m*u,this.d[10]=m*d,this.d[11]=-m*p,this.d[12]=-m*n,this.d[13]=m*h,this.d[14]=-m*f,this.d[15]=m*y,this}},{key:"getDeterminant",value:function(){return this.d[0]*t.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15])-this.d[1]*t.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15])+this.d[2]*t.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15])-this.d[3]*t.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14])}}],[{key:"transpose",value:function(t){for(var e=new Float32Array(16),i=0,s=0;s<4;s+=1)for(var n=0;n<4;n+=1)e[i]=t[4*n+s],i+=1;return e}},{key:"getCofacteur",value:function(t,e,i,s,n,r,o,a,u){return t*(n*u-r*a)-e*(s*u-r*o)+i*(s*a-n*o)}}]),t}();e.a=c},25:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(29),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n()(this,t),this.d=[0,0,0],this.set(e,i,s)}return o()(t,[{key:"normalise",value:function(){var t=this.length();return 0!==t&&(this.d[0]/=t,this.d[1]/=t,this.d[2]/=t),this}},{key:"get",value:function(){return this.d}},{key:"getX",value:function(){return this.d[0]}},{key:"getY",value:function(){return this.d[1]}},{key:"getZ",value:function(){return this.d[2]}},{key:"set",value:function(t,e,i){return null!==t&&(this.d[0]=t),null!==e?this.d[1]=e:null!==t&&(this.d[1]=t),null!==i?this.d[2]=i:null!==t&&(this.d[2]=t),this}},{key:"setX",value:function(t){this.d[0]=t}},{key:"setY",value:function(t){this.d[1]=t}},{key:"setZ",value:function(t){this.d[2]=t}},{key:"addXYZ",value:function(t,e,i){return this.d[0]+=t,this.d[1]+=e,this.d[2]+=i,this}},{key:"addX",value:function(t){return this.d[0]+=t,this}},{key:"addY",value:function(t){return this.d[1]+=t,this}},{key:"addZ",value:function(t){return this.d[2]+=t,this}},{key:"multiplyX",value:function(t){return this.d[0]*=t,this}},{key:"multiplyY",value:function(t){return this.d[1]*=t,this}},{key:"multiplyZ",value:function(t){return this.d[2]*=t,this}},{key:"limiter",value:function(t){var e=this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2];if(e>t*t&&e>0){var i=t/Math.sqrt(e);this.d[0]*=i,this.d[1]*=i,this.d[2]*=i}return this}},{key:"cross",value:function(e){return new t(this.d[1]*e.d[2]-this.d[2]*e.d[1],this.d[2]*e.d[0]-this.d[0]*e.d[2],this.d[0]*e.d[1]-this.d[1]*e.d[0])}},{key:"dot",value:function(t){return this.d[0]*t.d[0]+this.d[1]*t.d[1]+this.d[2]*t.d[2]}},{key:"length",value:function(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2])}},{key:"directionVers",value:function(t){return this.d[0]=t.d[0]-this.d[0],this.d[1]=t.d[1]-this.d[1],this.d[2]=t.d[2]-this.d[2],this}},{key:"equal",value:function(t){return this.d=[t.d[0],t.d[1],t.d[2]],this}},{key:"add",value:function(t){return this.d[0]+=t.d[0],this.d[1]+=t.d[1],this.d[2]+=t.d[2],this}},{key:"addNumber",value:function(t){return this.d[0]+=t,this.d[1]+=t,this.d[2]+=t,this}},{key:"minus",value:function(t){return this.d[0]-=t.d[0],this.d[1]-=t.d[1],this.d[2]-=t.d[2],this}},{key:"minusNumber",value:function(t){return this.d[0]-=t,this.d[1]-=t,this.d[2]-=t,this}},{key:"multiplyNumber",value:function(t){return this.d[0]*=t,this.d[1]*=t,this.d[2]*=t,this}},{key:"multiplyMatrix",value:function(t){return this.set(t.d[0]*this.d[0]+t.d[1]*this.d[1]+t.d[2]*this.d[2],t.d[3]*this.d[0]+t.d[4]*this.d[1]+t.d[5]*this.d[2],t.d[6]*this.d[0]+t.d[7]*this.d[1]+t.d[8]*this.d[2]),this}},{key:"multiply",value:function(t){return this.d[0]*=t.d[0],this.d[1]*=t.d[1],this.d[2]*=t.d[2],this}},{key:"divideNumber",value:function(t){return this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this}},{key:"divide",value:function(t){return this.d[0]/=t.d[0],this.d[1]/=t.d[1],this.d[2]/=t.d[2],this}},{key:"distance",value:function(t){return Math.sqrt((t.d[0]-this.d[0])*(t.d[0]-this.d[0])+(t.d[1]-this.d[1])*(t.d[1]-this.d[1])+(t.d[2]-this.d[2])*(t.d[2]-this.d[2]))}},{key:"angleDegree",value:function(t){var e=this.dot(t)/(this.length()*t.length());return 180*Math.acos(e)/Math.PI*-Object(a.d)(this.d[0]*t.d[1]+this.d[1]*t.d[0])}},{key:"computeNormal",value:function(e,i,s){var n=new t,r=new t,o=new t;return r.equal(e.minus(this)),o.equal(i.minus(this)),s?n.equal(o.cross(r)):n.equal(r.cross(o)),n.normalise(),n}}],[{key:"getBarycentre",value:function(t,e,i,s){var n=(e.d[2]-i.d[2])*(t.d[0]-i.d[0])+(i.d[0]-e.d[0])*(t.d[2]-i.d[2]),r=((e.d[2]-i.d[2])*(s[0]-i.d[0])+(i.d[0]-e.d[0])*(s[1]-i.d[2]))/n,o=((i.d[2]-t.d[2])*(s[0]-i.d[0])+(t.d[0]-i.d[0])*(s[1]-i.d[2]))/n,a=1-r-o;return r*t.d[1]+o*e.d[1]+a*i.d[1]}},{key:"lerp",value:function(e,i,s){var n=e.d[0],r=e.d[1],o=e.d[2];return new t(n+s*(i.d[0]-n),r+s*(i.d[1]-r),o+s*(i.d[2]-o))}}]),t}();e.a=u},29:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return r})),i.d(e,"d",(function(){return o}));var s=function(t){return Math.PI*t/180},n=function(t,e){return Math.random()*(e-t)+t},r=function(t,e,i,s,n){var r=s+(t-e)*(n-s)/(i-e);return r<Math.min(s,n)&&(r=Math.min(s,n)),r>Math.max(s,n)&&(r=Math.max(s,n)),r},o=function(t){return 0===t?0:t>0?1:-1}},336:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(19),u=function(){function t(){n()(this,t),this.model=new a.a,this.model.identity(),this.selected=!1}return o()(t,[{key:"setProgram",value:function(t){t.setMatrix("model",this.model.get())}},{key:"setProgramSpecifics",value:function(t){t.setInt("selected",this.selected),t.setVector("color",[1,1,1,1])}},{key:"render",value:function(t,e){this.setProgram(e),this.setProgramSpecifics(e),t.enable(e.get()),t.render(e.get())}},{key:"renderColor",value:function(t,e){this.setProgram(e),e.setInt("selected",this.selected),e.setVector("color",[1,1,1,1]),t.enable(e.get()),t.render(e.get())}},{key:"update",value:function(){this.model.identity()}},{key:"setDraggingInfos",value:function(t){this.angle.x.addToSpeed(.1*t.relPrevious.x),this.angle.y.addToSpeed(-.1*t.relPrevious.y)}},{key:"setSelected",value:function(t){this.selected=255===t[0]&&255===t[1]&&255===t[2],this.size.set(this.selected?1.1:1)}},{key:"setLightPos",value:function(t){this.lightPos=t}},{key:"reset",value:function(){this.model.identity()}},{key:"setRotate",value:function(t,e,i,s){this.model.rotate(t,e,i,s)}},{key:"setTranslate",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.model.translate(t,e,i)}},{key:"setScale",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.model.scale(t,e,i)}}]),t}()},337:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(0),u=i.n(a),h=function(){function t(e){var i=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n()(this,t),u()(this,"reset",(function(){i.sprite={uv:{x:0,y:0,w:1,h:1},size:{w:1,h:1}},i.step=0})),this.states=e,this.step=0,this.oldStep=this.step,this.nbSteps=1,this.timeout=this.states.time,this.lastFrame=null,this.sprite={uv:{x:0,y:0,w:1,h:1},size:{w:1,h:1}},this.uv=null,this.iteration=null,this.nextState=null,this.currentState=null,this.callbackEndOfAnimation=s,this.scale=1}return o()(t,[{key:"set",value:function(t){void 0!==t&&this.currentState!==t&&(this.currentState=t,this.reload(t))}},{key:"reload",value:function(t){var e=this.states[t];this.uv=e.uv,this.setUV(0),this.nbSteps=this.uv.length,1===this.nbSteps?this.lastFrame=null:(this.step=0,this.timeout=this.uv[this.step].t||this.states.time||100,this.iteration=e.iteration||null,this.nextState=e.next,this.lastFrame=(new Date).getTime())}},{key:"update",value:function(){if(this.oldStep=this.step,null!==this.lastFrame){var t=(new Date).getTime();t-this.lastFrame>this.timeout&&(this.step<this.nbSteps-1?this.nexStep():this.endOfLoop(),this.setUV(this.step),this.lastFrame=t)}}},{key:"nexStep",value:function(){this.step+=1,this.timeout=this.uv[this.step].t||this.states.time||100}},{key:"endOfLoop",value:function(){1===this.iteration?(this.callbackEndOfAnimation&&this.callbackEndOfAnimation(this.currentState,this.nextState),null!==this.nextState||void 0!==this.nextState?this.set(this.nextState):this.lastFrame=null):this.step=0}},{key:"get",value:function(){return{x:this.sprite.uv.x,y:this.sprite.uv.y,texW:this.states.size.w,texH:this.states.size.h,w:this.sprite.uv.w,h:this.sprite.uv.h,px:this.sprite.uv.px||-1,py:this.sprite.uv.py||-1,refSize:this.states.refSize}}},{key:"setUV",value:function(t){this.sprite.uv={x:this.uv[t].x||0,y:this.uv[t].y||0,w:this.uv[t].w||1,h:this.uv[t].h||1,px:this.uv[t].px,py:this.uv[t].py}}},{key:"getStatus",value:function(){return this.currentState}},{key:"getStep",value:function(){return this.step}},{key:"isNewStep",value:function(){return this.step!==this.oldStep}},{key:"getRelSize",value:function(){var t=this.states.refSize,e=this.sprite.uv,i=e.w/t,s=e.h/t,n=void 0!==e.px?-e.px/t:null,r=void 0!==e.py?-e.py/t:null;return{w:i*=this.scale,h:s*=this.scale,px:n=null!==n?n*this.scale:null,py:r=null!==r?r*this.scale:null}}},{key:"setScale",value:function(t){this.scale=t}},{key:"getScale",value:function(){return this.scale}},{key:"getState",value:function(){return this.currentState}}]),t}()},35:function(t,e,i){"use strict";var s=i(48),n=i.n(s),r=i(1),o=i.n(r),a=i(2),u=i.n(a),h=i(25),c=i(19),l=i(53),d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;o()(this,t),this.x=e,this.y=i,this.z=s,this.w=n}return u()(t,[{key:"set",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}},{key:"setFromAxeAndAngle",value:function(t,e){var i=n()(t,3),s=i[0],r=i[1],o=i[2];return this.x=s,this.y=r,this.z=o,this.w=e,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}},{key:"approx",value:function(t,e){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e&&Math.abs(this.z-t.z)<=e&&Math.abs(this.w-t.w)<=e}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}},{key:"multiplyArray",value:function(t){var e=this.x,i=this.y,s=this.z,n=this.w,r=t[0],o=t[1],a=t[2],u=t[3];return this.x=e*u+n*r+i*a-s*o,this.y=i*u+n*o+s*r-e*a,this.z=s*u+n*a+e*o-i*r,this.w=n*u-e*r-i*o-s*a,this}},{key:"multiply",value:function(t){var e=this.x,i=this.y,s=this.z,n=this.w,r=t.x,o=t.y,a=t.z,u=t.w;return this.x=e*u+n*r+i*a-s*o,this.y=i*u+n*o+s*r-e*a,this.z=s*u+n*a+e*o-i*r,this.w=n*u-e*r-i*o-s*a,this}},{key:"multiplyVector",value:function(t){var e=this.w*t.x+this.y*t.z-this.z*t.y,i=this.w*t.y+this.z*t.x-this.x*t.z,s=this.w*t.z+this.x*t.y-this.y*t.x,n=-this.x*t.x-this.y*t.y-this.z*t.z,r=e*this.w+n*-this.x+i*-this.z-s*-this.y,o=i*this.w+n*-this.y+s*-this.x-e*-this.z,a=s*this.w+n*-this.z+e*-this.y-i*-this.x;return new h.a(r,o,a)}},{key:"normalize",value:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return 0!==t&&1!==t&&(t=1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}},{key:"rotateX",value:function(t){var e=.5*t,i=this.x,s=this.y,n=this.z,r=this.w,o=Math.sin(e),a=Math.cos(e);return this.x=i*a+r*o,this.y=s*a+n*o,this.z=n*a-s*o,this.w=r*a-i*o,this}},{key:"rotateY",value:function(t){var e=.5*t,i=this.x,s=this.y,n=this.z,r=this.w,o=Math.sin(e),a=Math.cos(e);return this.x=i*a-n*o,this.y=s*a+r*o,this.z=n*a+i*o,this.w=r*a-s*o,this}},{key:"rotateZ",value:function(t){var e=.5*t,i=this.x,s=this.y,n=this.z,r=this.w,o=Math.sin(e),a=Math.cos(e);return this.x=i*a+s*o,this.y=s*a-i*o,this.z=n*a+r*o,this.w=r*a-n*o,this}},{key:"scale",value:function(t){var e=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return 0===e?this:1===e?(this.x*=t,this.y*=t,this.z*=t,this.w*=t,this):(e=t/Math.sqrt(e),this.x*=e,this.y*=e,this.z*=e,this.w*=e,this)}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}},{key:"slerp",value:function(t,e,i){var s,n,r,o,a,u=t.x,h=t.y,c=t.z,d=t.w,f=e.x,v=e.y,g=e.z,p=e.w;return(n=u*f+h*v+c*g+d*p)<0&&(n=-n,f=-f,v=-v,g=-g,p=-p),1-n>l.a?(s=Math.acos(n),r=Math.sin(s),o=Math.sin((1-i)*s)/r,a=Math.sin(i*s)/r):(o=1-i,a=i),this.x=o*u+a*f,this.y=o*h+a*v,this.z=o*c+a*g,this.w=o*d+a*p,this}},{key:"toMatrix4",value:function(){var t=this.w*this.w,e=this.x*this.x,i=this.y*this.y,s=this.z*this.z,n=1/(e+i+s+t),r=(e-i-s+t)*n,o=(-e+i-s+t)*n,a=(-e-i+s+t)*n,u=this.x*this.y,h=this.z*this.w,l=2*(u+h)*n,d=2*(u-h)*n,f=2*((u=this.x*this.z)-(h=this.y*this.w))*n,v=2*(u+h)*n,g=2*((u=this.y*this.z)+(h=this.x*this.w))*n,p=2*(u-h)*n;return(new c.a).set(r,l,f,0,d,o,g,0,v,p,a,0,0,0,0,1)}},{key:"setFromMat3",value:function(t){var e=t.get(),i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],u=e[6],h=e[7],c=e[8];return this.w=.5*Math.sqrt(Math.max(0,1+i+o+c)),this.x=.5*Math.sqrt(Math.max(0,1+i-o-c)),this.y=.5*Math.sqrt(Math.max(0,1-i+o-c)),this.z=.5*Math.sqrt(Math.max(0,1-i-o+c)),this.x*=Math.sign(a-h),this.y*=Math.sign(u-n),this.z*=Math.sign(s-r),this}},{key:"get",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getZ",value:function(){return this.z}},{key:"getW",value:function(){return this.w}}],[{key:"slerpArray",value:function(e,i,s){var n=new t(e[0],e[1],e[2],e[3]),r=new t(i[0],i[1],i[2],i[3]);return new t(0,0,0,1).slerp(n,r,s)}}]),t}();e.a=d},392:function(t,e,i){"use strict";i.d(e,"a",(function(){return v}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(7),u=i.n(a),h=i(8),c=i.n(h),l=i(3),d=i.n(l);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=d()(t);if(e){var n=d()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return c()(this,i)}}var v=function(t){u()(i,t);var e=f(i);function i(){var t;return n()(this,i),(t=e.call(this)).sprite={x:0,y:0,texW:1,texH:1,w:1,h:1},t.tint=[1,1,1],t.inverseColor=!1,t}return o()(i,[{key:"setProgramSpecifics",value:function(t){t.setVector("spriteUV",[this.sprite.x,this.sprite.y]),t.setVector("spriteGrid",[this.sprite.texW,this.sprite.texH]),t.setVector("spriteSize",[this.sprite.w,this.sprite.h]),t.setVector("spritePivot",[this.sprite.px,this.sprite.py]),t.setFloat("spriteRefSize",this.sprite.refSize),t.setVector("tint",this.tint),t.setInt("inverseColor",this.inverseColor?1:0)}},{key:"setTint",value:function(t,e,i){this.tint=[t,e,i]}},{key:"setInverseColor",value:function(t){this.inverseColor=t}},{key:"setSprite",value:function(t){this.sprite=t}}]),i}(i(336).a)},394:function(t,e,i){"use strict";i.d(e,"a",(function(){return D}));var s=i(27),n=i.n(s),r=i(1),o=i.n(r),a=i(2),u=i.n(a),h=i(22),c=i.n(h),l=i(7),d=i.n(l),f=i(8),v=i.n(f),g=i(3),p=i.n(g),y=i(10),m=i.n(y),k=i(0),b=i.n(k),x=i(337),P=i(392),w=i(25);function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p()(t);if(e){var n=p()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return v()(this,i)}}var E=function(t){d()(i,t);var e=T(i);function i(t){var s,n=t.constants,r=t.sprites,a=t.viewBox;return o()(this,i),s=e.call(this),b()(m()(s),"updateState",(function(t,e){s.inverseX=e,s.stateSprite.set(t),s.setSprite(s.stateSprite.get())})),b()(m()(s),"setEndOfAnimation",(function(t,e){e&&s.behavior.setEndOfAnimation(e),t===s.constants.states.DIE&&s.callbackDeath&&s.callbackDeath()})),s.inverseX=!1,s.stateSprite=new x.a(r,s.setEndOfAnimation),s.viewBox=a,s.constants=n,s.sprites=r,s.worldPos=new w.a,s.reset(),s}return u()(i,[{key:"update",value:function(t,e){c()(p()(i.prototype),"update",this).call(this),this.stateSprite.update(),this.behavior.update(t,e)}},{key:"render",value:function(t,e,s){var n=this.stateSprite.getRelSize(),r=n.w,o=n.h,a=n.px,u=n.py,h=0;null!==a&&(h=this.inverseX?-r-a:r-(r-a)),this.setScale(r,o,1),this.setTranslate(this.behavior.getX()-this.viewBox.x+h,this.behavior.getY()-this.viewBox.y-(1-o)+(u||0),this.behavior.getZ()),t.setTexture(0,e.get()),t.setInt("inverseX",this.inverseX?1:0),c()(p()(i.prototype),"render",this).call(this,s,t),this.setSprite(this.stateSprite.get())}},{key:"addToSpeed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.behavior.addToSpeed(new w.a(t,e,i))}},{key:"getX",value:function(){return this.behavior.getPosition().getX()}},{key:"getPosition",value:function(){return this.behavior.getPosition().get()}},{key:"getWorldPosition",value:function(){return this.worldPos.set(this.behavior.getX()-this.viewBox.x,this.behavior.getY()-this.viewBox.y,this.behavior.getZ()).get()}},{key:"getInverseX",value:function(){return this.inverseX}},{key:"getStatus",value:function(){return this.behavior.getStatus()}},{key:"isStatusChanged",value:function(){return this.behavior.isStatusChanged()}},{key:"getConstants",value:function(){return this.constants}},{key:"reset",value:function(){this.stateSprite.reset(),this.stateSprite.set(this.constants.states[Object.keys(this.constants.states)[0]]),this.setSprite(this.stateSprite.get())}}]),i}(P.a),R=i(473);function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p()(t);if(e){var n=p()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return v()(this,i)}}var D=function(t){d()(i,t);var e=S(i);function i(t){var s,n=t.constants,r=t.sprites,a=t.viewBox;return o()(this,i),(s=e.call(this,{constants:n,sprites:r,viewBox:a})).collisionBox=new R.a,s.collisionBox.setup(n.id),s.collisionCallback=null,s}return u()(i,[{key:"update",value:function(t,e){var s;c()(p()(i.prototype),"update",this).call(this,t,e),(s=this.collisionBox).update.apply(s,n()(this.getCollisionInfos()))}},{key:"getCollisionBox",value:function(){return this.collisionBox}},{key:"getCollisionInfos",value:function(){var t=this.constants,e=t.w,i=t.h;return[].concat(n()(this.getPosition()),[e,i])}},{key:"getId",value:function(){return this.constants.id}},{key:"setCallbacks",value:function(t){var e=t.addBoxes,i=t.removeBox;this.collisionCallback={addBoxes:e,removeBox:i}}}]),i}(E)},408:function(t,e,i){"use strict";i.d(e,"a",(function(){return v}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(7),u=i.n(a),h=i(8),c=i.n(h),l=i(3),d=i.n(l);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=d()(t);if(e){var n=d()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return c()(this,i)}}var v=function(t){u()(i,t);var e=f(i);function i(){var t;return n()(this,i),(t=e.call(this)).color=[255,255,255,1],t}return o()(i,[{key:"render",value:function(t,e){this.setProgram(e),e.setInt("selected",this.selected),e.setVector("color",[this.color[0]/255,this.color[1]/255,this.color[2]/255,this.color[3]]),t.enable(e.get()),t.render(e.get())}},{key:"setColor",value:function(t,e,i,s){this.color=[t,e,i,s]}}]),i}(i(336).a)},475:function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(22),u=i.n(a),h=i(7),c=i.n(h),l=i(8),d=i.n(l),f=i(3),v=i.n(f),g=i(394),p=i(476);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=v()(t);if(e){var n=v()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return d()(this,i)}}var m=function(t){c()(i,t);var e=y(i);function i(t){var s,r=t.constants,o=t.sprites,a=t.viewBox,u=t.tileSize,h=t.startPos,c=t.goLeft;return n()(this,i),(s=e.call(this,{constants:r,sprites:o,viewBox:a})).behavior=new p.a(r,null,u,h,c),s.inverseX=c,s.startPos=h,s.isShooted=!1,s}return o()(i,[{key:"update",value:function(t,e,s,n){this.isShooted||this.setAimingStrength(n),this.behavior.setStartPos(s),u()(v()(i.prototype),"update",this).call(this,t,e)}},{key:"shoot",value:function(t){this.isShooted=!0,this.stateSprite.set(t),this.setAimingStrength(1),this.behavior.shoot()}},{key:"isCollide",value:function(){return this.behavior.getCollisionAxeX()}},{key:"setAimingStrength",value:function(t){this.stateSprite.setScale(t)}}]),i}(g.a)},485:function(t,e,i){"use strict";i.d(e,"a",(function(){return W}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(10),u=i.n(a),h=i(22),c=i.n(h),l=i(7),d=i.n(l),f=i(8),v=i.n(f),g=i(3),p=i.n(g),y=i(0),m=i.n(y),k=i(132),b=i(472),x=i(487),P=i(52),w=i(27),T=i.n(w);function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p()(t);if(e){var n=p()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return v()(this,i)}}var R=function(t){d()(i,t);var e=E(i);function i(t){var s,r=t.constants,o=t.sprites,a=t.viewBox;return n()(this,i),s=e.call(this,{constants:r,sprites:o,viewBox:a}),m()(u()(s),"setCallbackDeath",(function(t){s.callbackDeath=t})),m()(u()(s),"setLife",(function(t){s.life=t,s.bar.setAttribute("value",s.life)})),m()(u()(s),"setDamage",(function(t){s.life-=t,s.targetDamage.setDirect(2),s.bar&&s.bar.setAttribute("value",s.life),s.life<=0&&(s.behavior.setStatus(s.constants.states.DIE),s.stateSprite.set(s.constants.states.DIE),s.collisionCallback.removeBox(s.constants.id))})),m()(u()(s),"insert",(function(t){t&&t.appendChild(s.bar)})),s.life=r.life,s.callbackDeath=null,s.targetDamage=new P.a(0,.1),r.displayLife&&(s.bar=document.createElement("meter"),s.bar.setAttribute("data-id",r.id),s.bar.setAttribute("min",0),s.bar.setAttribute("max",r.life),s.bar.setAttribute("value",s.life),s.insert(document.querySelector("#gameinfos"))),s}return o()(i,[{key:"update",value:function(t,e){var s;c()(p()(i.prototype),"update",this).call(this,t,e),(s=this.collisionBox).update.apply(s,T()(this.getCollisionInfos())),this.targetDamage.update()}},{key:"render",value:function(t,e,s){t.setFloat("damage",this.targetDamage.get()),c()(p()(i.prototype),"render",this).call(this,t,e,s)}},{key:"getLife",value:function(){return this.life}},{key:"reset",value:function(){c()(p()(i.prototype),"reset",this).call(this),this.life=this.constants.life,this.bar&&this.bar.setAttribute("value",this.life)}}]),i}(i(394).a),S=i(489);function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p()(t);if(e){var n=p()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return v()(this,i)}}var O=function(t){d()(i,t);var e=D(i);function i(t){var s,r=t.constants,o=t.sprites,a=t.viewBox,u=t.fxs;return n()(this,i),s=e.call(this,{constants:r,sprites:o,viewBox:a}),u&&(s.fxs=new S.a(u.constants,u.sprites,a)),s}return o()(i,[{key:"update",value:function(t,e){if(c()(p()(i.prototype),"update",this).call(this,t,e),this.fxs){this.fxs.update();var s=this.constants.states,n=s.JUMP_UP,r=s.RUN_JUMP_UP,o=this.fxs.getConstants().states.DUST,a=this.getStatus(),u=this.getLastJumpingPosition(),h=this.getLastRunningPosition();!this.isStatusChanged()||a!==n&&a!==r||this.fxs.createNewOne(u,o),null!==h&&this.fxs.createNewOne(h,o)}}},{key:"renderFxs",value:function(t,e,i){this.fxs.render(t,e,i)}},{key:"getLastJumpingPosition",value:function(){return this.behavior.getLastJumpingPosition()}},{key:"getLastRunningPosition",value:function(){return this.behavior.getStatus()!==this.constants.states.RUN||!this.stateSprite.isNewStep()||0!==this.stateSprite.getStep()&&2!==this.stateSprite.getStep()?null:this.behavior.getPosition()}}]),i}(R),M=i(474),A=i(25);function F(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function j(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?F(Object(i),!0).forEach((function(e){m()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):F(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p()(t);if(e){var n=p()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return v()(this,i)}}var C=function(t){d()(i,t);var e=z(i);function i(t){var s,r=t.constants,o=t.sprites,a=t.viewBox,h=t.fxs,c=t.bullets;if(n()(this,i),s=e.call(this,{constants:r,sprites:o,viewBox:a,fxs:h}),m()(u()(s),"callbackBulletShoot",(function(t,e,i){s.setRecoil(i),s.collisionCallback.addBoxes([e])})),m()(u()(s),"callbackBulletCollide",(function(t){s.collisionCallback.removeBox(t)})),m()(u()(s),"setRecoil",(function(t){s.behavior.addToSpeed(new A.a(s.inverseX?t:-t,0,0))})),m()(u()(s),"removeBullet",(function(t){s.bullets.removeOne(t)})),s.offsetAiming=s.getAimingOffsetVector(),s.aimingPos=new A.a,c){var l="".concat(r.id,"-").concat(c.constants.id);s.bullets=new M.a(j(j({},c.constants),{},{id:l}),c.sprites,a),s.bullets.setCallbackShoot(s.callbackBulletShoot),s.bullets.setCallbackCollide(s.callbackBulletCollide)}return s}return o()(i,[{key:"update",value:function(t,e){c()(p()(i.prototype),"update",this).call(this,t,e),this.aimingPos.equal(this.behavior.getPosition()),this.aimingPos.addX(this.inverseX?this.offsetAiming.invX:this.offsetAiming.x),this.aimingPos.addY(this.offsetAiming.y),this.bullets&&this.bullets.update(t,e,this.aimingPos,this.isAiming(),this.inverseX)}},{key:"renderBullets",value:function(t,e,i){this.bullets.render(t,e,i)}},{key:"getAimingOffsetVector",value:function(){var t=this.sprites.refSize,e=this.sprites[this.constants.states.AIM].uv[0],i=e.w,s=e.cx;return{x:s/t,y:e.cy/t,invX:(i-s)/t}}},{key:"getAimingPos",value:function(){return this.aimingPos}},{key:"getAimingPosition",value:function(){var t=this.stateSprite.getRelSize().h;return new A.a(this.behavior.getX()-this.viewBox.x+(this.inverseX?this.offsetAiming.invX:this.offsetAiming.x),this.behavior.getY()-this.viewBox.y-t+this.offsetAiming.y,this.behavior.getZ())}},{key:"isAiming",value:function(){return this.behavior.isAiming()}}]),i}(O),I=i(477);function B(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p()(t);if(e){var n=p()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return v()(this,i)}}var _=function(t){d()(i,t);var e=B(i);function i(t){var s,r=t.constants,o=t.sprites,a=t.viewBox,h=t.tileSize,c=t.bullets,l=t.fxs;return n()(this,i),s=e.call(this,{constants:r,sprites:o,viewBox:a,bullets:c,fxs:l}),m()(u()(s),"setInteraction",(function(t){s.behavior.setInteraction(t)})),s.behavior=new I.a(r,s.updateState,h),s}return o()(i,[{key:"getDashing",value:function(){return this.behavior.getDashing()}},{key:"reset",value:function(){this.behavior&&this.behavior.reset(),c()(p()(i.prototype),"reset",this).call(this)}}]),i}(C),L=i(478);function U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p()(t);if(e){var n=p()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return v()(this,i)}}var N=function(t){d()(i,t);var e=U(i);function i(t){var s,r,o=t.constants,a=t.sprites,h=t.viewBox,l=t.tileSize;return n()(this,i),r=e.call(this,{constants:o,sprites:a,viewBox:h}),m()(u()(r),"reset",(function(){c()((s=u()(r),p()(i.prototype)),"reset",s).call(s),r.behavior&&r.behavior.reset()})),r.behavior=new L.a(o,r.updateState,l),r.setInverseColor(!0),r}return i}(R),X=i(486);function V(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function G(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?V(Object(i),!0).forEach((function(e){m()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):V(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=p()(t);if(e){var n=p()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return v()(this,i)}}var W=function(t){d()(i,t);var e=q(i);function i(t,s,r){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1024,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1024;return n()(this,i),o=e.call(this,t,s,r,a,h),m()(u()(o),"updateCollisionsInteractions",(function(){var t=o.collisions.get();t.length>0&&t.forEach((function(t){var e=t.type,i=t.on,s=t.from,n=t.bulletId;switch(e){case"SIMPLE":var r=o.interactives[i],a=o.interactives[s];"SLASH"===r.getStatus()?(a.addToSpeed(a.getX()<r.getX()?-1:1),a.setDamage(30)):(r.addToSpeed(a.getX()<r.getX()?1:-1),r.setDamage(10));break;case"SHOOT":var u=o.interactives[i],h=o.interactives[s];u.addToSpeed(h.getX()<u.getX()?1:-1),u.setDamage(10),o.collisions.removeBox(n),h.removeBullet(n)}}))})),m()(u()(o),"setPause",(function(t){o.isPause=t})),o.targetRGB=new P.a(0,.1),o.targetWave=new P.a(0,.1),o.oldInverse=!1,o.oldAiming=!1,o.isPause=!0,o.interactives={},o.tilemap=null,o}return o()(i,[{key:"setupGameLevel",value:function(t,e,i){var s=this;if(this.config.game){var n=this.config.game.types,r=t.tilemap,o=t.interactives,a=r.tileSize;this.tilemap=new x.a(e,r);var u=this.tilemap.getViewBox();Object.keys(o).forEach((function(t){var e=o[t],r=e.type,h=e.x,c=e.y;if(n[r]){var l=n[r],d=G(G({},l.constants),{},{x:h,y:c,id:t}),f=l.sprites;switch(r){case"heros":var v=l.fxs,g=l.bullets;s.interactives[t]=new _({constants:d,sprites:f,viewBox:u,tileSize:a,bullets:g,fxs:v}),s.interactives[t].setCallbackDeath(i);break;case"monster":s.interactives[t]=new N({constants:d,sprites:f,viewBox:u,tileSize:a})}}}));var h=Object.keys(this.interactives).map((function(t){return s.interactives[t].getCollisionBox()}));this.background=new b.a(u,this.tilemap.getLevelSize()),this.collisions=new X.a(h);var c=this.collisions,l=c.addBoxes,d=c.removeBox;Object.keys(this.interactives).forEach((function(t){s.interactives[t].setCallbacks({addBoxes:l,removeBox:d})}))}}},{key:"resetGameLevel",value:function(){var t=this;Object.keys(this.interactives).forEach((function(e){t.interactives[e].reset()})),this.collisions.clear();var e=Object.keys(this.interactives).map((function(e){return t.interactives[e].getCollisionBox()}));this.collisions.addBoxes(e)}},{key:"resize",value:function(t){c()(p()(i.prototype),"resize",this).call(this,t),this.postProcess.resize(t)}},{key:"update",value:function(t){var e=this;c()(p()(i.prototype),"update",this).call(this,t);var s=this.interactives.heros,n=s.getWorldPosition(),r=s.getPosition(),o=this.tilemap.get();if(this.camera.followPosY(n[1]),this.tilemap.follow(r),this.tilemap.update(this.mngProg.get("spritePhong")),!this.isPause){var a=this.tilemap.getTileSize();Object.keys(this.interactives).forEach((function(t){e.interactives[t].update(o,a)})),this.updateCollisionsInteractions()}}},{key:"renderPause",value:function(){c()(p()(i.prototype),"render",this).call(this),this.renderBackground(),this.renderTilemap()}},{key:"mainRender",value:function(){this.renderBackground(),this.renderTilemap(),this.renderInteractives(),this.renderForeground()}},{key:"renderTilemap",value:function(){this.tilemap.render(this.mngProg.get("spritePhong"),this.mngTex.get("level1"),this.mngObj.get("cubeTile"),this.mngObj.get("tile"))}},{key:"renderInteractives",value:function(){var t=this;Object.keys(this.interactives).forEach((function(e){t.interactives[e].render(t.mngProg.get("sprite"),t.mngTex.get("heros"),t.mngObj.get("tile"))}));var e=this.interactives.heros;e.renderFxs(this.mngProg.get("sprite"),this.mngTex.get("fx"),this.mngObj.get("tile")),e.renderBullets(this.mngProg.get("sprite"),this.mngTex.get("bullet"),this.mngObj.get("tile"))}},{key:"renderBackground",value:function(){var t=this.interactives.heros.getX(),e=this.mngProg.get("background");this.background.renderMountains(this.mngObj.get("tile"),this.mngProg.get("color")),this.background.updateScreens(-.15),e.setTexture(0,this.mngTex.get("clouds").get(),"textureMap"),this.background.renderScreen(this.mngObj.get("tile"),e,t,5e-4),this.background.updateScreens(-.1),e.setTexture(0,this.mngTex.get("rocks").get(),"textureMap"),this.background.renderScreen(this.mngObj.get("tile"),e,t,.001),this.background.updateScreens(-.05),e.setTexture(0,this.mngTex.get("ground").get(),"textureMap"),this.background.renderScreen(this.mngObj.get("tile"),e,t,.005),this.background.renderCloudsBack(this.mngObj.get("tile"),this.mngProg.get("color"))}},{key:"renderForeground",value:function(){this.background.renderCloudsFront(this.mngObj.get("tile"),this.mngProg.get("color"))}},{key:"effects",value:function(){var t=this.interactives.heros,e=t.getAimingPosition(),i=t.getInverseX(),s=t.isAiming();this.targetRGB.update(),this.targetWave.update(),i!==this.oldInverse&&(this.camera.setSmoothRotation(i?.4:-.4),this.camera.setSmoothTarget(i?-4:4),this.oldInverse=i),s!==this.oldAiming&&(this.targetWave.set(s?.01:0),this.camera.setSmoothZoom(s?.8:1),this.oldAiming=s),this.targetRGB.set(t.getDashing()||this.isPause?2:0);var n=this.camera.get2dTexturePoint(e),r=this.targetRGB.get();this.postProcess.setRGB(r,r,e.getX(),e.getY()),this.postProcess.setWave(.1*this.time,this.targetWave.get(),n)}},{key:"render",value:function(){c()(p()(i.prototype),"render",this).call(this),this.postProcess.start(),this.mainRender(),this.postProcess.end(),this.effects(),this.postProcess.render()}},{key:"setKeyboardInteraction",value:function(t){this.isPause||this.interactives.heros.setInteraction(t)}}]),i}(k.a)},488:function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=i(7),u=i.n(a),h=i(8),c=i.n(h),l=i(3),d=i.n(l),f=i(336),v=i(117);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=d()(t);if(e){var n=d()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return c()(this,i)}}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=d()(t);if(e){var n=d()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return c()(this,i)}}var y=function(t){u()(i,t);var e=p(i);function i(){var t;return n()(this,i),(t=e.call(this)).sprite={x:0,y:0,texW:1,texH:1,w:1,h:1},t}return o()(i,[{key:"setProgramSpecifics",value:function(t){t.setVector("spriteUV",[this.sprite.x,this.sprite.y]),t.setVector("spriteGrid",[this.sprite.texW,this.sprite.texH]),t.setVector("spriteSize",[this.sprite.w,this.sprite.h]),t.setFloat("spriteRefSize",this.sprite.refSize)}},{key:"setSprite",value:function(t){this.sprite=t}}]),i}(function(t){u()(i,t);var e=g(i);function i(){var t;return n()(this,i),(t=e.call(this)).normalMatrix=new v.a,t}return o()(i,[{key:"setNormalMatrix",value:function(t){this.normalMatrix.equal(this.model.getMatrice3x3()),this.normalMatrix.inverse(),this.normalMatrix.transpose(),t.setMatrix("normalMatrix",this.normalMatrix.get())}}]),i}(f.a))},52:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.04;n()(this,t),this.value=e,this.target=e,this.sampling=i,this.threshold=1e-6}return o()(t,[{key:"update",value:function(){Math.abs(this.value-this.target)>this.threshold?this.value+=(this.target-this.value)*this.sampling:this.value=this.target}},{key:"get",value:function(){return this.value}},{key:"set",value:function(t){this.target=t}},{key:"setDirect",value:function(t){this.value=t}}]),t}()},54:function(t,e,i){"use strict";i.r(e),i.d(e,"chunkArray",(function(){return s})),i.d(e,"capitalize",(function(){return n})),i.d(e,"getEnvPath",(function(){return r}));var s=function(t,e){return Array.from({length:Math.ceil(t.length/e)},(function(i,s){return t.slice(s*e,s*e+e)}))},n=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},r=function(t){return"".concat("/public").concat(t)}},57:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i(1),n=i.n(s),r=i(2),o=i.n(r),a=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64;n()(this,t),this.gl=e,this.size={width:i,height:s},this.texture=e.createTexture(),this.filter=e.NEAREST,this.setup()}return o()(t,[{key:"setup",value:function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.create(),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"create",value:function(){for(var t=new ArrayBuffer(this.size.width*this.size.height),e=new Uint8Array(t),i=0,s=0;s<this.size.height;s+=1)for(var n=0;n<this.size.width;n+=1)e[i]=255*Math.random(),i+=1;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.ALPHA,this.size.width,this.size.height,0,this.gl.ALPHA,this.gl.UNSIGNED_BYTE,e)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}},{key:"get",value:function(){return this.texture}},{key:"setFiltre",value:function(t){this.filter=t}}]),t}()},87:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var s=function(t,e,i){return(1-t)*e+t*i}},88:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var s=i(0),n=i.n(s),r=i(1),o=i.n(r),a=i(2),u=i.n(a),h=function(){function t(e,i){o()(this,t),this.gl=e,i&&this.create(i)}return u()(t,[{key:"create",value:function(t){var e=t.locationKey,i=t.type,s=t.values,n=t.count,r=t.componentType,o=t.size,a=t.modeCalcul,u="SCALAR"!==i?this.gl.ARRAY_BUFFER:this.gl.ELEMENT_ARRAY_BUFFER;this.vbo=this.gl.createBuffer(),this.gl.bindBuffer(u,this.vbo),this.gl.bufferData(u,s,a),this.gl.bindBuffer(u,null),this.size=o,this.count=n,this.componentType=r,this.bufferType=u,this.locationKey=e}},{key:"enable",value:function(t){var e=this.locationKey,i=this.vbo,s=this.componentType,n=this.size,r=this.bufferType;if("indices"===e)this.gl.bindBuffer(r,i);else{var o=t.locations[e];void 0!==o&&-1!==o&&(this.gl.bindBuffer(r,i),this.gl.enableVertexAttribArray(o),this.gl.vertexAttribPointer(o,n,s,!1,0,0))}}},{key:"start",value:function(t){this.gl.useProgram(t)}},{key:"end",value:function(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}},{key:"update",value:function(t){this.gl.bindBuffer(this.bufferType,this.vbo),this.gl.bufferSubData(this.bufferType,0,new Float32Array(t)),this.gl.bindBuffer(this.bufferType,null)}},{key:"render",value:function(t,e){"indices"===this.locationKey?this.gl.drawElements(e,this.count,this.componentType,0):this.gl.drawArrays(e,0,this.count)}},{key:"getCount",value:function(){return this.count}}]),t}();function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var d=function(){function t(e,i){var s=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o()(this,t),this.gl=e,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=n?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,this.vbos=Object.keys(i).reduce((function(t,n){return t[n]=new h(e,l({locationKey:n,modeCalcul:s.modeCalcul},i[n])),t}),{})}return u()(t,[{key:"enable",value:function(t){var e=this;this.gl.useProgram(t),Object.keys(this.vbos).forEach((function(i){e.vbos[i].enable(t)}))}},{key:"update",value:function(t){var e=this;Object.keys(t).forEach((function(i){e.vbos[i].update(t[i])}))}},{key:"render",value:function(t){this.enable(t);var e=this.vbos.indices||this.vbos.position||this.vbos.texture;e.render(t,this.modeDessin),e.end()}},{key:"setModeDessin",value:function(t){this.modeDessin=t}},{key:"setModeCalcul",value:function(t){this.modeCalcul=t}}]),t}()}}]);