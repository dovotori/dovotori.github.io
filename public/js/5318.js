"use strict";(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[5318],{19574:(e,t,n)=>{n.d(t,{Z:()=>C});var r=n(55431),i=n(36885),o=n(74187),s=n(6101),a=n(28641),l=n(92710),d=n(1295),c=n(91900);class h extends r.Z{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){(0,o.O3)()}calculateMatrices2D(e){const t=e.viewState,n=e.coordinateToPixelTransform,r=e.pixelToCoordinateTransform;(0,s.qC)(n,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),(0,s.nb)(r,n)}forEachFeatureAtCoordinate(e,t,n,r,i,o,s,l){let h;const g=t.viewState;function u(e,t,n,r){return i.call(o,t,e?n:null,r)}const p=g.projection,f=(0,c.Cf)(e.slice(),p),T=[[0,0]];if(p.canWrapX()&&r){const e=p.getExtent(),t=(0,a.dz)(e);T.push([-t,0],[t,0])}const x=t.layerStatesArray,m=x.length,y=[],R=[];for(let r=0;r<T.length;r++)for(let i=m-1;i>=0;--i){const o=x[i],a=o.layer;if(a.hasRenderer()&&(0,d.j)(o,g)&&s.call(l,a)){const i=a.getRenderer(),s=a.getSource();if(i&&s){const a=s.getWrapX()?f:e,l=u.bind(null,o.managed);R[0]=a[0]+T[r][0],R[1]=a[1]+T[r][1],h=i.forEachFeatureAtCoordinate(R,t,n,l,y)}if(h)return h}}if(0===y.length)return;const C=1/y.length;return y.forEach(((e,t)=>e.distanceSq+=t*C)),y.sort(((e,t)=>e.distanceSq-t.distanceSq)),y.some((e=>h=e.callback(e.feature,e.layer,e.geometry))),h}hasFeatureAtCoordinate(e,t,n,r,o,s){return void 0!==this.forEachFeatureAtCoordinate(e,t,n,r,i.uX,this,o,s)}getMap(){return this.map_}renderFrame(e){(0,o.O3)()}scheduleExpireIconCache(e){l.c.canExpireCache()&&e.postRenderFunctions.push(g)}}function g(e,t){l.c.expire()}const u=h;var p=n(35990),f=n(57380),T=n(98771),x=n(10245),m=n(50147),y=n(65818),R=n(68326);const C=class extends u{constructor(e){super(e),this.fontChangeListenerKey_=(0,y.oL)(m.sG,p.Z.PROPERTYCHANGE,e.redrawText.bind(e)),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=x.XV+" ol-layers";const n=e.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const n=this.getMap();if(n.hasListener(e)){const r=new f.Z(e,void 0,t);n.dispatchEvent(r)}}disposeInternal(){(0,y.bN)(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(e){if(!e)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(e),this.dispatchRenderEvent(T.Z.PRECOMPOSE,e);const t=e.layerStatesArray.sort((function(e,t){return e.zIndex-t.zIndex})),n=e.viewState;this.children_.length=0;const r=[];let i=null;for(let o=0,s=t.length;o<s;++o){const s=t[o];e.layerIndex=o;const a=s.layer,l=a.getSourceState();if(!(0,d.j)(s,n)||"ready"!=l&&"undefined"!=l){a.unrender();continue}const c=a.render(e,i);c&&(c!==i&&(this.children_.push(c),i=c),"getDeclutter"in a&&r.push(a))}for(let t=r.length-1;t>=0;--t)r[t].renderDeclutter(e);(0,R.hF)(this.element_,this.children_),this.dispatchRenderEvent(T.Z.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}}},98015:(e,t,n)=>{n.d(t,{r:()=>T,Z:()=>m});var r=n(85487),i=n(70553),o=n(62706),s=n(74187);class a extends o.Z{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.declutterExecutorGroup=null}getFeatures(e){return(0,s.O3)()}getData(e){return null}prepareFrame(e){return(0,s.O3)()}renderFrame(e,t){return(0,s.O3)()}loadedTileCallback(e,t,n){e[t]||(e[t]={}),e[t][n.tileCoord.toString()]=n}createLoadedTileFinder(e,t,n){return(r,i)=>{const o=this.loadedTileCallback.bind(this,n,r);return e.forEachLoadedTile(t,r,i,o)}}forEachFeatureAtCoordinate(e,t,n,r,i){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){e.target.getState()===i.Z.LOADED&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=i.Z.LOADED&&t!=i.Z.ERROR&&e.addEventListener(r.Z.CHANGE,this.boundHandleImageChange_),t==i.Z.IDLE&&(e.load(),t=e.getState()),t==i.Z.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&"ready"===e.getSourceState()&&e.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}}const l=a;var d=n(57380),c=n(98771),h=n(6101),g=n(79706),u=n(68326),p=n(65537),f=n(28641);const T=[];let x=null;const m=class extends l{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=(0,h.Ue)(),this.pixelTransform=(0,h.Ue)(),this.inversePixelTransform=(0,h.Ue)(),this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(e,t,n){let r;x||(x=(0,u.E4)(1,1,void 0,{willReadFrequently:!0})),x.clearRect(0,0,1,1);try{x.drawImage(e,t,n,1,1,0,0,1,1),r=x.getImageData(0,0,1,1).data}catch(e){return x=null,null}return r}getBackground(e){let t=this.getLayer().getBackground();return"function"==typeof t&&(t=t(e.viewState.resolution)),t||void 0}useContainer(e,t,n){const r=this.getLayer().getClassName();let i,o;if(e&&e.className===r&&(!n||e&&e.style.backgroundColor&&(0,p.fS)((0,g._2)(e.style.backgroundColor),(0,g._2)(n)))){const t=e.firstElementChild;t instanceof HTMLCanvasElement&&(o=t.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){i=document.createElement("div"),i.className=r;let e=i.style;e.position="absolute",e.width="100%",e.height="100%",o=(0,u.E4)();const t=o.canvas;i.appendChild(t),e=t.style,e.position="absolute",e.left="0",e.transformOrigin="top left",this.container=i,this.context=o}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}clipUnrotated(e,t,n){const r=(0,f.rL)(n),i=(0,f.Xv)(n),o=(0,f.w$)(n),s=(0,f.hC)(n);(0,h.nn)(t.coordinateToPixelTransform,r),(0,h.nn)(t.coordinateToPixelTransform,i),(0,h.nn)(t.coordinateToPixelTransform,o),(0,h.nn)(t.coordinateToPixelTransform,s);const a=this.inversePixelTransform;(0,h.nn)(a,r),(0,h.nn)(a,i),(0,h.nn)(a,o),(0,h.nn)(a,s),e.save(),e.beginPath(),e.moveTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.clip()}dispatchRenderEvent_(e,t,n){const r=this.getLayer();if(r.hasListener(e)){const i=new d.Z(e,this.inversePixelTransform,n,t);r.dispatchEvent(i)}}preRender(e,t){this.frameState=t,this.dispatchRenderEvent_(c.Z.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(c.Z.POSTRENDER,e,t)}getRenderTransform(e,t,n,r,i,o,s){const a=i/2,l=o/2,d=r/t,c=-d,g=-e[0]+s,u=-e[1];return(0,h.qC)(this.tempTransform,a,l,d,c,-n,g,u)}disposeInternal(){delete this.frameState,super.disposeInternal()}}},25682:(e,t,n)=>{n.d(t,{Z:()=>x});var r=n(31391),i=n(98015),o=n(62963),s=n(37755),a=n(9289),l=n(6101),d=n(28641),c=n(68326),h=n(76234),g=n(65537),u=n(62369),p=n(74187),f=n(91900);class T extends i.Z{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,d.lJ)(),this.wrappedRenderedExtent_=(0,d.lJ)(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(e,t,n){const r=t.extent,i=t.viewState,o=i.center,a=i.resolution,l=i.projection,c=i.rotation,h=l.getExtent(),g=this.getLayer().getSource(),u=t.pixelRatio,p=t.viewHints,f=!(p[s.Z.ANIMATING]||p[s.Z.INTERACTING]),T=this.compositionContext_,x=Math.round(t.size[0]*u),m=Math.round(t.size[1]*u),y=g.getWrapX()&&l.canWrapX(),R=y?(0,d.dz)(h):null,C=y?Math.ceil((r[2]-h[2])/R)+1:1;let S=y?Math.floor((r[0]-h[0])/R):0;do{const t=this.getRenderTransform(o,a,c,u,x,m,S*R);e.execute(T,1,t,c,f,void 0,n)}while(++S<C)}setupCompositionContext_(){if(1!==this.opacity_){const e=(0,c.E4)(this.context.canvas.width,this.context.canvas.height,i.r);this.compositionContext_=e}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const e=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=e,(0,c.jy)(this.compositionContext_),i.r.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(e){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,e,e.declutterTree),this.releaseCompositionContext_())}renderFrame(e,t){const n=e.pixelRatio,r=e.layerStatesArray[e.layerIndex];(0,l.n3)(this.pixelTransform,1/n,1/n),(0,l.nb)(this.inversePixelTransform,this.pixelTransform);const i=(0,l.BB)(this.pixelTransform);this.useContainer(t,i,this.getBackground(e));const o=this.context,s=o.canvas,a=this.replayGroup_,c=this.declutterExecutorGroup;if((!a||a.isEmpty())&&(!c||c.isEmpty()))return null;const h=Math.round(e.size[0]*n),g=Math.round(e.size[1]*n);s.width!=h||s.height!=g?(s.width=h,s.height=g,s.style.transform!==i&&(s.style.transform=i)):this.containerReused||o.clearRect(0,0,h,g),this.preRender(o,e);const p=e.viewState,f=p.projection;this.opacity_=r.opacity,this.setupCompositionContext_();let T=!1,x=!0;if(r.extent&&this.clipping){const t=(0,u.dY)(r.extent,f);x=(0,d.kK)(t,e.extent),T=x&&!(0,d.r4)(t,e.extent),T&&this.clipUnrotated(this.compositionContext_,e,t)}return x&&this.renderWorlds(a,e),T&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,e),this.renderedRotation_!==p.rotation&&(this.renderedRotation_=p.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(e){return new Promise((t=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const e=[this.context.canvas.width,this.context.canvas.height];(0,l.nn)(this.pixelTransform,e);const t=this.renderedCenter_,n=this.renderedResolution_,r=this.renderedRotation_,i=this.renderedProjection_,o=this.wrappedRenderedExtent_,s=this.getLayer(),c=[],h=e[0]*a.UN,g=e[1]*a.UN;c.push(this.getRenderTransform(t,n,r,a.UN,h,g,0).slice());const u=s.getSource(),p=i.getExtent();if(u.getWrapX()&&i.canWrapX()&&!(0,d.r4)(p,o)){let e=o[0];const i=(0,d.dz)(p);let s,l=0;for(;e<p[0];)--l,s=i*l,c.push(this.getRenderTransform(t,n,r,a.UN,h,g,s).slice()),e+=i;for(l=0,e=o[2];e>p[2];)++l,s=i*l,c.push(this.getRenderTransform(t,n,r,a.UN,h,g,s).slice()),e-=i}this.hitDetectionImageData_=(0,a.TU)(e,c,this.renderedFeatures_,s.getStyleFunction(),o,n,r)}t((0,a.ix)(e,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(e,t,n,r,i){if(!this.replayGroup_)return;const o=t.viewState.resolution,s=t.viewState.rotation,a=this.getLayer(),l={},d=function(e,t,n){const o=(0,p.sq)(e),s=l[o];if(s){if(!0!==s&&n<s.distanceSq){if(0===n)return l[o]=!0,i.splice(i.lastIndexOf(s),1),r(e,a,t);s.geometry=t,s.distanceSq=n}}else{if(0===n)return l[o]=!0,r(e,a,t);i.push(l[o]={feature:e,layer:a,geometry:t,distanceSq:n,callback:r})}};let c;const h=[this.replayGroup_];return this.declutterExecutorGroup&&h.push(this.declutterExecutorGroup),h.some((r=>c=r.forEachFeatureAtCoordinate(e,o,s,n,d,r===this.declutterExecutorGroup&&t.declutterTree?t.declutterTree.all().map((e=>e.value)):null))),c}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),n=t.getSource();if(!n)return!1;const i=e.viewHints[s.Z.ANIMATING],a=e.viewHints[s.Z.INTERACTING],l=t.getUpdateWhileAnimating(),c=t.getUpdateWhileInteracting();if(this.ready&&!l&&i||!c&&a)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const p=e.extent,T=e.viewState,x=T.projection,m=T.resolution,y=e.pixelRatio,R=t.getRevision(),C=t.getRenderBuffer();let S=t.getRenderOrder();void 0===S&&(S=h.eR);const _=T.center.slice(),I=(0,d.f3)(p,C*m),v=I.slice(),E=[I.slice()],w=x.getExtent();if(n.getWrapX()&&x.canWrapX()&&!(0,d.r4)(w,e.extent)){const e=(0,d.dz)(w),t=Math.max((0,d.dz)(I)/2,e);I[0]=w[0]-t,I[2]=w[2]+t,(0,f.Cf)(_,x);const n=(0,d.Cf)(E[0],x);n[0]<w[0]&&n[2]<w[2]?E.push([n[0]+e,n[1],n[2]+e,n[3]]):n[0]>w[0]&&n[2]>w[2]&&E.push([n[0]-e,n[1],n[2]-e,n[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==R&&this.renderedRenderOrder_==S&&(0,d.r4)(this.wrappedRenderedExtent_,I))return(0,g.fS)(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=_,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const Z=new r.Z((0,h.Qz)(m,y),I,m,y);let b;this.getLayer().getDeclutter()&&(b=new r.Z((0,h.Qz)(m,y),I,m,y));const F=(0,u.Cs)();let D;if(F){for(let e=0,t=E.length;e<t;++e){const t=E[e],r=(0,u.Fj)(t,x);n.loadFeatures(r,(0,u.on)(m,x),F)}D=(0,u.WO)(F,x)}else for(let e=0,t=E.length;e<t;++e)n.loadFeatures(E[e],m,x);const P=(0,h.se)(m,y);let A=!0;const L=e=>{let n;const r=e.getStyleFunction()||t.getStyleFunction();if(r&&(n=r(e,m)),n){const t=this.renderFeature(e,P,n,Z,D,b);A=A&&!t}},G=(0,u.Fj)(I,x),M=n.getFeaturesInExtent(G);S&&M.sort(S);for(let e=0,t=M.length;e<t;++e)L(M[e]);this.renderedFeatures_=M,this.ready=A;const O=Z.finish(),N=new o.Z(I,m,y,n.getOverlaps(),O,t.getRenderBuffer());return b&&(this.declutterExecutorGroup=new o.Z(I,m,y,n.getOverlaps(),b.finish(),t.getRenderBuffer())),this.renderedResolution_=m,this.renderedRevision_=R,this.renderedRenderOrder_=S,this.renderedExtent_=v,this.wrappedRenderedExtent_=I,this.renderedCenter_=_,this.renderedProjection_=x,this.replayGroup_=N,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,n,r,i,o){if(!n)return!1;let s=!1;if(Array.isArray(n))for(let a=0,l=n.length;a<l;++a)s=(0,h.Pn)(r,e,n[a],t,this.boundHandleStyleImageChange_,i,o)||s;else s=(0,h.Pn)(r,e,n,t,this.boundHandleStyleImageChange_,i,o);return s}}const x=T},38862:(e,t,n)=>{n.d(t,{Z:()=>I});var r=n(31391),i=n(62963),o=n(98015),s=n(20825),a=n(83883),l=n(2519),d=n(37195),c=n(6101),h=n(65537),g=n(28641),u=n(62369),p=n(74187),f=n(4307);class T extends o.Z{constructor(e){super(e),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=(0,g.lJ)(),this.tmpTileRange_=new l.Z(0,0,0,0)}isDrawableTile(e){const t=this.getLayer(),n=e.getState(),r=t.getUseInterimTilesOnError();return n==d.Z.LOADED||n==d.Z.EMPTY||n==d.Z.ERROR&&!r}getTile(e,t,n,r){const i=r.pixelRatio,o=r.viewState.projection,s=this.getLayer();let a=s.getSource().getTile(e,t,n,i,o);return a.getState()==d.Z.ERROR&&s.getUseInterimTilesOnError()&&s.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(e){const t=this.frameState;if(!t)return null;const n=this.getLayer(),r=(0,c.nn)(t.pixelToCoordinateTransform,e.slice()),i=n.getExtent();if(i&&!(0,g.b8)(i,r))return null;const o=t.pixelRatio,l=t.viewState.projection,h=t.viewState,u=n.getRenderSource(),p=u.getTileGridForProjection(h.projection),T=u.getTilePixelRatio(t.pixelRatio);for(let e=p.getZForResolution(h.resolution);e>=p.getMinZoom();--e){const t=p.getTileCoordForCoordAndZ(r,e),n=u.getTile(e,t[1],t[2],o,l);if(!(n instanceof s.Z||n instanceof a.Z)||n instanceof a.Z&&n.getState()===d.Z.EMPTY)return null;if(n.getState()!==d.Z.LOADED)continue;const i=p.getOrigin(e),c=(0,f.Pq)(p.getTileSize(e)),g=p.getResolution(e),x=Math.floor(T*((r[0]-i[0])/g-t[1]*c[0])),m=Math.floor(T*((i[1]-r[1])/g-t[2]*c[1])),y=Math.round(T*u.getGutterForProjection(h.projection));return this.getImageData(n.getImage(),x+y,m+y)}return null}loadedTileCallback(e,t,n){return!!this.isDrawableTile(n)&&super.loadedTileCallback(e,t,n)}prepareFrame(e){return!!this.getLayer().getSource()}renderFrame(e,t){const n=e.layerStatesArray[e.layerIndex],r=e.viewState,i=r.projection,o=r.resolution,s=r.center,a=r.rotation,l=e.pixelRatio,f=this.getLayer(),T=f.getSource(),x=T.getRevision(),m=T.getTileGridForProjection(i),y=m.getZForResolution(o,T.zDirection),R=m.getResolution(y);let C=e.extent;const S=e.viewState.resolution,_=T.getTilePixelRatio(l),I=Math.round((0,g.dz)(C)/S*l),v=Math.round((0,g.Cr)(C)/S*l),E=n.extent&&(0,u.dY)(n.extent,i);E&&(C=(0,g.Ed)(C,(0,u.dY)(n.extent,i)));const w=R*I/2/_,Z=R*v/2/_,b=[s[0]-w,s[1]-Z,s[0]+w,s[1]+Z],F=m.getTileRangeForExtentAndZ(C,y),D={};D[y]={};const P=this.createLoadedTileFinder(T,i,D),A=this.tmpExtent,L=this.tmpTileRange_;this.newTiles_=!1;const G=a?(0,g.dY)(r.center,S,a,e.size):void 0;for(let t=F.minX;t<=F.maxX;++t)for(let r=F.minY;r<=F.maxY;++r){if(a&&!m.tileCoordIntersectsViewport([y,t,r],G))continue;const i=this.getTile(y,t,r,e);if(this.isDrawableTile(i)){const t=(0,p.sq)(this);if(i.getState()==d.Z.LOADED){D[y][i.tileCoord.toString()]=i;let e=i.inTransition(t);e&&1!==n.opacity&&(i.endTransition(t),e=!1),this.newTiles_||!e&&this.renderedTiles.includes(i)||(this.newTiles_=!0)}if(1===i.getAlpha(t,e.time))continue}const o=m.getTileCoordChildTileRange(i.tileCoord,L,A);let s=!1;o&&(s=P(y+1,o)),s||m.forEachTileCoordParentTileRange(i.tileCoord,P,L,A)}const M=R/o*l/_;(0,c.qC)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/l,1/l,a,-I/2,-v/2);const O=(0,c.BB)(this.pixelTransform);this.useContainer(t,O,this.getBackground(e));const N=this.context,j=N.canvas;(0,c.nb)(this.inversePixelTransform,this.pixelTransform),(0,c.qC)(this.tempTransform,I/2,v/2,M,M,0,-I/2,-v/2),j.width!=I||j.height!=v?(j.width=I,j.height=v):this.containerReused||N.clearRect(0,0,I,v),E&&this.clipUnrotated(N,e,E),T.getInterpolate()||(N.imageSmoothingEnabled=!1),this.preRender(N,e),this.renderedTiles.length=0;let k,q,B,z=Object.keys(D).map(Number);z.sort(h.j2),1!==n.opacity||this.containerReused&&!T.getOpaque(e.viewState.projection)?(k=[],q=[]):z=z.reverse();for(let t=z.length-1;t>=0;--t){const n=z[t],r=T.getTilePixelSize(n,l,i),o=m.getResolution(n)/R,s=r[0]*o*M,a=r[1]*o*M,d=m.getTileCoordForCoordAndZ((0,g.rL)(b),n),h=m.getTileCoordExtent(d),u=(0,c.nn)(this.tempTransform,[_*(h[0]-b[0])/R,_*(b[3]-h[3])/R]),f=_*T.getGutterForProjection(i),x=D[n];for(const t in x){const r=x[t],i=r.tileCoord,o=d[1]-i[1],l=Math.round(u[0]-(o-1)*s),c=d[2]-i[2],h=Math.round(u[1]-(c-1)*a),m=Math.round(u[0]-o*s),R=Math.round(u[1]-c*a),C=l-m,S=h-R,_=y===n,I=_&&1!==r.getAlpha((0,p.sq)(this),e.time);let v=!1;if(!I)if(k){B=[m,R,m+C,R,m+C,R+S,m,R+S];for(let e=0,t=k.length;e<t;++e)if(y!==n&&n<q[e]){const t=k[e];(0,g.kK)([m,R,m+C,R+S],[t[0],t[3],t[4],t[7]])&&(v||(N.save(),v=!0),N.beginPath(),N.moveTo(B[0],B[1]),N.lineTo(B[2],B[3]),N.lineTo(B[4],B[5]),N.lineTo(B[6],B[7]),N.moveTo(t[6],t[7]),N.lineTo(t[4],t[5]),N.lineTo(t[2],t[3]),N.lineTo(t[0],t[1]),N.clip())}k.push(B),q.push(n)}else N.clearRect(m,R,C,S);this.drawTileImage(r,e,m,R,C,S,f,_),k&&!I?(v&&N.restore(),this.renderedTiles.unshift(r)):this.renderedTiles.push(r),this.updateUsedTiles(e.usedTiles,T,r)}}return this.renderedRevision=x,this.renderedResolution=R,this.extentChanged=!this.renderedExtent_||!(0,g.fS)(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=l,this.renderedProjection=i,this.manageTilePyramid(e,T,m,l,i,C,y,f.getPreload()),this.scheduleExpireCache(e,T),this.postRender(N,e),n.extent&&N.restore(),N.imageSmoothingEnabled=!0,O!==j.style.transform&&(j.style.transform=O),this.container}drawTileImage(e,t,n,r,i,o,s,a){const l=this.getTileImage(e);if(!l)return;const d=(0,p.sq)(this),c=t.layerStatesArray[t.layerIndex],h=c.opacity*(a?e.getAlpha(d,t.time):1),g=h!==this.context.globalAlpha;g&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(l,s,s,l.width-2*s,l.height-2*s,n,r,i,o),g&&this.context.restore(),h!==c.opacity?t.animate=!0:a&&e.endTransition(d)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}scheduleExpireCache(e,t){if(t.canExpireCache()){const n=function(e,t,n){const r=(0,p.sq)(e);r in n.usedTiles&&e.expireCache(n.viewState.projection,n.usedTiles[r])}.bind(null,t);e.postRenderFunctions.push(n)}}updateUsedTiles(e,t,n){const r=(0,p.sq)(t);r in e||(e[r]={}),e[r][n.getKey()]=!0}manageTilePyramid(e,t,n,r,i,o,s,a,l){const c=(0,p.sq)(t);c in e.wantedTiles||(e.wantedTiles[c]={});const h=e.wantedTiles[c],u=e.tileQueue,f=n.getMinZoom(),T=e.viewState.rotation,x=T?(0,g.dY)(e.viewState.center,e.viewState.resolution,T,e.size):void 0;let m,y,R,C,S,_,I=0;for(_=f;_<=s;++_)for(y=n.getTileRangeForExtentAndZ(o,_,y),R=n.getResolution(_),C=y.minX;C<=y.maxX;++C)for(S=y.minY;S<=y.maxY;++S)T&&!n.tileCoordIntersectsViewport([_,C,S],x)||(s-_<=a?(++I,m=t.getTile(_,C,S,r,i),m.getState()==d.Z.IDLE&&(h[m.getKey()]=!0,u.isKeyQueued(m.getKey())||u.enqueue([m,c,n.getTileCoordCenter(m.tileCoord),R])),void 0!==l&&l(m)):t.useTile(_,C,S,i));t.updateCacheSize(I,i)}}const x=T;var m=n(37755),y=n(9289),R=n(76234),C=n(91900);const S={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},_={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};const I=class extends x{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.tmpTransform_=(0,c.Ue)()}prepareTile(e,t,n){let r;const i=e.getState();return i!==d.Z.LOADED&&i!==d.Z.ERROR||(this.updateExecutorGroup_(e,t,n),this.tileImageNeedsRender_(e)&&(r=!0)),r}getTile(e,t,n,r){const i=r.pixelRatio,o=r.viewState,s=o.resolution,a=o.projection,l=this.getLayer(),d=l.getSource().getTile(e,t,n,i,a),c=r.viewHints,h=!(c[m.Z.ANIMATING]||c[m.Z.INTERACTING]);!h&&d.wantedResolution||(d.wantedResolution=s);return this.prepareTile(d,i,a)&&(h||Date.now()-r.time<8)&&"vector"!==l.getRenderMode()&&this.renderTileImage_(d,r),super.getTile(e,t,n,r)}isDrawableTile(e){const t=this.getLayer();return super.isDrawableTile(e)&&("vector"===t.getRenderMode()?(0,p.sq)(t)in e.executorGroups:e.hasContext(t))}getTileImage(e){return e.getImage(this.getLayer())}prepareFrame(e){const t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,n){const o=this.getLayer(),s=o.getRevision(),a=o.getRenderOrder()||null,l=e.wantedResolution,c=e.getReplayState(o);if(!c.dirty&&c.renderedResolution===l&&c.renderedRevision==s&&c.renderedRenderOrder==a)return;const h=o.getSource(),u=o.getDeclutter(),f=h.getTileGrid(),T=h.getTileGridForProjection(n).getTileCoordExtent(e.wrappedTileCoord),x=h.getSourceTiles(t,n,e),m=(0,p.sq)(o);delete e.hitDetectionImageData[m],e.executorGroups[m]=[],u&&(e.declutterExecutorGroups[m]=[]),c.dirty=!1;for(let n=0,s=x.length;n<s;++n){const s=x[n];if(s.getState()!=d.Z.LOADED)continue;const p=s.tileCoord,y=f.getTileCoordExtent(p),C=(0,g.Ed)(T,y),S=(0,g.f3)(C,o.getRenderBuffer()*l,this.tmpExtent),_=(0,g.fS)(y,C)?null:S,I=new r.Z(0,S,l,t),v=u?new r.Z(0,C,l,t):void 0,E=(0,R.se)(l,t),w=function(e){let t;const n=e.getStyleFunction()||o.getStyleFunction();if(n&&(t=n(e,l)),t){const n=this.renderFeature(e,E,t,I,v);c.dirty=c.dirty||n}},Z=s.getFeatures();a&&a!==c.renderedRenderOrder&&Z.sort(a);for(let e=0,t=Z.length;e<t;++e){const t=Z[e];_&&!(0,g.kK)(_,t.getGeometry().getExtent())||w.call(this,t)}const b=I.finish(),F="vector"!==o.getRenderMode()&&u&&1===x.length?null:C,D=new i.Z(F,l,t,h.getOverlaps(),b,o.getRenderBuffer());if(e.executorGroups[m].push(D),v){const n=new i.Z(null,l,t,h.getOverlaps(),v.finish(),o.getRenderBuffer());e.declutterExecutorGroups[m].push(n)}}c.renderedRevision=s,c.renderedRenderOrder=a,c.renderedResolution=l}forEachFeatureAtCoordinate(e,t,n,r,i){const o=t.viewState.resolution,s=t.viewState.rotation;n=null==n?0:n;const a=this.getLayer(),l=a.getSource().getTileGridForProjection(t.viewState.projection),d=(0,g.hI)([e]);(0,g.f3)(d,o*n,d);const c={},h=function(e,t,n){let o=e.getId();void 0===o&&(o=(0,p.sq)(e));const s=c[o];if(s){if(!0!==s&&n<s.distanceSq){if(0===n)return c[o]=!0,i.splice(i.lastIndexOf(s),1),r(e,a,t);s.geometry=t,s.distanceSq=n}}else{if(0===n)return c[o]=!0,r(e,a,t);i.push(c[o]={feature:e,layer:a,geometry:t,distanceSq:n,callback:r})}},u=this.renderedTiles;let f;for(let r=0,i=u.length;!f&&r<i;++r){const i=u[r],c=l.getTileCoordExtent(i.wrappedTileCoord);if(!(0,g.kK)(c,d))continue;const T=(0,p.sq)(a),x=[i.executorGroups[T]],m=i.declutterExecutorGroups[T];m&&x.push(m),x.some((r=>{const i=r===m?t.declutterTree.all().map((e=>e.value)):null;for(let t=0,a=r.length;t<a;++t){const a=r[t];if(f=a.forEachFeatureAtCoordinate(e,o,s,n,h,i),f)return!0}}))}return f}getFeatures(e){return new Promise(((t,n)=>{const r=this.getLayer(),i=(0,p.sq)(r),o=r.getSource(),s=this.renderedProjection,a=s.getExtent(),l=this.renderedResolution,h=o.getTileGridForProjection(s),u=(0,c.nn)(this.renderedPixelToCoordinateTransform_,e.slice()),T=h.getTileCoordForCoordAndResolution(u,l);let x;for(let e=0,t=this.renderedTiles.length;e<t;++e)if(T.toString()===this.renderedTiles[e].tileCoord.toString()){if(x=this.renderedTiles[e],x.getState()===d.Z.LOADED){const e=h.getTileCoordExtent(x.tileCoord);o.getWrapX()&&s.canWrapX()&&!(0,g.r4)(a,e)&&(0,C.Cf)(u,s);break}x=void 0}if(!x||x.loadingSourceTiles>0)return void t([]);const m=h.getTileCoordExtent(x.wrappedTileCoord),R=(0,g.rL)(m),S=[(u[0]-R[0])/l,(R[1]-u[1])/l],_=x.getSourceTiles().reduce((function(e,t){return e.concat(t.getFeatures())}),[]);let I=x.hitDetectionImageData[i];if(!I){const e=(0,f.Pq)(h.getTileSize(h.getZForResolution(l,o.zDirection))),t=this.renderedRotation_,n=[this.getRenderTransform(h.getTileCoordCenter(x.wrappedTileCoord),l,0,y.UN,e[0]*y.UN,e[1]*y.UN,0)];I=(0,y.TU)(e,n,_,r.getStyleFunction(),h.getTileCoordExtent(x.wrappedTileCoord),x.getReplayState(r).renderedResolution,t),x.hitDetectionImageData[i]=I}t((0,y.ix)(S,_,I))}))}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e){const t=this.context,n=t.globalAlpha;t.globalAlpha=this.getLayer().getOpacity();const r=e.viewHints,i=!(r[m.Z.ANIMATING]||r[m.Z.INTERACTING]),o=this.renderedTiles;for(let t=0,n=o.length;t<n;++t){const n=o[t],r=n.declutterExecutorGroups[(0,p.sq)(this.getLayer())];if(r)for(let t=r.length-1;t>=0;--t)r[t].execute(this.context,1,this.getTileRenderTransform(n,e),e.viewState.rotation,i,void 0,e.declutterTree)}t.globalAlpha=n}getTileRenderTransform(e,t){const n=t.pixelRatio,r=t.viewState,i=r.center,o=r.resolution,s=r.rotation,a=t.size,l=Math.round(a[0]*n),d=Math.round(a[1]*n),h=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),g=e.tileCoord,u=h.getTileCoordExtent(e.wrappedTileCoord),p=h.getTileCoordExtent(g,this.tmpExtent)[0]-u[0];return(0,c.Jp)((0,c.bA)(this.inversePixelTransform.slice(),1/n,1/n),this.getRenderTransform(i,o,s,n,l,d,p))}postRender(e,t){const n=t.viewHints,r=!(n[m.Z.ANIMATING]||n[m.Z.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;const i=this.getLayer(),o=i.getRenderMode(),s=e.globalAlpha;e.globalAlpha=i.getOpacity();const a=_[o],l=t.viewState,d=l.rotation,c=i.getSource(),h=c.getTileGridForProjection(l.projection).getZForResolution(l.resolution,c.zDirection),u=this.renderedTiles,f=[],T=[];let x=!0;for(let n=u.length-1;n>=0;--n){const o=u[n];x=x&&!o.getReplayState(i).dirty;const s=o.executorGroups[(0,p.sq)(i)].filter((e=>e.hasExecutors(a)));if(0===s.length)continue;const l=this.getTileRenderTransform(o,t),c=o.tileCoord[0];let m=!1;const y=s[0].getClipCoords(l);if(y){for(let t=0,n=f.length;t<n;++t)if(h!==c&&c<T[t]){const n=f[t];(0,g.kK)([y[0],y[3],y[4],y[7]],[n[0],n[3],n[4],n[7]])&&(m||(e.save(),m=!0),e.beginPath(),e.moveTo(y[0],y[1]),e.lineTo(y[2],y[3]),e.lineTo(y[4],y[5]),e.lineTo(y[6],y[7]),e.moveTo(n[6],n[7]),e.lineTo(n[4],n[5]),e.lineTo(n[2],n[3]),e.lineTo(n[0],n[1]),e.clip())}f.push(y),T.push(c)}for(let t=0,n=s.length;t<n;++t){s[t].execute(e,1,l,d,r,a)}m&&e.restore()}e.globalAlpha=s,this.ready=x,super.postRender(e,t)}renderFeature(e,t,n,r,i){if(!n)return!1;let o=!1;if(Array.isArray(n))for(let s=0,a=n.length;s<a;++s)o=(0,R.Pn)(r,e,n[s],t,this.boundHandleStyleImageChange_,void 0,i)||o;else o=(0,R.Pn)(r,e,n,t,this.boundHandleStyleImageChange_,void 0,i);return o}tileImageNeedsRender_(e){const t=this.getLayer();if("vector"===t.getRenderMode())return!1;const n=e.getReplayState(t),r=t.getRevision(),i=e.wantedResolution;return n.renderedTileResolution!==i||n.renderedTileRevision!==r}renderTileImage_(e,t){const n=this.getLayer(),r=e.getReplayState(n),i=n.getRevision(),o=e.executorGroups[(0,p.sq)(n)];r.renderedTileRevision=i;const s=e.wrappedTileCoord,a=s[0],l=n.getSource();let d=t.pixelRatio;const h=t.viewState.projection,g=l.getTileGridForProjection(h),u=g.getResolution(e.tileCoord[0]),f=t.pixelRatio/e.wantedResolution*u,T=g.getResolution(a),x=e.getContext(n);d=Math.round(Math.max(d,f/d));const m=l.getTilePixelSize(a,d,h);x.canvas.width=m[0],x.canvas.height=m[1];const y=d/f;if(1!==y){const e=(0,c.mc)(this.tmpTransform_);(0,c.bA)(e,y,y),x.setTransform.apply(x,e)}const R=g.getTileCoordExtent(s,this.tmpExtent),C=f/T,_=(0,c.mc)(this.tmpTransform_);(0,c.bA)(_,C,-C),(0,c.Iu)(_,-R[0],-R[3]);for(let e=0,t=o.length;e<t;++e){o[e].execute(x,y,_,0,!0,S[n.getRenderMode()])}r.renderedTileResolution=e.wantedResolution}}},76234:(e,t,n)=>{n.d(t,{Pn:()=>d,Qz:()=>l,eR:()=>s,se:()=>a});var r=n(70553),i=n(74187);const o={Point:function(e,t,n,i,o){const s=n.getImage(),a=n.getText();let l;if(s){if(s.getImageState()!=r.Z.LOADED)return;let d=e;if(o){const r=s.getDeclutterMode();if("none"!==r)if(d=o,"obstacle"===r){const r=e.getBuilder(n.getZIndex(),"Image");r.setImageStyle(s,l),r.drawPoint(t,i)}else a&&a.getText()&&(l={})}const c=d.getBuilder(n.getZIndex(),"Image");c.setImageStyle(s,l),c.drawPoint(t,i)}if(a&&a.getText()){let r=e;o&&(r=o);const s=r.getBuilder(n.getZIndex(),"Text");s.setTextStyle(a,l),s.drawText(t,i)}},LineString:function(e,t,n,r,i){const o=n.getStroke();if(o){const i=e.getBuilder(n.getZIndex(),"LineString");i.setFillStrokeStyle(null,o),i.drawLineString(t,r)}const s=n.getText();if(s&&s.getText()){const o=(i||e).getBuilder(n.getZIndex(),"Text");o.setTextStyle(s),o.drawText(t,r)}},Polygon:function(e,t,n,r,i){const o=n.getFill(),s=n.getStroke();if(o||s){const i=e.getBuilder(n.getZIndex(),"Polygon");i.setFillStrokeStyle(o,s),i.drawPolygon(t,r)}const a=n.getText();if(a&&a.getText()){const o=(i||e).getBuilder(n.getZIndex(),"Text");o.setTextStyle(a),o.drawText(t,r)}},MultiPoint:function(e,t,n,i,o){const s=n.getImage(),a=n.getText();let l;if(s){if(s.getImageState()!=r.Z.LOADED)return;let d=e;if(o){const r=s.getDeclutterMode();if("none"!==r)if(d=o,"obstacle"===r){const r=e.getBuilder(n.getZIndex(),"Image");r.setImageStyle(s,l),r.drawMultiPoint(t,i)}else a&&a.getText()&&(l={})}const c=d.getBuilder(n.getZIndex(),"Image");c.setImageStyle(s,l),c.drawMultiPoint(t,i)}if(a&&a.getText()){let r=e;o&&(r=o);const s=r.getBuilder(n.getZIndex(),"Text");s.setTextStyle(a,l),s.drawText(t,i)}},MultiLineString:function(e,t,n,r,i){const o=n.getStroke();if(o){const i=e.getBuilder(n.getZIndex(),"LineString");i.setFillStrokeStyle(null,o),i.drawMultiLineString(t,r)}const s=n.getText();if(s&&s.getText()){const o=(i||e).getBuilder(n.getZIndex(),"Text");o.setTextStyle(s),o.drawText(t,r)}},MultiPolygon:function(e,t,n,r,i){const o=n.getFill(),s=n.getStroke();if(s||o){const i=e.getBuilder(n.getZIndex(),"Polygon");i.setFillStrokeStyle(o,s),i.drawMultiPolygon(t,r)}const a=n.getText();if(a&&a.getText()){const o=(i||e).getBuilder(n.getZIndex(),"Text");o.setTextStyle(a),o.drawText(t,r)}},GeometryCollection:function(e,t,n,r,i){const s=t.getGeometriesArray();let a,l;for(a=0,l=s.length;a<l;++a){(0,o[s[a].getType()])(e,s[a],n,r,i)}},Circle:function(e,t,n,r,i){const o=n.getFill(),s=n.getStroke();if(o||s){const i=e.getBuilder(n.getZIndex(),"Circle");i.setFillStrokeStyle(o,s),i.drawCircle(t,r)}const a=n.getText();if(a&&a.getText()){const o=(i||e).getBuilder(n.getZIndex(),"Text");o.setTextStyle(a),o.drawText(t,r)}}};function s(e,t){return parseInt((0,i.sq)(e),10)-parseInt((0,i.sq)(t),10)}function a(e,t){const n=l(e,t);return n*n}function l(e,t){return.5*e/t}function d(e,t,n,i,s,a,l){let d=!1;const h=n.getImage();if(h){const e=h.getImageState();e==r.Z.LOADED||e==r.Z.ERROR?h.unlistenImageChange(s):(e==r.Z.IDLE&&h.load(),h.listenImageChange(s),d=!0)}return function(e,t,n,r,i,s){const a=n.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(r,i);if(n.getRenderer())c(e,l,n,t);else{(0,o[l.getType()])(e,l,n,t,s)}}(e,t,n,i,a,l),d}function c(e,t,n,r){if("GeometryCollection"==t.getType()){const i=t.getGeometries();for(let t=0,o=i.length;t<o;++t)c(e,i[t],n,r);return}e.getBuilder(n.getZIndex(),"Default").drawCustom(t,r,n.getRenderer(),n.getHitDetectionRenderer())}}}]);