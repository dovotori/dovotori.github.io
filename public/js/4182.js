"use strict";(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[4182],{807(t,e,s){var i=s(85072),r=s.n(i),n=s(97825),o=s.n(n),a=s(77659),h=s.n(a),d=s(55056),u=s.n(d),l=s(10540),c=s.n(l),p=s(41113),g=s.n(p),f=s(55420),m={};m.styleTagTransform=g(),m.setAttributes=u(),m.insert=h().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=c();r()(f.A,m),f.A&&f.A.locals&&f.A.locals},10540(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},14182(t,e,s){s.r(e),s.d(e,{default:()=>g,destroy:()=>f});var i=s(99590);const r={slug:"particule3d",shaders:["/wgsl/fragment/f_particule_3d.js","/wgsl/vertex/v_particule_3d.js","/wgsl/skybox.js","/wgsl/postprocess.js","/wgsl/gaussianBlur.js","/wgsl/bright.js"],assets:["/gltf/suzanne.glb","/gltf/smoothSphere.glb","/gltf/cube.glb","/textures/pos-x.webp","/textures/neg-x.webp","/textures/pos-y.webp","/textures/neg-y.webp","/textures/pos-z.webp","/textures/neg-z.webp"],canvas:{width:1024,height:1024},useWebGpu:!0,controls:{fullscreen:{buttonId:"fullscreen-toggle-btn"}},camera:{position:{x:0,y:0,z:1500},target:{x:0,y:0,z:0},near:1,far:4e3,angle:60},particules:{workgroupSize:1,workgroupCount:10,size:200,speed:10},postprocess:{bright:{params:{threshold:[.2],glowThresholdKnee:[.3]},programName:"bright"},guassianBlurHorizontal:{params:{direction:[1,0],radius:[4]},programName:"gaussianBlur"},guassianBlurVertical:{params:{direction:[0,1],radius:[4]},programName:"gaussianBlur"}}};var n=s(71907),o=s(67269),a=s(67998),h=s(69194),d=s(44425),u=s(15142),l=s(20446);class c extends l.A{constructor(t,e){super(t,e);const{width:s,height:i}=e.canvas;this.canvasSize={width:s,height:i},this.camera=new n.A(e.camera),this.camera.perspective(s,i),this.model=new o.A,this.numParticules=this.config.particules.workgroupSize*this.config.particules.workgroupCount,this.textures=new h.A(1)}async setupAssets(t){const{programs:e}=await super.setupAssets(t),s=this.context.getDevice();this.textures.setup(s,this.context.getCanvasFormat(),this.canvasSize,"depth24plus"),this.postProcess=new d.w(this.context),this.postProcess.setup(e.postprocess.get()),Object.keys(this.config.postprocess).forEach((t=>{const s=this.config.postprocess[t];this.postProcess.addEffect(t,e[s.programName].get(),s.params)}));const i=s.createShaderModule({code:(r=this.config.particules.workgroupSize,`@group(0) @binding(0) var<storage, read> input: array<f32, 7>; // [nbParticles, xMin, xMax, yMin, yMax, zMin, zMax]\n@group(0) @binding(1) var<storage, read_write> velocity: array<vec4<f32>>;\n@group(0) @binding(2) var<storage, read_write> model: array<mat4x4<f32>>;\n\n// Generic rotation matrix from Euler angles (radians)\n// Order: Z (roll), Y (yaw), X (pitch)\nfn rotationXYZ(angles: vec3<f32>) -> mat4x4<f32> {\n  let cx = cos(angles.x);\n  let sx = sin(angles.x);\n  let cy = cos(angles.y);\n  let sy = sin(angles.y);\n  let cz = cos(angles.z);\n  let sz = sin(angles.z);\n\n  let rotX = mat4x4<f32>(\n    vec4<f32>(1.0, 0.0, 0.0, 0.0),\n    vec4<f32>(0.0, cx, -sx, 0.0),\n    vec4<f32>(0.0, sx, cx, 0.0),\n    vec4<f32>(0.0, 0.0, 0.0, 1.0)\n  );\n\n  let rotY = mat4x4<f32>(\n    vec4<f32>(cy, 0.0, sy, 0.0),\n    vec4<f32>(0.0, 1.0, 0.0, 0.0),\n    vec4<f32>(-sy, 0.0, cy, 0.0),\n    vec4<f32>(0.0, 0.0, 0.0, 1.0)\n  );\n\n  let rotZ = mat4x4<f32>(\n    vec4<f32>(cz, -sz, 0.0, 0.0),\n    vec4<f32>(sz, cz, 0.0, 0.0),\n    vec4<f32>(0.0, 0.0, 1.0, 0.0),\n    vec4<f32>(0.0, 0.0, 0.0, 1.0)\n  );\n\n  // Combined rotation: rotZ * rotY * rotX\n  return rotZ * rotY * rotX;\n}\n\n// Extracts Euler angles (YXZ order) from a 4x4 matrix\nfn extractEulerYXZ(m: mat4x4<f32>) -> vec3<f32> {\n    let m00 = m[0][0];\n    let m01 = m[0][1];\n    let m02 = m[0][2];\n    let m10 = m[1][0];\n    let m11 = m[1][1];\n    let m12 = m[1][2];\n    let m20 = m[2][0];\n    let m21 = m[2][1];\n    let m22 = m[2][2];\n\n    var y = asin(clamp(-m02, -1.0, 1.0));\n    var x: f32;\n    var z: f32;\n\n    if (abs(m02) < 0.99999) {\n        x = atan2(m12, m22);\n        z = atan2(m01, m00);\n    } else {\n        // Gimbal lock\n        x = atan2(-m21, m11);\n        z = 0.0;\n    }\n    return vec3<f32>(x, y, z);\n}\n\n@compute @workgroup_size(${r})\nfn main(\n    @builtin(global_invocation_id) GlobalInvocationID : vec3<u32>\n) {\n    var index = GlobalInvocationID.x;\n    if(index >= u32(input[0])){\n      return;\n    }\n\n    var xMin = input[1];\n    var xMax = input[2];\n    var yMin = input[3];\n    var yMax = input[4];\n    var zMin = input[5];\n    var zMax = input[6];\n    var pos = model[index][3];\n    var vel = velocity[index];\n    \n    // change x\n    pos.x += vel.x;\n    if(pos.x < xMin){\n        pos.x = xMin;\n        vel.x = -vel.x;\n    }else if(pos.x > xMax){\n        pos.x = xMax;\n        vel.x = -vel.x;\n    }\n    \n    // change y\n    pos.y += vel.y;\n    if(pos.y < yMin){\n        pos.y = yMin;\n        vel.y = -vel.y;\n    } else if(pos.y > yMax){\n        pos.y = yMax;\n        vel.y = -vel.y;\n    }\n    \n    // change z\n    pos.z += vel.z;\n    if(pos.z < zMin){\n        pos.z = zMin;\n        vel.z = -vel.z;\n    }else if(pos.z > zMax){\n        pos.z = zMax;\n        vel.z = -vel.z;\n    }\n    \n    // update velocity\n    velocity[index] = vel;\n    \n    // update position in model matrix\n    model[index][3] = pos;\n\n    // Apply constant rotation around Y axis\n    // let curRot = extractEulerYXZ(model[index]);\n    let rotMat = rotationXYZ(vec3<f32>(pos[0] * 0.00001, pos[1] * 0.00002, pos[2] * 0.00005)); // rotate around X and Z too\n    model[index] = model[index] * rotMat;\n}`),label:"Compute Shader"});var r;this.computePipeline=s.createComputePipeline({layout:"auto",label:"Compute Pipeline",compute:{module:i,entryPoint:"main"}});const n=Array.from(t.gltfs.smoothSphere.get("meshes").get(0).primitives)[0];this.indexCount=n.indexCount,this.vertexBuffer=s.createBuffer({label:"GPUBuffer store vertex",size:n.bufferVertex.byteLength,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),s.queue.writeBuffer(this.vertexBuffer,0,n.bufferVertex),this.indexBuffer=s.createBuffer({label:"GPUBuffer store index",size:n.bufferIndex.byteLength,usage:GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST}),s.queue.writeBuffer(this.indexBuffer,0,n.bufferIndex);const h=s.createBuffer({label:"GPUBuffer store MAX model matrix",size:4*Float32Array.BYTES_PER_ELEMENT*4*this.numParticules,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),l=s.createBuffer({label:"GPUBuffer store MAX velocity",size:4*Float32Array.BYTES_PER_ELEMENT*this.numParticules,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),c=s.createBuffer({label:"GPUBuffer store input vars",size:7*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),p=20*Float32Array.BYTES_PER_ELEMENT;this.uniformBuffer=s.createBuffer({label:"uniforms",size:p,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.uniformValues=new Float32Array(p/4),this.model.identity();const g=[t.textures["pos-x"],t.textures["neg-x"],t.textures["pos-y"],t.textures["neg-y"],t.textures["pos-z"],t.textures["neg-z"]],f=new a.b(this.context);f.createTextureFromSources(s,g,{flipY:!1});const m=new Float32Array([this.numParticules,-500,500,-250,250,-500,500]),x=new Float32Array(4*this.numParticules*Float32Array.BYTES_PER_ELEMENT),v=new Float32Array(this.numParticules*Float32Array.BYTES_PER_ELEMENT);for(let t=0;t<this.numParticules;t++){const e=1e3*Math.random()-500,s=500*Math.random()-250,i=1e3*Math.random()-500,r=new o.A;r.identity(),r.scale(this.config.particules.size/2*Math.random()+10),r.translate(e,s,i),x.set(r.get(),4*t*4),v[4*t+0]=(Math.random()-.5)*this.config.particules.speed,v[4*t+1]=(Math.random()-.5)*this.config.particules.speed,v[4*t+2]=(Math.random()-.5)*this.config.particules.speed,v[4*t+3]=1}s.queue.writeBuffer(l,0,v),s.queue.writeBuffer(h,0,x),s.queue.writeBuffer(c,0,m),this.renderPipeline=await s.createRenderPipelineAsync({label:"Render Pipeline",layout:"auto",vertex:{module:e.v_particule_3d.get(),entryPoint:"v_main",buffers:[{arrayStride:32,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x3"},{shaderLocation:2,offset:24,format:"float32x2"}]}]},fragment:{module:e.f_particule_3d.get(),entryPoint:"f_main",targets:Array.from({length:this.postProcess.getRenderTargetsCount()}).map((()=>({format:this.postProcess.getRenderTargetFormat()})))},multisample:{count:this.textures.getSampleCount()},primitive:{topology:"triangle-list",cullMode:"back"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:this.textures.getDepthFormat()}}),this.renderGroup=s.createBindGroup({label:"Group for renderPass",layout:this.renderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:h}},{binding:1,resource:{buffer:this.uniformBuffer}},{binding:2,resource:f.getSampler(s)},{binding:3,resource:f.getView()}]}),this.computeGroup=s.createBindGroup({label:"Group for computePass",layout:this.computePipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:c}},{binding:1,resource:{buffer:l}},{binding:2,resource:{buffer:h}}]}),this.computePassDescriptor={label:"Compute Pass description"},this.renderPassDescriptor={colorAttachments:Array.from({length:this.postProcess.getRenderTargetsCount()}).map((()=>({view:null,clearValue:{r:0,g:0,b:0,a:0},loadOp:"clear",storeOp:"store"}))),depthStencilAttachment:{view:null,depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"}},this.skybox=new u.X(this.context,this.textures.getSampleCount()),this.skybox.setup(e.skybox.get(),f,Array.from({length:this.postProcess.getRenderTargetsCount()}).map((()=>({format:this.postProcess.getRenderTargetFormat()}))),this.textures.getDepthFormat()),this.resize(this.canvasSize)}resize(t){this.canvasSize=t;const e=this.context.getDevice();this.textures.resize(e,this.context.getCanvasFormat(),t),this.postProcess.resize(e,this.canvasSize)}update(){super.update();const t=this.context.getDevice();this.model.identity(),this.model.rotate(this.time,0,1,0),this.model.multiply(this.camera.getViewProjection());const e=[...this.camera.getPosition(),0,...this.camera.getViewProjection().get()];this.uniformValues.set(e),t.queue.writeBuffer(this.uniformBuffer,0,this.uniformValues);const s=this.context.getCurrentTexture().createView(),i=this.textures.getDepthTextureView();Array.from({length:this.postProcess.getRenderTargetsCount()}).forEach(((t,e)=>{this.renderPassDescriptor.colorAttachments[e].view=this.postProcess.getRenderTargetView(e)})),this.renderPassDescriptor.depthStencilAttachment.view=i,this.camera.moveAroundCenter(.01*this.time,this.config.camera.position.z),this.skybox.updateCamera(this.camera);const r=this.postProcess.getPingPongTexture(!0).createView();this.postProcess.updateTexture(r),this.postProcess.updateEffectTextures(s)}render(){super.render();const t=this.context.getDevice(),e=t.createCommandEncoder({label:"Command Encoder for render and compute passes"}),s=e.beginComputePass(this.computePassDescriptor);s.setPipeline(this.computePipeline),s.setBindGroup(0,this.computeGroup),s.dispatchWorkgroups(this.config.particules.workgroupCount),s.end();const i=e.beginRenderPass(this.renderPassDescriptor);i.setPipeline(this.renderPipeline),i.setVertexBuffer(0,this.vertexBuffer),i.setIndexBuffer(this.indexBuffer,"uint16"),i.setBindGroup(0,this.renderGroup),i.drawIndexed(this.indexCount,this.numParticules),i.setPipeline(this.skybox.getPipeline()),i.setBindGroup(0,this.skybox.getBindGroup()),i.draw(3),i.end(),this.postProcess.render(e),this.postProcess.renderEffects(e),t.queue.submit([e.finish()])}destroy(){super.destroy()}}s(19513),s(807);let p=null;const g=async()=>{p=new i.A,await p.setup(c,r);const t=document.querySelector(`#${r.slug}`),e=p.getCanvas();e&&t&&t.appendChild(e)},f=()=>{p&&p.destroy&&p.destroy()}},15142(t,e,s){s.d(e,{X:()=>r});var i=s(67269);class r{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;this.context=t,this.pipeline=void 0,this.sampleCount=e}setup(t,e,s,i){const r=this.context.getDevice();this.pipeline=r.createRenderPipeline({label:"skybox no attributes",layout:"auto",vertex:{module:t,entryPoint:"v_main"},fragment:{module:t,entryPoint:"f_main",targets:s},depthStencil:{depthWriteEnabled:!0,depthCompare:"less-equal",format:i},multisample:{count:this.sampleCount}});const n=16*Float32Array.BYTES_PER_ELEMENT;this.uniformBuffer=r.createBuffer({label:"skybox uniforms",size:n,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.uniformValues=new Float32Array(n/4),this.viewDirectionProjectionInverseValue=this.uniformValues.subarray(0,16),this.bindGroup=r.createBindGroup({label:"bind group for skybox triangle",layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.uniformBuffer}},{binding:1,resource:e.getSampler(r)},{binding:2,resource:e.getView()}]})}updateCamera(t){const e=this.context.getDevice(),s=t.getViewProjection(),r=new i.A;r.setRaw(s.get()).inverse(),this.viewDirectionProjectionInverseValue.set(r.get()),e.queue.writeBuffer(this.uniformBuffer,0,this.uniformValues)}getPipeline(){return this.pipeline}getBindGroup(){return this.bindGroup}}},19513(t,e,s){var i=s(85072),r=s.n(i),n=s(97825),o=s.n(n),a=s(77659),h=s.n(a),d=s(55056),u=s.n(d),l=s(10540),c=s.n(l),p=s(41113),g=s.n(p),f=s(77314),m={};m.styleTagTransform=g(),m.setAttributes=u(),m.insert=h().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=c();r()(f.A,m),f.A&&f.A.locals&&f.A.locals},20446(t,e,s){s.d(e,{A:()=>r});var i=s(29794);class r{constructor(t,e){this.context=t,this.config=e,this.time=0}async setupAssets(t){const e=this.context.getDevice();return{programs:Object.keys(t.shaders).reduce(((s,r)=>{const n=new i.A;return n.setup(e,r,t.shaders[r]),s[r]=n,s}),{})}}destroy(){}resize(){}update(){this.time++}render(){}}},23876(t,e,s){s.d(e,{A:()=>n});var i=s(67269),r=s(54096);const n=class{constructor(t){if(this.position=new r.A(t.position.x,t.position.y,t.position.z),this.target=new r.A(0,0,0),this.view=new i.A,t.ortho){const{left:e,right:s,bottom:r,top:n}=t.ortho,{near:o,far:a}=t;this.ortho=new i.A,this.ortho.ortho(e,s,r,n,o,a)}}lookAt(){this.view.identity().lookAt(this.position.getX(),this.position.getY(),this.position.getZ(),this.target.getX(),this.target.getY(),this.target.getZ(),0,1,0)}getView(){return this.view}getPosition(){return this.position.get()}getPositionVec3(){return this.position}getTarget(){return this.target.get()}getModel(){return this.repere.getModel()}getOrtho(){return this.ortho}addToPosition(t,e,s){this.position.addXYZ(t,e,s),this.lookAt()}setPosition(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=null!==t?t:this.position.getX(),r=null!==e?e:this.position.getY(),n=null!==s?s:this.position.getZ();this.position.set(i,r,n),this.lookAt()}setTarget(t,e,s){this.target.set(t,e,s)}setTargetVec3(t){this.target.equal(t)}}},29794(t,e,s){s.d(e,{A:()=>r});var i=s(54705);const r=class{constructor(){(0,i.A)(this,"get",(()=>this.program)),this.program=null}setup(t,e,s){this.program=t.createShaderModule({label:e,code:s})}}},31601(t){t.exports=function(t){return t[1]}},41113(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},44425(t,e,s){s.d(e,{w:()=>r});var i=s(54705);class r{constructor(t){(0,i.A)(this,"resize",((t,e)=>{this.canvasSize=e,this.renderTargets?.forEach((t=>{t.destroy()})),this.setupRenderTextures(t,e),this.pingTarget?.destroy(),this.pongTarget?.destroy(),this.setupPingPongTargets(t,e);let s=0;for(const[t,e]of this.effects)this.setupEffectSource(t,this.getPingPongTexture(s%2==0).createView()),s++})),this.context=t,this.pipeline=void 0,this.renderTargetFormat=navigator.gpu.getPreferredCanvasFormat(),this.presentationFormat=navigator.gpu.getPreferredCanvasFormat(),this.sampleCount=1,this.renderTargetsCount=3,this.effectRenderGroups=new Map,this.canvasSize={width:1,height:1},this.effects=new Map}setup(t){const e=this.context.getDevice();this.pipeline=e.createRenderPipeline({label:"post process no attributes",layout:"auto",vertex:{module:t},fragment:{module:t,targets:[{format:this.renderTargetFormat}]},multisample:{count:this.sampleCount}}),this.sampler=e.createSampler({minFilter:"linear",magFilter:"linear"}),this.renderPassDescriptor={label:"post process render pass",colorAttachments:[{loadOp:"clear",storeOp:"store"}]}}setupRenderTextures(t,e){this.renderTargets=Array.from({length:this.renderTargetsCount}).map(((s,i)=>t.createTexture({label:`post process render target ${i}`,size:e,format:this.renderTargetFormat,sampleCount:this.sampleCount,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}))),this.renderTargetViews=this.renderTargets.map((t=>t.createView())),this.bindGroup=t.createBindGroup({label:"post process bind group",layout:this.pipeline.getBindGroupLayout(0),entries:[{binding:0,resource:this.sampler},...this.renderTargets.map(((t,e)=>({binding:e+1,resource:this.renderTargetViews[e]})))]})}setupPingPongTargets(t,e){this.pingTarget=t.createTexture({label:"ping render target",size:e,format:this.renderTargetFormat,sampleCount:this.sampleCount,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),this.pongTarget=t.createTexture({label:"pong render target",size:e,format:this.renderTargetFormat,sampleCount:this.sampleCount,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING})}addEffect(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.context.getDevice();this.effects.set(t,{pipeline:i.createRenderPipeline({label:`post process ${t} no attributes`,layout:"auto",vertex:{module:e},fragment:{module:e,targets:[{format:this.presentationFormat}]},multisample:{count:this.sampleCount}}),passDescriptor:{label:`post process ${t}`,colorAttachments:[{loadOp:"clear",storeOp:"store"}]},params:s})}setupEffectSource(t,e){const s=this.context.getDevice();let i={};const r=[{binding:0,resource:this.sampler},{binding:1,resource:e}];switch(t){case"guassianBlurVertical":case"guassianBlurHorizontal":{const t=[1/this.canvasSize.width,1/this.canvasSize.height],e=s.createBuffer({label:"radius buffer",size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),n=s.createBuffer({label:"direction buffer",size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),o=s.createBuffer({label:"texel size buffer",size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});s.queue.writeBuffer(o,0,new Float32Array(t)),r.push({binding:2,resource:{buffer:n}},{binding:3,resource:{buffer:o}},{binding:4,resource:{buffer:e}}),i={radius:e,direction:n};break}case"bright":{const t=s.createBuffer({label:"threshold buffer",size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),e=s.createBuffer({label:"glow threshold knee buffer",size:8,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});r.push({binding:2,resource:{buffer:t}},{binding:3,resource:{buffer:e}}),i={threshold:t,glowThresholdKnee:e};break}}this.effects.set(t,{...this.effects.get(t),bindGroup:s.createBindGroup({label:`Group for ${t}`,layout:this.effects.get(t).pipeline.getBindGroupLayout(0),entries:r}),buffers:i})}updateTexture(t){this.renderPassDescriptor.colorAttachments[0].view=t}render(t){const e=t.beginRenderPass(this.renderPassDescriptor);e.setPipeline(this.pipeline),e.setBindGroup(0,this.bindGroup),e.draw(3),e.end()}updateEffectTextures(t){let e=0;for(const[s,i]of this.effects){const i=e===this.effects.size-1?t:this.getPingPongTexture(e%2!=0).createView();this.updateEffectTexture(s,i),e++}}updateEffectTexture(t,e){const s=this.effects.get(t);s&&(s.passDescriptor.colorAttachments[0].view=e)}renderEffects(t){for(const[e,s]of this.effects)this.applyEffect(e),this.renderEffect(e,t)}applyEffect(t){const e=this.effects.get(t);if(!e)return;const s=this.context.getDevice();for(const t of Object.keys(e.params))s.queue.writeBuffer(e.buffers[t],0,new Float32Array(e.params[t]))}renderEffect(t,e){const s=this.effects.get(t);if(!s)return;const i=e.beginRenderPass(s.passDescriptor);i.setPipeline(s.pipeline),i.setBindGroup(0,s.bindGroup),i.draw(3),i.end()}getPipeline(){return this.pipeline}getRenderTargetView(t){return this.renderTargetViews[t]}getRenderTargetFormat(){return this.renderTargetFormat}getRenderTargetsCount(){return this.renderTargetsCount}getPingPongTexture(t){return t?this.pingTarget:this.pongTarget}}},50416(t,e,s){s.d(e,{A:()=>n});var i=s(54096);class r{constructor(){this.d=new Array(9),this.sauvegardePrecedente=[],this.empilement=0,this.init()}init(){for(let t=0;t<9;t+=1)this.d[t]=0;return this.sauvegardePrecedente=[],this.empilement=0,this}get(){return this.d}set(t,e,s,i,r,n,o,a,h){return this.d[0]=t,this.d[1]=e,this.d[2]=s,this.d[3]=i,this.d[4]=r,this.d[5]=n,this.d[6]=o,this.d[7]=a,this.d[8]=h,this}setFromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}setOneValue(t){for(let e=0;e<9;e+=1)this.d[e]=t[e]}multiply(t){const e=new r;for(let s=0;s<3;s+=1)for(let i=0;i<3;i+=1)for(let r=0;r<3;r+=1)e.d[3*i+s]+=this.d[3*i+r]*t.d[3*r+s];for(let t=0;t<9;t+=1)this.d[t]=e.d[t];return this}equal(t){for(let e=0;e<9;e+=1)this.d[e]=t.d[e],this.sauvegardePrecedente[e]=t.sauvegardePrecedente[e];return this}push(){this.empilement+=1;let t=0;for(let e=9*(this.empilement-1);e<9*this.empilement;e+=1)this.sauvegardePrecedente[e]=this.d[t],t+=1;return this}pop(){if(this.empilement>0){let t=0;for(let e=9*(this.empilement-1);e<9*this.empilement;e+=1)this.d[t]=this.sauvegardePrecedente[e],this.sauvegardePrecedente[e]=null,t+=1;this.empilement-=1}return this}identity(){return this.init(),this.d[0]=1,this.d[4]=1,this.d[8]=1,this}transpose(){return this.setFromArray(r.transpose(this.d))}static transpose(t){const e=new Float32Array(9);let s=0;for(let i=0;i<3;i+=1)for(let r=0;r<3;r+=1)e[s]=t[3*r+i],s+=1;return e}inverse(){const t=new Array(9),e=this.getDeterminant();if(0===e)return this.identity(),null;t[0]=this.d[4]*this.d[8]-this.d[5]*this.d[7]/e,t[1]=-(this.d[1]*this.d[8]-this.d[7]*this.d[2])/e,t[2]=this.d[1]*this.d[5]-this.d[4]*this.d[2]/e,t[3]=-(this.d[3]*this.d[8]-this.d[5]*this.d[6])/e,t[4]=this.d[0]*this.d[8]-this.d[6]*this.d[2]/e,t[5]=-(this.d[0]*this.d[5]-this.d[3]*this.d[2])/e,t[6]=this.d[3]*this.d[7]-this.d[6]*this.d[4]/e,t[7]=-(this.d[0]*this.d[7]-this.d[6]*this.d[1])/e,t[8]=this.d[0]*this.d[4]-this.d[1]*this.d[3]/e;for(let e=0;e<9;e+=1)this.d[e]=t[e];return this}getDeterminant(){return this.d[0]*(this.d[4]*this.d[8]-this.d[7]*this.d[5])+this.d[1]*(this.d[5]*this.d[6]-this.d[3]*this.d[8])+this.d[2]*(this.d[3]*this.d[7]-this.d[6]*this.d[4])}rotate(t,e,s,n){const o=new r,a=t*(Math.PI/180),h=new i.A(e,s,n);return h.normalise(),o.d[0]=h.x*h.x*(1-Math.cos(a))+Math.cos(a),o.d[1]=h.x*h.y*(1-Math.cos(a))-h.z*Math.sin(a),o.d[2]=h.x*h.z*(1-Math.cos(a))+h.y*Math.sin(a),o.d[3]=h.x*h.y*(1-Math.cos(a))+h.z*Math.sin(a),o.d[4]=h.y*h.y*(1-Math.cos(a))+Math.cos(a),o.d[5]=h.y*h.z*(1-Math.cos(a))-h.x*Math.sin(a),o.d[6]=h.x*h.z*(1-Math.cos(a))-h.y*Math.sin(a),o.d[7]=h.y*h.z*(1-Math.cos(a))+h.x*Math.sin(a),o.d[8]=h.z*h.z*(1-Math.cos(a))+Math.cos(a),this.multiply(o),this}}const n=r},54096(t,e,s){s.d(e,{A:()=>n});var i=s(4689);class r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.d=[0,0,0],this.set(t,e,s)}normalise(){const t=this.length();return 0!==t&&(this.d[0]/=t,this.d[1]/=t,this.d[2]/=t),this}get(){return this.d}getX(){return this.d[0]}getY(){return this.d[1]}getZ(){return this.d[2]}set(t,e,s){return null!==t&&(this.d[0]=t),null!==e?this.d[1]=e:null!==t&&(this.d[1]=t),null!==s?this.d[2]=s:null!==t&&(this.d[2]=t),this}setX(t){this.d[0]=t}setY(t){this.d[1]=t}setZ(t){this.d[2]=t}addXYZ(t,e,s){return this.d[0]+=t,this.d[1]+=e,this.d[2]+=s,this}addX(t){return this.d[0]+=t,this}addY(t){return this.d[1]+=t,this}addZ(t){return this.d[2]+=t,this}multiplyX(t){return this.d[0]*=t,this}multiplyY(t){return this.d[1]*=t,this}multiplyZ(t){return this.d[2]*=t,this}limiter(t){const e=this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2];if(e>t*t&&e>0){const s=t/Math.sqrt(e);this.d[0]*=s,this.d[1]*=s,this.d[2]*=s}return this}cross(t){return new r(this.d[1]*t.d[2]-this.d[2]*t.d[1],this.d[2]*t.d[0]-this.d[0]*t.d[2],this.d[0]*t.d[1]-this.d[1]*t.d[0])}dot(t){return this.d[0]*t.d[0]+this.d[1]*t.d[1]+this.d[2]*t.d[2]}length(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2])}directionVers(t){return this.d[0]=t.d[0]-this.d[0],this.d[1]=t.d[1]-this.d[1],this.d[2]=t.d[2]-this.d[2],this}equal(t){return this.d=[t.d[0],t.d[1],t.d[2]],this}add(t){return this.d[0]+=t.d[0],this.d[1]+=t.d[1],this.d[2]+=t.d[2],this}addNumber(t){return this.d[0]+=t,this.d[1]+=t,this.d[2]+=t,this}minus(t){return this.d[0]-=t.d[0],this.d[1]-=t.d[1],this.d[2]-=t.d[2],this}minusNumber(t){return this.d[0]-=t,this.d[1]-=t,this.d[2]-=t,this}multiplyNumber(t){return this.d[0]*=t,this.d[1]*=t,this.d[2]*=t,this}multiplyMatrix(t){const e=t.d?t:{d:t},s=this.d[0],i=this.d[1],r=this.d[2],n=e.d[0]*s+e.d[4]*i+e.d[8]*r+e.d[12],o=e.d[1]*s+e.d[5]*i+e.d[9]*r+e.d[13],a=e.d[2]*s+e.d[6]*i+e.d[10]*r+e.d[14],h=e.d[3]*s+e.d[7]*i+e.d[11]*r+e.d[15];return 0!==h&&1!==h?this.set(n/h,o/h,a/h):this.set(n,o,a),this}multiply(t){return this.d[0]*=t.d[0],this.d[1]*=t.d[1],this.d[2]*=t.d[2],this}divideNumber(t){return this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this}divide(t){return this.d[0]/=t.d[0],this.d[1]/=t.d[1],this.d[2]/=t.d[2],this}fract(){return this.d[0]=(0,i.jc)(this.d[0]),this.d[1]=(0,i.jc)(this.d[1]),this.d[2]=(0,i.jc)(this.d[2]),this}distance(t){return Math.sqrt((t.d[0]-this.d[0])*(t.d[0]-this.d[0])+(t.d[1]-this.d[1])*(t.d[1]-this.d[1])+(t.d[2]-this.d[2])*(t.d[2]-this.d[2]))}angleDegree(t){const e=this.dot(t)/(this.length()*t.length());return 180*Math.acos(e)/Math.PI*-(0,i.FN)(this.d[0]*t.d[1]+this.d[1]*t.d[0])}computeNormal(t,e,s){const i=new r,n=new r,o=new r;return n.equal(t.minus(this)),o.equal(e.minus(this)),s?i.equal(o.cross(n)):i.equal(n.cross(o)),i.normalise(),i}static getBarycentre(t,e,s,i){const r=(e.d[2]-s.d[2])*(t.d[0]-s.d[0])+(s.d[0]-e.d[0])*(t.d[2]-s.d[2]),n=((e.d[2]-s.d[2])*(i[0]-s.d[0])+(s.d[0]-e.d[0])*(i[1]-s.d[2]))/r,o=((s.d[2]-t.d[2])*(i[0]-s.d[0])+(t.d[0]-s.d[0])*(i[1]-s.d[2]))/r,a=1-n-o;return n*t.d[1]+o*e.d[1]+a*s.d[1]}static lerp(t,e,s){const i=t.d[0],n=t.d[1],o=t.d[2],a=i+s*(e.d[0]-i),h=n+s*(e.d[1]-n),d=o+s*(e.d[2]-o);return new r(a,h,d)}}const n=r},55056(t,e,s){t.exports=function(t){var e=s.nc;e&&t.setAttribute("nonce",e)}},55420(t,e,s){s.d(e,{A:()=>a});var i=s(31601),r=s.n(i),n=s(76314),o=s.n(n)()(r());o.push([t.id,"#fullscreen-toggle-btn {\n\tborder-radius: 0;\n\tmargin: 0;\n\tpadding: 4px;\n\tborder: solid 2px var(--project-color);\n}\n\n#fullscreen-toggle-btn:hover svg,\n#fullscreen-toggle-btn:active svg {\n\ttransform: scale(0.8);\n\topacity: 1;\n}\n\n#fullscreen-toggle-btn svg {\n\tdisplay: block;\n\twidth: 2em;\n\tfill: #fff;\n\topacity: 0.8;\n\ttransform: scale(0.6);\n\ttransition:\n\t\topacity 300ms ease-out,\n\t\ttransform 300ms ease-out;\n}\n\n[data-fullscreen] {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n",""]);const a=o},67269(t,e,s){s.d(e,{A:()=>a});var i=s(87750),r=s(50416),n=s(54096);class o{constructor(){this.d=new Array(16),this.sauvegardePrecedente=[],this.empilement=0,this.init()}init(){return this.reset(),this.sauvegardePrecedente=[],this.empilement=0,this}reset(){for(let t=0;t<16;t+=1)this.d[t]=0;return this}get(){return this.d}setRaw(t){return this.d=t,this}set(t,e,s,i,r,n,o,a,h,d,u,l,c,p,g,f){return this.d[0]=t,this.d[1]=e,this.d[2]=s,this.d[3]=i,this.d[4]=r,this.d[5]=n,this.d[6]=o,this.d[7]=a,this.d[8]=h,this.d[9]=d,this.d[10]=u,this.d[11]=l,this.d[12]=c,this.d[13]=p,this.d[14]=g,this.d[15]=f,this}setFromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}getMatrice3x3(){const t=new r.A;return t.set(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),t}multiplyArray(t){const e=new o;return e.setFromArray(t),this.multiply(e)}multiply(t){const e=new o;for(let s=0;s<4;s+=1)for(let i=0;i<4;i+=1)for(let r=0;r<4;r+=1)e.d[4*i+s]+=this.d[4*i+r]*t.d[4*r+s];return this.d=e.d,this}equal(t){for(let e=0;e<16;e+=1)this.d[e]=t.d[e],this.sauvegardePrecedente[e]=t.sauvegardePrecedente[e];return this}push(){this.empilement+=1;let t=0;for(let e=16*(this.empilement-1);e<16*this.empilement;e+=1)this.sauvegardePrecedente[e]=this.d[t],t+=1;return this}pop(){if(this.empilement>0){let t=0;for(let e=16*(this.empilement-1);e<16*this.empilement;e+=1)this.d[t]=this.sauvegardePrecedente[e],this.sauvegardePrecedente[e]=null,t+=1;this.empilement-=1}return this}translate(t,e,s){const i=new o;return i.identity(),i.d[12]=t,i.d[13]=e,i.d[14]=s,this.multiply(i),this}scale(t,e,s){const i=new o;return i.d[0]=t,i.d[5]=void 0===e?t:e,i.d[10]=void 0===s?t:s,i.d[15]=1,this.multiply(i),this}resetScale(){return this.d[0]=1,this.d[5]=1,this.d[10]=1,this}resetTranslate(){return this.d[12]=0,this.d[13]=0,this.d[14]=0,this}setTranslation(t,e,s){return Array.isArray(t)?(this.d[12]=t[0],this.d[13]=t[1],this.d[14]=t[2],this):t&&"function"==typeof t.getX?(this.d[12]=t.getX(),this.d[13]=t.getY(),this.d[14]=t.getZ(),this):(this.d[12]=void 0!==t?t:this.d[12],this.d[13]=void 0!==e?e:this.d[13],this.d[14]=void 0!==s?s:this.d[14],this)}rotate(t,e,s,i){const r=new o,a=t*(Math.PI/180),h=new n.A(e,s,i);return h.normalise(),r.d[0]=h.d[0]*h.d[0]*(1-Math.cos(a))+Math.cos(a),r.d[1]=h.d[0]*h.d[1]*(1-Math.cos(a))-h.d[2]*Math.sin(a),r.d[2]=h.d[0]*h.d[2]*(1-Math.cos(a))+h.d[1]*Math.sin(a),r.d[4]=h.d[0]*h.d[1]*(1-Math.cos(a))+h.d[2]*Math.sin(a),r.d[5]=h.d[1]*h.d[1]*(1-Math.cos(a))+Math.cos(a),r.d[6]=h.d[1]*h.d[2]*(1-Math.cos(a))-h.d[0]*Math.sin(a),r.d[8]=h.d[0]*h.d[2]*(1-Math.cos(a))-h.d[1]*Math.sin(a),r.d[9]=h.d[1]*h.d[2]*(1-Math.cos(a))+h.d[0]*Math.sin(a),r.d[10]=h.d[2]*h.d[2]*(1-Math.cos(a))+Math.cos(a),r.d[15]=1,this.multiply(r),this}identity(){return this.init(),this.d[0]=1,this.d[5]=1,this.d[10]=1,this.d[15]=1,this}perspective(t,e,s,i){const r=t*(Math.PI/180),n=1/Math.tan(r/2),o=1/(s-i);return this.set(n/e,0,0,0,0,n,0,0,0,0,(s+i)*o,-1,0,0,s*i*o*2,0),this}ortho(t,e,s,i,r,n){return this.set(2/(e-t),0,0,0,0,2/(i-s),0,0,0,0,-2/(n-r),0,-(e+t)/(e-t),-(i+s)/(i-s),-(n+r)/(n-r),1),this}lookAt(t,e,s,r,n,o,a,h,d){let u,l,c,p,g,f,m,x,v,y;const T=t,b=e,P=s,w=a,A=h,M=d,C=r,E=n,B=o;return Math.abs(T-C)<i.p&&Math.abs(b-E)<i.p&&Math.abs(P-B)<i.p?(this.identity(),this):(m=T-C,x=b-E,v=P-B,y=1/Math.sqrt(m*m+x*x+v*v),m*=y,x*=y,v*=y,u=A*v-M*x,l=M*m-w*v,c=w*x-A*m,y=Math.sqrt(u*u+l*l+c*c),y?(y=1/y,u*=y,l*=y,c*=y):(u=0,l=0,c=0),p=x*c-v*l,g=v*u-m*c,f=m*l-x*u,y=Math.sqrt(p*p+g*g+f*f),y?(y=1/y,p*=y,g*=y,f*=y):(p=0,g=0,f=0),this.set(u,p,m,0,l,g,x,0,c,f,v,0,-(u*T+l*b+c*P),-(p*T+g*b+f*P),-(m*T+x*b+v*P),1),this)}transpose(){return this.setFromArray(o.transpose(this.d))}static transpose(t){const e=new Float32Array(16);let s=0;for(let i=0;i<4;i+=1)for(let r=0;r<4;r+=1)e[s]=t[4*r+i],s+=1;return e}inverse(){const t=o.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),e=o.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),s=o.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),i=o.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),r=this.d[0]*t-this.d[1]*e+this.d[2]*s-this.d[3]*i,n=o.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),a=o.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),h=o.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),d=o.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),u=o.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[13],this.d[14],this.d[15]),l=o.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[12],this.d[14],this.d[15]),c=o.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[12],this.d[13],this.d[15]),p=o.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[12],this.d[13],this.d[14]),g=o.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11]),f=o.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11]),m=o.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11]),x=o.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),v=1/r;return this.d[0]=v*t,this.d[1]=-v*n,this.d[2]=v*u,this.d[3]=-v*g,this.d[4]=-v*e,this.d[5]=v*a,this.d[6]=-v*l,this.d[7]=v*f,this.d[8]=v*s,this.d[9]=-v*h,this.d[10]=v*c,this.d[11]=-v*m,this.d[12]=-v*i,this.d[13]=v*d,this.d[14]=-v*p,this.d[15]=v*x,this}getDeterminant(){return this.d[0]*o.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15])-this.d[1]*o.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15])+this.d[2]*o.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15])-this.d[3]*o.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14])}static getCofacteur(t,e,s,i,r,n,o,a,h){return t*(r*h-n*a)-e*(i*h-n*o)+s*(i*a-r*o)}}const a=o},67998(t,e,s){s.d(e,{b:()=>i});class i{constructor(t){this.context=t,this.texture=null}createTextureFromSources(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e[0];this.texture=t.createTexture({format:"rgba8unorm",mipLevelCount:s.mips?this.numMipLevels(i.width,i.height):1,size:[i.width,i.height,e.length],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT}),this.copySourcesToTexture(t,this.texture,e,s)}numMipLevels(){const t=Math.max(...arguments);return 1+Math.log2(t)|0}copySourcesToTexture(t,e,s){let{flipY:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};s.forEach(((s,r)=>{t.queue.copyExternalImageToTexture({source:s,flipY:i},{texture:e,origin:[0,0,r]},{width:s.width,height:s.height})}))}get(){return this.texture}getSampler(t){return t.createSampler({magFilter:"linear",minFilter:"linear",mipmapFilter:"linear"})}getView(){return this.texture.createView({dimension:"cube"})}createOne(t,e){const s=e[arguments.length>2&&void 0!==arguments[2]?arguments[2]:0],i=t.createTexture({size:[s.width,s.height],format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});t.queue.copyExternalImageToTexture({source:s,flipY:!1},{texture:i,origin:[0,0,0]},{width:s.width,height:s.height}),this.texture=i}getViewOne(){return this.texture.createView()}}},69194(t,e,s){s.d(e,{A:()=>r});var i=s(54705);const r=class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;(0,i.A)(this,"resize",((t,e,s)=>{this.renderTarget.destroy(),this.depthTexture.destroy(),this.setup(t,e,s,this.depthTextureFormat)})),(0,i.A)(this,"setupRender",((t,e,s)=>{let{width:i,height:r}=s;this.renderTarget=t.createTexture({size:[i,r],sampleCount:this.sampleCount,format:e,usage:GPUTextureUsage.RENDER_ATTACHMENT}),this.renderTargetView=this.renderTarget.createView({label:"SceneTextureView"})})),(0,i.A)(this,"setupDepth",((t,e,s)=>{let{width:i,height:r}=s;this.depthTexture=t.createTexture({size:[i,r],sampleCount:this.sampleCount,format:e,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),this.depthTextureView=this.depthTexture.createView({label:"SceneDepthTextureView"})})),(0,i.A)(this,"getRenderTargetView",(()=>this.renderTargetView)),(0,i.A)(this,"getDepthTextureView",(()=>this.depthTextureView)),(0,i.A)(this,"getDepthFormat",(()=>this.depthTextureFormat)),(0,i.A)(this,"getSampleCount",(()=>this.sampleCount)),this.renderTarget=null,this.renderTargetView=null,this.depthTexture=null,this.depthTextureView=null,this.sampleCount=t,this.depthTextureFormat="depth32float"}setup(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"depth32float";this.depthTextureFormat=i,this.setupRender(t,e,s),this.setupDepth(t,i,s)}}},71907(t,e,s){s.d(e,{A:()=>o});var i=s(67269),r=s(54096),n=s(23876);const o=class extends n.A{constructor(t){super(t),this.matIdentity=new i.A,this.projection=new i.A,this.projection.identity(),this.near=t.near??1,this.far=t.far??100,this.angle=t.angle??50,this.matIdentity.identity(),this.lookAt()}update(){this.lookAt()}perspective(t,e){this.projection.identity().perspective(this.angle,t/e,this.near,this.far)}moveAroundCenter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.position.set(Math.cos(t)*e,Math.sin(t)*(2+e),Math.sin(t)*e),this.lookAt()}move(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.position.set(this.position.getX(),Math.sin(.02*t)*(2+e),this.position.getZ()),this.lookAt()}setNearFar(t,e){this.near=t,this.far=e}setAngle(t){this.angle=t}getModeProjection(){return this.ortho??this.projection}getProjection(){return this.projection}getViewProjection(){const t=new i.A;return t.identity(),t.multiply(this.getView()),t.multiply(this.getProjection()),t}getInverseViewProjection(){return this.getViewProjection().inverse()}unproject(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;const i=new r.A(t,e,s),n=this.getInverseViewProjection();return i.multiplyMatrix(n)}getRayFromNDC(t,e){const s=this.getInverseViewProjection(),i=new r.A(t,e,0).multiplyMatrix(s),n=new r.A(t,e,1).multiplyMatrix(s);return{origin:i,dir:new r.A(n.getX(),n.getY(),n.getZ()).minus(i).normalise()}}worldToNDC(t){const e=this.getViewProjection();return new r.A(t.getX(),t.getY(),t.getZ()).multiplyMatrix(e)}worldToRelativeScreen(t,e){const s=this.worldToNDC(t);return{x:(.5*s.getX()+.5)*e.width,y:(1-(.5*s.getY()+.5))*e.height}}getIdentity(){return this.matIdentity}getNearFar(){return[this.near,this.far]}getNear(){return this.near}getFar(){return this.far}getAngle(){return this.angle}getReflectViewMatrix(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const e=2*(this.position.getY()-t);return(new i.A).identity().lookAt(this.position.getX(),this.position.getY()-e,this.position.getZ(),this.target.getX(),this.target.getY(),this.target.getZ(),0,1,0)}}},76314(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var s="",i=void 0!==e[5];return e[4]&&(s+="@supports (".concat(e[4],") {")),e[2]&&(s+="@media ".concat(e[2]," {")),i&&(s+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),s+=t(e),i&&(s+="}"),e[2]&&(s+="}"),e[4]&&(s+="}"),s})).join("")},e.i=function(t,s,i,r,n){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var d=0;d<t.length;d++){var u=[].concat(t[d]);i&&o[u[0]]||(void 0!==n&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=n),s&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=s):u[2]=s),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},77314(t,e,s){s.d(e,{A:()=>a});var i=s(31601),r=s.n(i),n=s(76314),o=s.n(n)()(r());o.push([t.id,'#controls {\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tdisplay: flex;\n\talign-items: stretch;\n\tz-index: 10;\n\tbackground-color: rgba(34, 34, 34, 0.8);\n\tmargin: 0.5em;\n\tpadding: 0.5em;\n}\n\n#controls div {\n\tdisplay: flex;\n\talign-items: stretch;\n}\n\n#controls div input[type="range"] {\n\twidth: 100%;\n}\n\n#controls div input[type="checkbox"] {\n\tmargin-right: 0.5em;\n}\n\n#controls label {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n#controls label,\n#controls a {\n\tfont-size: 0.8em;\n}\n\n@media (max-width: 570px) {\n\t#controls.responsive {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t\tmargin: 0;\n\t}\n}\n',""]);const a=o},77659(t){var e={};t.exports=function(t,s){var i=function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(t){s=null}e[t]=s}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},85072(t){var e=[];function s(t){for(var s=-1,i=0;i<e.length;i++)if(e[i].identifier===t){s=i;break}return s}function i(t,i){for(var n={},o=[],a=0;a<t.length;a++){var h=t[a],d=i.base?h[0]+i.base:h[0],u=n[d]||0,l="".concat(d," ").concat(u);n[d]=u+1;var c=s(l),p={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==c)e[c].references++,e[c].updater(p);else{var g=r(p,i);i.byIndex=a,e.splice(a,0,{identifier:l,updater:g,references:1})}o.push(l)}return o}function r(t,e){var s=e.domAPI(e);s.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;s.update(t=e)}else s.remove()}}t.exports=function(t,r){var n=i(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<n.length;o++){var a=s(n[o]);e[a].references--}for(var h=i(t,r),d=0;d<n.length;d++){var u=s(n[d]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}n=h}}},87750(t,e,s){s.d(e,{p:()=>i});const i=1e-6},97825(t){t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(s){!function(t,e,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var r=void 0!==s.layer;r&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,r&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var n=s.sourceMap;n&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,s)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}}]);