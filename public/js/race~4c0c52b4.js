(window.webpackJsonp=window.webpackJsonp||[]).push([[149,174],{117:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(25),h=function(){function t(){n()(this,t),this.d=new Array(9),this.sauvegardePrecedente=[],this.empilement=0,this.init()}return a()(t,[{key:"init",value:function(){for(var t=0;t<9;t+=1)this.d[t]=0;return this.sauvegardePrecedente=[],this.empilement=0,this}},{key:"get",value:function(){return this.d}},{key:"set",value:function(t,e,i,s,n,r,a,o,h){return this.d[0]=t,this.d[1]=e,this.d[2]=i,this.d[3]=s,this.d[4]=n,this.d[5]=r,this.d[6]=a,this.d[7]=o,this.d[8]=h,this}},{key:"setFromArray",value:function(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}},{key:"setOneValue",value:function(t){for(var e=0;e<9;e+=1)this.d[e]=t[e]}},{key:"multiply",value:function(e){for(var i=new t,s=0;s<3;s+=1)for(var n=0;n<3;n+=1)for(var r=0;r<3;r+=1)i.d[3*n+s]+=this.d[3*n+r]*e.d[3*r+s];for(var a=0;a<9;a+=1)this.d[a]=i.d[a];return this}},{key:"equal",value:function(t){for(var e=0;e<9;e+=1)this.d[e]=t.d[e],this.sauvegardePrecedente[e]=t.sauvegardePrecedente[e];return this}},{key:"push",value:function(){this.empilement+=1;for(var t=0,e=9*(this.empilement-1);e<9*this.empilement;e+=1)this.sauvegardePrecedente[e]=this.d[t],t+=1;return this}},{key:"pop",value:function(){if(this.empilement>0){for(var t=0,e=9*(this.empilement-1);e<9*this.empilement;e+=1)this.d[t]=this.sauvegardePrecedente[e],this.sauvegardePrecedente[e]=null,t+=1;this.empilement-=1}return this}},{key:"identity",value:function(){return this.init(),this.d[0]=1,this.d[4]=1,this.d[8]=1,this}},{key:"transpose",value:function(){return this.setFromArray(t.transpose(this.d))}},{key:"inverse",value:function(){var t=new Array(9),e=this.getDeterminant();if(0===e)return this.identity(),null;t[0]=this.d[4]*this.d[8]-this.d[5]*this.d[7]/e,t[1]=-(this.d[1]*this.d[8]-this.d[7]*this.d[2])/e,t[2]=this.d[1]*this.d[5]-this.d[4]*this.d[2]/e,t[3]=-(this.d[3]*this.d[8]-this.d[5]*this.d[6])/e,t[4]=this.d[0]*this.d[8]-this.d[6]*this.d[2]/e,t[5]=-(this.d[0]*this.d[5]-this.d[3]*this.d[2])/e,t[6]=this.d[3]*this.d[7]-this.d[6]*this.d[4]/e,t[7]=-(this.d[0]*this.d[7]-this.d[6]*this.d[1])/e,t[8]=this.d[0]*this.d[4]-this.d[1]*this.d[3]/e;for(var i=0;i<9;i+=1)this.d[i]=t[i];return this}},{key:"getDeterminant",value:function(){return this.d[0]*(this.d[4]*this.d[8]-this.d[7]*this.d[5])+this.d[1]*(this.d[5]*this.d[6]-this.d[3]*this.d[8])+this.d[2]*(this.d[3]*this.d[7]-this.d[6]*this.d[4])}},{key:"rotate",value:function(e,i,s,n){var r=new t,a=e*(Math.PI/180),h=new o.a(i,s,n);return h.normalise(),r.d[0]=h.x*h.x*(1-Math.cos(a))+Math.cos(a),r.d[1]=h.x*h.y*(1-Math.cos(a))-h.z*Math.sin(a),r.d[2]=h.x*h.z*(1-Math.cos(a))+h.y*Math.sin(a),r.d[3]=h.x*h.y*(1-Math.cos(a))+h.z*Math.sin(a),r.d[4]=h.y*h.y*(1-Math.cos(a))+Math.cos(a),r.d[5]=h.y*h.z*(1-Math.cos(a))-h.x*Math.sin(a),r.d[6]=h.x*h.z*(1-Math.cos(a))-h.y*Math.sin(a),r.d[7]=h.y*h.z*(1-Math.cos(a))+h.x*Math.sin(a),r.d[8]=h.z*h.z*(1-Math.cos(a))+Math.cos(a),this.multiply(r),this}}],[{key:"transpose",value:function(t){for(var e=new Float32Array(9),i=0,s=0;s<3;s+=1)for(var n=0;n<3;n+=1)e[i]=t[3*n+s],i+=1;return e}}]),t}();e.a=h},118:function(t,e,i){"use strict";e.a={position:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],indices:[0,1,2,1,3,2],texture:[0,0,1,0,0,1,1,1]}},121:function(t,e,i){"use strict";e.a={position:[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],texture:[1,1,0,1,0,0,1,0,0,0,1,0,1,1,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1]}},132:function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(22),h=i.n(o),u=i(7),c=i.n(u),l=i(8),d=i.n(l),f=i(3),g=i.n(f),v=i(134),p=i(149);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=g()(t);if(e){var n=g()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return d()(this,i)}}var m=function(t){c()(i,t);var e=y(i);function i(t,s,r){var a;n()(this,i);var o=(a=e.call(this,t,s,r)).canUseDepth(),h=s.canvas,u=h.width,c=h.height;a.lampes=s.lampes&&s.lampes.map((function(t){return new p.a(a.gl,t,u,c,o)}))||[];var l=a.mngProg.getAll();return Object.keys(l).forEach((function(t){var e=l[t];e.getLocations().numLights&&a.setLampeInfos(e)})),a}return a()(i,[{key:"renderReperes",value:function(){var t=this;this.lampes.forEach((function(e){return e.renderRepere(t.camera)}))}},{key:"randomLampesPositions",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.lampes.forEach((function(s,n){(null===i||null!==i&&n===i)&&s.move(t.time*e,n)}))}},{key:"setLampeInfos",value:function(t){var e=this;t.setVector("posEye",this.camera.getPosition()),t.setInt("numLights",this.lampes.length),this.config.lampes.forEach((function(i,s){var n=i.type,r=i.ambiant,a=i.diffuse,o=i.specular,h=i.brillance,u=i.radius,c=i.direction,l=i.strength;t.setInt("lights[".concat(s,"].type"),n),t.setVector("lights[".concat(s,"].position"),e.lampes[s].getPosition()),t.setVector("lights[".concat(s,"].ambiant"),r),t.setVector("lights[".concat(s,"].diffuse"),a),t.setVector("lights[".concat(s,"].specular"),o),h&&t.setFloat("lights[".concat(s,"].brillance"),h),u&&t.setFloat("lights[".concat(s,"].radius"),u),c&&t.setVector("lights[".concat(s,"].direction"),c),t.setFloat("lights[".concat(s,"].strength"),l||1)}))}},{key:"computeLampesDepthTexture",value:function(){if("function"==typeof this.renderBasiqueForShadow)for(var t=0;t<1;t+=1){var e=this.getLampe(t);e.start();var i=this.mngProg.get("basique3d");i.setMatrix("projection",e.getOrtho().get()),i.setMatrix("view",e.getView().get()),this.renderBasiqueForShadow(i),e.end()}}},{key:"render",value:function(){h()(g()(i.prototype),"render",this).call(this),this.computeLampesDepthTexture(),this.mngProg.setCameraMatrix(this.camera,!!this.config.camera.ortho)}},{key:"getLampe",value:function(t){return this.lampes[t]?this.lampes[t]:null}}]),i}(v.a)},134:function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(22),h=i.n(o),u=i(7),c=i.n(u),l=i(8),d=i.n(l),f=i(3),g=i.n(f),v=i(136),p=i(137);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=g()(t);if(e){var n=g()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return d()(this,i)}}var m=function(t){c()(i,t);var e=y(i);function i(t,s,r){var a;return n()(this,i),(a=e.call(this,t,s,r)).camera=new p.a(s.camera),a.camera.perspective(a.containerSize.width,a.containerSize.height),a}return a()(i,[{key:"resize",value:function(t){h()(g()(i.prototype),"resize",this).call(this,t),this.camera.perspective(this.containerSize.width,this.containerSize.height)}},{key:"update",value:function(t){h()(g()(i.prototype),"update",this).call(this,t),this.camera.update(),this.mngProg.setCameraMatrix(this.camera,!!this.config.camera.ortho)}}]),i}(v.a)},135:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n()(this,t),this.d=[0,0,0,0],this.set(e,i,s,r)}return a()(t,[{key:"normalise",value:function(){var t=this.length();return 0!==t&&(this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this.d[3]/=t),this}},{key:"get",value:function(){return this.d}},{key:"getX",value:function(){return this.d[0]}},{key:"getY",value:function(){return this.d[1]}},{key:"getZ",value:function(){return this.d[2]}},{key:"getW",value:function(){return this.d[3]}},{key:"length",value:function(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2]+this.d[3]*this.d[3])}},{key:"set",value:function(t,e,i,s){return null!=t&&(this.d[0]=t),null!=e?this.d[1]=e:null!=t&&(this.d[1]=t),null!=i?this.d[2]=i:null!=t&&(this.d[2]=t),null!=s?this.d[3]=s:null!=t&&(this.d[3]=t),this}},{key:"equal",value:function(t){return this.d=[t.d[0],t.d[1],t.d[2],t.d[3]],this}},{key:"add",value:function(t){return this.d[0]+=t.d[0],this.d[1]+=t.d[1],this.d[2]+=t.d[2],this.d[3]+=t.d[3],this}},{key:"addNumber",value:function(t){return this.d[0]+=t,this.d[1]+=t,this.d[2]+=t,this.d[3]+=t,this}},{key:"minus",value:function(t){return this.d[0]-=t.d[0],this.d[1]-=t.d[1],this.d[2]-=t.d[2],this.d[3]-=t.d[3],this}},{key:"minusNumber",value:function(t){return this.d[0]-=t,this.d[1]-=t,this.d[2]-=t,this.d[3]-=t,this}},{key:"multiplyNumber",value:function(t){return this.d[0]*=t,this.d[1]*=t,this.d[2]*=t,this.d[3]*=t,this}},{key:"multiplyMatrix",value:function(t){var e=this.d[0],i=this.d[1],s=this.d[2],n=this.d[3];return this.d[0]=t.d[0]*e+t.d[4]*i+t.d[8]*s+t.d[12]*n,this.d[1]=t.d[1]*e+t.d[5]*i+t.d[9]*s+t.d[13]*n,this.d[2]=t.d[2]*e+t.d[6]*i+t.d[10]*s+t.d[14]*n,this.d[3]=t.d[3]*e+t.d[7]*i+t.d[11]*s+t.d[15]*n,this}},{key:"multiply",value:function(t){return this.d[0]*=t.d[0],this.d[1]*=t.d[1],this.d[2]*=t.d[2],this.d[3]*=t.d[3],this}},{key:"divideNumber",value:function(t){return this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this.d[3]/=t,this}},{key:"divide",value:function(t){return this.d[0]/=t.d[0],this.d[1]/=t.d[1],this.d[2]/=t.d[2],this.d[3]/=t.d[3],this}},{key:"distance",value:function(t){return Math.sqrt((t.d[0]-this.d[0])*(t.d[0]-this.d[0])+(t.d[1]-this.d[1])*(t.d[1]-this.d[1])+(t.d[2]-this.d[2])*(t.d[2]-this.d[2])+(t.d[3]-this.d[3])*(t.d[3]-this.d[3]))}}]),t}();e.a=o},136:function(t,e,i){"use strict";i.d(e,"a",(function(){return Q}));var s=i(0),n=i.n(s),r=i(1),a=i.n(r),o=i(2),h=i.n(o),u=function(){function t(e,i,s){a()(this,t),this.gl=e,this.texture=e.createTexture(),this.filter=s?e[s]:e.NEAREST,this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}return h()(t,[{key:"get",value:function(){return this.texture}}]),t}(),c=function(){function t(e,i){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a()(this,t),this.textures={},Object.keys(i).forEach((function(t){s.textures[t]=new u(e,i[t],n[t])}))}return h()(t,[{key:"get",value:function(t){return this.textures[t]}}]),t}(),l=i(143),d=function(){function t(e,i){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;a()(this,t),this.objets={},Object.keys(i).forEach((function(t){s.objets[t]=new l.a(e,i[t],n&&n[t])}))}return h()(t,[{key:"get",value:function(t){return this.objets[t]}}]),t}(),f=i(144),g=function(){function t(e,i,s){var r=this;a()(this,t),n()(this,"getAll",(function(){return r.programs})),this.programs={},Object.keys(i).forEach((function(t){var n=i[t];r.programs[t]=new f.a(e,n),-1!==n.uniforms.indexOf("resolution")&&r.programs[t].setVector("resolution",[s.width,s.height])}))}return h()(t,[{key:"setCameraMatrix",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(this.programs).forEach((function(s){e.programs[s].setMatrix("view",t.getView().get());var n=i?t.getOrtho():t.getProjection();e.programs[s].setMatrix("projection",n.get())}))}},{key:"get",value:function(t){return this.programs[t]}}]),t}(),v=i(89),p=i(86),y=i(146),m=function(){function t(e,i){var s=this;a()(this,t),n()(this,"hasAnimation",(function(t){var e=!1;return t.forEach((function(t){!e&&t.animations&&(e=!0)})),e})),this.gltfs={},Object.keys(i).forEach((function(t){i[t].skins?s.gltfs[t]=new y.a(e,i[t]):s.hasAnimation(i[t].nodes)?s.gltfs[t]=new p.a(e,i[t]):s.gltfs[t]=new v.a(e,i[t])}))}return h()(t,[{key:"get",value:function(t){return this.gltfs[t]}}]),t}(),k=function(){function t(e){var i=this;a()(this,t),n()(this,"saveData",(function(t){i.audioData=t})),n()(this,"togglePause",(function(){i.isPlaying?i.isPause?(i.audioContext.resume(),i.isPause=!1):(i.audioContext.suspend(),i.isPause=!0):(i.play(),i.isPause=!1)})),n()(this,"stop",(function(){i.clearAnalyse(),i.sourceNode&&(i.sourceNode.removeEventListener("ended",i.stop,!1),i.sourceNode.disconnect(),i.sourceNode.stop(0)),i.isPlaying=!1})),n()(this,"toggle",(function(){i.isPlaying?i.stop():i.play()})),n()(this,"clearAnalyse",(function(){i.amplitudeArray.fill(0),i.javascriptNode&&(i.analyserNode.disconnect(),i.javascriptNode.disconnect(),i.javascriptNode.removeEventListener("audioprocess",i.onAnalyse,!1))})),n()(this,"onAnalyse",(function(){i.analyserNode.getByteFrequencyData(i.amplitudeArray)})),n()(this,"onError",(function(t){})),n()(this,"setPlaybackRate",(function(t){i.playbackRate=t,i.sourceNode&&(i.sourceNode.playbackRate.value=i.playbackRate)})),n()(this,"setVolume",(function(t){i.volume=t,i.gainNode&&(i.gainNode.gain.value=i.volume)})),n()(this,"getAmplitudes",(function(){return i.amplitudeArray})),n()(this,"getFrequencyLength",(function(){return i.analyserNode.frequencyBinCount})),n()(this,"getIsPlaying",(function(){return i.isPlaying})),n()(this,"getIsPause",(function(){return i.isPause}));var s=window.AudioContext||window.webkitAudioContext;this.support=!!s;try{this.audioContext=new s}catch(t){this.support=!1}this.audioData=null,this.playbackRate=1,this.playMultiple=!1,this.isPlaying=!1,this.isPause=!0,this.isMute=!0,this.isLoop=!0,this.volume=.5,this.setup(e)}return h()(t,[{key:"setup",value:function(t){this.support&&(this.audioContext.decodeAudioData(t,this.saveData,this.onError),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=this.volume,this.gainNode.connect(this.audioContext.destination),this.sampleSize=1024,this.javascriptNode=this.audioContext.createScriptProcessor(this.sampleSize,1,1),this.analyserNode=this.audioContext.createAnalyser(),this.amplitudeArray=new Uint8Array(this.analyserNode.frequencyBinCount))}},{key:"play",value:function(){this.audioData&&(!this.playMultiple&&this.isPlaying&&this.stop(),this.sourceNode=this.audioContext.createBufferSource(),this.sourceNode.playbackRate.value=this.playbackRate,this.sourceNode.buffer=this.audioData,this.sourceNode.loop=this.isLoop,this.sourceNode.connect(this.gainNode),this.setupAnalyse(),this.sourceNode.addEventListener("ended",this.stop,!1),this.sourceNode.start(0),this.isPlaying=!0)}},{key:"setupAnalyse",value:function(){this.sourceNode.connect(this.analyserNode),this.analyserNode.connect(this.javascriptNode),this.javascriptNode.connect(this.audioContext.destination),this.javascriptNode.addEventListener("audioprocess",this.onAnalyse,!1)}},{key:"getSupport",value:function(){return this.support}}]),t}(),b=function(){function t(e){var i=this;a()(this,t),this.audios={},Object.keys(e).forEach((function(t){i.audios[t]=new k(e[t])}))}return h()(t,[{key:"get",value:function(t){return this.audios[t]}}]),t}(),T=i(7),P=i.n(T),x=i(8),E=i.n(x),w=i(3),M=i.n(w),R=i(65),F=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a()(this,t),this.fbos=[],this.currentFbo=0;var r=null;this.fbos[0]=new R.a(e,i,s,n,r,0),this.fbos[1]=new R.a(e,i,s,n,r,1)}return h()(t,[{key:"start",value:function(){this.fbos[this.currentFbo].start()}},{key:"end",value:function(){this.fbos[this.currentFbo].end()}},{key:"swap",value:function(){this.currentFbo=0===this.currentFbo?1:0}},{key:"resize",value:function(t){this.fbos[0].resize(t),this.fbos[1].resize(t)}},{key:"getTexture",value:function(){return this.fbos[this.currentFbo].getTexture()}},{key:"getDepthTexture",value:function(){return this.fbos[this.currentFbo].getDepthTexture()}}]),t}(),D=i(116),A=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;a()(this,t),this.gl=e;var n=i.width,r=void 0===n?1024:n,o=i.height,h=void 0===o?1024:o,u=i.useDepth,c=void 0!==u&&u;this.ppb=new F(e,r,h,c),this.screen=new D.a(e),this.width=r,this.height=h,this.passCount=0,this.programs=s}return h()(t,[{key:"start",value:function(){this.ppb.start(),this.passCount=0}},{key:"end",value:function(){this.ppb.end()}},{key:"resize",value:function(t){this.ppb.resize(t)}},{key:"applyTexToProg",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=null===e;this.passCount=i?this.passCount+1:0;var s=this.passCount+1,n=i?this.ppb.getTexture().get():e;return t.setTexture(s,n,"textureMap"),t.setFloat("flipY",-1),t}},{key:"setBrightContrast",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.brightcontrast,i);s.setFloat("brightness",t),s.setFloat("contrast",e),this.renderToPingPong(s)}},{key:"setFxaa",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.fxaa,t);this.renderToPingPong(e)}},{key:"setBloom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.bloom,i);s.setFloat("scale",t),s.setFloat("threshold",e),this.renderToPingPong(s)}},{key:"setFxaa2",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.fxaa2,t);this.renderToPingPong(e)}},{key:"renderToPingPong",value:function(t){this.ppb.swap(),this.ppb.start(),this.screen.render(t.get()),this.ppb.end()}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.applyTexToProg(this.programs[e?"debug":"screen"],t);this.screen.render(i.get())}},{key:"renderInverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.applyTexToProg(this.programs[e?"debug":"screen"],t);i.setFloat("flipY",1),this.screen.render(i.get())}},{key:"getTexture",value:function(){return this.ppb.getTexture()}}]),t}();function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=M()(t);if(e){var n=M()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return E()(this,i)}}var j=function(t){P()(i,t);var e=O(i);function i(){return a()(this,i),e.apply(this,arguments)}return h()(i,[{key:"create",value:function(){for(var t=new ArrayBuffer(this.size.width*this.size.height*4),e=new Uint8Array(t),i=0,s=0;s<this.size.height;s+=1)for(var n=0;n<this.size.width;n+=1)e[i]=255*Math.random(),e[i+1]=255*Math.random(),e[i+2]=0,e[i+3]=255,i+=4;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.height,this.size.width,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}}]),i}(i(57).a);function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=M()(t);if(e){var n=M()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return E()(this,i)}}var S=function(t){P()(i,t);var e=z(i);function i(t,s){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a()(this,i),(n=e.call(this,t,s,r)).textures={},Object.keys(n.programs).forEach((function(t){switch(t){case"watercolor2":case"watercolor3":n.textures[t]=new j(n.gl,512,512)}})),n}return h()(i,[{key:"setDOF",value:function(t,e,i,s){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=this.applyTexToProg(this.programs.dof,n);r.setFloat("focusDistance",i),r.setFloat("blur",e),r.setFloat("ppm",s),r.setVector("range",t),r.setTexture(2,this.ppb.getDepthTexture().get(),"depthMap"),this.renderToPingPong(r)}},{key:"mergeBloom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.mergeBloom,s);n.setFloat("gamma",e),n.setFloat("exposure",i),n.setTexture(3,t.get(),"bloomMap"),this.renderToPingPong(n)}},{key:"setKuwahara",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.kuwahara,t);this.renderToPingPong(e)}},{key:"setWatercolor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.watercolor,t);this.renderToPingPong(e)}},{key:"setWatercolor2",value:function(t,e,i,s){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=this.applyTexToProg(this.programs.watercolor2,n);r.setFloat("gradientStep",t),r.setFloat("advectStep",e),r.setFloat("flipHeightMap",i),r.setFloat("time",s),r.setTexture(2,this.textures.watercolor2.get(),"heightMap"),this.renderToPingPong(r)}},{key:"setWatercolor3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.watercolor3,t);e.setTexture(2,this.textures.watercolor3.get(),"noiseMap"),this.renderToPingPong(e)}},{key:"setWatercolorMoving",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.watercolorMoving,s);n.setFloat("time",t),n.setVector("mouse",e),n.setFloat("scale",i),this.renderToPingPong(n)}},{key:"setSobel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.sobel,t);this.renderToPingPong(e)}},{key:"setGamma",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.applyTexToProg(this.programs.gamma,e);i.setFloat("gamma",t),this.renderToPingPong(i)}},{key:"setRGB",value:function(t,e,i,s){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=this.applyTexToProg(this.programs.rgb,n);r.setVector("center",[i,s]),r.setVector("delta",[t,e]),this.renderToPingPong(r)}},{key:"setVortex",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.vortex,s);n.setVector("center",t),n.setFloat("radius",e),n.setFloat("angle",i),this.renderToPingPong(n)}},{key:"setOil",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.applyTexToProg(this.programs.oil,e);i.setFloat("radius",t),this.renderToPingPong(i)}},{key:"setSketch",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.applyTexToProg(this.programs.sketch,e);i.setFloat("delta",t),this.renderToPingPong(i)}},{key:"setPixel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.pixel,i);s.setVector("delta",[t,e]),this.renderToPingPong(s)}},{key:"setWave",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.wave,s);n.setFloat("time",t),n.setFloat("radius",e),n.setVector("center",i),this.renderToPingPong(n)}},{key:"setSepia",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.applyTexToProg(this.programs.sepia,e);i.setFloat("delta",t),this.renderToPingPong(i)}},{key:"setGlitch",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.glitch,s);n.setFloat("delta",e),n.setFloat("time",t),n.setFloat("speed",i),this.renderToPingPong(n)}},{key:"setGlitch2",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.glitch2,s);n.setFloat("delta",e),n.setFloat("time",t),n.setFloat("speed",i),this.renderToPingPong(n)}},{key:"setGlitch3",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.glitch3,i);s.setFloat("delta",e),s.setFloat("time",t),this.renderToPingPong(s)}},{key:"setGlitch4",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.glitch4,s);n.setFloat("delta",e),n.setFloat("time",t),n.setFloat("rate",i),this.renderToPingPong(n)}},{key:"setSignature",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.applyTexToProg(this.programs.signature,i);s.setFloat("delta",e),s.setFloat("time",t),this.renderToPingPong(s)}},{key:"setCompose",value:function(t,e,i){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this.applyTexToProg(this.programs.compose,s);n.setTexture(6,t,"ssaoMap"),n.setTexture(7,e,"shadowMap"),n.setTexture(4,i,"depthMap"),this.renderToPingPong(n)}}]),i}(A),_=i(10),C=i.n(_);function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=M()(t);if(e){var n=M()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return E()(this,i)}}var I=function(t){P()(i,t);var e=L(i);function i(t,s){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a()(this,i),r=e.call(this,t,s,o),n()(C()(r),"setBlurIntensity",(function(t){r.blurIntensity=t})),n()(C()(r),"setBlurSize",(function(t){r.blurSize=t}));var h=s.blur||{};return r.blurSize=void 0!==h.size?h.size:.6,r.blurIntensity=void 0!==h.intensity?h.intensity:1,r}return h()(i,[{key:"setBlur",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.blurOnePass,t);e.setFloat("size",this.blurSize),e.setFloat("intensity",this.blurIntensity),this.renderToPingPong(e)}}]),i}(A);function U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=M()(t);if(e){var n=M()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return E()(this,i)}}var N=function(t){P()(i,t);var e=U(i);function i(t,s){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a()(this,i),r=e.call(this,t,s,o),n()(C()(r),"setNbPass",(function(t){r.blurNbPass=t})),r}return i}(I),X=i(25),B=i(87),V=i(29);function q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=M()(t);if(e){var n=M()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return E()(this,i)}}var G=function(t){P()(i,t);var e=q(i);function i(t,s){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a()(this,i),(n=e.call(this,t,s,r)).near=s.near||1,n.far=s.far||100,n.radius=s.radius||5,n.strength=s.strength||1;var o=n.programs.ssao;return o.setFloat("radius",n.radius),o.setFloat("near",n.near),o.setFloat("far",n.far),o.setFloat("strength",n.strength),n}return h()(i,[{key:"generateSsaoSamples",value:function(t,e){for(var i=0;i<e;i+=1){var s=i/e;s=Object(B.a)(s*s,.1,1);var n=new X.a(Object(V.c)(-1,1),Object(V.c)(-1,1),Object(V.c)(0,1)).normalise().multiplyNumber(Object(V.c)(0,1)).multiplyNumber(s);this.programs[t].setVector("samples[".concat(i,"]"),n.get())}}},{key:"compute",value:function(t){var e=this.applyTexToProg(this.programs.ssao,t);e.setFloat("flipY",-1),this.renderToPingPong(e)}}]),i}(I),Y=i(22),W=i.n(Y);function K(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=M()(t);if(e){var n=M()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return E()(this,i)}}var Z=function(t){P()(i,t);var e=K(i);function i(t,s){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a()(this,i),r=e.call(this,t,s,o),n()(C()(r),"getProgram",(function(){return r.programs.shadow}));var h=r.programs.shadow;return h.setFloat("shadowEpsilon",s.epsilon||.01),h.setFloat("lighten",s.lighten||0),r}return h()(i,[{key:"start",value:function(t){W()(M()(i.prototype),"start",this).call(this);var e=this.programs.shadow;e.setTexture(2,t.getDepthTexture().get(),"shadowMap"),e.setMatrix("shadowView",t.getView().get()),e.setMatrix("shadowProjection",t.getOrtho().get()),e.setVector("posLum",t.getPosition())}}]),i}(I);function H(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function J(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?H(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Q=function(){function t(e,i,s){a()(this,t),this.gl=e,this.config=i,this.time=0;var n=this.config.canvas,r=n.width,o=n.height;if(this.containerSize={width:r,height:o},s){if(s.shaders&&(this.mngProg=new g(this.gl,s.shaders,i.canvas),i.postprocess)){var h={width:r,height:o,useDepth:this.canUseDepth()},u=this.mngProg.getAll();this.postProcess=new S(this.gl,h,u),i.postprocess.bloom&&(this.bloom=new N(this.gl,J(J({},h),i.postprocess.bloom),u)),i.postprocess.ssao&&(this.ssao=new G(this.gl,J(J(J({},h),i.postprocess.ssao),{},{near:i.camera.near,far:i.camera.far}),u)),i.postprocess.shadow&&(this.shadow=new Z(this.gl,J(J({},h),i.postprocess.shadow),u))}s.textures&&(this.mngTex=new c(this.gl,s.textures,i.textures)),s.objets&&(this.mngObj=new d(this.gl,s.objets,s.materials)),s.gltfs&&(this.mngGltf=new m(this.gl,s.gltfs)),s.sounds&&(this.mngSound=new b(s.sounds))}this.resizeViewport()}return h()(t,[{key:"canUseDepth",value:function(){return this.config.useDepthTexture&&this.config.support.depthTexture}},{key:"resize",value:function(t){this.containerSize=t,this.resizeViewport()}},{key:"update",value:function(t){this.time=t}},{key:"render",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"resizeViewport",value:function(){this.gl.viewport(0,0,this.containerSize.width,this.containerSize.height)}},{key:"getColorPixel",value:function(t,e){var i=new Uint8Array(4);return this.gl.readPixels(t,e,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i),i}}]),t}()},138:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=function(){function t(e,i){n()(this,t),this.gl=e;var s=Math.sqrt(i.length/4);this.size={width:s,height:s},this.texture=e.createTexture(),this.filter=e.NEAREST,this.setup(i)}return a()(t,[{key:"setup",value:function(t){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}},{key:"get",value:function(){return this.texture}}]),t}()},139:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(0),h=i.n(o),u=function(){function t(){var e=this;n()(this,t),h()(this,"start",(function(){var t=(new Date).getTime(),i=t-e.lastFrame;e.callbackNoFps&&e.callbackNoFps(),i>e.fps&&(e.callback(t-e.firstFrame),e.lastFrame=t),e.ref=window.requestAnimationFrame(e.start)})),this.fps=25,this.firstFrame=(new Date).getTime(),this.lastFrame=this.firstFrame,this.ref=null}return a()(t,[{key:"setCallback",value:function(t){this.callback=t}},{key:"setCallbackNoFps",value:function(t){this.callbackNoFps=t}},{key:"setFps",value:function(t){this.fps=t}},{key:"stop",value:function(){window.cancelAnimationFrame(this.ref)}}]),t}()},140:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=function(){function t(){n()(this,t),this.shaders={}}return a()(t,[{key:"get",value:function(e){var s=this,n=e.map((function(e){var s={},n=t.getInfos(e).name;try{s=i(282)("./shaders".concat(e)).then((function(t){return{name:n,js:t}}))}catch(t){}return s}));return Promise.all(n).then((function(t){return t.forEach((function(t){var e=t.name,i=t.js;s.shaders[e]=i.default})),s.shaders}))}}],[{key:"getInfos",value:function(t){var e=t.substring(t.lastIndexOf("/")+1,t.length).split(".");return{name:e[0],ext:e[1].toLowerCase()}}}]),t}();e.a=o},141:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(0),h=i.n(o),u=function(){function t(e){var i=this;n()(this,t),h()(this,"onKeyPress",(function(t){void 0!==i.keysPressed[t.keyCode]&&(t.preventDefault(),i.keysPressed[t.keyCode]=!0,i.oneKeysPressed[t.keyCode]=!0)})),h()(this,"onKeyUp",(function(t){void 0!==i.keysPressed[t.keyCode]&&(t.preventDefault(),i.keysUp[t.keyCode]=!0)})),this.keys=e,this.oneKeysPressed={},this.keysPressed={},this.keysUp={},this.charges={},Object.keys(this.keys).forEach((function(t){i.keysPressed[i.keys[t]]=!1,i.keysUp[i.keys[t]]=!1,i.oneKeysPressed[i.keys[t]]=!1,i.charges[i.keys[t]]=0})),document.addEventListener("keydown",this.onKeyPress,!1),document.addEventListener("keyup",this.onKeyUp,!1)}return a()(t,[{key:"cancel",value:function(){document.removeEventListener("keydown",this.onKeyPress,!1),document.removeEventListener("keyup",this.onKeyUp,!1)}},{key:"start",value:function(){var t=this;Object.keys(this.keys).forEach((function(e){t.keysPressed[t.keys[e]]&&(t.charges[t.keys[e]]+=1)}))}},{key:"end",value:function(){var t=this;Object.keys(this.keys).forEach((function(e){t.keysPressed[t.keys[e]]&&t.keysUp[t.keys[e]]&&(t.charges[t.keys[e]]=0,t.keysPressed[t.keys[e]]=!1,t.keysUp[t.keys[e]]=!1)}))}},{key:"getCharge",value:function(t){return this.charges[t]}},{key:"resetCharge",value:function(t){this.charges[t]=0}},{key:"isPressed",value:function(t){return this.charges[t]>0}},{key:"isPressedOne",value:function(t){return 1===this.charges[t]}},{key:"isUp",value:function(t){return this.keysUp[t]}}]),t}()},142:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(0),h=i.n(o),u=i(29),c=function(){function t(e,i){var s=this,r=i.callbackDrag,a=i.callbackDown,o=i.callbackUp,u=i.callbackMove,c=i.callbackWheel,l=i.callbackClick;n()(this,t),h()(this,"onMove",(function(e){var i=s.computeInfos(e);s.oldPos=t.getPos(e),null!==s.callbackMove&&s.callbackMove(i),s.isDragging&&null!==s.callbackDrag&&s.callbackDrag(i)})),h()(this,"onDown",(function(e){if(s.isDragging=!0,s.startDraggingMousePos=t.getPos(e),null!==s.callbackDown){var i=s.computeInfos(e);s.callbackDown(i),s.oldPos=t.getPos(e)}})),h()(this,"onUp",(function(t){if(s.onMove(t),s.isDragging=!1,null!==s.callbackUp){var e=s.computeInfos(t);s.callbackUp(e)}})),h()(this,"onWheel",(function(t){var e=t.deltaY;null!==s.callbackWheel&&s.callbackWheel({deltaY:e})})),h()(this,"onClick",(function(t){null!==s.callbackClick&&s.callbackClick(s.computeInfos(t))})),this.div=e,this.callbackDrag=r||null,this.callbackDown=a||null,this.callbackUp=o||null,this.callbackMove=u||null,this.callbackWheel=c||null,this.callbackClick=l||null,this.isDragging=!1,this.startDraggingMousePos={x:0,y:0},this.oldPos={x:0,y:0},this.options={capture:!1,passive:!0},this.setup()}return a()(t,[{key:"setup",value:function(){this.callbackClick&&this.div.addEventListener("click",this.onClick,!1),(this.callbackDrag||this.callbackMove)&&(this.div.addEventListener("mousemove",this.onMove,this.options),this.div.addEventListener("touchmove",this.onMove,this.options)),(this.callbackDrag||this.callbackDown||this.callbackUp)&&(window.addEventListener("mouseup",this.onUp,this.options),this.div.addEventListener("mousedown",this.onDown,this.options),this.div.addEventListener("touchstart",this.onDown,this.options),this.div.addEventListener("touchend",this.onUp,this.options)),this.callbackWheel&&this.div.addEventListener("wheel",this.onWheel,this.options)}},{key:"cancel",value:function(){this.callbackClick&&this.div.removeEventListener("click",this.onClick,!1),(this.callbackDrag||this.callbackMove)&&(this.div.removeEventListener("mousemove",this.onMove,this.options),this.div.removeEventListener("touchmove",this.onMove,this.options)),this.callbackDrag&&(window.removeEventListener("mouseup",this.onUp,this.options),this.div.removeEventListener("mousedown",this.onDown,this.options),this.div.removeEventListener("touchstart",this.onDown,this.options),this.div.removeEventListener("touchend",this.onUp,this.options)),this.callbackWheel&&this.div.removeEventListener("wheel",this.onWheel,this.options)}},{key:"computeInfos",value:function(e){var i=t.getPos(e),s=this.div.getBoundingClientRect(),n=i.x-s.x,r=i.y-s.y,a={x:this.oldPos.x-i.x,y:this.oldPos.y-i.y};return{size:s,pos:{x:n,y:r},rel:{x:Object(u.b)(n,0,s.width,-1,1),y:Object(u.b)(r,0,s.height,1,-1)},relScroll:{x:e.pageX-s.left+window.scrollX,y:e.pageY-s.top+window.scrollY},relDown:{x:this.startDraggingMousePos.x-i.x,y:this.startDraggingMousePos.y-i.y},relPrevious:a,speed:Math.max(Math.abs(a.x),Math.abs(a.x))}}},{key:"get",value:function(){return this.infos}}],[{key:"getPos",value:function(t){return t.touches?{x:t.touches[0].clientX,y:t.touches[0].clientY}:{x:t.clientX,y:t.clientY}}}]),t}();e.a=c},145:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(0),h=i.n(o),u=function(){function t(e){var i=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LINEAR",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;n()(this,t),h()(this,"findIndex",(function(t){var e=0,s=i.timeSteps[e];for(0===s&&(e++,s=i.timeSteps[e]);s&&t>s;)e++,s=i.timeSteps[e];i.index=e})),h()(this,"setTimes",(function(t){i.timeSteps=i.times.map((function(e){return e*t})),i.index=0,i.interpolationValue=0})),this.times=e,this.setTimes(r),this.interpolationType=s}return a()(t,[{key:"update",value:function(t){if(this.findIndex(t),0===this.index)this.interpolationValue=0;else if(this.index===this.times.length)this.interpolationValue=this.timeSteps[this.times.length-1];else{var e=this.timeSteps[this.index],i=this.timeSteps[this.index-1];this.interpolationValue=(t-i)/(e-i)}}},{key:"setSpeed",value:function(t){this.setTimes(t)}},{key:"getIndex",value:function(){return this.index}},{key:"get",value:function(){return this.interpolationValue}}]),t}()},147:function(t,e,i){"use strict";i.d(e,"a",(function(){return g}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(7),h=i.n(o),u=i(8),c=i.n(u),l=i(3),d=i.n(l);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=d()(t);if(e){var n=d()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return c()(this,i)}}var g=function(t){h()(i,t);var e=f(i);function i(){return n()(this,i),e.apply(this,arguments)}return a()(i,[{key:"create",value:function(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}}]),i}(i(57).a)},148:function(t,e,i){"use strict";i.d(e,"a",(function(){return g}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(7),h=i.n(o),u=i(8),c=i.n(u),l=i(3),d=i.n(l);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=d()(t);if(e){var n=d()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return c()(this,i)}}var g=function(t){h()(i,t);var e=f(i);function i(){return n()(this,i),e.apply(this,arguments)}return a()(i,[{key:"create",value:function(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.DEPTH_COMPONENT,this.size.width,this.size.height,0,this.gl.DEPTH_COMPONENT,this.gl.UNSIGNED_INT,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}}]),i}(i(57).a)},150:function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(73),h=i(19),u=i(121),c=function(){function t(e){n()(this,t),this.gl=e,this.objet=new o.a(this.gl,u.a),this.model=new h.a,this.model.identity()}return a()(t,[{key:"render",value:function(t){t.setMatrix("model",this.model.get()),this.objet.render(t.get())}},{key:"update",value:function(t,e){this.model.identity().scale(e.getX(),e.getY(),e.getZ()).translate(t.getX(),t.getY(),t.getZ())}},{key:"getModel",value:function(){return this.model}}]),t}()},151:function(t,e,i){"use strict";i(43),i(61);var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(0),h=i.n(o);function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){h()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}for(var l=function(){function t(e){var i=this;n()(this,t),h()(this,"addFaceIndex",(function(t){var e=t.split("/");e[0]&&""!==e[0]&&i.obj.v.indices.push(parseInt(e[0],10)-1),e[1]&&""!==e[1]&&i.obj.vt.indices.push(parseInt(e[1],10)-1),e[2]&&""!==e[2]&&i.obj.vn.indices.push(parseInt(e[2],10)-1)})),this.obj={v:{indices:[],points:[]},vt:{indices:[],points:[]},vn:{indices:[],points:[]}},this.mat={},this.faceCount=0,this.readLines(e)}return a()(t,[{key:"readLines",value:function(t){var e=this;t.split("\n").forEach((function(t){var i=t.split(" "),s=i[0];switch(s){case"f":e.addFace(i.slice(1));break;case"v":case"vn":case"vt":e.addPoints(s,i.slice(1));break;case"usemtl":e.addNewMaterial(i.slice(1)[0])}}))}},{key:"addFace",value:function(t){t.forEach(this.addFaceIndex),this.faceCount+=1}},{key:"addPoints",value:function(t,e){var i=this;("vt"===t&&3===e.length?e.slice(0,2):e).forEach((function(e){return i.obj[t].points.push(parseFloat(e,10))}))}},{key:"addNewMaterial",value:function(t){this.mat[3*this.faceCount]=t}},{key:"get",value:function(){return c(c({},this.obj),{},{mat:this.mat})}}]),t}(),d=function(){function t(e){n()(this,t),this.materials={},this.current="",this.readLines(e)}return a()(t,[{key:"readLines",value:function(t){var e=this;t.split("\n").forEach((function(t){var i=t.split(" "),s=i[0];switch(s){case"newmtl":e.createMaterial(i.slice(1));break;case"Ns":case"Ka":case"Kd":case"Ks":case"Ke":case"Ni":case"d":case"illum":e.addInfoToMaterial(s,i.slice(1))}}))}},{key:"createMaterial",value:function(t){this.current=t,this.materials[this.current]={}}},{key:"addInfoToMaterial",value:function(t,e){var i="";switch(t){case"Ka":i="ambiant";break;case"Kd":i="diffuse";break;case"Ks":i="specular";break;case"Ke":i="emissive";break;case"Ns":i="specDensity";break;case"d":i="opacity"}""!==i&&(this.materials[this.current][i]=e.map((function(t){return parseFloat(t,10)})))}},{key:"get",value:function(){return this.materials}}]),t}(),f=i(27),g=i.n(f),v=i(49),p=i.n(v),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=new Uint8Array(256),k=0;k<y.length;k++)m[y.charCodeAt(k)]=k;var b=function(t,e,i,s,n){for(var r=new Float32Array(e),a=n||Float32Array.BYTES_PER_ELEMENT*s,o=0,h=0,u=0;u<i;u++){for(var c=0;c<s;c++){var l=o+c*Float32Array.BYTES_PER_ELEMENT;r[h]=t.getFloat32(l,!0),h++}o+=a}return r},T=function(t,e,i,s,n){for(var r=new Uint16Array(e),a=n||Uint16Array.BYTES_PER_ELEMENT*s,o=0,h=0,u=0;u<i;u++){for(var c=0;c<s;c++){var l=o+c*Uint16Array.BYTES_PER_ELEMENT;r[h]=t.getUint16(l,!0),h++}o+=a}return r},P=i(54);function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function E(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach((function(e){h()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var w="SCALAR",M="VEC2",R="VEC3",F="VEC4",D="MAT2",A="MAT3",O="MAT4",j=function(t){switch(t){default:case w:return 1;case M:return 2;case R:return 3;case F:case D:return 4;case A:return 9;case O:return 16}},z=function(t,e,i){var s=i.bufferView,n=i.componentType,r=i.count,a=i.type,o=i.byteOffset,h=void 0===o?0:o,u=e[s],c=u.buffer,l=u.byteLength,d=u.byteOffset,f=void 0===d?0:d,g=u.byteStride,v=new DataView(t[c],f+h,l-h),p=j(a),y=function(t,e){return j(t)*e}(a,r),m=function(t){switch(t){case 5123:return T;case 5126:return b;case 5120:case 5121:case 5122:case 5125:default:return null}}(n);return m?m(v,y,r,p,g):null},S=function(t,e){var i=e.buffer,s=e.byteOffset,n=e.byteLength;return function(t,e){for(var i=new Uint8Array(e),s=0;s<e;s++)i[s]=t.getUint8(s,!0);return i}(new DataView(t[i],s,n),n)},_=function(t){switch(t){case"normal":return"normale";case"texcoord_0":return"texture";case"baseColorFactor":return"color";case"metallicFactor":return"metal";case"roughnessFactor":return"rough";case"joints_0":return"joint";case"weights_0":return"weight";default:return t}},C=["position","normale","texture","joint","weight","tangent"],L=function(t,e){var i,s={};if(t&&(s=E(E({},(i=t.pbrMetallicRoughness,Object.keys(i).reduce((function(t,e){var s=_(e);return E(E({},t),{},h()({},s,i[e]))}),[]))),{},{name:t.name}),t.normalTexture)){var n=e[t.normalTexture.index];s.normalMap=n||void 0}return Object.keys(s).length>0?s:void 0},I=function(t,e){return t.map((function(t){var i=t.attributes,s=t.indices,n=t.material,r=t.targets,a={vbos:function(t,e,i,s){var n=e[i],r={indices:E(E({},n),{},{size:j(n.type)})},a=s&&s.map((function(t){return Object.keys(t).reduce((function(i,s){var n=e[t[s]];return E(E({},i),{},h()({},s,E(E({},n),{},{size:j(n.type)})))}),{})}));return a&&(a=a.reduce((function(t,e,i){var s=Object.keys(e).reduce((function(t,s){var n=_(s.toLowerCase());return E(E({},t),{},h()({},"target".concat(n).concat(i),e[s]))}),{});return E(E({},t),s)}),{}),r=E(E({},a),r)),Object.keys(t).reduce((function(i,s){var n=_(s.toLowerCase());if(-1===C.indexOf(n))return i;var r=t[s],a=e[r];return E(E({},i),{},h()({},n,E(E({},a),{},{size:j(a.type)})))}),r)}(i,e,s,r)};return void 0!==n&&(a=E({material:n},a)),a}))},U=function t(e,i){return e.map((function(e){var s=i.findIndex((function(t){return t.id===e})),n=i.splice(s,1)[0];n.children&&(n.children=t(n.children,i));n.id;return p()(n,["id"])}))},N=function(){function t(e){n()(this,t);var i=JSON.parse(e),s=i.animations,r=i.buffers,a=i.bufferViews,o=i.accessors,h=i.skins,u=i.nodes,c=i.meshes,l=i.materials,d=i.images,f=r&&r.map((function(t){return function(t){var e,i,s,n,r,a=t.split(",")[1],o=.75*a.length,h=a.length,u=0;"="===a[a.length-1]&&(o--,"="===a[a.length-2]&&o--);var c=new ArrayBuffer(o),l=new Uint8Array(c);for(e=0;e<h;e+=4)i=m[a.charCodeAt(e)],s=m[a.charCodeAt(e+1)],n=m[a.charCodeAt(e+2)],r=m[a.charCodeAt(e+3)],l[u++]=i<<2|s>>4,l[u++]=(15&s)<<4|n>>2,l[u++]=(3&n)<<6|63&r;return c}(t.uri)})),v=o&&o.map((function(t){return E(E({},t),{},{values:z(f,a,t)})})),y=function(t,e,i,s){var n={};return t&&t.forEach((function(t){var r=t.channels,a=t.samplers;r.forEach((function(t){var r=t.target,o=t.sampler,h=a[o],u=h.input,c=h.output,l=h.interpolation,d=i[u],f=i[c],v=r.node,p=r.path,y=e[v],m=j(f.type);y[p]?m=y[p].length:y.mesh&&s[y.mesh][p]?m=s[y.mesh][p].length:"scale"===p&&(m=3);var k=Object(P.chunkArray)(f.values,m),b={path:p,times:d.values,output:k,interpolation:l};n[v]=n[v]?[].concat(g()(n[v]),[b]):[b]}))})),n}(s,u,v,c);Object.keys(y).forEach((function(t){u[t].animations=y[t]}));var k=function(t,e,i){var s=null;if(t){var n=e.map((function(t,e){return E(E({},t),{},{id:e})}));s=t.map((function(t){var e=t.inverseBindMatrices,s=t.joints,r=[];if(e){var a=i[e].values;r=Object(P.chunkArray)(a,16)}if(s){for(var o=s.map((function(t,e){return E(E({},n[t]),{},{invMatrix:r[e]})})).slice(),h=[];0!==o.length;){var u=o.shift();u.children&&(u.children=U(u.children,o)),u.id;var c=p()(u,["id"]);h.push(c)}return{joints:h}}return null})).filter((function(t){return t}))}return s}(h,u,v),b=c.map((function(t){var e=t.primitives,i=t.weights,s={primitives:I(e,v)};return i&&(s=E({weights:i},s)),s})),T=function(t,e,i,s){return t?t.map((function(t){var e=t.bufferView,n=t.mimeType,r=t.name,a=s[e];return{mimeType:n,name:r,data:S(i,a)}})):null}(d,0,f,a),x=l&&l.map((function(t){return L(t,T)}));this.data={},b&&(this.data.meshes=b),u&&(this.data.nodes=u.filter((function(t){return void 0!==t.mesh}))),k&&(this.data.skins=k),x&&(this.data.materials=x)}return a()(t,[{key:"get",value:function(){return this.data}}]),t}(),X=function(){function t(){n()(this,t),this.assets={textures:{},objets:{},materials:{},levels:{},gltfs:{},sounds:{}}}return a()(t,[{key:"get",value:function(e){var i=this,s=e.map((function(e){var i=t.getInfo(e);switch(i.ext){case"jpg":case"jpeg":case"png":case"bmp":return t.loadImage(e,i);case"obj":return t.load3dObj(e,i);case"gltf":return t.load3dGltf(e,i);case"mtl":return t.loadMaterial(e,i);case"mp3":return t.loadSound(e,i);default:return null}}));return Promise.all(s).then((function(t){return t.forEach((function(t){switch(t.info.ext){case"jpg":case"jpeg":case"png":i.assets.textures[t.info.name]=t.data;break;case"bmp":i.assets.levels[t.info.name]=t.data;break;case"obj":i.assets.objets[t.info.name]=t.data;break;case"gltf":i.assets.gltfs[t.info.name]=t.data;break;case"mtl":i.assets.materials[t.info.name]=t.data;break;case"mp3":i.assets.sounds[t.info.name]=t.data}})),i.assets}))}}],[{key:"getInfo",value:function(t){var e=t.substring(t.lastIndexOf("/")+1,t.length).split(".");return{name:e[0],ext:e[1].toLowerCase()}}},{key:"loadMaterial",value:function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new d(t).get(),info:e}}))}},{key:"loadImage",value:function(t,e){return new Promise((function(i,s){var n=new Image;n.onload=function(){return i({data:n,info:e})},n.onerror=s,n.src=t}))}},{key:"loadSound",value:function(t,e){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,info:e}}))}}]),t}();h()(X,"load3dObj",(function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new l(t).get(),info:e}}))})),h()(X,"load3dGltf",(function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new N(t).get(),info:e}}))}));e.a=X},153:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(0),h=i.n(o),u=function(){function t(e){var i=this;n()(this,t),h()(this,"enter",(function(){i.support&&(i.isFullscreen=!0,i.domItem.requestFullscreen?i.domItem.requestFullscreen():i.domItem.msRequestFullscreen?i.domItem.msRequestFullscreen():i.domItem.mozRequestFullScreen?i.domItem.mozRequestFullScreen():i.domItem.webkitRequestFullscreen&&i.domItem.webkitRequestFullscreen())})),h()(this,"exit",(function(){i.support&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())})),h()(this,"listen",(function(){i.support&&(document.exitFullscreen?document.addEventListener("fullscreenchange",i.onChange,!1):document.msExitFullscreen?document.addEventListener("MSFullscreenChange",i.onChange,!1):document.mozCancelFullScreen?document.addEventListener("mozfullscreenchange",i.onChange,!1):document.webkitExitFullscreen&&document.addEventListener("webkitfullscreenchange",i.onChange,!1))})),h()(this,"onChange",(function(){i.domItem&&(i.isOnFullscreen()?(i.domItem.setAttribute("data-fullscreen",!0),i.isFullscreen=!0):(i.domItem.removeAttribute("data-fullscreen"),i.isFullscreen=!1))})),h()(this,"isOnFullscreen",(function(){return!!document.fullscreenElement})),h()(this,"toggle",(function(){i.isFullscreen?i.exit():i.enter()})),h()(this,"getButton",(function(){return i.button})),this.domItem=e,this.isFullscreen=!1,this.support=!!(document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen),this.button=document.createElement("button"),this.button.id="fullscreen-toggle-btn",this.button.innerHTML='\n<svg viewbox="0 0 100 100">\n  <path d="M 0 40 L 0 0 L 40 0 L 40 10 L 10 10 L 10 40 Z"></path>\n  <path d="M 60 100 L 100 100 L 100 60 L 90 60 L 90 90 L 60 90 Z"></path>\n</svg>\n    ',this.button.addEventListener("click",this.toggle,!1),this.listen()}return a()(t,[{key:"destroy",value:function(){this.button&&this.button.removeEventListener("click",this.toggle,!1),this.support&&(document.exitFullscreen?document.removeEventListener("fullscreenchange",this.onExit,!1):document.msExitFullscreen?document.removeEventListener("MSFullscreenChange",this.onExit,!1):document.mozCancelFullScreen?document.removeEventListener("mozfullscreenchange",this.onExit,!1):document.webkitExitFullscreen&&document.removeEventListener("webkitfullscreenchange",this.onExit,!1))}},{key:"get",value:function(){return this.isFullscreen}},{key:"getSupport",value:function(){return this.support}}]),t}();function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){h()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var d=function(){function t(e,i){var s=this;n()(this,t),h()(this,"getDomItem",(function(){return s.controlsDomItem})),h()(this,"getRanges",(function(){return s.ranges})),this.controlsDomItem=document.createElement("div"),this.controlsDomItem.id="controls",this.controlsDomItem.style.opacity=0;var r=i.fullscreen,a=i.ranges;a&&(this.ranges=Object.keys(a).reduce((function(t,e){var i=a[e],n=i.min,r=void 0===n?0:n,o=i.max,u=void 0===o?100:o,c=i.value,d=void 0===c?0:c,f=document.createElement("input");return f.setAttribute("type","range"),f.setAttribute("id",e),f.setAttribute("min",r),f.setAttribute("max",u),f.setAttribute("value",d),s.controlsDomItem.appendChild(f),l(l({},t),{},h()({},e,{id:e,min:r,max:u,value:d,dom:f}))}),{})),r&&(this.fullscreen=new u(e),this.controlsDomItem.appendChild(this.fullscreen.getButton()))}return a()(t,[{key:"destroy",value:function(){this.fullscreen&&this.fullscreen.destroy()}}]),t}()},19:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(53),h=i(25),u=i(117),c=function(){function t(){n()(this,t),this.d=new Array(16),this.sauvegardePrecedente=[],this.empilement=0,this.init()}return a()(t,[{key:"init",value:function(){return this.reset(),this.sauvegardePrecedente=[],this.empilement=0,this}},{key:"reset",value:function(){for(var t=0;t<16;t+=1)this.d[t]=0;return this}},{key:"get",value:function(){return this.d}},{key:"setRaw",value:function(t){this.d=t}},{key:"set",value:function(t,e,i,s,n,r,a,o,h,u,c,l,d,f,g,v){return this.d[0]=t,this.d[1]=e,this.d[2]=i,this.d[3]=s,this.d[4]=n,this.d[5]=r,this.d[6]=a,this.d[7]=o,this.d[8]=h,this.d[9]=u,this.d[10]=c,this.d[11]=l,this.d[12]=d,this.d[13]=f,this.d[14]=g,this.d[15]=v,this}},{key:"setFromArray",value:function(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}},{key:"getMatrice3x3",value:function(){var t=new u.a;return t.set(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),t}},{key:"multiplyArray",value:function(e){var i=new t;return i.setFromArray(e),this.multiply(i)}},{key:"multiply",value:function(e){for(var i=new t,s=0;s<4;s+=1)for(var n=0;n<4;n+=1)for(var r=0;r<4;r+=1)i.d[4*n+s]+=this.d[4*n+r]*e.d[4*r+s];return this.d=i.d,this}},{key:"equal",value:function(t){for(var e=0;e<16;e+=1)this.d[e]=t.d[e],this.sauvegardePrecedente[e]=t.sauvegardePrecedente[e];return this}},{key:"push",value:function(){this.empilement+=1;for(var t=0,e=16*(this.empilement-1);e<16*this.empilement;e+=1)this.sauvegardePrecedente[e]=this.d[t],t+=1;return this}},{key:"pop",value:function(){if(this.empilement>0){for(var t=0,e=16*(this.empilement-1);e<16*this.empilement;e+=1)this.d[t]=this.sauvegardePrecedente[e],this.sauvegardePrecedente[e]=null,t+=1;this.empilement-=1}return this}},{key:"translate",value:function(e,i,s){var n=new t;return n.identity(),n.d[12]=e,n.d[13]=i,n.d[14]=s,this.multiply(n),this}},{key:"scale",value:function(e,i,s){var n=new t;return n.d[0]=e,n.d[5]=void 0===i?e:i,n.d[10]=void 0===s?e:s,n.d[15]=1,this.multiply(n),this}},{key:"resetScale",value:function(){return this.d[0]=1,this.d[5]=1,this.d[10]=1,this}},{key:"resetTranslate",value:function(){return this.d[12]=0,this.d[13]=0,this.d[14]=0,this}},{key:"rotate",value:function(e,i,s,n){var r=new t,a=e*(Math.PI/180),o=new h.a(i,s,n);return o.normalise(),r.d[0]=o.d[0]*o.d[0]*(1-Math.cos(a))+Math.cos(a),r.d[1]=o.d[0]*o.d[1]*(1-Math.cos(a))-o.d[2]*Math.sin(a),r.d[2]=o.d[0]*o.d[2]*(1-Math.cos(a))+o.d[1]*Math.sin(a),r.d[4]=o.d[0]*o.d[1]*(1-Math.cos(a))+o.d[2]*Math.sin(a),r.d[5]=o.d[1]*o.d[1]*(1-Math.cos(a))+Math.cos(a),r.d[6]=o.d[1]*o.d[2]*(1-Math.cos(a))-o.d[0]*Math.sin(a),r.d[8]=o.d[0]*o.d[2]*(1-Math.cos(a))-o.d[1]*Math.sin(a),r.d[9]=o.d[1]*o.d[2]*(1-Math.cos(a))+o.d[0]*Math.sin(a),r.d[10]=o.d[2]*o.d[2]*(1-Math.cos(a))+Math.cos(a),r.d[15]=1,this.multiply(r),this}},{key:"identity",value:function(){return this.init(),this.d[0]=1,this.d[5]=1,this.d[10]=1,this.d[15]=1,this}},{key:"perspective",value:function(t,e,i,s){var n=t*(Math.PI/180),r=1/Math.tan(n/2),a=1/(i-s);return this.set(r/e,0,0,0,0,r,0,0,0,0,(i+s)*a,-1,0,0,i*s*a*2,0),this}},{key:"ortho",value:function(t,e,i,s,n,r){return this.set(2/(e-t),0,0,0,0,2/(s-i),0,0,0,0,-2/(r-n),0,-(e+t)/(e-t),-(s+i)/(s-i),-(r+n)/(r-n),1),this}},{key:"lookAt",value:function(t,e,i,s,n,r,a,h,u){var c,l,d,f,g,v,p,y,m,k,b=t,T=e,P=i,x=a,E=h,w=u,M=s,R=n,F=r;return Math.abs(b-M)<o.a&&Math.abs(T-R)<o.a&&Math.abs(P-F)<o.a?(this.identity(),this):(p=b-M,y=T-R,m=P-F,c=E*(m*=k=1/Math.sqrt(p*p+y*y+m*m))-w*(y*=k),l=w*(p*=k)-x*m,d=x*y-E*p,(k=Math.sqrt(c*c+l*l+d*d))?(c*=k=1/k,l*=k,d*=k):(c=0,l=0,d=0),f=y*d-m*l,g=m*c-p*d,v=p*l-y*c,(k=Math.sqrt(f*f+g*g+v*v))?(f*=k=1/k,g*=k,v*=k):(f=0,g=0,v=0),this.set(c,f,p,0,l,g,y,0,d,v,m,0,-(c*b+l*T+d*P),-(f*b+g*T+v*P),-(p*b+y*T+m*P),1),this)}},{key:"transpose",value:function(){return this.setFromArray(t.transpose(this.d))}},{key:"inverse",value:function(){var e=t.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),i=t.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),s=t.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),n=t.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),r=this.d[0]*e-this.d[1]*i+this.d[2]*s-this.d[3]*n,a=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),o=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),h=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),u=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),c=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[13],this.d[14],this.d[15]),l=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[12],this.d[14],this.d[15]),d=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[12],this.d[13],this.d[15]),f=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[12],this.d[13],this.d[14]),g=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11]),v=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11]),p=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11]),y=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),m=1/r;return this.d[0]=m*e,this.d[1]=-m*a,this.d[2]=m*c,this.d[3]=-m*g,this.d[4]=-m*i,this.d[5]=m*o,this.d[6]=-m*l,this.d[7]=m*v,this.d[8]=m*s,this.d[9]=-m*h,this.d[10]=m*d,this.d[11]=-m*p,this.d[12]=-m*n,this.d[13]=m*u,this.d[14]=-m*f,this.d[15]=m*y,this}},{key:"getDeterminant",value:function(){return this.d[0]*t.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15])-this.d[1]*t.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15])+this.d[2]*t.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15])-this.d[3]*t.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14])}}],[{key:"transpose",value:function(t){for(var e=new Float32Array(16),i=0,s=0;s<4;s+=1)for(var n=0;n<4;n+=1)e[i]=t[4*n+s],i+=1;return e}},{key:"getCofacteur",value:function(t,e,i,s,n,r,a,o,h){return t*(n*h-r*o)-e*(s*h-r*a)+i*(s*o-n*a)}}]),t}();e.a=c},25:function(t,e,i){"use strict";var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=i(29),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n()(this,t),this.d=[0,0,0],this.set(e,i,s)}return a()(t,[{key:"normalise",value:function(){var t=this.length();return 0!==t&&(this.d[0]/=t,this.d[1]/=t,this.d[2]/=t),this}},{key:"get",value:function(){return this.d}},{key:"getX",value:function(){return this.d[0]}},{key:"getY",value:function(){return this.d[1]}},{key:"getZ",value:function(){return this.d[2]}},{key:"set",value:function(t,e,i){return null!==t&&(this.d[0]=t),null!==e?this.d[1]=e:null!==t&&(this.d[1]=t),null!==i?this.d[2]=i:null!==t&&(this.d[2]=t),this}},{key:"setX",value:function(t){this.d[0]=t}},{key:"setY",value:function(t){this.d[1]=t}},{key:"setZ",value:function(t){this.d[2]=t}},{key:"addXYZ",value:function(t,e,i){return this.d[0]+=t,this.d[1]+=e,this.d[2]+=i,this}},{key:"addX",value:function(t){return this.d[0]+=t,this}},{key:"addY",value:function(t){return this.d[1]+=t,this}},{key:"addZ",value:function(t){return this.d[2]+=t,this}},{key:"multiplyX",value:function(t){return this.d[0]*=t,this}},{key:"multiplyY",value:function(t){return this.d[1]*=t,this}},{key:"multiplyZ",value:function(t){return this.d[2]*=t,this}},{key:"limiter",value:function(t){var e=this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2];if(e>t*t&&e>0){var i=t/Math.sqrt(e);this.d[0]*=i,this.d[1]*=i,this.d[2]*=i}return this}},{key:"cross",value:function(e){return new t(this.d[1]*e.d[2]-this.d[2]*e.d[1],this.d[2]*e.d[0]-this.d[0]*e.d[2],this.d[0]*e.d[1]-this.d[1]*e.d[0])}},{key:"dot",value:function(t){return this.d[0]*t.d[0]+this.d[1]*t.d[1]+this.d[2]*t.d[2]}},{key:"length",value:function(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2])}},{key:"directionVers",value:function(t){return this.d[0]=t.d[0]-this.d[0],this.d[1]=t.d[1]-this.d[1],this.d[2]=t.d[2]-this.d[2],this}},{key:"equal",value:function(t){return this.d=[t.d[0],t.d[1],t.d[2]],this}},{key:"add",value:function(t){return this.d[0]+=t.d[0],this.d[1]+=t.d[1],this.d[2]+=t.d[2],this}},{key:"addNumber",value:function(t){return this.d[0]+=t,this.d[1]+=t,this.d[2]+=t,this}},{key:"minus",value:function(t){return this.d[0]-=t.d[0],this.d[1]-=t.d[1],this.d[2]-=t.d[2],this}},{key:"minusNumber",value:function(t){return this.d[0]-=t,this.d[1]-=t,this.d[2]-=t,this}},{key:"multiplyNumber",value:function(t){return this.d[0]*=t,this.d[1]*=t,this.d[2]*=t,this}},{key:"multiplyMatrix",value:function(t){return this.set(t.d[0]*this.d[0]+t.d[1]*this.d[1]+t.d[2]*this.d[2],t.d[3]*this.d[0]+t.d[4]*this.d[1]+t.d[5]*this.d[2],t.d[6]*this.d[0]+t.d[7]*this.d[1]+t.d[8]*this.d[2]),this}},{key:"multiply",value:function(t){return this.d[0]*=t.d[0],this.d[1]*=t.d[1],this.d[2]*=t.d[2],this}},{key:"divideNumber",value:function(t){return this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this}},{key:"divide",value:function(t){return this.d[0]/=t.d[0],this.d[1]/=t.d[1],this.d[2]/=t.d[2],this}},{key:"distance",value:function(t){return Math.sqrt((t.d[0]-this.d[0])*(t.d[0]-this.d[0])+(t.d[1]-this.d[1])*(t.d[1]-this.d[1])+(t.d[2]-this.d[2])*(t.d[2]-this.d[2]))}},{key:"angleDegree",value:function(t){var e=this.dot(t)/(this.length()*t.length());return 180*Math.acos(e)/Math.PI*-Object(o.d)(this.d[0]*t.d[1]+this.d[1]*t.d[0])}},{key:"computeNormal",value:function(e,i,s){var n=new t,r=new t,a=new t;return r.equal(e.minus(this)),a.equal(i.minus(this)),s?n.equal(a.cross(r)):n.equal(r.cross(a)),n.normalise(),n}}],[{key:"getBarycentre",value:function(t,e,i,s){var n=(e.d[2]-i.d[2])*(t.d[0]-i.d[0])+(i.d[0]-e.d[0])*(t.d[2]-i.d[2]),r=((e.d[2]-i.d[2])*(s[0]-i.d[0])+(i.d[0]-e.d[0])*(s[1]-i.d[2]))/n,a=((i.d[2]-t.d[2])*(s[0]-i.d[0])+(t.d[0]-i.d[0])*(s[1]-i.d[2]))/n,o=1-r-a;return r*t.d[1]+a*e.d[1]+o*i.d[1]}},{key:"lerp",value:function(e,i,s){var n=e.d[0],r=e.d[1],a=e.d[2];return new t(n+s*(i.d[0]-n),r+s*(i.d[1]-r),a+s*(i.d[2]-a))}}]),t}();e.a=h},29:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return r})),i.d(e,"d",(function(){return a}));var s=function(t){return Math.PI*t/180},n=function(t,e){return Math.random()*(e-t)+t},r=function(t,e,i,s,n){var r=s+(t-e)*(n-s)/(i-e);return r<Math.min(s,n)&&(r=Math.min(s,n)),r>Math.max(s,n)&&(r=Math.max(s,n)),r},a=function(t){return 0===t?0:t>0?1:-1}},35:function(t,e,i){"use strict";var s=i(48),n=i.n(s),r=i(1),a=i.n(r),o=i(2),h=i.n(o),u=i(25),c=i(19),l=i(53),d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a()(this,t),this.x=e,this.y=i,this.z=s,this.w=n}return h()(t,[{key:"set",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}},{key:"setFromAxeAndAngle",value:function(t,e){var i=n()(t,3),s=i[0],r=i[1],a=i[2];return this.x=s,this.y=r,this.z=a,this.w=e,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}},{key:"approx",value:function(t,e){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e&&Math.abs(this.z-t.z)<=e&&Math.abs(this.w-t.w)<=e}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}},{key:"multiplyArray",value:function(t){var e=this.x,i=this.y,s=this.z,n=this.w,r=t[0],a=t[1],o=t[2],h=t[3];return this.x=e*h+n*r+i*o-s*a,this.y=i*h+n*a+s*r-e*o,this.z=s*h+n*o+e*a-i*r,this.w=n*h-e*r-i*a-s*o,this}},{key:"multiply",value:function(t){var e=this.x,i=this.y,s=this.z,n=this.w,r=t.x,a=t.y,o=t.z,h=t.w;return this.x=e*h+n*r+i*o-s*a,this.y=i*h+n*a+s*r-e*o,this.z=s*h+n*o+e*a-i*r,this.w=n*h-e*r-i*a-s*o,this}},{key:"multiplyVector",value:function(t){var e=this.w*t.x+this.y*t.z-this.z*t.y,i=this.w*t.y+this.z*t.x-this.x*t.z,s=this.w*t.z+this.x*t.y-this.y*t.x,n=-this.x*t.x-this.y*t.y-this.z*t.z,r=e*this.w+n*-this.x+i*-this.z-s*-this.y,a=i*this.w+n*-this.y+s*-this.x-e*-this.z,o=s*this.w+n*-this.z+e*-this.y-i*-this.x;return new u.a(r,a,o)}},{key:"normalize",value:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return 0!==t&&1!==t&&(t=1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}},{key:"rotateX",value:function(t){var e=.5*t,i=this.x,s=this.y,n=this.z,r=this.w,a=Math.sin(e),o=Math.cos(e);return this.x=i*o+r*a,this.y=s*o+n*a,this.z=n*o-s*a,this.w=r*o-i*a,this}},{key:"rotateY",value:function(t){var e=.5*t,i=this.x,s=this.y,n=this.z,r=this.w,a=Math.sin(e),o=Math.cos(e);return this.x=i*o-n*a,this.y=s*o+r*a,this.z=n*o+i*a,this.w=r*o-s*a,this}},{key:"rotateZ",value:function(t){var e=.5*t,i=this.x,s=this.y,n=this.z,r=this.w,a=Math.sin(e),o=Math.cos(e);return this.x=i*o+s*a,this.y=s*o-i*a,this.z=n*o+r*a,this.w=r*o-n*a,this}},{key:"scale",value:function(t){var e=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return 0===e?this:1===e?(this.x*=t,this.y*=t,this.z*=t,this.w*=t,this):(e=t/Math.sqrt(e),this.x*=e,this.y*=e,this.z*=e,this.w*=e,this)}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}},{key:"slerp",value:function(t,e,i){var s,n,r,a,o,h=t.x,u=t.y,c=t.z,d=t.w,f=e.x,g=e.y,v=e.z,p=e.w;return(n=h*f+u*g+c*v+d*p)<0&&(n=-n,f=-f,g=-g,v=-v,p=-p),1-n>l.a?(s=Math.acos(n),r=Math.sin(s),a=Math.sin((1-i)*s)/r,o=Math.sin(i*s)/r):(a=1-i,o=i),this.x=a*h+o*f,this.y=a*u+o*g,this.z=a*c+o*v,this.w=a*d+o*p,this}},{key:"toMatrix4",value:function(){var t=this.w*this.w,e=this.x*this.x,i=this.y*this.y,s=this.z*this.z,n=1/(e+i+s+t),r=(e-i-s+t)*n,a=(-e+i-s+t)*n,o=(-e-i+s+t)*n,h=this.x*this.y,u=this.z*this.w,l=2*(h+u)*n,d=2*(h-u)*n,f=2*((h=this.x*this.z)-(u=this.y*this.w))*n,g=2*(h+u)*n,v=2*((h=this.y*this.z)+(u=this.x*this.w))*n,p=2*(h-u)*n;return(new c.a).set(r,l,f,0,d,a,v,0,g,p,o,0,0,0,0,1)}},{key:"setFromMat3",value:function(t){var e=t.get(),i=e[0],s=e[1],n=e[2],r=e[3],a=e[4],o=e[5],h=e[6],u=e[7],c=e[8];return this.w=.5*Math.sqrt(Math.max(0,1+i+a+c)),this.x=.5*Math.sqrt(Math.max(0,1+i-a-c)),this.y=.5*Math.sqrt(Math.max(0,1-i+a-c)),this.z=.5*Math.sqrt(Math.max(0,1-i-a+c)),this.x*=Math.sign(o-u),this.y*=Math.sign(h-n),this.z*=Math.sign(s-r),this}},{key:"get",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getZ",value:function(){return this.z}},{key:"getW",value:function(){return this.w}}],[{key:"slerpArray",value:function(e,i,s){var n=new t(e[0],e[1],e[2],e[3]),r=new t(i[0],i[1],i[2],i[3]);return new t(0,0,0,1).slerp(n,r,s)}}]),t}();e.a=d},385:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return r}));var s=i(29),n=function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.startX,r=void 0===n?-1:n,a=i.endX,o=void 0===a?1:a,h=i.startZ,u=void 0===h?-1:h,c=i.endZ,l=void 0===c?1:c,d=[],f=0;f<e;f++)for(var g=0;g<t;g++){var v=Object(s.b)(g,0,t-1,r,o),p=Object(s.b)(f,0,e-1,u,l);d.push(v),d.push(0),d.push(p)}return d},r=function(t,e){for(var i=[],s=0;s<e-1;s++)for(var n=0;n<t-1;n++){var r=s*t+n;i.push(r),i.push(t+r),i.push(r+1),i.push(t+r),i.push(t+r+1),i.push(r+1)}return i}},52:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.04;n()(this,t),this.value=e,this.target=e,this.sampling=i,this.threshold=1e-6}return a()(t,[{key:"update",value:function(){Math.abs(this.value-this.target)>this.threshold?this.value+=(this.target-this.value)*this.sampling:this.value=this.target}},{key:"get",value:function(){return this.value}},{key:"set",value:function(t){this.target=t}},{key:"setDirect",value:function(t){this.value=t}}]),t}()},54:function(t,e,i){"use strict";i.r(e),i.d(e,"chunkArray",(function(){return s})),i.d(e,"capitalize",(function(){return n})),i.d(e,"getEnvPath",(function(){return r}));var s=function(t,e){return Array.from({length:Math.ceil(t.length/e)},(function(i,s){return t.slice(s*e,s*e+e)}))},n=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},r=function(t){return"".concat("/public").concat(t)}},545:function(t,e,i){var s=i(99),n=i(546);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[t.i,n,""]]);var r={insert:"head",singleton:!1};s(n,r);t.exports=n.locals||{}},546:function(t,e,i){"use strict";i.r(e);var s=i(60),n=i.n(s)()(!1);n.push([t.i,"#race {\n  position: relative;\n  width: 100%;\n  height: auto;\n}\n\n#race canvas {\n  margin: 0 auto;\n  width: 100%;\n}\n",""]),e.default=n},57:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i(1),n=i.n(s),r=i(2),a=i.n(r),o=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64;n()(this,t),this.gl=e,this.size={width:i,height:s},this.texture=e.createTexture(),this.filter=e.NEAREST,this.setup()}return a()(t,[{key:"setup",value:function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.create(),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"create",value:function(){for(var t=new ArrayBuffer(this.size.width*this.size.height),e=new Uint8Array(t),i=0,s=0;s<this.size.height;s+=1)for(var n=0;n<this.size.width;n+=1)e[i]=255*Math.random(),i+=1;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.ALPHA,this.size.width,this.size.height,0,this.gl.ALPHA,this.gl.UNSIGNED_BYTE,e)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}},{key:"get",value:function(){return this.texture}},{key:"setFiltre",value:function(t){this.filter=t}}]),t}()},746:function(t,e,i){"use strict";i.r(e),i.d(e,"destroy",(function(){return N}));var s=i(43),n=i.n(s),r=i(61),a=i.n(r),o=i(130),h=i(46),u=i.n(h),c=i(27),l=i.n(c),d=i(1),f=i.n(d),g=i(2),v=i.n(g),p=i(10),y=i.n(p),m=i(22),k=i.n(m),b=i(7),T=i.n(b),P=i(8),x=i.n(P),E=i(3),w=i.n(E),M=i(0),R=i.n(M),F=i(132),D=i(116),A=i(73),O=i(19),j=i(25),z=i(385),S=i(52);i(121);function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,s=w()(t);if(e){var n=w()(this).constructor;i=Reflect.construct(s,arguments,n)}else i=s.apply(this,arguments);return x()(this,i)}}var C=function(t){return.5*Math.sin(t)+.5},L=function(t){T()(i,t);var e=_(i);function i(t,s,n){var r;f()(this,i),r=e.call(this,t,s,n),R()(y()(r),"getDistPos",(function(t){var e,i,s,n,a,o=r.config,h=o.roadAmplitude,c=o.roadLength,d=o.roadFrequence;return u()(j.a,l()((e=t/c,i=d,s=h,n=r.posTime,a=.02,[Math.cos(e*Math.PI*i[0]+n)*s[0]-Math.cos(a*Math.PI*i[0]+n)*s[0],C(e*Math.PI*i[1]+n)*s[1]-C(a*Math.PI*i[1]+n)*s[1],C(e*Math.PI*i[2]+n)*s[2]-C(a*Math.PI*i[2]+n)*s[2]])))})),R()(y()(r),"updateCamera",(function(){var t=r.config,e=t.roadLength,i=t.camera,s=r.getDistPos(100),n=r.getDistPos(0);r.camera.setTarget(s.getX(),i.position.y+s.getY(),e),r.camera.setPosition(n.getX(),i.position.y+n.getY(),0)})),R()(y()(r),"moveShip",(function(){r.targetPosX.update(),r.targetSpeed.update(),r.posTime+=r.targetSpeed.get();var t=r.getDistPos(r.shipPos.getZ());r.currentShipPos.equal(t).add(r.shipPos).addX(r.targetPosX.get())})),R()(y()(r),"renderMountain",(function(){var t=r.config,e=t.roadAmplitude,i=t.roadLength,s=t.roadWidth,n=t.roadFrequence,a=r.mngProg.get("roadmountain");a.setProjectionView(r.camera),a.setMatrix("model",r.model.get()),a.setFloat("time",r.posTime),a.setVector("frequence",n),a.setVector("amplitude",e),a.setFloat("roadWidth",s),a.setFloat("roadLength",i),r.mountainVbo.render(a.get())})),R()(y()(r),"renderRoad",(function(){var t=r.config,e=t.roadAmplitude,i=t.roadLength,s=t.roadWidth,n=t.roadFrequence,a=r.mngProg.get("road");a.setProjectionView(r.camera),a.setMatrix("model",r.model.get()),a.setFloat("time",r.posTime),a.setVector("frequence",n),a.setVector("amplitude",e),a.setFloat("roadWidth",s),a.setFloat("roadLength",i),r.roadVbo.render(a.get())})),R()(y()(r),"renderShip",(function(){var t,e=r.mngProg.get("gltf"),i=r.mngGltf.get("raceship");r.model.push(),(t=r.model).translate.apply(t,l()(r.currentShipPos.get())),i.render(e,r.model),r.model.pop()})),R()(y()(r),"renderShipTrails",(function(){var t,e=r.mngProg.get("gltf"),i=r.mngGltf.get("raceship");r.model.push(),(t=r.model).translate.apply(t,l()(r.currentShipPos.get())),i.renderNode("trail1",e,r.model),i.renderNode("trail2",e,r.model),r.model.pop()})),R()(y()(r),"interactShip",(function(t){var e=r.config.roadWidth;r.targetSpeed.set(.1),r.targetPosX.set(-t.rel.x*e*.6)})),R()(y()(r),"onMouseDrag",(function(t){r.interactShip(t)})),R()(y()(r),"onMouseDown",(function(t){r.interactShip(t)})),R()(y()(r),"onMouseUp",(function(){r.targetSpeed.set(0)})),r.screen=new D.a(r.gl),r.model=new O.a;var a=s.roadLength,o=s.roadWidth,h=s.shipPosition,c=Object(z.b)(2,a,{startX:-o,endX:o,startZ:0,endZ:a}),d=Object(z.b)(120,a,{startX:-120,endX:120,startZ:0,endZ:a}),g=Object(z.a)(2,a);r.roadVbo=new A.a(t,{position:c,indices:g});var v=Object(z.a)(120,a);return r.mountainVbo=new A.a(t,{position:d,indices:v}),r.shipPos=u()(j.a,l()(h)),r.currentShipPos=new j.a(0),r.targetPosX=new S.a(0,.1),r.targetSpeed=new S.a(0,.1),r.posTime=0,r.setLampeInfos(r.mngProg.get("gltf")),r.mngProg.get("roadSky").setTexture(1,r.mngTex.get("noisergb").get(),"textureMap"),r}return v()(i,[{key:"update",value:function(t){k()(w()(i.prototype),"update",this).call(this,t),this.model.identity(),this.moveShip(),this.updateTrails(),this.updateCamera(),this.mngGltf.get("raceship").update(t)}},{key:"updateTrails",value:function(){var t=this.mngProg.get("gltf"),e=this.mngGltf.get("raceship");t.setProjectionView(this.camera),e.setAnimationStep("trail1","scale",10*this.targetSpeed.get()),e.setAnimationStep("trail2","scale",10*this.targetSpeed.get())}},{key:"renderLandscape",value:function(){this.gl.disable(this.gl.DEPTH_TEST);var t=this.mngProg.get("roadSky");t.setFloat("flipY",-1),t.setFloat("time",.1*this.time),t.setVector("wind",[.1,.2]),this.screen.render(t.get()),this.gl.enable(this.gl.DEPTH_TEST)}},{key:"render",value:function(){k()(w()(i.prototype),"render",this).call(this),this.postProcess.start(),this.renderMountain(),this.renderRoad(),this.renderShip(),this.postProcess.end(),this.bloom.start(),this.renderShipTrails(),this.bloom.end(),this.bloom.setBloom(1,.1),this.postProcess.mergeBloom(this.bloom.getTexture(),1.5,2.2),this.postProcess.setFxaa2(),this.postProcess.render()}}]),i}(F.a),I={slug:"race",assets:["/textures/noisergb.png","/gltf/raceship.gltf"],shaders:["/camera/road.js","/camera/gltf.js","/camera/roadmountain.js","/camera/basique3d.js","/sky/roadSky.js","/camera/gltf.js","/screen/screen.js","/screen/debug.js","/screen/blurOnePass.js","/screen/bloom.js","/screen/mergeBloom.js","/screen/fxaa.js","/screen/fxaa2.js"],useDepthTexture:!0,postprocess:{bloom:{intensity:1}},textures:{noisergb:"LINEAR"},canvas:{width:1024,height:512},mouse:{events:["down","up","drag"]},camera:{position:{x:0,y:4,z:0},target:{x:0,y:0,z:128},near:1,far:200,angle:90},lampes:[{type:0,position:{x:0,y:3,z:3},ambiant:[1,1,1],diffuse:[.8,.6,.5],specular:[1,.8,.7],brillance:1,strength:40}],controls:{fullscreen:{buttonId:"fullscreen-toggle-btn"}},roadFrequence:[2,0,2],roadAmplitude:[10,0,4],roadLength:128,roadWidth:8,shipPosition:[0,2,3]},U=(i(351),i(353),i(545),null),N=(e.default=a()(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return U=new o.a,t.next=3,U.setup(L,I);case 3:document.querySelector("#".concat(I.slug)).appendChild(U.getCanvas());case 5:case"end":return t.stop()}}),t)}))),function(){U&&U.destroy&&U.destroy()})},87:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var s=function(t,e,i){return(1-t)*e+t*i}},88:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var s=i(0),n=i.n(s),r=i(1),a=i.n(r),o=i(2),h=i.n(o),u=function(){function t(e,i){a()(this,t),this.gl=e,i&&this.create(i)}return h()(t,[{key:"create",value:function(t){var e=t.locationKey,i=t.type,s=t.values,n=t.count,r=t.componentType,a=t.size,o=t.modeCalcul,h="SCALAR"!==i?this.gl.ARRAY_BUFFER:this.gl.ELEMENT_ARRAY_BUFFER;this.vbo=this.gl.createBuffer(),this.gl.bindBuffer(h,this.vbo),this.gl.bufferData(h,s,o),this.gl.bindBuffer(h,null),this.size=a,this.count=n,this.componentType=r,this.bufferType=h,this.locationKey=e}},{key:"enable",value:function(t){var e=this.locationKey,i=this.vbo,s=this.componentType,n=this.size,r=this.bufferType;if("indices"===e)this.gl.bindBuffer(r,i);else{var a=t.locations[e];void 0!==a&&-1!==a&&(this.gl.bindBuffer(r,i),this.gl.enableVertexAttribArray(a),this.gl.vertexAttribPointer(a,n,s,!1,0,0))}}},{key:"start",value:function(t){this.gl.useProgram(t)}},{key:"end",value:function(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}},{key:"update",value:function(t){this.gl.bindBuffer(this.bufferType,this.vbo),this.gl.bufferSubData(this.bufferType,0,new Float32Array(t)),this.gl.bindBuffer(this.bufferType,null)}},{key:"render",value:function(t,e){"indices"===this.locationKey?this.gl.drawElements(e,this.count,this.componentType,0):this.gl.drawArrays(e,0,this.count)}},{key:"getCount",value:function(){return this.count}}]),t}();function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,s)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){n()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var d=function(){function t(e,i){var s=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a()(this,t),this.gl=e,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=n?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,this.vbos=Object.keys(i).reduce((function(t,n){return t[n]=new u(e,l({locationKey:n,modeCalcul:s.modeCalcul},i[n])),t}),{})}return h()(t,[{key:"enable",value:function(t){var e=this;this.gl.useProgram(t),Object.keys(this.vbos).forEach((function(i){e.vbos[i].enable(t)}))}},{key:"update",value:function(t){var e=this;Object.keys(t).forEach((function(i){e.vbos[i].update(t[i])}))}},{key:"render",value:function(t){this.enable(t);var e=this.vbos.indices||this.vbos.position||this.vbos.texture;e.render(t,this.modeDessin),e.end()}},{key:"setModeDessin",value:function(t){this.modeDessin=t}},{key:"setModeCalcul",value:function(t){this.modeCalcul=t}}]),t}()}}]);