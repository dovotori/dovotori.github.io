(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[4716],{3957:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>S});s(50835);var n=s(59713),i=s.n(n),r=s(33559);var o=s(38853),a=s.n(o);var c=s(93379),h=s.n(c),l=s(7795),u=s.n(l),d=s(90569),f=s.n(d),m=s(3565),w=s.n(m),k=s(70609),p=s.n(k),y=s(44589),g=s.n(y),I=s(80668),C={};C.styleTagTransform=g(),C.setAttributes=w(),C.insert=f().bind(null,"head"),C.domAPI=u(),C.insertStyleElement=p();h()(I.Z,C);I.Z&&I.Z.locals&&I.Z.locals;const b=document.querySelector("#btn"),v=async t=>{const e=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((t=>t)).catch((t=>{}));if(e){t.setStream(e);const s=document.querySelector("#own");s.srcObject=e,s.play()}else b.innerHTML="Can't access your webcam. Retry"},T=async t=>{const e=new class{constructor(){var t=this;i()(this,"create",(()=>new Promise(((t,e)=>{this.socket=(0,r.ZP)("http://localhost:8083"),this.socket.on("connect_error",(t=>{this.socket.disconnect(),e(t)})),this.socket.on("connect",(()=>{t(this)}))})))),i()(this,"on",(function(){return t.socket.on(...arguments)})),i()(this,"emit",(function(){return t.socket.emit(...arguments)})),i()(this,"reconnect",(()=>(this.close(),new Promise(((t,e)=>{this.socket.connect(),this.socket.on("connect_error",(t=>{this.socket.close(),e(t)})),this.socket.on("connect",(()=>{t(this)}))}))))),i()(this,"close",(()=>{this.socket.connected&&this.socket.disconnect()})),i()(this,"isConnected",(()=>this.socket.connected)),this.socket=null}};await e.create();return t.setAsk((function(){return e.emit(...arguments)})),e.on("answer initiator",t.setIsInitiator),e.on("answer offer",t.setOffer),e.on("answer answer",t.setAnswer),e.emit("question initiator"),e},S=()=>{let t=null;b&&b.addEventListener("click",(async()=>{b.innerHTML="Loading";try{if(null===t){b.innerHTML="Please allow webcam access";const e=new class{constructor(){i()(this,"setSignal",(t=>{this.peer.signal(t)})),i()(this,"setAsk",(t=>{this.ask=t})),i()(this,"setStream",(t=>{this.stream=t,this.isCreated&&this.peer.addStream(this.stream)})),i()(this,"setAnswer",(t=>{this.answer=t,this.isInitiator&&this.isCreated&&this.peer.signal(this.answer)})),i()(this,"setOffer",(t=>{this.offer=t,this.tryToCreate()})),i()(this,"setIsInitiator",(t=>{this.isInitiator=t,this.tryToCreate()})),this.isInitiator=null,this.isConnected=!1,this.peer=null,this.stream=null,this.answer=null,this.offer=null,this.ask=null,this.isCreated=!1}tryToCreate(){this.isCreated||null===this.isInitiator||(this.isInitiator||!this.isInitiator&&this.offer)&&this.create()}create(){this.peer=new(a())({initiator:this.isInitiator,trickle:!1,stream:this.stream}),this.peer.on("error",(t=>{})),this.peer.on("signal",(t=>{this.isConnected||(this.isInitiator&&t.type&&"offer"===t.type?this.ask("question offer",t):!this.isInitiator&&t.type&&"answer"===t.type&&this.ask("question answer",t))})),this.peer.on("stream",(t=>{const e=document.querySelector("#emitter");e.srcObject=t,e.play()})),this.peer.on("connect",(()=>{this.isConnected=!0})),this.isInitiator||this.setSignal(this.offer),this.isCreated=!0}getIsInitiator(){return this.isInitiator}};await v(e),t=await T(e),b.innerHTML=e.getIsInitiator()?"Connected (wait for another connection)":"Wait you will join someone"}else t.close(),t=null,b.innerHTML="Join"}catch(t){b.innerHTML="Retry"}}),!1)}},80668:(t,e,s)=>{"use strict";s.d(e,{Z:()=>a});var n=s(8081),i=s.n(n),r=s(23645),o=s.n(r)()(i());o.push([t.id,"#labo {\n  position: relative;\n  width: 100%;\n  height: auto;\n  background-color: #222;\n  text-align: center;\n}\nvideo {\n  width: 50%;\n}\n.flex {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n#status {\n  width: 80%;\n  color: #fff;\n  margin: 0 auto;\n  padding: 1em;\n}\n#btn {\n  background: #fff;\n  width: 80%;\n  margin: 0 auto;\n  padding: 1em;\n  text-transform: uppercase;\n  letter-spacing: 0.2em;\n}\n",""]);const a=o},52361:()=>{},94616:()=>{}}]);