(window.webpackJsonp=window.webpackJsonp||[]).push([[166],{805:function(n,t,e){"use strict";e.r(t);var i=e(43),r=e.n(i),s=e(61),o=e.n(s),a=(e(859),e(1)),c=e.n(a),u=e(0),f=e.n(u),l=e(811),h=e.n(l),p=function n(){var t=this;c()(this,n),f()(this,"on",(function(){var n;return(n=t.socket).on.apply(n,arguments)})),f()(this,"emit",(function(){var n;return(n=t.socket).emit.apply(n,arguments)})),f()(this,"reconnect",(function(){return t.close(),new Promise((function(n,e){t.socket.connect(),t.socket.on("connect_error",(function(n){t.socket.close(),e(n)})),t.socket.on("connect",(function(){n(t)}))}))})),f()(this,"close",(function(){t.socket.connected&&t.socket.disconnect()})),f()(this,"isConnected",(function(){return t.socket.connected}));return this.socket=null,new Promise((function(n,e){t.socket=h()("http://localhost:8083"),t.socket.on("connect_error",(function(n){t.socket.disconnect(),e(n)})),t.socket.on("connect",(function(){n(t)}))}))},d=e(2),w=e.n(d),k=e(841),m=e.n(k),v=function(){function n(){var t=this;c()(this,n),f()(this,"setSignal",(function(n){t.peer.signal(n)})),f()(this,"setAsk",(function(n){t.ask=n})),f()(this,"setStream",(function(n){t.stream=n,t.isCreated&&t.peer.addStream(t.stream)})),f()(this,"setAnswer",(function(n){t.answer=n,t.isInitiator&&t.isCreated&&t.peer.signal(t.answer)})),f()(this,"setOffer",(function(n){t.offer=n,t.tryToCreate()})),f()(this,"setIsInitiator",(function(n){t.isInitiator=n,t.tryToCreate()})),this.isInitiator=null,this.isConnected=!1,this.peer=null,this.stream=null,this.answer=null,this.offer=null,this.ask=null,this.isCreated=!1}return w()(n,[{key:"tryToCreate",value:function(){this.isCreated||null===this.isInitiator||(this.isInitiator||!this.isInitiator&&this.offer)&&this.create()}},{key:"create",value:function(){var n=this;this.peer=new m.a({initiator:this.isInitiator,trickle:!1,stream:this.stream}),this.peer.on("error",(function(n){})),this.peer.on("signal",(function(t){n.isConnected||(n.isInitiator&&t.type&&"offer"===t.type?n.ask("question offer",t):!n.isInitiator&&t.type&&"answer"===t.type&&n.ask("question answer",t))})),this.peer.on("stream",(function(n){var t=document.querySelector("#emitter");t.srcObject=n,t.play()})),this.peer.on("connect",(function(){n.isConnected=!0})),this.isInitiator||this.setSignal(this.offer),this.isCreated=!0}},{key:"getIsInitiator",value:function(){return this.isInitiator}}]),n}(),y=(e(857),document.querySelector("#btn")),g=function(){var n=o()(r.a.mark((function n(t){var e,i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((function(n){return n})).catch((function(n){}));case 2:(e=n.sent)?(t.setStream(e),(i=document.querySelector("#own")).srcObject=e,i.play()):y.innerHTML="Can't access your webcam. Retry";case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),I=function(){var n=o()(r.a.mark((function n(t){var e,i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new p;case 2:return e=n.sent,i=function(){return e.emit.apply(e,arguments)},t.setAsk(i),e.on("answer initiator",t.setIsInitiator),e.on("answer offer",t.setOffer),e.on("answer answer",t.setAnswer),e.emit("question initiator"),n.abrupt("return",e);case 10:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}();t.default=function(){var n=null;y&&y.addEventListener("click",o()(r.a.mark((function t(){var e;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(y.innerHTML="Loading",t.prev=1,null!==n){t.next=14;break}return y.innerHTML="Please allow webcam access",e=new v,t.next=8,g(e);case 8:return t.next=10,I(e);case 10:n=t.sent,y.innerHTML=e.getIsInitiator()?"Connected (wait for another connection)":"Wait you will join someone",t.next=17;break;case 14:n.close(),n=null,y.innerHTML="Join";case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(1),y.innerHTML="Retry";case 23:case"end":return t.stop()}}),t,null,[[1,19]])}))),!1)}},838:function(n,t){},848:function(n,t){},850:function(n,t){},857:function(n,t,e){var i=e(99),r=e(858);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[n.i,r,""]]);var s={insert:"head",singleton:!1};i(r,s);n.exports=r.locals||{}},858:function(n,t,e){"use strict";e.r(t);var i=e(60),r=e.n(i)()(!1);r.push([n.i,"#labo {\n  position: relative;\n  width: 100%;\n  height: auto;\n  background-color: #222;\n  text-align: center;\n}\nvideo {\n  width: 50%;\n}\n.flex {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n#status {\n  width: 80%;\n  color: #fff;\n  margin: 0 auto;\n  padding: 1em;\n}\n#btn {\n  background: #fff;\n  width: 80%;\n  margin: 0 auto;\n  padding: 1em;\n  text-transform: uppercase;\n  letter-spacing: 0.2em;\n}\n",""]),t.default=r}}]);