"use strict";(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[1036],{49917:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(90025),i=r(74238),o=r(4087),s=r(9703),a=r(70915),l=r(82241),d=r(60764),c=r(6933);class h extends n.A{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){(0,o.b0)()}calculateMatrices2D(e){const t=e.viewState,r=e.coordinateToPixelTransform,n=e.pixelToCoordinateTransform;(0,s.Zz)(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),(0,s.T9)(n,r)}forEachFeatureAtCoordinate(e,t,r,n,i,o,s,l){let h;const g=t.viewState;function u(e,t,r,n){return i.call(o,t,e?r:null,n)}const p=g.projection,T=(0,c.Li)(e.slice(),p),x=[[0,0]];if(p.canWrapX()&&n){const e=p.getExtent(),t=(0,a.RG)(e);x.push([-t,0],[t,0])}const f=t.layerStatesArray,m=f.length,R=[],y=[];for(let n=0;n<x.length;n++)for(let i=m-1;i>=0;--i){const o=f[i],a=o.layer;if(a.hasRenderer()&&(0,d.l)(o,g)&&s.call(l,a)){const i=a.getRenderer(),s=a.getSource();if(i&&s){const a=s.getWrapX()?T:e,l=u.bind(null,o.managed);y[0]=a[0]+x[n][0],y[1]=a[1]+x[n][1],h=i.forEachFeatureAtCoordinate(y,t,r,l,R)}if(h)return h}}if(0===R.length)return;const v=1/R.length;return R.forEach(((e,t)=>e.distanceSq+=t*v)),R.sort(((e,t)=>e.distanceSq-t.distanceSq)),R.some((e=>h=e.callback(e.feature,e.layer,e.geometry))),h}hasFeatureAtCoordinate(e,t,r,n,o,s){return void 0!==this.forEachFeatureAtCoordinate(e,t,r,n,i.rT,this,o,s)}getMap(){return this.map_}renderFrame(e){(0,o.b0)()}scheduleExpireIconCache(e){l.ue.canExpireCache()&&e.postRenderFunctions.push(g)}}function g(e,t){l.ue.expire()}const u=h},96769:(e,t,r)=>{r.d(t,{A:()=>T,B:()=>g});var n=r(5986),i=r(9960),o=r(83984),s=r(40808),a=r(9703),l=r(89352),d=r(68711),c=r(66514),h=r(70915);const g=[];let u=null;class p extends n.A{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=(0,a.vt)(),this.pixelTransform=(0,a.vt)(),this.inversePixelTransform=(0,a.vt)(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(e,t,r){let n;u||(u=(0,d.Y)(1,1,void 0,{willReadFrequently:!0})),u.clearRect(0,0,1,1);try{u.drawImage(e,t,r,1,1,0,0,1,1),n=u.getImageData(0,0,1,1).data}catch(e){return u=null,null}return n}getBackground(e){let t=this.getLayer().getBackground();return"function"==typeof t&&(t=t(e.viewState.resolution)),t||void 0}useContainer(e,t,r){const n=this.getLayer().getClassName();let i,o;if(e&&e.className===n&&(!r||e&&e.style.backgroundColor&&(0,c.aI)((0,l._j)(e.style.backgroundColor),(0,l._j)(r)))){const t=e.firstElementChild;t instanceof HTMLCanvasElement&&(o=t.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){i=document.createElement("div"),i.className=n;let e=i.style;e.position="absolute",e.width="100%",e.height="100%",o=(0,d.Y)();const t=o.canvas;i.appendChild(t),e=t.style,e.position="absolute",e.left="0",e.transformOrigin="top left",this.container=i,this.context=o}this.containerReused||!r||this.container.style.backgroundColor||(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){const n=(0,h.Py)(r),i=(0,h.WU)(r),o=(0,h.k_)(r),s=(0,h.R)(r);(0,a.Bb)(t.coordinateToPixelTransform,n),(0,a.Bb)(t.coordinateToPixelTransform,i),(0,a.Bb)(t.coordinateToPixelTransform,o),(0,a.Bb)(t.coordinateToPixelTransform,s);const l=this.inversePixelTransform;(0,a.Bb)(l,n),(0,a.Bb)(l,i),(0,a.Bb)(l,o),(0,a.Bb)(l,s),e.save(),e.beginPath(),e.moveTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.clip()}dispatchRenderEvent_(e,t,r){const n=this.getLayer();if(n.hasListener(e)){const o=new i.A(e,this.inversePixelTransform,r,t);n.dispatchEvent(o)}}preRender(e,t){this.frameState=t,t.declutter||this.dispatchRenderEvent_(o.A.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(o.A.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new s.A),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(o.A.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(o.A.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,n,i,o,s){const l=i/2,d=o/2,c=n/t,h=-c,g=-e[0]+s,u=-e[1];return(0,a.Zz)(this.tempTransform,l,d,c,h,-r,g,u)}disposeInternal(){delete this.frameState,super.disposeInternal()}}const T=p},32348:(e,t,r)=>{r.d(t,{A:()=>m});var n=r(70136),i=r(96769),o=r(41401),s=r(83984),a=r(62703),l=r(13663),d=r(9703),c=r(70915),h=r(68711),g=r(73608),u=r(66514),p=r(9687),T=r(4087),x=r(6933);class f extends i.A{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,c.S5)(),this.wrappedRenderedExtent_=(0,c.S5)(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){const n=t.extent,i=t.viewState,s=i.center,l=i.resolution,d=i.projection,h=i.rotation,g=d.getExtent(),u=this.getLayer().getSource(),p=this.getLayer().getDeclutter(),T=t.pixelRatio,x=t.viewHints,f=!(x[a.A.ANIMATING]||x[a.A.INTERACTING]),m=this.context,R=Math.round((0,c.RG)(n)/l*T),y=Math.round((0,c.Oq)(n)/l*T),v=u.getWrapX()&&d.canWrapX(),C=v?(0,c.RG)(g):null,S=v?Math.ceil((n[2]-g[2])/C)+1:1;let _=v?Math.floor((n[0]-g[0])/C):0;do{const n=this.getRenderTransform(s,l,h,T,R,y,_*C);e.execute(m,[m.canvas.width,m.canvas.height],n,h,f,void 0===r?o.y2:r?o.$i:o.x$,r?p&&t.declutter[p]:void 0)}while(++_<S)}setDrawContext_(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=(0,h.Y)(this.context.canvas.width,this.context.canvas.height,i.B))}resetDrawContext_(){if(1!==this.opacity_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,(0,h.Yg)(this.context),i.B.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.resetDrawContext_())}renderFrame(e,t){const r=e.pixelRatio,n=e.layerStatesArray[e.layerIndex];this.opacity_=n.opacity;const i=e.extent,o=e.viewState.resolution,a=Math.round((0,c.RG)(i)/o*r),l=Math.round((0,c.Oq)(i)/o*r);(0,d.Zz)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/r,1/r,0,-a/2,-l/2),(0,d.T9)(this.inversePixelTransform,this.pixelTransform);const h=(0,d.dI)(this.pixelTransform);this.useContainer(t,h,this.getBackground(e));const g=this.context,u=g.canvas,T=this.replayGroup_;let x=T&&!T.isEmpty();if(!x){if(!(this.getLayer().hasListener(s.A.PRERENDER)||this.getLayer().hasListener(s.A.POSTRENDER)))return null}u.width!=a||u.height!=l?(u.width=a,u.height=l,u.style.transform!==h&&(u.style.transform=h)):this.containerReused||g.clearRect(0,0,a,l),this.setDrawContext_(),this.preRender(g,e);const f=e.viewState,m=f.projection;let R=!1;if(x&&n.extent&&this.clipping){const t=(0,p.SD)(n.extent,m);x=(0,c.HY)(t,e.extent),R=x&&!(0,c.ms)(t,e.extent),R&&this.clipUnrotated(g,e,t)}return x&&this.renderWorlds(T,e,!this.getLayer().getDeclutter()&&void 0),R&&g.restore(),this.postRender(g,e),this.renderedRotation_!==f.rotation&&(this.renderedRotation_=f.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise((t=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const e=[this.context.canvas.width,this.context.canvas.height];(0,d.Bb)(this.pixelTransform,e);const t=this.renderedCenter_,r=this.renderedResolution_,n=this.renderedRotation_,i=this.renderedProjection_,o=this.wrappedRenderedExtent_,s=this.getLayer(),a=[],h=e[0]*l.tF,u=e[1]*l.tF;a.push(this.getRenderTransform(t,r,n,l.tF,h,u,0).slice());const T=s.getSource(),x=i.getExtent();if(T.getWrapX()&&i.canWrapX()&&!(0,c.ms)(x,o)){let e=o[0];const i=(0,c.RG)(x);let s,d=0;for(;e<x[0];)--d,s=i*d,a.push(this.getRenderTransform(t,r,n,l.tF,h,u,s).slice()),e+=i;for(d=0,e=o[2];e>x[2];)++d,s=i*d,a.push(this.getRenderTransform(t,r,n,l.tF,h,u,s).slice()),e-=i}const f=(0,p.Tf)();this.hitDetectionImageData_=(0,l._7)(e,a,this.renderedFeatures_,s.getStyleFunction(),o,r,n,(0,g.j)(r,this.renderedPixelRatio_),f?i:null)}t((0,l.F8)(e,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(e,t,r,n,i){if(!this.replayGroup_)return;const o=t.viewState.resolution,s=t.viewState.rotation,a=this.getLayer(),l={},d=function(e,t,r){const o=(0,T.v6)(e),s=l[o];if(s){if(!0!==s&&r<s.distanceSq){if(0===r)return l[o]=!0,i.splice(i.lastIndexOf(s),1),n(e,a,t);s.geometry=t,s.distanceSq=r}}else{if(0===r)return l[o]=!0,n(e,a,t);i.push(l[o]={feature:e,layer:a,geometry:t,distanceSq:r,callback:n})}};let c;const h=[this.replayGroup_],g=this.getLayer().getDeclutter();return h.some((n=>c=n.forEachFeatureAtCoordinate(e,o,s,r,d,g&&t.declutter[g]?t.declutter[g].all().map((e=>e.value)):null))),c}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),r=t.getSource();if(!r)return!1;const i=e.viewHints[a.A.ANIMATING],s=e.viewHints[a.A.INTERACTING],l=t.getUpdateWhileAnimating(),d=t.getUpdateWhileInteracting();if(this.ready&&!l&&i||!d&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const h=e.extent,T=e.viewState,f=T.projection,m=T.resolution,R=e.pixelRatio,y=t.getRevision(),v=t.getRenderBuffer();let C=t.getRenderOrder();void 0===C&&(C=g.Eo);const S=T.center.slice(),_=(0,c.r)(h,v*m),w=_.slice(),I=[_.slice()],A=f.getExtent();if(r.getWrapX()&&f.canWrapX()&&!(0,c.ms)(A,e.extent)){const e=(0,c.RG)(A),t=Math.max((0,c.RG)(_)/2,e);_[0]=A[0]-t,_[2]=A[2]+t,(0,x.Li)(S,f);const r=(0,c.Li)(I[0],f);r[0]<A[0]&&r[2]<A[2]?I.push([r[0]+e,r[1],r[2]+e,r[3]]):r[0]>A[0]&&r[2]>A[2]&&I.push([r[0]-e,r[1],r[2]-e,r[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==y&&this.renderedRenderOrder_==C&&(0,c.ms)(this.wrappedRenderedExtent_,_))return(0,u.aI)(this.renderedExtent_,w)||(this.hitDetectionImageData_=null,this.renderedExtent_=w),this.renderedCenter_=S,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const E=new n.A((0,g.gY)(m,R),_,m,R),D=(0,p.Tf)();let F;if(D){for(let e=0,t=I.length;e<t;++e){const t=I[e],n=(0,p.JR)(t,f);r.loadFeatures(n,(0,p.vN)(m,f),D)}F=(0,p.FO)(D,f)}else for(let e=0,t=I.length;e<t;++e)r.loadFeatures(I[e],m,f);const b=(0,g.j)(m,R);let P=!0;const L=(e,r)=>{let n;const i=e.getStyleFunction()||t.getStyleFunction();if(i&&(n=i(e,m)),n){const t=this.renderFeature(e,b,n,E,F,this.getLayer().getDeclutter(),r);P=P&&!t}},G=(0,p.JR)(_,f),M=r.getFeaturesInExtent(G);C&&M.sort(C);for(let e=0,t=M.length;e<t;++e)L(M[e],e);this.renderedFeatures_=M,this.ready=P;const O=E.finish(),j=new o.Ay(_,m,R,r.getOverlaps(),O,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=m,this.renderedRevision_=y,this.renderedRenderOrder_=C,this.renderedExtent_=w,this.wrappedRenderedExtent_=_,this.renderedCenter_=S,this.renderedProjection_=f,this.renderedPixelRatio_=R,this.replayGroup_=j,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,n,i,o,s){if(!r)return!1;let a=!1;if(Array.isArray(r))for(let l=0,d=r.length;l<d;++l)a=(0,g.nl)(n,e,r[l],t,this.boundHandleStyleImageChange_,i,o,s)||a;else a=(0,g.nl)(n,e,r,t,this.boundHandleStyleImageChange_,i,o,s);return a}}const m=f},13939:(e,t,r)=>{r.d(t,{A:()=>w});var n=r(70136),i=r(41401),o=r(96769),s=r(40190),a=r(32963),l=r(91110),d=r(11078),c=r(9703),h=r(66514),g=r(70915),u=r(9687),p=r(4087),T=r(6782);class x extends o.A{constructor(e){super(e),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=(0,g.S5)(),this.tmpTileRange_=new l.A(0,0,0,0)}isDrawableTile(e){const t=this.getLayer(),r=e.getState(),n=t.getUseInterimTilesOnError();return r==d.A.LOADED||r==d.A.EMPTY||r==d.A.ERROR&&!n}getTile(e,t,r,n){const i=n.pixelRatio,o=n.viewState.projection,s=this.getLayer();let a=s.getSource().getTile(e,t,r,i,o);return a.getState()==d.A.ERROR&&s.getUseInterimTilesOnError()&&s.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(e){const t=this.frameState;if(!t)return null;const r=this.getLayer(),n=(0,c.Bb)(t.pixelToCoordinateTransform,e.slice()),i=r.getExtent();if(i&&!(0,g.Ym)(i,n))return null;const o=t.pixelRatio,l=t.viewState.projection,h=t.viewState,u=r.getRenderSource(),p=u.getTileGridForProjection(h.projection),x=u.getTilePixelRatio(t.pixelRatio);for(let e=p.getZForResolution(h.resolution);e>=p.getMinZoom();--e){const t=p.getTileCoordForCoordAndZ(n,e),r=u.getTile(e,t[1],t[2],o,l);if(!(r instanceof s.A||r instanceof a.A)||r instanceof a.A&&r.getState()===d.A.EMPTY)return null;if(r.getState()!==d.A.LOADED)continue;const i=p.getOrigin(e),c=(0,T.xq)(p.getTileSize(e)),g=p.getResolution(e),f=Math.floor(x*((n[0]-i[0])/g-t[1]*c[0])),m=Math.floor(x*((i[1]-n[1])/g-t[2]*c[1])),R=Math.round(x*u.getGutterForProjection(h.projection));return this.getImageData(r.getImage(),f+R,m+R)}return null}loadedTileCallback(e,t,r){return!!this.isDrawableTile(r)&&super.loadedTileCallback(e,t,r)}prepareFrame(e){return!!this.getLayer().getSource()}renderFrame(e,t){const r=e.layerStatesArray[e.layerIndex],n=e.viewState,i=n.projection,o=n.resolution,s=n.center,a=n.rotation,l=e.pixelRatio,T=this.getLayer(),x=T.getSource(),f=x.getRevision(),m=x.getTileGridForProjection(i),R=m.getZForResolution(o,x.zDirection),y=m.getResolution(R);let v=e.extent;const C=e.viewState.resolution,S=x.getTilePixelRatio(l),_=Math.round((0,g.RG)(v)/C*l),w=Math.round((0,g.Oq)(v)/C*l),I=r.extent&&(0,u.SD)(r.extent,i);I&&(v=(0,g._N)(v,(0,u.SD)(r.extent,i)));const A=y*_/2/S,E=y*w/2/S,D=[s[0]-A,s[1]-E,s[0]+A,s[1]+E],F=m.getTileRangeForExtentAndZ(v,R),b={};b[R]={};const P=this.createLoadedTileFinder(x,i,b),L=this.tmpExtent,G=this.tmpTileRange_;this.newTiles_=!1;const M=a?(0,g.Yw)(n.center,C,a,e.size):void 0;for(let t=F.minX;t<=F.maxX;++t)for(let n=F.minY;n<=F.maxY;++n){if(a&&!m.tileCoordIntersectsViewport([R,t,n],M))continue;const i=this.getTile(R,t,n,e);if(this.isDrawableTile(i)){const t=(0,p.v6)(this);if(i.getState()==d.A.LOADED){b[R][i.tileCoord.toString()]=i;let e=i.inTransition(t);e&&1!==r.opacity&&(i.endTransition(t),e=!1),this.newTiles_||!e&&this.renderedTiles.includes(i)||(this.newTiles_=!0)}if(1===i.getAlpha(t,e.time))continue}const o=m.getTileCoordChildTileRange(i.tileCoord,G,L);let s=!1;o&&(s=P(R+1,o)),s||m.forEachTileCoordParentTileRange(i.tileCoord,P,G,L)}const O=y/o*l/S;(0,c.Zz)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/l,1/l,a,-_/2,-w/2);const j=(0,c.dI)(this.pixelTransform);this.useContainer(t,j,this.getBackground(e));const B=this.getRenderContext(e),N=this.context.canvas;(0,c.T9)(this.inversePixelTransform,this.pixelTransform),(0,c.Zz)(this.tempTransform,_/2,w/2,O,O,0,-_/2,-w/2),N.width!=_||N.height!=w?(N.width=_,N.height=w):this.containerReused||B.clearRect(0,0,_,w),I&&this.clipUnrotated(B,e,I),x.getInterpolate()||(B.imageSmoothingEnabled=!1),this.preRender(B,e),this.renderedTiles.length=0;let k,Z,z,Y=Object.keys(b).map(Number);Y.sort(h.V_),1!==r.opacity||this.containerReused&&!x.getOpaque(e.viewState.projection)?(k=[],Z=[]):Y=Y.reverse();for(let t=Y.length-1;t>=0;--t){const r=Y[t],n=x.getTilePixelSize(r,l,i),o=m.getResolution(r)/y,s=n[0]*o*O,a=n[1]*o*O,d=m.getTileCoordForCoordAndZ((0,g.Py)(D),r),h=m.getTileCoordExtent(d),u=(0,c.Bb)(this.tempTransform,[S*(h[0]-D[0])/y,S*(D[3]-h[3])/y]),T=S*x.getGutterForProjection(i),f=b[r];for(const t in f){const n=f[t],i=n.tileCoord,o=d[1]-i[1],l=Math.round(u[0]-(o-1)*s),c=d[2]-i[2],h=Math.round(u[1]-(c-1)*a),m=Math.round(u[0]-o*s),y=Math.round(u[1]-c*a),v=l-m,C=h-y,S=R===r,_=S&&1!==n.getAlpha((0,p.v6)(this),e.time);let w=!1;if(!_)if(k){z=[m,y,m+v,y,m+v,y+C,m,y+C];for(let e=0,t=k.length;e<t;++e)if(R!==r&&r<Z[e]){const t=k[e];(0,g.HY)([m,y,m+v,y+C],[t[0],t[3],t[4],t[7]])&&(w||(B.save(),w=!0),B.beginPath(),B.moveTo(z[0],z[1]),B.lineTo(z[2],z[3]),B.lineTo(z[4],z[5]),B.lineTo(z[6],z[7]),B.moveTo(t[6],t[7]),B.lineTo(t[4],t[5]),B.lineTo(t[2],t[3]),B.lineTo(t[0],t[1]),B.clip())}k.push(z),Z.push(r)}else B.clearRect(m,y,v,C);this.drawTileImage(n,e,m,y,v,C,T,S),k&&!_?(w&&B.restore(),this.renderedTiles.unshift(n)):this.renderedTiles.push(n),this.updateUsedTiles(e.usedTiles,x,n)}}return this.renderedRevision=f,this.renderedResolution=y,this.extentChanged=!this.renderedExtent_||!(0,g.aI)(this.renderedExtent_,D),this.renderedExtent_=D,this.renderedPixelRatio=l,this.renderedProjection=i,this.manageTilePyramid(e,x,m,l,i,v,R,T.getPreload()),this.scheduleExpireCache(e,x),this.postRender(this.context,e),r.extent&&B.restore(),B.imageSmoothingEnabled=!0,j!==N.style.transform&&(N.style.transform=j),this.container}drawTileImage(e,t,r,n,i,o,s,a){const l=this.getTileImage(e);if(!l)return;const d=this.getRenderContext(t),c=(0,p.v6)(this),h=t.layerStatesArray[t.layerIndex],g=h.opacity*(a?e.getAlpha(c,t.time):1),u=g!==d.globalAlpha;u&&(d.save(),d.globalAlpha=g),d.drawImage(l,s,s,l.width-2*s,l.height-2*s,r,n,i,o),u&&d.restore(),g!==h.opacity?t.animate=!0:a&&e.endTransition(c)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}scheduleExpireCache(e,t){if(t.canExpireCache()){const r=function(e,t,r){const n=(0,p.v6)(e);n in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[n])}.bind(null,t);e.postRenderFunctions.push(r)}}updateUsedTiles(e,t,r){const n=(0,p.v6)(t);n in e||(e[n]={}),e[n][r.getKey()]=!0}manageTilePyramid(e,t,r,n,i,o,s,a,l){const c=(0,p.v6)(t);c in e.wantedTiles||(e.wantedTiles[c]={});const h=e.wantedTiles[c],u=e.tileQueue,T=r.getMinZoom(),x=e.viewState.rotation,f=x?(0,g.Yw)(e.viewState.center,e.viewState.resolution,x,e.size):void 0;let m,R,y,v,C,S,_=0;for(S=T;S<=s;++S)for(R=r.getTileRangeForExtentAndZ(o,S,R),y=r.getResolution(S),v=R.minX;v<=R.maxX;++v)for(C=R.minY;C<=R.maxY;++C)x&&!r.tileCoordIntersectsViewport([S,v,C],f)||(s-S<=a?(++_,m=t.getTile(S,v,C,n,i),m.getState()==d.A.IDLE&&(h[m.getKey()]=!0,u.isKeyQueued(m.getKey())||u.enqueue([m,c,r.getTileCoordCenter(m.tileCoord),y])),void 0!==l&&l(m)):t.useTile(S,v,C,i));t.updateCacheSize(_,i)}}const f=x;var m=r(62703),R=r(40808),y=r(13663),v=r(73608),C=r(6933);const S={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},_={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};const w=class extends f{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=(0,c.vt)(),this.tileClipContexts_=null}prepareTile(e,t,r){let n;const i=e.getState();return i!==d.A.LOADED&&i!==d.A.ERROR||(this.updateExecutorGroup_(e,t,r),this.tileImageNeedsRender_(e)&&(n=!0)),n}getTile(e,t,r,n){const i=n.pixelRatio,o=n.viewState,s=o.resolution,a=o.projection,l=this.getLayer(),d=l.getSource().getTile(e,t,r,i,a),c=n.viewHints,h=!(c[m.A.ANIMATING]||c[m.A.INTERACTING]);!h&&d.wantedResolution||(d.wantedResolution=s);return this.prepareTile(d,i,a)&&(h||Date.now()-n.time<8)&&"vector"!==l.getRenderMode()&&this.renderTileImage_(d,n),super.getTile(e,t,r,n)}isDrawableTile(e){const t=this.getLayer();return super.isDrawableTile(e)&&("vector"===t.getRenderMode()?(0,p.v6)(t)in e.executorGroups:e.hasContext(t))}getTileImage(e){return e.getImage(this.getLayer())}prepareFrame(e){const t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,r){const o=this.getLayer(),s=o.getRevision(),a=o.getRenderOrder()||null,l=e.wantedResolution,c=e.getReplayState(o);if(!c.dirty&&c.renderedResolution===l&&c.renderedRevision==s&&c.renderedRenderOrder==a)return;const h=o.getSource(),u=!!o.getDeclutter(),T=h.getTileGrid(),x=h.getTileGridForProjection(r).getTileCoordExtent(e.wrappedTileCoord),f=h.getSourceTiles(t,r,e),m=(0,p.v6)(o);delete e.hitDetectionImageData[m],e.executorGroups[m]=[],c.dirty=!1;for(let r=0,s=f.length;r<s;++r){const s=f[r];if(s.getState()!=d.A.LOADED)continue;const p=s.tileCoord,R=T.getTileCoordExtent(p),y=(0,g._N)(x,R),C=(0,g.r)(y,o.getRenderBuffer()*l,this.tmpExtent),S=(0,g.aI)(R,y)?null:C,_=new n.A(0,y,l,t),w=(0,v.j)(l,t),I=function(e,t){let r;const n=e.getStyleFunction()||o.getStyleFunction();if(n&&(r=n(e,l)),r){const n=this.renderFeature(e,w,r,_,u,t);c.dirty=c.dirty||n}},A=s.getFeatures();a&&a!==c.renderedRenderOrder&&A.sort(a);for(let e=0,t=A.length;e<t;++e){const t=A[e];S&&!(0,g.HY)(S,t.getGeometry().getExtent())||I.call(this,t,e)}const E=_.finish(),D="vector"!==o.getRenderMode()&&u&&1===f.length?null:y,F=new i.Ay(D,l,t,h.getOverlaps(),E,o.getRenderBuffer(),!!this.frameState?.declutter);e.executorGroups[m].push(F)}c.renderedRevision=s,c.renderedRenderOrder=a,c.renderedResolution=l}forEachFeatureAtCoordinate(e,t,r,n,i){const o=t.viewState.resolution,s=t.viewState.rotation;r=null==r?0:r;const a=this.getLayer(),l=a.getSource().getTileGridForProjection(t.viewState.projection),d=(0,g.Tr)([e]);(0,g.r)(d,o*r,d);const c={},h=function(e,t,r){let o=e.getId();void 0===o&&(o=(0,p.v6)(e));const s=c[o];if(s){if(!0!==s&&r<s.distanceSq){if(0===r)return c[o]=!0,i.splice(i.lastIndexOf(s),1),n(e,a,t);s.geometry=t,s.distanceSq=r}}else{if(0===r)return c[o]=!0,n(e,a,t);i.push(c[o]={feature:e,layer:a,geometry:t,distanceSq:r,callback:n})}},u=this.renderedTiles;let T;for(let n=0,i=u.length;!T&&n<i;++n){const i=u[n],c=l.getTileCoordExtent(i.wrappedTileCoord);if(!(0,g.HY)(c,d))continue;const x=(0,p.v6)(a),f=[i.executorGroups[x]],m=a.getDeclutter();f.some((n=>{const i=m?t.declutter[m].all().map((e=>e.value)):null;for(let t=0,a=n.length;t<a;++t){const a=n[t];if(T=a.forEachFeatureAtCoordinate(e,o,s,r,h,i),T)return!0}}))}return T}getFeatures(e){return new Promise(((t,r)=>{const n=this.getLayer(),i=(0,p.v6)(n),o=n.getSource(),s=this.renderedProjection,a=s.getExtent(),l=this.renderedResolution,h=o.getTileGridForProjection(s),u=(0,c.Bb)(this.renderedPixelToCoordinateTransform_,e.slice()),x=h.getTileCoordForCoordAndResolution(u,l);let f;for(let e=0,t=this.renderedTiles.length;e<t;++e)if(x.toString()===this.renderedTiles[e].tileCoord.toString()){if(f=this.renderedTiles[e],f.getState()===d.A.LOADED){const e=h.getTileCoordExtent(f.tileCoord);o.getWrapX()&&s.canWrapX()&&!(0,g.ms)(a,e)&&(0,C.Li)(u,s);break}f=void 0}if(!f||f.loadingSourceTiles>0)return void t([]);const m=h.getTileCoordExtent(f.wrappedTileCoord),R=(0,g.Py)(m),v=[(u[0]-R[0])/l,(R[1]-u[1])/l],S=f.getSourceTiles().reduce((function(e,t){return e.concat(t.getFeatures())}),[]);let _=f.hitDetectionImageData[i];if(!_){const e=(0,T.xq)(h.getTileSize(h.getZForResolution(l,o.zDirection))),t=this.renderedRotation_,r=[this.getRenderTransform(h.getTileCoordCenter(f.wrappedTileCoord),l,0,y.tF,e[0]*y.tF,e[1]*y.tF,0)];_=(0,y._7)(e,r,S,n.getStyleFunction(),h.getTileCoordExtent(f.wrappedTileCoord),f.getReplayState(n).renderedResolution,t),f.hitDetectionImageData[i]=_}t((0,y.F8)(v,S,_))}))}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e,t){const r=this.context,n=r.globalAlpha;r.globalAlpha=t.opacity;const o=e.viewHints,s=!(o[m.A.ANIMATING]||o[m.A.INTERACTING]),a=this.renderedTiles;for(let t=0,r=a.length;t<r;++t){const r=a[t],n=r.executorGroups[(0,p.v6)(this.getLayer())],o=this.getLayer().getDeclutter();if(n)for(let t=n.length-1;t>=0;--t)n[t].execute(this.context,[this.context.canvas.width,this.context.canvas.height],this.getTileRenderTransform(r,e),e.viewState.rotation,s,i.$i,o?e.declutter[o]:void 0)}r.globalAlpha=n}renderDeferredInternal(e){const t=this.renderedTiles.reduce(((e,t,r)=>(t.executorGroups[(0,p.v6)(this.getLayer())].forEach((t=>e.push({executorGroup:t,index:r}))),e)),[]),r=t.map((({executorGroup:e})=>e.getDeferredZIndexContexts()));r.map((e=>Object.keys(e))).flat().sort(h.V_).map(Number).forEach((e=>{r.forEach(((r,n)=>{r[e]&&r[e].forEach((e=>{const{executorGroup:r,index:i}=t[n],o=r.getRenderedContext(),s=o.globalAlpha;o.globalAlpha=this.renderedOpacity_;const a=this.tileClipContexts_[i];a&&a.draw(o),e.draw(o),a&&o.restore(),o.globalAlpha=s,e.clear()}))}))}))}getTileRenderTransform(e,t){const r=t.pixelRatio,n=t.viewState,i=n.center,o=n.resolution,s=n.rotation,a=t.size,l=Math.round(a[0]*r),d=Math.round(a[1]*r),h=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),g=e.tileCoord,u=h.getTileCoordExtent(e.wrappedTileCoord),p=h.getTileCoordExtent(g,this.tmpExtent)[0]-u[0];return(0,c.lw)((0,c.hs)(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(i,o,s,r,l,d,p))}postRender(e,t){const r=t.viewHints,n=!(r[m.A.ANIMATING]||r[m.A.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation,this.renderedOpacity_=t.layerStatesArray[t.layerIndex].opacity;const o=this.getLayer(),s=o.getRenderMode(),a=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;const l=o.getDeclutter(),d=l?_[s].filter((e=>!i.$i.includes(e))):_[s],c=t.viewState,h=c.rotation,u=o.getSource(),T=u.getTileGridForProjection(c.projection).getZForResolution(c.resolution,u.zDirection),x=this.renderedTiles,f=[],y=[],v=[];let C=!0;for(let r=x.length-1;r>=0;--r){const i=x[r];C=C&&!i.getReplayState(o).dirty;const s=i.executorGroups[(0,p.v6)(o)].filter((e=>e.hasExecutors(d)));if(0===s.length)continue;const a=this.getTileRenderTransform(i,t),c=i.tileCoord[0];let u=!1;const m=s[0].getClipCoords(a);let S,_=e;if(m){l&&(S=new R.A,_=S.getContext());for(let e=0,t=f.length;e<t;++e)if(T!==c&&c<y[e]){const t=f[e];(0,g.HY)([m[0],m[3],m[4],m[7]],[t[0],t[3],t[4],t[7]])&&(u||(_.save(),u=!0),_.beginPath(),_.moveTo(m[0],m[1]),_.lineTo(m[2],m[3]),_.lineTo(m[4],m[5]),_.lineTo(m[6],m[7]),_.moveTo(t[6],t[7]),_.lineTo(t[4],t[5]),_.lineTo(t[2],t[3]),_.lineTo(t[0],t[1]),_.clip())}f.push(m),y.push(c)}for(let t=0,r=s.length;t<r;++t){s[t].execute(e,[e.canvas.width,e.canvas.height],a,h,n,d)}u&&(_===e?_.restore():v[r]=S)}e.globalAlpha=a,this.ready=C,this.tileClipContexts_=v,super.postRender(e,t)}renderFeature(e,t,r,n,i,o){if(!r)return!1;let s=!1;if(Array.isArray(r))for(let a=0,l=r.length;a<l;++a)s=(0,v.nl)(n,e,r[a],t,this.boundHandleStyleImageChange_,void 0,i,o)||s;else s=(0,v.nl)(n,e,r,t,this.boundHandleStyleImageChange_,void 0,i,o);return s}tileImageNeedsRender_(e){const t=this.getLayer();if("vector"===t.getRenderMode())return!1;const r=e.getReplayState(t),n=t.getRevision(),i=e.wantedResolution;return r.renderedTileResolution!==i||r.renderedTileRevision!==n}renderTileImage_(e,t){const r=this.getLayer(),n=e.getReplayState(r),i=r.getRevision(),o=e.executorGroups[(0,p.v6)(r)];n.renderedTileRevision=i;const s=e.wrappedTileCoord,a=s[0],l=r.getSource();let d=t.pixelRatio;const h=t.viewState.projection,g=l.getTileGridForProjection(h),u=g.getResolution(e.tileCoord[0]),T=t.pixelRatio/e.wantedResolution*u,x=g.getResolution(a),f=e.getContext(r);d=Math.round(Math.max(d,T/d));const m=l.getTilePixelSize(a,d,h);f.canvas.width=m[0],f.canvas.height=m[1];const R=d/T;if(1!==R){const e=(0,c.cL)(this.tmpTransform_);(0,c.hs)(e,R,R),f.setTransform.apply(f,e)}const y=g.getTileCoordExtent(s,this.tmpExtent),v=T/x,C=(0,c.cL)(this.tmpTransform_);(0,c.hs)(C,v,-v),(0,c.Tl)(C,-y[0],-y[3]);for(let e=0,t=o.length;e<t;++e){o[e].execute(f,[f.canvas.width*R,f.canvas.height*R],C,0,!0,S[r.getRenderMode()],null)}n.renderedTileResolution=e.wantedResolution}}},73608:(e,t,r)=>{r.d(t,{Eo:()=>a,gY:()=>d,j:()=>l,nl:()=>c});var n=r(6141),i=r(4087);const o=.5,s={Point:function(e,t,r,i,o,s){const a=r.getImage(),l=r.getText(),d=l&&l.getText(),c=s&&a&&d?{}:void 0;if(a){if(a.getImageState()!=n.A.LOADED)return;const s=e.getBuilder(r.getZIndex(),"Image");s.setImageStyle(a,c),s.drawPoint(t,i,o)}if(d){const n=e.getBuilder(r.getZIndex(),"Text");n.setTextStyle(l,c),n.drawText(t,i,o)}},LineString:function(e,t,r,n,i){const o=r.getStroke();if(o){const s=e.getBuilder(r.getZIndex(),"LineString");s.setFillStrokeStyle(null,o),s.drawLineString(t,n,i)}const s=r.getText();if(s&&s.getText()){const o=e.getBuilder(r.getZIndex(),"Text");o.setTextStyle(s),o.drawText(t,n,i)}},Polygon:function(e,t,r,n,i){const o=r.getFill(),s=r.getStroke();if(o||s){const a=e.getBuilder(r.getZIndex(),"Polygon");a.setFillStrokeStyle(o,s),a.drawPolygon(t,n,i)}const a=r.getText();if(a&&a.getText()){const o=e.getBuilder(r.getZIndex(),"Text");o.setTextStyle(a),o.drawText(t,n,i)}},MultiPoint:function(e,t,r,i,o,s){const a=r.getImage(),l=a&&0!==a.getOpacity(),d=r.getText(),c=d&&d.getText(),h=s&&l&&c?{}:void 0;if(l){if(a.getImageState()!=n.A.LOADED)return;const s=e.getBuilder(r.getZIndex(),"Image");s.setImageStyle(a,h),s.drawMultiPoint(t,i,o)}if(c){const n=e.getBuilder(r.getZIndex(),"Text");n.setTextStyle(d,h),n.drawText(t,i,o)}},MultiLineString:function(e,t,r,n,i){const o=r.getStroke();if(o){const s=e.getBuilder(r.getZIndex(),"LineString");s.setFillStrokeStyle(null,o),s.drawMultiLineString(t,n,i)}const s=r.getText();if(s&&s.getText()){const o=e.getBuilder(r.getZIndex(),"Text");o.setTextStyle(s),o.drawText(t,n,i)}},MultiPolygon:function(e,t,r,n,i){const o=r.getFill(),s=r.getStroke();if(s||o){const a=e.getBuilder(r.getZIndex(),"Polygon");a.setFillStrokeStyle(o,s),a.drawMultiPolygon(t,n,i)}const a=r.getText();if(a&&a.getText()){const o=e.getBuilder(r.getZIndex(),"Text");o.setTextStyle(a),o.drawText(t,n,i)}},GeometryCollection:function(e,t,r,n,i,o){const a=t.getGeometriesArray();let l,d;for(l=0,d=a.length;l<d;++l){(0,s[a[l].getType()])(e,a[l],r,n,i,o)}},Circle:function(e,t,r,n,i){const o=r.getFill(),s=r.getStroke();if(o||s){const a=e.getBuilder(r.getZIndex(),"Circle");a.setFillStrokeStyle(o,s),a.drawCircle(t,n,i)}const a=r.getText();if(a&&a.getText()){const i=e.getBuilder(r.getZIndex(),"Text");i.setTextStyle(a),i.drawText(t,n)}}};function a(e,t){return parseInt((0,i.v6)(e),10)-parseInt((0,i.v6)(t),10)}function l(e,t){const r=d(e,t);return r*r}function d(e,t){return o*e/t}function c(e,t,r,i,o,a,l,d){const c=[],g=r.getImage();if(g){let e=!0;const t=g.getImageState();t==n.A.LOADED||t==n.A.ERROR?e=!1:t==n.A.IDLE&&g.load(),e&&c.push(g.ready())}const u=r.getFill();u&&u.loading()&&c.push(u.ready());const p=c.length>0;return p&&Promise.all(c).then((()=>o(null))),function(e,t,r,n,i,o,a){const l=r.getGeometryFunction()(t);if(!l)return;const d=l.simplifyTransformed(n,i),c=r.getRenderer();if(c)h(e,d,r,t,a);else{(0,s[d.getType()])(e,d,r,t,a,o)}}(e,t,r,i,a,l,d),p}function h(e,t,r,n,i){if("GeometryCollection"==t.getType()){const o=t.getGeometries();for(let t=0,s=o.length;t<s;++t)h(e,o[t],r,n,i);return}e.getBuilder(r.getZIndex(),"Default").drawCustom(t,n,r.getRenderer(),r.getHitDetectionRenderer(),i)}}}]);