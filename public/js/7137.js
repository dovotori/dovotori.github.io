(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[7137,8983],{35466:(t,e,s)=>{"use strict";s.d(e,{Z:()=>ht});var i=s(15861),r=s(15671),n=s(43144),a=s(4942),o=s(87757),h=s.n(o),u=function(){function t(){var e=this;(0,r.Z)(this,t),(0,a.Z)(this,"start",(function(){var t=(new Date).getTime(),s=t-e.lastFrame;e.callbackNoFps&&e.callbackNoFps(),s>e.fps&&(e.callback(t-e.firstFrame),e.lastFrame=t),e.ref=window.requestAnimationFrame(e.start)})),this.fps=25,this.firstFrame=(new Date).getTime(),this.lastFrame=this.firstFrame,this.ref=null}return(0,n.Z)(t,[{key:"setCallback",value:function(t){this.callback=t}},{key:"setCallbackNoFps",value:function(t){this.callbackNoFps=t}},{key:"setFps",value:function(t){this.fps=t}},{key:"stop",value:function(){window.cancelAnimationFrame(this.ref)}}]),t}();function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function l(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){(0,a.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}for(var d=function(){function t(e){var s=this;(0,r.Z)(this,t),(0,a.Z)(this,"addFaceIndex",(function(t){var e=t.split("/");e[0]&&""!==e[0]&&s.obj.v.indices.push(parseInt(e[0],10)-1),e[1]&&""!==e[1]&&s.obj.vt.indices.push(parseInt(e[1],10)-1),e[2]&&""!==e[2]&&s.obj.vn.indices.push(parseInt(e[2],10)-1)})),this.obj={v:{indices:[],points:[]},vt:{indices:[],points:[]},vn:{indices:[],points:[]}},this.mat={},this.faceCount=0,this.readLines(e)}return(0,n.Z)(t,[{key:"readLines",value:function(t){var e=this;t.split("\n").forEach((function(t){var s=t.split(" "),i=s[0];switch(i){case"f":e.addFace(s.slice(1));break;case"v":case"vn":case"vt":e.addPoints(i,s.slice(1));break;case"usemtl":e.addNewMaterial(s.slice(1)[0])}}))}},{key:"addFace",value:function(t){t.forEach(this.addFaceIndex),this.faceCount+=1}},{key:"addPoints",value:function(t,e){var s=this;("vt"===t&&3===e.length?e.slice(0,2):e).forEach((function(e){return s.obj[t].points.push(parseFloat(e,10))}))}},{key:"addNewMaterial",value:function(t){this.mat[3*this.faceCount]=t}},{key:"get",value:function(){return l(l({},this.obj),{},{mat:this.mat})}}]),t}(),f=function(){function t(e){(0,r.Z)(this,t),this.materials={},this.current="",this.readLines(e)}return(0,n.Z)(t,[{key:"readLines",value:function(t){var e=this;t.split("\n").forEach((function(t){var s=t.split(" "),i=s[0];switch(i){case"newmtl":e.createMaterial(s.slice(1));break;case"Ns":case"Ka":case"Kd":case"Ks":case"Ke":case"Ni":case"d":case"illum":e.addInfoToMaterial(i,s.slice(1))}}))}},{key:"createMaterial",value:function(t){this.current=t,this.materials[this.current]={}}},{key:"addInfoToMaterial",value:function(t,e){var s="";switch(t){case"Ka":s="ambiant";break;case"Kd":s="diffuse";break;case"Ks":s="specular";break;case"Ke":s="emissive";break;case"Ns":s="specDensity";break;case"d":s="opacity"}""!==s&&(this.materials[this.current][s]=e.map((function(t){return parseFloat(t,10)})))}},{key:"get",value:function(){return this.materials}}]),t}(),g=s(42982),v=s(45987),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y=new Uint8Array(256),m=0;m<p.length;m++)y[p.charCodeAt(m)]=m;var b=function(t,e,s,i,r){for(var n=new Float32Array(e),a=r||Float32Array.BYTES_PER_ELEMENT*i,o=0,h=0,u=0;u<s;u++){for(var c=0;c<i;c++){var l=o+c*Float32Array.BYTES_PER_ELEMENT;n[h]=t.getFloat32(l,!0),h++}o+=a}return n},k=function(t,e,s,i,r){for(var n=new Uint16Array(e),a=r||Uint16Array.BYTES_PER_ELEMENT*i,o=0,h=0,u=0;u<s;u++){for(var c=0;c<i;c++){var l=o+c*Uint16Array.BYTES_PER_ELEMENT;n[h]=t.getUint16(l,!0),h++}o+=a}return n},w=s(8983),E=["id"],x=["id"];function T(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function P(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?T(Object(s),!0).forEach((function(e){(0,a.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):T(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var Z="SCALAR",j="VEC2",O="VEC3",R="VEC4",A="MAT2",M="MAT3",F="MAT4",D=function(t){switch(t){default:case Z:return 1;case j:return 2;case O:return 3;case R:case A:return 4;case M:return 9;case F:return 16}},C=function(t,e,s){var i=s.bufferView,r=s.componentType,n=s.count,a=s.type,o=s.byteOffset,h=void 0===o?0:o,u=e[i],c=u.buffer,l=u.byteLength,d=u.byteOffset,f=void 0===d?0:d,g=u.byteStride,v=new DataView(t[c],f+h,l-h),p=D(a),y=function(t,e){return D(t)*e}(a,n),m=function(t){switch(t){case 5123:return k;case 5126:return b;default:return null}}(r);return m?m(v,y,n,p,g):null},_=function(t,e){var s=e.buffer,i=e.byteOffset,r=e.byteLength;return function(t,e){for(var s=new Uint8Array(e),i=0;i<e;i++)s[i]=t.getUint8(i,!0);return s}(new DataView(t[s],i,r),r)},S=function(t){switch(t){case"normal":return"normale";case"texcoord_0":return"texture";case"baseColorFactor":return"color";case"metallicFactor":return"metal";case"roughnessFactor":return"rough";case"joints_0":return"joint";case"weights_0":return"weight";default:return t}},z=["position","normale","texture","joint","weight","tangent"],I=function(t,e){var s,i={};if(t&&(i=P(P({},(s=t.pbrMetallicRoughness,Object.keys(s).reduce((function(t,e){var i=S(e);return P(P({},t),{},(0,a.Z)({},i,s[e]))}),[]))),{},{name:t.name}),t.normalTexture)){var r=e[t.normalTexture.index];i.normalMap=r||void 0}return Object.keys(i).length>0?i:void 0},L=function(t,e){return t.map((function(t){var s=t.attributes,i=t.indices,r=t.material,n=t.targets,o=function(t,e,s,i){var r=e[s],n={indices:P(P({},r),{},{size:D(r.type)})},o=i&&i.map((function(t){return Object.keys(t).reduce((function(s,i){var r=e[t[i]];return P(P({},s),{},(0,a.Z)({},i,P(P({},r),{},{size:D(r.type)})))}),{})}));return o&&(o=o.reduce((function(t,e,s){var i=Object.keys(e).reduce((function(t,i){var r=S(i.toLowerCase());return P(P({},t),{},(0,a.Z)({},"target".concat(r).concat(s),e[i]))}),{});return P(P({},t),i)}),{}),n=P(P({},o),n)),Object.keys(t).reduce((function(s,i){var r=S(i.toLowerCase());if(-1===z.indexOf(r))return s;var n=t[i],o=e[n];return P(P({},s),{},(0,a.Z)({},r,P(P({},o),{},{size:D(o.type)})))}),n)}(s,e,i,n),h={vbos:o};return void 0!==r&&(h=P({material:r},h)),h}))},N=function t(e,s){return e.map((function(e){var i=s.findIndex((function(t){return t.id===e})),r=s.splice(i,1)[0];r.children&&(r.children=t(r.children,s));r.id;return(0,v.Z)(r,E)}))},U=function t(e,s){var i=e.children;if(i){var r=i.map((function(e){return t(s[e],s)}));return P(P({},e),{},{children:r})}return e},B=function(t){var e={};return t.forEach((function(t){var s=t.children;return s&&s.forEach((function(t){e[t]=!0}))})),t.map((function(e){return U(e,t)})).filter((function(t,s){return void 0===e[s]}))},X=function t(e){return e.reduce((function(e,s){var i=s.name,r=s.children;return e[i]=s,r&&t(r),e}),{})},G=function(){function t(e){(0,r.Z)(this,t);var s=JSON.parse(e),i=s.animations,n=s.buffers,a=s.bufferViews,o=s.accessors,h=s.skins,u=s.nodes,c=s.meshes,l=s.materials,d=s.images,f=n&&n.map((function(t){return function(t){var e,s,i,r,n,a=t.split(",")[1],o=.75*a.length,h=a.length,u=0;"="===a[a.length-1]&&(o--,"="===a[a.length-2]&&o--);var c=new ArrayBuffer(o),l=new Uint8Array(c);for(e=0;e<h;e+=4)s=y[a.charCodeAt(e)],i=y[a.charCodeAt(e+1)],r=y[a.charCodeAt(e+2)],n=y[a.charCodeAt(e+3)],l[u++]=s<<2|i>>4,l[u++]=(15&i)<<4|r>>2,l[u++]=(3&r)<<6|63&n;return c}(t.uri)})),p=o&&o.map((function(t){return P(P({},t),{},{values:C(f,a,t)})})),m=function(t,e,s,i){var r={};return t&&t.forEach((function(t){var n=t.channels,a=t.samplers;n.forEach((function(t){var n=t.target,o=t.sampler,h=a[o],u=h.input,c=h.output,l=h.interpolation,d=s[u],f=s[c],v=n.node,p=n.path,y=e[v],m=D(f.type);y[p]?m=y[p].length:y.mesh&&i[y.mesh][p]?m=i[y.mesh][p].length:"scale"===p&&(m=3);var b=(0,w.chunkArray)(f.values,m),k={path:p,times:d.values,output:b,interpolation:l};r[v]=r[v]?[].concat((0,g.Z)(r[v]),[k]):[k]}))})),r}(i,u,p,c);Object.keys(m).forEach((function(t){u[t].animations=m[t]}));var b=function(t,e,s){var i=null;if(t){var r=e.map((function(t,e){return P(P({},t),{},{id:e})}));i=t.map((function(t){var e=t.inverseBindMatrices,i=t.joints,n=[];if(e){var a=s[e].values;n=(0,w.chunkArray)(a,16)}if(i){for(var o=i.map((function(t,e){return P(P({},r[t]),{},{invMatrix:n[e]})})).slice(),h=[];0!==o.length;){var u=o.shift();u.children&&(u.children=N(u.children,o)),u.id;var c=(0,v.Z)(u,x);h.push(c)}return{joints:h}}return null})).filter((function(t){return t}))}return i}(h,u,p),k=c.map((function(t){var e=t.primitives,s=t.weights,i={primitives:L(e,p)};return s&&(i=P({weights:s},i)),i})),E=function(t,e,s,i){return t?t.map((function(t){var e=t.bufferView,r=t.mimeType,n=t.name,a=i[e];return{mimeType:r,name:n,data:_(s,a)}})):null}(d,0,f,a),T=l&&l.map((function(t){return I(t,E)})),Z=B(u);Z=X(Z),this.data={},k&&(this.data.meshes=k),Z&&(this.data.nodes=Z),b&&(this.data.skins=b),T&&(this.data.materials=T),console.log("CUSTOM",this.data)}return(0,n.Z)(t,[{key:"get",value:function(){return this.data}}]),t}(),V=function(){function t(){(0,r.Z)(this,t),this.assets={textures:{},objets:{},materials:{},levels:{},gltfs:{},sounds:{}}}return(0,n.Z)(t,[{key:"get",value:function(e){var s=this,i=e.map((function(e){var s=t.getInfo(e);switch(s.ext){case"jpg":case"jpeg":case"png":case"bmp":return t.loadImage(e,s);case"obj":return t.load3dObj(e,s);case"gltf":return t.load3dGltf(e,s);case"mtl":return t.loadMaterial(e,s);case"mp3":return t.loadSound(e,s);default:return null}}));return Promise.all(i).then((function(t){return t.forEach((function(t){switch(t.info.ext){case"jpg":case"jpeg":case"png":s.assets.textures[t.info.name]=t.data;break;case"bmp":s.assets.levels[t.info.name]=t.data;break;case"obj":s.assets.objets[t.info.name]=t.data;break;case"gltf":s.assets.gltfs[t.info.name]=t.data;break;case"mtl":s.assets.materials[t.info.name]=t.data;break;case"mp3":s.assets.sounds[t.info.name]=t.data}})),s.assets}))}}],[{key:"getInfo",value:function(t){var e=t.substring(t.lastIndexOf("/")+1,t.length).split(".");return{name:e[0],ext:e[1].toLowerCase()}}},{key:"loadMaterial",value:function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new f(t).get(),info:e}}))}},{key:"loadImage",value:function(t,e){return new Promise((function(s,i){var r=new Image;r.onload=function(){return s({data:r,info:e})},r.onerror=i,r.src=t}))}},{key:"loadSound",value:function(t,e){return fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return{data:t,info:e}}))}}]),t}();(0,a.Z)(V,"load3dObj",(function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new d(t).get(),info:e}}))})),(0,a.Z)(V,"load3dGltf",(function(t,e){return fetch(t).then((function(t){return t.text()})).then((function(t){return{data:new G(t).get(),info:e}}))}));const q=V;var Y=function(){function t(){(0,r.Z)(this,t),this.shaders={}}return(0,n.Z)(t,[{key:"get",value:function(e){var i=this,r=e.map((function(e){var i={},r=t.getInfos(e).name;try{i=s(46007)("./shaders".concat(e)).then((function(t){return{name:r,js:t}}))}catch(t){console.error(t)}return i}));return Promise.all(r).then((function(t){return t.forEach((function(t){var e=t.name,s=t.js;i.shaders[e]=s.default})),i.shaders}))}}],[{key:"getInfos",value:function(t){var e=t.substring(t.lastIndexOf("/")+1,t.length).split(".");return{name:e[0],ext:e[1].toLowerCase()}}}]),t}();const W=Y;var K=function(){function t(e){(0,r.Z)(this,t),this.gl=t.checkWebGl(e),this.support={webgl:!1,depthTexture:!1},this.gl&&(this.support.webgl=!0,this.gl.enable(this.gl.DEPTH_TEST),this.gl.clearDepth(1),this.gl.depthFunc(this.gl.LESS),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.clearColor(0,0,0,0),this.support.depthTexture=!!this.gl.getExtension("WEBGL_depth_texture"),this.support.instancedArrays=!!this.gl.getExtension("ANGLE_instanced_arrays"),this.support.drawBuffers=!!this.gl.getExtension("WEBGL_draw_buffers")||!!this.gl.getExtension("GL_EXT_draw_buffers")||!!this.gl.getExtension("EXT_draw_buffers")),this.support.pixelRatio=window.devicePixelRatio||1,console.log("Webgl support info",this.support)}return(0,n.Z)(t,[{key:"get",value:function(){return this.gl}},{key:"getSupport",value:function(){return this.support}}],[{key:"checkWebGl",value:function(t){for(var e,s=["webgl","experimental-webgl","webkit-3d","moz-webgl"],i=0;i<s.length;i+=1){try{e=t.getContext(s[i],{preserveDrawingBuffer:!0})}catch(t){console.error(t)}if(e)break}return e}}]),t}();const H=K;var J=function(){function t(){var e=this;(0,r.Z)(this,t),(0,a.Z)(this,"resize",(function(t){e.canvas.setAttribute("width",t.width),e.canvas.setAttribute("height",t.height)})),this.canvas=document.createElement("canvas"),this.context=new H(this.canvas)}return(0,n.Z)(t,[{key:"get",value:function(){return this.canvas}},{key:"getContext",value:function(){return this.context.get()}},{key:"getSupport",value:function(){return this.context.getSupport()}}]),t}(),Q=function(){function t(e){var s=this;(0,r.Z)(this,t),(0,a.Z)(this,"onKeyPress",(function(t){void 0!==s.keysPressed[t.keyCode]&&(t.preventDefault(),s.keysPressed[t.keyCode]=!0,s.oneKeysPressed[t.keyCode]=!0)})),(0,a.Z)(this,"onKeyUp",(function(t){void 0!==s.keysPressed[t.keyCode]&&(t.preventDefault(),s.keysUp[t.keyCode]=!0)})),this.keys=e,this.oneKeysPressed={},this.keysPressed={},this.keysUp={},this.charges={},Object.keys(this.keys).forEach((function(t){s.keysPressed[s.keys[t]]=!1,s.keysUp[s.keys[t]]=!1,s.oneKeysPressed[s.keys[t]]=!1,s.charges[s.keys[t]]=0})),document.addEventListener("keydown",this.onKeyPress,!1),document.addEventListener("keyup",this.onKeyUp,!1)}return(0,n.Z)(t,[{key:"cancel",value:function(){document.removeEventListener("keydown",this.onKeyPress,!1),document.removeEventListener("keyup",this.onKeyUp,!1)}},{key:"start",value:function(){var t=this;Object.keys(this.keys).forEach((function(e){t.keysPressed[t.keys[e]]&&(t.charges[t.keys[e]]+=1)}))}},{key:"end",value:function(){var t=this;Object.keys(this.keys).forEach((function(e){t.keysPressed[t.keys[e]]&&t.keysUp[t.keys[e]]&&(t.charges[t.keys[e]]=0,t.keysPressed[t.keys[e]]=!1,t.keysUp[t.keys[e]]=!1)}))}},{key:"getCharge",value:function(t){return this.charges[t]}},{key:"resetCharge",value:function(t){this.charges[t]=0}},{key:"isPressed",value:function(t){return this.charges[t]>0}},{key:"isPressedOne",value:function(t){return 1===this.charges[t]}},{key:"isUp",value:function(t){return this.keysUp[t]}}]),t}(),$=function(){function t(e){var s=this;(0,r.Z)(this,t),(0,a.Z)(this,"enter",(function(){s.support&&(s.isFullscreen=!0,s.domItem.requestFullscreen?s.domItem.requestFullscreen():s.domItem.msRequestFullscreen?s.domItem.msRequestFullscreen():s.domItem.mozRequestFullScreen?s.domItem.mozRequestFullScreen():s.domItem.webkitRequestFullscreen&&s.domItem.webkitRequestFullscreen())})),(0,a.Z)(this,"exit",(function(){s.support&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())})),(0,a.Z)(this,"listen",(function(){s.support&&(document.exitFullscreen?document.addEventListener("fullscreenchange",s.onChange,!1):document.msExitFullscreen?document.addEventListener("MSFullscreenChange",s.onChange,!1):document.mozCancelFullScreen?document.addEventListener("mozfullscreenchange",s.onChange,!1):document.webkitExitFullscreen&&document.addEventListener("webkitfullscreenchange",s.onChange,!1))})),(0,a.Z)(this,"onChange",(function(){s.domItem&&(s.isOnFullscreen()?(s.domItem.setAttribute("data-fullscreen",!0),s.isFullscreen=!0):(s.domItem.removeAttribute("data-fullscreen"),s.isFullscreen=!1))})),(0,a.Z)(this,"isOnFullscreen",(function(){return!!document.fullscreenElement})),(0,a.Z)(this,"toggle",(function(){s.isFullscreen?s.exit():s.enter()})),(0,a.Z)(this,"getButton",(function(){return s.button})),this.domItem=e,this.isFullscreen=!1,this.support=!!(document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen),this.button=document.createElement("button"),this.button.id="fullscreen-toggle-btn",this.button.innerHTML='\n<svg viewbox="0 0 100 100">\n  <path d="M 0 40 L 0 0 L 40 0 L 40 10 L 10 10 L 10 40 Z"></path>\n  <path d="M 60 100 L 100 100 L 100 60 L 90 60 L 90 90 L 60 90 Z"></path>\n</svg>\n    ',this.button.addEventListener("click",this.toggle,!1),this.listen()}return(0,n.Z)(t,[{key:"destroy",value:function(){this.button&&this.button.removeEventListener("click",this.toggle,!1),this.support&&(document.exitFullscreen?document.removeEventListener("fullscreenchange",this.onExit,!1):document.msExitFullscreen?document.removeEventListener("MSFullscreenChange",this.onExit,!1):document.mozCancelFullScreen?document.removeEventListener("mozfullscreenchange",this.onExit,!1):document.webkitExitFullscreen&&document.removeEventListener("webkitfullscreenchange",this.onExit,!1))}},{key:"get",value:function(){return this.isFullscreen}},{key:"getSupport",value:function(){return this.support}}]),t}();function tt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function et(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?tt(Object(s),!0).forEach((function(e){(0,a.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):tt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var st=function(){function t(e,s){var i=this;(0,r.Z)(this,t),(0,a.Z)(this,"getDomItem",(function(){return i.controlsDomItem})),(0,a.Z)(this,"getRanges",(function(){return i.ranges})),this.controlsDomItem=document.createElement("div"),this.controlsDomItem.id="controls",this.controlsDomItem.style.opacity=0;var n=s.fullscreen,o=s.ranges;o&&(this.ranges=Object.keys(o).reduce((function(t,e){var s=o[e],r=s.min,n=void 0===r?0:r,h=s.max,u=void 0===h?100:h,c=s.value,l=void 0===c?0:c,d=s.label,f=void 0===d?null:d,g=document.createElement("div"),v=document.createElement("input");if(v.setAttribute("type","range"),v.setAttribute("id",e),v.setAttribute("min",n),v.setAttribute("max",u),v.setAttribute("value",l),v.setAttribute("name",e),f){var p=document.createElement("label");p.setAttribute("for",e),p.innerHTML=f,g.appendChild(p)}return g.appendChild(v),i.controlsDomItem.appendChild(g),et(et({},t),{},(0,a.Z)({},e,{id:e,min:n,max:u,value:l,dom:v}))}),{})),n&&(this.fullscreen=new $(e),this.controlsDomItem.appendChild(this.fullscreen.getButton()))}return(0,n.Z)(t,[{key:"destroy",value:function(){this.fullscreen&&this.fullscreen.destroy()}}]),t}(),it=s(68763),rt=function(){function t(e,s){var i=this,n=s.callbackDrag,o=s.callbackDown,h=s.callbackUp,u=s.callbackMove,c=s.callbackWheel,l=s.callbackClick;(0,r.Z)(this,t),(0,a.Z)(this,"onMove",(function(t){var e=i.computeInfos(t);i.oldPos=i.getPos(t),null!==i.callbackMove&&i.callbackMove(e),i.isDragging&&null!==i.callbackDrag&&i.callbackDrag(e)})),(0,a.Z)(this,"onDown",(function(t){if(i.isDragging=!0,i.startDraggingMousePos=i.getPos(t),null!==i.callbackDown){var e=i.computeInfos(t);i.callbackDown(e)}i.oldPos=i.getPos(t)})),(0,a.Z)(this,"onUp",(function(t){if(i.onMove(t),i.isDragging=!1,null!==i.callbackUp){var e=i.computeInfos(t);i.callbackUp(e)}})),(0,a.Z)(this,"onWheel",(function(t){var e=t.deltaY;null!==i.callbackWheel&&i.callbackWheel({deltaY:e})})),(0,a.Z)(this,"onClick",(function(t){null!==i.callbackClick&&i.callbackClick(i.computeInfos(t))})),this.div=e,this.callbackDrag=n||null,this.callbackDown=o||null,this.callbackUp=h||null,this.callbackMove=u||null,this.callbackWheel=c||null,this.callbackClick=l||null,this.isDragging=!1,this.startDraggingMousePos={x:0,y:0},this.oldPos={x:0,y:0},this.options={capture:!1,passive:!0},this.setup()}return(0,n.Z)(t,[{key:"setup",value:function(){this.div&&(this.callbackClick&&this.div.addEventListener("click",this.onClick,!1),(this.callbackDrag||this.callbackMove)&&(this.div.addEventListener("mousemove",this.onMove,this.options),this.div.addEventListener("touchmove",this.onMove,this.options)),(this.callbackDrag||this.callbackDown||this.callbackUp)&&(window.addEventListener("mouseup",this.onUp,this.options),this.div.addEventListener("mousedown",this.onDown,this.options),this.div.addEventListener("touchstart",this.onDown,this.options),this.div.addEventListener("touchend",this.onUp,this.options)),this.callbackWheel&&this.div.addEventListener("wheel",this.onWheel,this.options))}},{key:"cancel",value:function(){this.div&&(this.callbackClick&&this.div.removeEventListener("click",this.onClick,!1),(this.callbackDrag||this.callbackMove)&&(this.div.removeEventListener("mousemove",this.onMove,this.options),this.div.removeEventListener("touchmove",this.onMove,this.options)),this.callbackDrag&&(window.removeEventListener("mouseup",this.onUp,this.options),this.div.removeEventListener("mousedown",this.onDown,this.options),this.div.removeEventListener("touchstart",this.onDown,this.options),this.div.removeEventListener("touchend",this.onUp,this.options)),this.callbackWheel&&this.div.removeEventListener("wheel",this.onWheel,this.options))}},{key:"getPos",value:function(t){var e;return(null===(e=t.touches)||void 0===e?void 0:e.length)>=0?{x:0===t.touches.length?this.oldPos.x:t.touches[0].clientX,y:0===t.touches.length?this.oldPos.y:t.touches[0].clientY}:{x:t.clientX,y:t.clientY}}},{key:"computeInfos",value:function(t){var e=this.getPos(t),s=this.div.getBoundingClientRect(),i=e.x-s.x,r=e.y-s.y,n={x:this.oldPos.x-e.x,y:this.oldPos.y-e.y};return{size:s,pos:{x:i,y:r},rel:{x:(0,it.Yp)(i,0,s.width,-1,1),y:(0,it.Yp)(r,0,s.height,1,-1)},relScroll:{x:t.pageX-s.left+window.scrollX,y:t.pageY-s.top+window.scrollY},relDown:{x:this.startDraggingMousePos.x-e.x,y:this.startDraggingMousePos.y-e.y},relPrevious:n,speed:Math.max(Math.abs(n.x),Math.abs(n.x))}}},{key:"get",value:function(){return this.infos}}]),t}();const nt=rt;function at(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function ot(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?at(Object(s),!0).forEach((function(e){(0,a.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):at(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var ht=function(){function t(){var e=this;(0,r.Z)(this,t),(0,a.Z)(this,"resize",(function(t){var s=t[0].target;s&&e.adaptCanvas(s)})),(0,a.Z)(this,"adaptCanvas",(function(t){var s=e.getCurrentSize(t),i=s.width,r=s.height;e.canvas.resize({width:i,height:r}),e.scene.resize({width:i,height:r})})),(0,a.Z)(this,"getCurrentSize",(function(t){var s=window.devicePixelRatio||1,i=((null==t?void 0:t.offsetWidth)||1024)*s;return{width:i,height:i*e.configRatio}})),(0,a.Z)(this,"render",(function(t){e.keyboard&&(e.keyboard.start(),e.scene.setKeyboardInteraction(e.keyboard)),e.scene.update(t),e.scene.render(),e.keyboard&&e.keyboard.end()})),(0,a.Z)(this,"revealAfterLoaded",(function(t){t&&t.querySelectorAll("[style]").forEach((function(t){return t.removeAttribute("style")}))})),this.keyboard=null,this.mouse=null,this.scene=null,this.loop=null,this.configRatio=null}var e;return(0,n.Z)(t,[{key:"setup",value:(e=(0,i.Z)(h().mark((function t(e,s){var i,r,n,o,c,l,d,f,g,v,p,y,m,b=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=document.querySelector("#".concat(s.slug))){t.next=3;break}return t.abrupt("return");case 3:if(this.configRatio=window.innerHeight/document.body.offsetWidth,r={},!s){t.next=17;break}if(this.configRatio=s.canvas.height/s.canvas.width,!s.assets){t.next=12;break}return n=new q,t.next=11,n.get(s.assets.map((function(t){return(0,w.getEnvPath)(t)})));case 11:r=t.sent;case 12:if(!s.shaders){t.next=17;break}return o=new W,t.next=16,o.get(s.shaders);case 16:r.shaders=t.sent;case 17:this.canvas=new J,c=this.getCurrentSize(i),l=c.width,d=c.height,f=ot(ot({},s),{},{canvas:ot(ot({},s.canvas),{},{width:l,height:d}),support:this.canvas.getSupport()}),this.scene=new e(this.canvas.getContext(),f,r),new ResizeObserver(this.resize).observe(i),s&&(s.keyboard&&(this.keyboard=new Q(s.keyboard)),s.mouse&&(g=s.mouse,v=g.events,p=g.domId,y=v.reduce((function(t,e){return ot(ot({},t),{},(0,a.Z)({},"callback".concat((0,w.capitalize)(e)),b.scene["onMouse".concat((0,w.capitalize)(e))]))}),{}),m=p?document.querySelector("#".concat(p)):i,this.mouse=new nt(m,y)),s.controls&&(this.controls=new st(i,s.controls),i.appendChild(this.controls.getDomItem()),s.controls.ranges&&this.scene.setupControls&&this.scene.setupControls({ranges:this.controls.getRanges()}))),this.revealAfterLoaded(i),this.loop=new u,this.loop.setCallback(this.render),this.loop.start();case 27:case"end":return t.stop()}}),t,this)}))),function(t,s){return e.apply(this,arguments)})},{key:"stop",value:function(){this.loop&&this.loop.stop(),this.mouse&&this.mouse.cancel()}},{key:"getCanvas",value:function(){return this.canvas&&this.canvas.get()}},{key:"destroy",value:function(){this.stop(),this.scene&&this.scene.destroy&&this.scene.destroy(),this.controls&&this.controls.destroy()}}]),t}()},39966:(t,e,s)=>{"use strict";s.d(e,{I:()=>i});var i=1e-6},2444:(t,e,s)=>{"use strict";s.d(e,{Z:()=>f});var i=s(15671),r=s(43144),n=s(60136),a=s(6215),o=s(61120),h=s(72710);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,o.Z)(t);if(e){var r=(0,o.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,a.Z)(this,s)}}var c=function(t){(0,n.Z)(s,t);var e=u(s);function s(){return(0,i.Z)(this,s),e.apply(this,arguments)}return(0,r.Z)(s,[{key:"create",value:function(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}}]),s}(h.Z);function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,o.Z)(t);if(e){var r=(0,o.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,a.Z)(this,s)}}var d=function(t){(0,n.Z)(s,t);var e=l(s);function s(){return(0,i.Z)(this,s),e.apply(this,arguments)}return(0,r.Z)(s,[{key:"create",value:function(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.DEPTH_COMPONENT,this.size.width,this.size.height,0,this.gl.DEPTH_COMPONENT,this.gl.UNSIGNED_INT,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}}]),s}(h.Z),f=function(){function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;(0,i.Z)(this,t),this.gl=e,this.buffer=this.gl.createFramebuffer(),this.buffer.width=s,this.buffer.height=r,this.clearColor=[0,0,0,0],this.useDepth=n,this.setup(a)}return(0,r.Z)(t,[{key:"setup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer);var e=this.gl.getExtension("WEBGL_draw_buffers")||this.gl.getExtension("GL_EXT_draw_buffers")||this.gl.getExtension("EXT_draw_buffers"),s=null!==e?e.COLOR_ATTACHMENT0_WEBGL+t:this.gl.COLOR_ATTACHMENT0;this.texture=new c(this.gl,this.buffer.width,this.buffer.height),this.texture.setup(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,s,this.gl.TEXTURE_2D,this.texture.get(),0),this.useDepth&&(this.depthTexture=new d(this.gl,this.buffer.width,this.buffer.height),this.depthTexture.setup(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.get(),0)),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}},{key:"resize",value:function(t){this.end(),this.texture&&this.texture.delete(),this.depthTexture&&this.depthTexture.delete(),this.destroy(),this.buffer=this.gl.createFramebuffer(),this.buffer.width=t.width,this.buffer.height=t.height,this.setup()}},{key:"start",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer),this.gl.viewport(0,0,this.buffer.width,this.buffer.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"end",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"get",value:function(){return this.buffer}},{key:"getTexture",value:function(){return this.texture}},{key:"getDepthTexture",value:function(){return this.depthTexture}},{key:"setClearColor",value:function(t,e,s,i){this.clearColor=[t,e,s,i]}},{key:"destroy",value:function(){this.buffer&&this.gl.deleteFramebuffer(this.buffer)}}]),t}()},80602:(t,e,s)=>{"use strict";s.d(e,{Z:()=>l});var i=s(43144),r=s(15671),n=s(60136),a=s(6215),o=s(61120),h=s(35115);function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,o.Z)(t);if(e){var r=(0,o.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,a.Z)(this,s)}}var c=function(t,e){return Object.keys(e).reduce((function(s,i){var r,n,a,o,h=e[i];switch(i){case"color":n="VEC4",a=4,r=t.FLOAT,o=new Float32Array(h);break;case"texture":n="VEC2",a=2,r=t.FLOAT,o=new Float32Array(h);break;case"indices":n="SCALAR",a=1,r=t.UNSIGNED_SHORT,o=new Uint16Array(h);break;case"side":case"random":n="FLOAT",a=1,r=t.FLOAT,o=new Float32Array(h);break;default:n="VEC3",a=3,r=t.FLOAT,o=new Float32Array(h)}return s[i]={locationKey:i,type:n,values:o,count:h.length/a,componentType:r,size:a},s}),{})},l=function(t){(0,n.Z)(s,t);var e=u(s);function s(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,r.Z)(this,s);var a=c(t,i);return e.call(this,t,a,n)}return(0,i.Z)(s)}(h.Z)},21200:(t,e,s)=>{"use strict";s.d(e,{Z:()=>o});var i=s(15671),r=s(43144),n=s(80602),a=s(31073),o=function(){function t(e){(0,i.Z)(this,t),this.gl=e,this.objet=new n.Z(e,a.Z)}return(0,r.Z)(t,[{key:"render",value:function(t){this.gl.disable(this.gl.CULL_FACE),this.objet.render(t),this.gl.enable(this.gl.CULL_FACE)}}]),t}()},79475:(t,e,s)=>{"use strict";s.d(e,{Z:()=>a});var i=s(15671),r=s(43144),n=s(25773);const a=function(){function t(){(0,i.Z)(this,t),this.d=new Array(9),this.sauvegardePrecedente=[],this.empilement=0,this.init()}return(0,r.Z)(t,[{key:"init",value:function(){for(var t=0;t<9;t+=1)this.d[t]=0;return this.sauvegardePrecedente=[],this.empilement=0,this}},{key:"get",value:function(){return this.d}},{key:"set",value:function(t,e,s,i,r,n,a,o,h){return this.d[0]=t,this.d[1]=e,this.d[2]=s,this.d[3]=i,this.d[4]=r,this.d[5]=n,this.d[6]=a,this.d[7]=o,this.d[8]=h,this}},{key:"setFromArray",value:function(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}},{key:"setOneValue",value:function(t){for(var e=0;e<9;e+=1)this.d[e]=t[e]}},{key:"multiply",value:function(e){for(var s=new t,i=0;i<3;i+=1)for(var r=0;r<3;r+=1)for(var n=0;n<3;n+=1)s.d[3*r+i]+=this.d[3*r+n]*e.d[3*n+i];for(var a=0;a<9;a+=1)this.d[a]=s.d[a];return this}},{key:"equal",value:function(t){for(var e=0;e<9;e+=1)this.d[e]=t.d[e],this.sauvegardePrecedente[e]=t.sauvegardePrecedente[e];return this}},{key:"push",value:function(){this.empilement+=1;for(var t=0,e=9*(this.empilement-1);e<9*this.empilement;e+=1)this.sauvegardePrecedente[e]=this.d[t],t+=1;return this}},{key:"pop",value:function(){if(this.empilement>0){for(var t=0,e=9*(this.empilement-1);e<9*this.empilement;e+=1)this.d[t]=this.sauvegardePrecedente[e],this.sauvegardePrecedente[e]=null,t+=1;this.empilement-=1}else console.error("pop de trop");return this}},{key:"identity",value:function(){return this.init(),this.d[0]=1,this.d[4]=1,this.d[8]=1,this}},{key:"transpose",value:function(){return this.setFromArray(t.transpose(this.d))}},{key:"inverse",value:function(){var t=new Array(9),e=this.getDeterminant();if(0===e)return this.identity(),console.error("Inversement impossible de la matrice"),null;t[0]=this.d[4]*this.d[8]-this.d[5]*this.d[7]/e,t[1]=-(this.d[1]*this.d[8]-this.d[7]*this.d[2])/e,t[2]=this.d[1]*this.d[5]-this.d[4]*this.d[2]/e,t[3]=-(this.d[3]*this.d[8]-this.d[5]*this.d[6])/e,t[4]=this.d[0]*this.d[8]-this.d[6]*this.d[2]/e,t[5]=-(this.d[0]*this.d[5]-this.d[3]*this.d[2])/e,t[6]=this.d[3]*this.d[7]-this.d[6]*this.d[4]/e,t[7]=-(this.d[0]*this.d[7]-this.d[6]*this.d[1])/e,t[8]=this.d[0]*this.d[4]-this.d[1]*this.d[3]/e;for(var s=0;s<9;s+=1)this.d[s]=t[s];return this}},{key:"getDeterminant",value:function(){return this.d[0]*(this.d[4]*this.d[8]-this.d[7]*this.d[5])+this.d[1]*(this.d[5]*this.d[6]-this.d[3]*this.d[8])+this.d[2]*(this.d[3]*this.d[7]-this.d[6]*this.d[4])}},{key:"rotate",value:function(e,s,i,r){var a=new t,o=e*(Math.PI/180),h=new n.Z(s,i,r);return h.normalise(),a.d[0]=h.x*h.x*(1-Math.cos(o))+Math.cos(o),a.d[1]=h.x*h.y*(1-Math.cos(o))-h.z*Math.sin(o),a.d[2]=h.x*h.z*(1-Math.cos(o))+h.y*Math.sin(o),a.d[3]=h.x*h.y*(1-Math.cos(o))+h.z*Math.sin(o),a.d[4]=h.y*h.y*(1-Math.cos(o))+Math.cos(o),a.d[5]=h.y*h.z*(1-Math.cos(o))-h.x*Math.sin(o),a.d[6]=h.x*h.z*(1-Math.cos(o))-h.y*Math.sin(o),a.d[7]=h.y*h.z*(1-Math.cos(o))+h.x*Math.sin(o),a.d[8]=h.z*h.z*(1-Math.cos(o))+Math.cos(o),this.multiply(a),this}}],[{key:"transpose",value:function(t){for(var e=new Float32Array(9),s=0,i=0;i<3;i+=1)for(var r=0;r<3;r+=1)e[s]=t[3*r+i],s+=1;return e}}]),t}()},21969:(t,e,s)=>{"use strict";s.d(e,{Z:()=>h});var i=s(15671),r=s(43144),n=s(39966),a=s(25773),o=s(79475);const h=function(){function t(){(0,i.Z)(this,t),this.d=new Array(16),this.sauvegardePrecedente=[],this.empilement=0,this.init()}return(0,r.Z)(t,[{key:"init",value:function(){return this.reset(),this.sauvegardePrecedente=[],this.empilement=0,this}},{key:"reset",value:function(){for(var t=0;t<16;t+=1)this.d[t]=0;return this}},{key:"get",value:function(){return this.d}},{key:"setRaw",value:function(t){this.d=t}},{key:"set",value:function(t,e,s,i,r,n,a,o,h,u,c,l,d,f,g,v){return this.d[0]=t,this.d[1]=e,this.d[2]=s,this.d[3]=i,this.d[4]=r,this.d[5]=n,this.d[6]=a,this.d[7]=o,this.d[8]=h,this.d[9]=u,this.d[10]=c,this.d[11]=l,this.d[12]=d,this.d[13]=f,this.d[14]=g,this.d[15]=v,this}},{key:"setFromArray",value:function(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}},{key:"getMatrice3x3",value:function(){var t=new o.Z;return t.set(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),t}},{key:"multiplyArray",value:function(e){var s=new t;return s.setFromArray(e),this.multiply(s)}},{key:"multiply",value:function(e){for(var s=new t,i=0;i<4;i+=1)for(var r=0;r<4;r+=1)for(var n=0;n<4;n+=1)s.d[4*r+i]+=this.d[4*r+n]*e.d[4*n+i];return this.d=s.d,this}},{key:"equal",value:function(t){for(var e=0;e<16;e+=1)this.d[e]=t.d[e],this.sauvegardePrecedente[e]=t.sauvegardePrecedente[e];return this}},{key:"push",value:function(){this.empilement+=1;for(var t=0,e=16*(this.empilement-1);e<16*this.empilement;e+=1)this.sauvegardePrecedente[e]=this.d[t],t+=1;return this}},{key:"pop",value:function(){if(this.empilement>0){for(var t=0,e=16*(this.empilement-1);e<16*this.empilement;e+=1)this.d[t]=this.sauvegardePrecedente[e],this.sauvegardePrecedente[e]=null,t+=1;this.empilement-=1}else console.error("pop de trop");return this}},{key:"translate",value:function(e,s,i){var r=new t;return r.identity(),r.d[12]=e,r.d[13]=s,r.d[14]=i,this.multiply(r),this}},{key:"scale",value:function(e,s,i){var r=new t;return r.d[0]=e,r.d[5]=void 0===s?e:s,r.d[10]=void 0===i?e:i,r.d[15]=1,this.multiply(r),this}},{key:"resetScale",value:function(){return this.d[0]=1,this.d[5]=1,this.d[10]=1,this}},{key:"resetTranslate",value:function(){return this.d[12]=0,this.d[13]=0,this.d[14]=0,this}},{key:"rotate",value:function(e,s,i,r){var n=new t,o=e*(Math.PI/180),h=new a.Z(s,i,r);return h.normalise(),n.d[0]=h.d[0]*h.d[0]*(1-Math.cos(o))+Math.cos(o),n.d[1]=h.d[0]*h.d[1]*(1-Math.cos(o))-h.d[2]*Math.sin(o),n.d[2]=h.d[0]*h.d[2]*(1-Math.cos(o))+h.d[1]*Math.sin(o),n.d[4]=h.d[0]*h.d[1]*(1-Math.cos(o))+h.d[2]*Math.sin(o),n.d[5]=h.d[1]*h.d[1]*(1-Math.cos(o))+Math.cos(o),n.d[6]=h.d[1]*h.d[2]*(1-Math.cos(o))-h.d[0]*Math.sin(o),n.d[8]=h.d[0]*h.d[2]*(1-Math.cos(o))-h.d[1]*Math.sin(o),n.d[9]=h.d[1]*h.d[2]*(1-Math.cos(o))+h.d[0]*Math.sin(o),n.d[10]=h.d[2]*h.d[2]*(1-Math.cos(o))+Math.cos(o),n.d[15]=1,this.multiply(n),this}},{key:"identity",value:function(){return this.init(),this.d[0]=1,this.d[5]=1,this.d[10]=1,this.d[15]=1,this}},{key:"perspective",value:function(t,e,s,i){var r=t*(Math.PI/180),n=1/Math.tan(r/2),a=1/(s-i);return this.set(n/e,0,0,0,0,n,0,0,0,0,(s+i)*a,-1,0,0,s*i*a*2,0),this}},{key:"ortho",value:function(t,e,s,i,r,n){return this.set(2/(e-t),0,0,0,0,2/(i-s),0,0,0,0,-2/(n-r),0,-(e+t)/(e-t),-(i+s)/(i-s),-(n+r)/(n-r),1),this}},{key:"lookAt",value:function(t,e,s,i,r,a,o,h,u){var c,l,d,f,g,v,p,y,m,b,k=t,w=e,E=s,x=o,T=h,P=u,Z=i,j=r,O=a;return Math.abs(k-Z)<n.I&&Math.abs(w-j)<n.I&&Math.abs(E-O)<n.I?(this.identity(),this):(p=k-Z,y=w-j,m=E-O,c=T*(m*=b=1/Math.sqrt(p*p+y*y+m*m))-P*(y*=b),l=P*(p*=b)-x*m,d=x*y-T*p,(b=Math.sqrt(c*c+l*l+d*d))?(c*=b=1/b,l*=b,d*=b):(c=0,l=0,d=0),f=y*d-m*l,g=m*c-p*d,v=p*l-y*c,(b=Math.sqrt(f*f+g*g+v*v))?(f*=b=1/b,g*=b,v*=b):(f=0,g=0,v=0),this.set(c,f,p,0,l,g,y,0,d,v,m,0,-(c*k+l*w+d*E),-(f*k+g*w+v*E),-(p*k+y*w+m*E),1),this)}},{key:"transpose",value:function(){return this.setFromArray(t.transpose(this.d))}},{key:"inverse",value:function(){var e=t.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),s=t.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),i=t.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),r=t.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),n=this.d[0]*e-this.d[1]*s+this.d[2]*i-this.d[3]*r,a=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),o=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),h=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),u=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),c=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[13],this.d[14],this.d[15]),l=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[12],this.d[14],this.d[15]),d=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[12],this.d[13],this.d[15]),f=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[12],this.d[13],this.d[14]),g=t.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11]),v=t.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11]),p=t.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11]),y=t.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),m=1/n;return this.d[0]=m*e,this.d[1]=-m*a,this.d[2]=m*c,this.d[3]=-m*g,this.d[4]=-m*s,this.d[5]=m*o,this.d[6]=-m*l,this.d[7]=m*v,this.d[8]=m*i,this.d[9]=-m*h,this.d[10]=m*d,this.d[11]=-m*p,this.d[12]=-m*r,this.d[13]=m*u,this.d[14]=-m*f,this.d[15]=m*y,this}},{key:"getDeterminant",value:function(){return this.d[0]*t.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15])-this.d[1]*t.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15])+this.d[2]*t.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15])-this.d[3]*t.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14])}}],[{key:"transpose",value:function(t){for(var e=new Float32Array(16),s=0,i=0;i<4;i+=1)for(var r=0;r<4;r+=1)e[s]=t[4*r+i],s+=1;return e}},{key:"getCofacteur",value:function(t,e,s,i,r,n,a,o,h){return t*(r*h-n*o)-e*(i*h-n*a)+s*(i*o-r*a)}}]),t}()},17968:(t,e,s)=>{"use strict";s.d(e,{Z:()=>u});var i=s(93324),r=s(15671),n=s(43144),a=s(25773),o=s(21969),h=s(39966);const u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,r.Z)(this,t),this.x=e,this.y=s,this.z=i,this.w=n}return(0,n.Z)(t,[{key:"set",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}},{key:"setFromAxeAndAngle",value:function(t,e){var s=(0,i.Z)(t,3),r=s[0],n=s[1],a=s[2];return this.x=r,this.y=n,this.z=a,this.w=e,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}},{key:"approx",value:function(t,e){return Math.abs(this.x-t.x)<=e&&Math.abs(this.y-t.y)<=e&&Math.abs(this.z-t.z)<=e&&Math.abs(this.w-t.w)<=e}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}},{key:"multiplyArray",value:function(t){var e=this.x,s=this.y,i=this.z,r=this.w,n=t[0],a=t[1],o=t[2],h=t[3];return this.x=e*h+r*n+s*o-i*a,this.y=s*h+r*a+i*n-e*o,this.z=i*h+r*o+e*a-s*n,this.w=r*h-e*n-s*a-i*o,this}},{key:"multiply",value:function(t){var e=this.x,s=this.y,i=this.z,r=this.w,n=t.x,a=t.y,o=t.z,h=t.w;return this.x=e*h+r*n+s*o-i*a,this.y=s*h+r*a+i*n-e*o,this.z=i*h+r*o+e*a-s*n,this.w=r*h-e*n-s*a-i*o,this}},{key:"multiplyVector",value:function(t){var e=this.w*t.x+this.y*t.z-this.z*t.y,s=this.w*t.y+this.z*t.x-this.x*t.z,i=this.w*t.z+this.x*t.y-this.y*t.x,r=-this.x*t.x-this.y*t.y-this.z*t.z,n=e*this.w+r*-this.x+s*-this.z-i*-this.y,o=s*this.w+r*-this.y+i*-this.x-e*-this.z,h=i*this.w+r*-this.z+e*-this.y-s*-this.x;return new a.Z(n,o,h)}},{key:"normalize",value:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return 0!==t&&1!==t&&(t=1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}},{key:"rotateX",value:function(t){var e=.5*t,s=this.x,i=this.y,r=this.z,n=this.w,a=Math.sin(e),o=Math.cos(e);return this.x=s*o+n*a,this.y=i*o+r*a,this.z=r*o-i*a,this.w=n*o-s*a,this}},{key:"rotateY",value:function(t){var e=.5*t,s=this.x,i=this.y,r=this.z,n=this.w,a=Math.sin(e),o=Math.cos(e);return this.x=s*o-r*a,this.y=i*o+n*a,this.z=r*o+s*a,this.w=n*o-i*a,this}},{key:"rotateZ",value:function(t){var e=.5*t,s=this.x,i=this.y,r=this.z,n=this.w,a=Math.sin(e),o=Math.cos(e);return this.x=s*o+i*a,this.y=i*o-s*a,this.z=r*o+n*a,this.w=n*o-r*a,this}},{key:"scale",value:function(t){var e=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return 0===e?this:1===e?(this.x*=t,this.y*=t,this.z*=t,this.w*=t,this):(e=t/Math.sqrt(e),this.x*=e,this.y*=e,this.z*=e,this.w*=e,this)}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}},{key:"slerp",value:function(t,e,s){var i,r,n,a,o,u=t.x,c=t.y,l=t.z,d=t.w,f=e.x,g=e.y,v=e.z,p=e.w;return(r=u*f+c*g+l*v+d*p)<0&&(r=-r,f=-f,g=-g,v=-v,p=-p),1-r>h.I?(i=Math.acos(r),n=Math.sin(i),a=Math.sin((1-s)*i)/n,o=Math.sin(s*i)/n):(a=1-s,o=s),this.x=a*u+o*f,this.y=a*c+o*g,this.z=a*l+o*v,this.w=a*d+o*p,this}},{key:"toMatrix4",value:function(){var t=this.w*this.w,e=this.x*this.x,s=this.y*this.y,i=this.z*this.z,r=1/(e+s+i+t),n=(e-s-i+t)*r,a=(-e+s-i+t)*r,h=(-e-s+i+t)*r,u=this.x*this.y,c=this.z*this.w,l=2*(u+c)*r,d=2*(u-c)*r,f=2*((u=this.x*this.z)-(c=this.y*this.w))*r,g=2*(u+c)*r,v=2*((u=this.y*this.z)+(c=this.x*this.w))*r,p=2*(u-c)*r;return(new o.Z).set(n,l,f,0,d,a,v,0,g,p,h,0,0,0,0,1)}},{key:"setFromMat3",value:function(t){var e=t.get(),s=e[0],i=e[1],r=e[2],n=e[3],a=e[4],o=e[5],h=e[6],u=e[7],c=e[8];return this.w=.5*Math.sqrt(Math.max(0,1+s+a+c)),this.x=.5*Math.sqrt(Math.max(0,1+s-a-c)),this.y=.5*Math.sqrt(Math.max(0,1-s+a-c)),this.z=.5*Math.sqrt(Math.max(0,1-s-a+c)),this.x*=Math.sign(o-u),this.y*=Math.sign(h-r),this.z*=Math.sign(i-n),this}},{key:"get",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getZ",value:function(){return this.z}},{key:"getW",value:function(){return this.w}}],[{key:"slerpArray",value:function(e,s,i){var r=new t(e[0],e[1],e[2],e[3]),n=new t(s[0],s[1],s[2],s[3]);return new t(0,0,0,1).slerp(r,n,i)}}]),t}()},25773:(t,e,s)=>{"use strict";s.d(e,{Z:()=>a});var i=s(15671),r=s(43144),n=s(68763);const a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,i.Z)(this,t),this.d=[0,0,0],this.set(e,s,r)}return(0,r.Z)(t,[{key:"normalise",value:function(){var t=this.length();return 0!==t&&(this.d[0]/=t,this.d[1]/=t,this.d[2]/=t),this}},{key:"get",value:function(){return this.d}},{key:"getX",value:function(){return this.d[0]}},{key:"getY",value:function(){return this.d[1]}},{key:"getZ",value:function(){return this.d[2]}},{key:"set",value:function(t,e,s){return null!==t&&(this.d[0]=t),null!==e?this.d[1]=e:null!==t&&(this.d[1]=t),null!==s?this.d[2]=s:null!==t&&(this.d[2]=t),this}},{key:"setX",value:function(t){this.d[0]=t}},{key:"setY",value:function(t){this.d[1]=t}},{key:"setZ",value:function(t){this.d[2]=t}},{key:"addXYZ",value:function(t,e,s){return this.d[0]+=t,this.d[1]+=e,this.d[2]+=s,this}},{key:"addX",value:function(t){return this.d[0]+=t,this}},{key:"addY",value:function(t){return this.d[1]+=t,this}},{key:"addZ",value:function(t){return this.d[2]+=t,this}},{key:"multiplyX",value:function(t){return this.d[0]*=t,this}},{key:"multiplyY",value:function(t){return this.d[1]*=t,this}},{key:"multiplyZ",value:function(t){return this.d[2]*=t,this}},{key:"limiter",value:function(t){var e=this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2];if(e>t*t&&e>0){var s=t/Math.sqrt(e);this.d[0]*=s,this.d[1]*=s,this.d[2]*=s}return this}},{key:"cross",value:function(e){return new t(this.d[1]*e.d[2]-this.d[2]*e.d[1],this.d[2]*e.d[0]-this.d[0]*e.d[2],this.d[0]*e.d[1]-this.d[1]*e.d[0])}},{key:"dot",value:function(t){return this.d[0]*t.d[0]+this.d[1]*t.d[1]+this.d[2]*t.d[2]}},{key:"length",value:function(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2])}},{key:"directionVers",value:function(t){return this.d[0]=t.d[0]-this.d[0],this.d[1]=t.d[1]-this.d[1],this.d[2]=t.d[2]-this.d[2],this}},{key:"equal",value:function(t){return this.d=[t.d[0],t.d[1],t.d[2]],this}},{key:"add",value:function(t){return this.d[0]+=t.d[0],this.d[1]+=t.d[1],this.d[2]+=t.d[2],this}},{key:"addNumber",value:function(t){return this.d[0]+=t,this.d[1]+=t,this.d[2]+=t,this}},{key:"minus",value:function(t){return this.d[0]-=t.d[0],this.d[1]-=t.d[1],this.d[2]-=t.d[2],this}},{key:"minusNumber",value:function(t){return this.d[0]-=t,this.d[1]-=t,this.d[2]-=t,this}},{key:"multiplyNumber",value:function(t){return this.d[0]*=t,this.d[1]*=t,this.d[2]*=t,this}},{key:"multiplyMatrix",value:function(t){return this.set(t.d[0]*this.d[0]+t.d[1]*this.d[1]+t.d[2]*this.d[2],t.d[3]*this.d[0]+t.d[4]*this.d[1]+t.d[5]*this.d[2],t.d[6]*this.d[0]+t.d[7]*this.d[1]+t.d[8]*this.d[2]),this}},{key:"multiply",value:function(t){return this.d[0]*=t.d[0],this.d[1]*=t.d[1],this.d[2]*=t.d[2],this}},{key:"divideNumber",value:function(t){return this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this}},{key:"divide",value:function(t){return this.d[0]/=t.d[0],this.d[1]/=t.d[1],this.d[2]/=t.d[2],this}},{key:"fract",value:function(){return this.d[0]=(0,n.ZI)(this.d[0]),this.d[1]=(0,n.ZI)(this.d[1]),this.d[2]=(0,n.ZI)(this.d[2]),this}},{key:"distance",value:function(t){return Math.sqrt((t.d[0]-this.d[0])*(t.d[0]-this.d[0])+(t.d[1]-this.d[1])*(t.d[1]-this.d[1])+(t.d[2]-this.d[2])*(t.d[2]-this.d[2]))}},{key:"angleDegree",value:function(t){var e=this.dot(t)/(this.length()*t.length());return 180*Math.acos(e)/Math.PI*-(0,n.mK)(this.d[0]*t.d[1]+this.d[1]*t.d[0])}},{key:"computeNormal",value:function(e,s,i){var r=new t,n=new t,a=new t;return n.equal(e.minus(this)),a.equal(s.minus(this)),i?r.equal(a.cross(n)):r.equal(n.cross(a)),r.normalise(),r}}],[{key:"getBarycentre",value:function(t,e,s,i){var r=(e.d[2]-s.d[2])*(t.d[0]-s.d[0])+(s.d[0]-e.d[0])*(t.d[2]-s.d[2]),n=((e.d[2]-s.d[2])*(i[0]-s.d[0])+(s.d[0]-e.d[0])*(i[1]-s.d[2]))/r,a=((s.d[2]-t.d[2])*(i[0]-s.d[0])+(t.d[0]-s.d[0])*(i[1]-s.d[2]))/r,o=1-n-a;return n*t.d[1]+a*e.d[1]+o*s.d[1]}},{key:"lerp",value:function(e,s,i){var r=e.d[0],n=e.d[1],a=e.d[2];return new t(r+i*(s.d[0]-r),n+i*(s.d[1]-n),a+i*(s.d[2]-a))}}]),t}()},31073:(t,e,s)=>{"use strict";s.d(e,{Z:()=>i});const i={position:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],indices:[0,1,2,1,3,2],texture:[0,0,1,0,0,1,1,1]}},35551:(t,e,s)=>{"use strict";s.d(e,{Z:()=>lt});var i=s(4942),r=s(15671),n=s(43144),a=function(){function t(e,s,i){(0,r.Z)(this,t),this.gl=e,this.texture=e.createTexture(),this.filter=i?e[i]:e.NEAREST,this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}return(0,n.Z)(t,[{key:"get",value:function(){return this.texture}}]),t}(),o=function(){function t(e,s){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,r.Z)(this,t),this.textures={},Object.keys(s).forEach((function(t){i.textures[t]=new a(e,s[t],n[t])}))}return(0,n.Z)(t,[{key:"get",value:function(t){return this.textures[t]}}]),t}(),h=s(93324);function u(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function c(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?u(Object(s),!0).forEach((function(e){(0,i.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var l={ambiant:[0,0,0],diffuse:[.5,.5,.5],specular:[1,1,1],emissive:[0,0,0],specDensity:[1],opacity:1},d=function(){function t(e,s){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,r.Z)(this,t),this.gl=e,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=this.gl.STATIC_DRAW,this.materialProps={},this.steps=this.getSteps(s,n);var a=this.getPoints(s,n);this.stride=0,Object.entries(this.steps).forEach((function(t){null!==t[1]&&(i.stride+=t[1])})),this.vbo=this.gl.createBuffer(),this.count=a.length/this.stride,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(a),this.modeCalcul),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}return(0,n.Z)(t,[{key:"enable",value:function(t){var e=this;this.gl.useProgram(t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo);var s=0;Object.entries(this.steps).forEach((function(i){var r=(0,h.Z)(i,2),n=r[0],a=r[1];void 0!==t.locations[n]&&-1!==t.locations[n]&&(e.gl.enableVertexAttribArray(t.locations[n]),e.gl.vertexAttribPointer(t.locations[n],a,e.gl.FLOAT,!1,4*e.stride,4*s)),null!==e.steps[n]&&(s+=e.steps[n])}))}},{key:"render",value:function(t){this.enable(t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.drawArrays(this.modeDessin,0,this.count),this.end()}},{key:"end",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}},{key:"setModeDessin",value:function(t){this.modeDessin=t}},{key:"setModeCalcul",value:function(t){this.modeCalcul=t}},{key:"getSteps",value:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i={position:3};return t.vt.indices.length>0&&(i.texture=2),t.vn.indices.length>0&&(i.normale=3),s&&t.mat&&Object.keys(t.mat).forEach((function(i){var r=t.mat[i],n=s[r];n&&Object.keys(n).forEach((function(t){void 0===e.materialProps[t]&&(e.materialProps[t]=n[t].length)}))})),c(c({},i),this.materialProps)}},{key:"getPoints",value:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=[];return t.v.indices.forEach((function(r,n){var a=3*r;if(i.push(t.v.points[a]),i.push(t.v.points[a+1]),i.push(t.v.points[a+2]),t.vt.indices.length>0){var o=2*t.vt.indices[n];i.push(t.vt.points[o]),i.push(t.vt.points[o+1])}if(t.vn.indices.length>0){var h=3*t.vn.indices[n];i.push(t.vn.points[h]),i.push(t.vn.points[h+1]),i.push(t.vn.points[h+2])}if(s&&t.mat){var u=Object.keys(t.mat).findIndex((function(e,s){var i=Object.keys(t.mat)[s+1];return!i||n>=e&&n<i})),c=t.mat[Object.keys(t.mat)[u]];Object.keys(e.materialProps).forEach((function(t){(s[c]&&s[c][t]||l[t]).forEach((function(t){return i.push(t)}))}))}})),i}}]),t}(),f=function(){function t(e,s){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,r.Z)(this,t),this.objets={},Object.keys(s).forEach((function(t){i.objets[t]=new d(e,s[t],n&&n[t])}))}return(0,n.Z)(t,[{key:"get",value:function(t){return this.objets[t]}}]),t}(),g=function(){function t(e,s){var n=this;(0,r.Z)(this,t),(0,i.Z)(this,"getLocation",(function(t){return n.program.locations[t]||null})),this.gl=e,this.program=this.gl.createProgram(),this.setup(s)}return(0,n.Z)(t,[{key:"setup",value:function(t){if(this.creerShader("vertex",t.vertex),this.creerShader("fragment",t.fragment),this.gl.linkProgram(this.program),this.gl.useProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.error("Erreur: ne peux pas lier le shader au program"),void this.gl.deleteProgram(this.program);this.createLocations(t),this.gl.useProgram(null)}},{key:"creerShader",value:function(t,e){var s=this.gl.createShader("vertex"===t?this.gl.VERTEX_SHADER:this.gl.FRAGMENT_SHADER);if(this.gl.shaderSource(s,e),this.gl.compileShader(s),!this.gl.getShaderParameter(s,this.gl.COMPILE_STATUS))return console.error("Peux pas compiler ".concat(t," shader: ").concat(this.gl.getShaderInfoLog(s))),void this.gl.deleteShader(s);this.gl.attachShader(this.program,s),this.gl.deleteShader(s)}},{key:"createLocations",value:function(t){var e=this;this.program.locations={},t.uniforms.forEach((function(t){e.program.locations[t]=e.gl.getUniformLocation(e.program,t)})),t.attributes.forEach((function(t){e.program.locations[t]=e.gl.getAttribLocation(e.program,t)}))}},{key:"setProjectionView",value:function(t){this.setMatrix("projection",t.getProjection().get()),this.setMatrix("view",t.getView().get())}},{key:"setMatrix",value:function(t,e){var s=this.getLocation(t);null!==s&&(this.gl.useProgram(this.program),16===e.length?this.gl.uniformMatrix4fv(s,!1,e):this.gl.uniformMatrix3fv(s,!1,e),this.gl.useProgram(null))}},{key:"setInt",value:function(t,e){var s=this.getLocation(t);null!==s&&(this.gl.useProgram(this.program),this.gl.uniform1i(s,e),this.gl.useProgram(null))}},{key:"setTexture",value:function(t,e,s){var i=this.getLocation(s);null!==i&&(this.gl.useProgram(this.program),this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(i,t),this.gl.useProgram(null))}},{key:"setFloat",value:function(t,e){var s=this.getLocation(t);null!==s&&(this.gl.useProgram(this.program),this.gl.uniform1f(s,e),this.gl.useProgram(null))}},{key:"setVector",value:function(t,e){var s=this.getLocation(t);if(null!==s){switch(this.gl.useProgram(this.program),e.length){case 3:this.gl.uniform3fv(s,e);break;case 4:this.gl.uniform4fv(s,e);break;default:this.gl.uniform2fv(s,e)}this.gl.useProgram(null)}}},{key:"enable",value:function(){this.gl.useProgram(this.program)}},{key:"disable",value:function(){this.gl.useProgram(null)}},{key:"get",value:function(){return this.program}},{key:"getLocations",value:function(){return this.program.locations}}]),t}(),v=function(){function t(e,s,n){var a=this;(0,r.Z)(this,t),(0,i.Z)(this,"updateResolution",(function(t,e){Object.keys(a.programs).forEach((function(s){a.programs[s].setVector("resolution",[t,e])}))})),(0,i.Z)(this,"getAll",(function(){return a.programs})),this.programs={},Object.keys(s).forEach((function(t){var i=s[t];a.programs[t]=new g(e,i)})),this.updateResolution(n.width,n.height)}return(0,n.Z)(t,[{key:"setCameraMatrix",value:function(t){var e=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(this.programs).forEach((function(i){e.programs[i].setMatrix("view",t.getView().get());var r=s?t.getOrtho():t.getProjection();e.programs[i].setMatrix("projection",r.get())}))}},{key:"get",value:function(t){return this.programs[t]}}]),t}(),p=s(92826),y=s(42982),m=s(35115),b=s(91215),k=function(){function t(e,s){var n=this,a=s.vbos,o=s.material,h=void 0===o?{}:o;(0,r.Z)(this,t),(0,i.Z)(this,"addInstancing",(function(t,e){n.vbos.addInstancingVbos(t,e)})),this.material=h,this.vbos=new m.Z(e,a),h.normalMap&&(this.normalMap=new b.Z(e,h.normalMap.data))}return(0,n.Z)(t,[{key:"render",value:function(t){var e=this.material,s=e.color,i=e.metal,r=e.rough,n=e.ao;t.setVector("color",s||[1,1,1,1]),t.setFloat("metal",void 0!==i?i:0),t.setFloat("rough",void 0!==r?r:.5),t.setFloat("ao",void 0!==n?n:1),this.vbos.render(t.get())}},{key:"setModeDessin",value:function(t){this.vbos.setModeDessin(t)}},{key:"setModeCalcul",value:function(t){this.vbos.setModeCalcul(t)}}]),t}(),w=s(17968),E=s(21969);function x(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function T(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?x(Object(s),!0).forEach((function(e){(0,i.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var P=function(){function t(e,s){var n=this;(0,r.Z)(this,t),(0,i.Z)(this,"formatPrimitives",(function(t,e){return e.map((function(e){var s=e.vbos,i=e.material;return new k(t,{vbos:s,material:i})}))})),(0,i.Z)(this,"renderNodesAndChildren",(function(t,e,s){Object.keys(t).forEach((function(i){var r=t[i];n.renderNodeAndChildren(r,e,s)}))})),(0,i.Z)(this,"renderNodeAndChildren",(function(t,e,s){var i;i=n.setNodeModel(t,e,s),n.renderNode(t,e),t.children&&n.renderNodesAndChildren(t.children,e,i)})),(0,i.Z)(this,"setNodeModel",(function(t,e,s){var i=n.handleLocalTransform(t);i.multiply(s),e.setMatrix("model",i.get());var r=i.getMatrice3x3();return r.inverse(),r.transpose(),e.setMatrix("normalMatrix",r.get()),i})),(0,i.Z)(this,"handleLocalTransform",(function(t){var e=t.translation,s=t.rotation,i=t.scale,r=t.matrix,n=new E.Z;return n.identity(),i&&n.scale.apply(n,(0,y.Z)(i)),s&&n.multiply((0,p.Z)(w.Z,(0,y.Z)(s)).toMatrix4()),e&&n.translate.apply(n,(0,y.Z)(e)),r&&n.multiplyArray(r),n}));var a=s.nodes,o=s.meshes,h=s.materials;this.meshes=o.map((function(t){var s=t.primitives,i=t.name,r=void 0===i?"":i,a=t.weights,o=s.map((function(t){return void 0!==t.material?T(T({},t),{},{material:h[t.material]}):t}));return{name:r,primitives:n.formatPrimitives(e,o),weights:a}})),this.nodes=a}return(0,n.Z)(t,[{key:"addInstancingVbos",value:function(t,e){var s=this;Object.keys(this.nodes).forEach((function(i){var r=s.nodes[i].mesh;s.meshes[r].primitives.forEach((function(s){return s.addInstancing(t,e)}))}))}},{key:"render",value:function(t,e){this.renderNodesAndChildren(this.nodes,t,e)}},{key:"renderOnly",value:function(t,e,s){var i=this;t.forEach((function(t){var r=i.nodes[t];i.renderNodeAndChildren(r,e,s)}))}},{key:"renderExcept",value:function(t,e,s){var i=this;Object.keys(this.nodes).forEach((function(r){if(-1===t.indexOf(r)){var n=i.nodes[r];i.renderNodeAndChildren(n,e,s)}}))}},{key:"renderNode",value:function(t,e){if(void 0!==t.mesh){var s=t.mesh;this.meshes[s].primitives.forEach((function(t){return t.render(e)}))}}}]),t}(),Z=s(45987),j=s(97326),O=s(60136),R=s(6215),A=s(61120),M=function(){function t(e){var s=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LINEAR",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;(0,r.Z)(this,t),(0,i.Z)(this,"findIndex",(function(t){var e=0,i=s.timeSteps[e];for(0===i&&(e++,i=s.timeSteps[e]);i&&t>i;)e++,i=s.timeSteps[e];s.index=e})),(0,i.Z)(this,"setTimes",(function(t){s.timeSteps=s.times.map((function(e){return e*t})),s.index=0,s.interpolationValue=0})),this.times=e,this.setTimes(a),this.interpolationType=n}return(0,n.Z)(t,[{key:"update",value:function(t){if(this.findIndex(t),0===this.index)this.interpolationValue=0;else if(this.index===this.times.length)this.interpolationValue=this.timeSteps[this.times.length-1];else{var e=this.timeSteps[this.index],s=this.timeSteps[this.index-1];this.interpolationValue=(t-s)/(e-s)}}},{key:"setSpeed",value:function(t){this.setTimes(t)}},{key:"getIndex",value:function(){return this.index}},{key:"get",value:function(){return this.interpolationValue}}]),t}(),F=function(t,e,s){return(1-t)*e+t*s},D=s(68763),C=["animations"];function _(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function S(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?_(Object(s),!0).forEach((function(e){(0,i.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,A.Z)(t);if(e){var r=(0,A.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,R.Z)(this,s)}}var I=function(t){(0,O.Z)(s,t);var e=z(s);function s(t,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,r.Z)(this,s),a=e.call(this,t,n),(0,i.Z)((0,j.Z)(a),"addAllAnimations",(function(t,e){return Object.keys(t).reduce((function(s,i){var r=s,n=t[i],o=n.animations,h=n.name,u=n.children;return o&&(r[h]=a.addAnimations(o,e)),u&&(r=S(S({},s),a.addAllAnimations(u,e))),r}),{})})),(0,i.Z)((0,j.Z)(a),"addAnimations",(function(t,e){var s={};return t.forEach((function(t){var i=t.path,r=t.times,n=t.output,o=t.interpolation,h=null!==e?n[e]:n[0];"rotation"===i&&(h=(0,p.Z)(w.Z,(0,y.Z)(h)).toMatrix4()),a.animationInterval[1]=Math.max.apply(Math,(0,y.Z)(r).concat([a.animationInterval[1]])),s[i]={output:n,sample:new M(r,o,a.speedAnimation),customStep:e,value:h}})),s})),(0,i.Z)((0,j.Z)(a),"removeNodesAnimations",(function(t){return Object.keys(t).reduce((function(e,i){var r=e,n=t[i];return r[n.name]=s.removeNodeAnim(n),n.children&&(r=S(S({},r),a.removeNodesAnimations(n.children))),e}),{})})),(0,i.Z)((0,j.Z)(a),"update",(function(t){var e=t-a.lastFrame;e>a.animationInterval[1]*a.speedAnimation&&(a.lastFrame=t),a.updateAnimations(e)})),(0,i.Z)((0,j.Z)(a),"updateAnimations",(function(t){Object.keys(a.animations).forEach((function(e){var i=a.animations[e];Object.keys(i).forEach((function(e){i[e]="rotation"===e?s.updateQuat(i[e],t):s.updateVector(i[e],t)}))}))})),(0,i.Z)((0,j.Z)(a),"handleLocalTransform",(function(t){var e=t.translation,i=t.rotation,r=t.scale,n=t.matrix,o=t.name,h=a.animations[o],u=h&&h.rotation||null,c=h&&h.translation||null,l=h&&h.scale||null,d=new E.Z;return d.identity(),(r||l)&&d.scale.apply(d,(0,y.Z)(s.getVector(r,l))),(i||u)&&d.multiply(s.getRotationMat(i,u)),(e||c)&&d.translate.apply(d,(0,y.Z)(s.getVector(e,c))),n&&d.multiplyArray(n),d})),(0,i.Z)((0,j.Z)(a),"setAnimationStep",(function(t,e,s){var i=a.animations[t][e],r=i.output.length,n=(0,D.Yp)(s,0,1,0,r-1);i.customStep=Math.round(n)})),(0,i.Z)((0,j.Z)(a),"setAnimationSpeed",(function(t,e,s){a.animations[t][e].sample.setSpeed(s)}));var h=n.nodes;return a.speedAnimation=2e3,a.animationInterval=[0,0],a.animations=a.addAllAnimations(h,o),a.nodes=a.removeNodesAnimations(h),a.lastFrame=0,a}return(0,n.Z)(s)}(P);(0,i.Z)(I,"removeNodeAnim",(function(t){t.animations;return(0,Z.Z)(t,C)})),(0,i.Z)(I,"getAnimationInterval",(function(t){var e=0;return t.forEach((function(t){var s=t.animations;s&&s.forEach((function(t){var s=t.times;e=Math.max.apply(Math,(0,y.Z)(s).concat([e]))}))})),[0,e]})),(0,i.Z)(I,"updateVector",(function(t,e){var s=t,i=s.sample,r=s.customStep,n=s.output;if(null===r){i.update(e);var a=i.getIndex();if(0===a){var o=(0,h.Z)(n,1);s.value=o[0]}else if(a>n.length-1)s.value=n[n.length-1];else{var u=n[a-1],c=n[a],l=i.get();s.value=u.map((function(t,e){return F(l,t,c[e])}))}}else s.value=n[r];return s})),(0,i.Z)(I,"updateQuat",(function(t,e){var s=t,i=s.sample,r=s.customStep,n=s.output;if(null===r){i.update(e);var a=i.getIndex();if(0===a)s.value=(0,p.Z)(w.Z,(0,y.Z)(n[0])).toMatrix4();else if(a>n.length-1)s.value=(0,p.Z)(w.Z,(0,y.Z)(n[n.length-1])).toMatrix4();else{var o=n[a-1],h=n[a],u=i.get();s.value=w.Z.slerpArray(o,h,u).toMatrix4()}}else s.value=(0,p.Z)(w.Z,(0,y.Z)(n[r])).toMatrix4();return s})),(0,i.Z)(I,"getVector",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&e.value?e.value:t})),(0,i.Z)(I,"getRotationMat",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,1],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&e.value?e.value:(0,p.Z)(w.Z,(0,y.Z)(t)).toMatrix4()}));const L=I;var N=s(11752);function U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,A.Z)(t);if(e){var r=(0,A.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,R.Z)(this,s)}}const B=function(t){(0,O.Z)(s,t);var e=U(s);function s(t,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,r.Z)(this,s),a=e.call(this,t,n),(0,i.Z)((0,j.Z)(a),"removeAnimations",(function(t){return t.map((function(t){var e=t;return e.children&&(e.children=a.removeAnimations(e.children)),L.removeNodeAnim(e)}))})),(0,i.Z)((0,j.Z)(a),"addJointsAnimations",(function(t,e){t.forEach((function(t){var s=t.animations,i=t.name,r=t.children;s&&(a.animations[i]=a.addAnimations(s,e)),r&&a.addJointsAnimations(r,e)}))})),(0,i.Z)((0,j.Z)(a),"setProgramSkin",(function(t,e){if(void 0!==t){var s=new E.Z;s.identity();var i=a.skins[t].joints;a.setProgramJoints(i,e,s)}})),(0,i.Z)((0,j.Z)(a),"setProgramJoints",(function(t,e,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t.forEach((function(t){var r=t.invMatrix,n=t.children,o=a.handleLocalTransform(t);o.multiply(s);var h=new E.Z;h.identity();var u=new E.Z;u.setFromArray(r),u.resetScale(),h.multiply(u),h.multiply(o),e.setMatrix("jointMat[".concat(i,"]"),h.get()),n&&a.setProgramJoints(n,e,o,i+1)}))}));var h=n.skins;return h&&(h.forEach((function(t){var e=t.joints;a.addJointsAnimations(e,o)})),a.skins=h.map((function(t){var e=t.joints;return{joints:a.removeAnimations(e)}}))),a}return(0,n.Z)(s,[{key:"renderNode",value:function(t,e,i){var r=t.skin;void 0!==r&&this.setProgramSkin(r,e),(0,N.Z)((0,A.Z)(s.prototype),"renderNode",this).call(this,t,e,i)}}]),s}(L);var X=function(){function t(e,s){var n=this;(0,r.Z)(this,t),(0,i.Z)(this,"hasAnimation",(function(t){var e=!1;return Object.keys(t).forEach((function(s){var i=t[s];!e&&i.animations&&(e=!0)})),e})),this.gltfs={},Object.keys(s).forEach((function(t){s[t].skins?n.gltfs[t]=new B(e,s[t]):n.hasAnimation(s[t].nodes)?n.gltfs[t]=new L(e,s[t]):n.gltfs[t]=new P(e,s[t])}))}return(0,n.Z)(t,[{key:"get",value:function(t){return this.gltfs[t]}}]),t}(),G=function(){function t(e){var s=this;(0,r.Z)(this,t),(0,i.Z)(this,"saveData",(function(t){s.audioData=t})),(0,i.Z)(this,"togglePause",(function(){s.isPlaying?s.isPause?(s.audioContext.resume(),s.isPause=!1):(s.audioContext.suspend(),s.isPause=!0):(s.play(),s.isPause=!1)})),(0,i.Z)(this,"stop",(function(){s.clearAnalyse(),s.sourceNode&&(s.sourceNode.removeEventListener("ended",s.stop,!1),s.sourceNode.disconnect(),s.sourceNode.stop(0)),s.isPlaying=!1})),(0,i.Z)(this,"toggle",(function(){s.isPlaying?s.stop():s.play()})),(0,i.Z)(this,"clearAnalyse",(function(){s.amplitudeArray.fill(0),s.javascriptNode&&(s.analyserNode.disconnect(),s.javascriptNode.disconnect(),s.javascriptNode.removeEventListener("audioprocess",s.onAnalyse,!1))})),(0,i.Z)(this,"onAnalyse",(function(){s.analyserNode.getByteFrequencyData(s.amplitudeArray)})),(0,i.Z)(this,"onError",(function(t){console.log("Error load audio",t)})),(0,i.Z)(this,"setPlaybackRate",(function(t){s.playbackRate=t,s.sourceNode&&(s.sourceNode.playbackRate.value=s.playbackRate)})),(0,i.Z)(this,"setVolume",(function(t){s.volume=t,s.gainNode&&(s.gainNode.gain.value=s.volume)})),(0,i.Z)(this,"getAmplitudes",(function(){return s.amplitudeArray})),(0,i.Z)(this,"getFrequencyLength",(function(){return s.analyserNode.frequencyBinCount})),(0,i.Z)(this,"getIsPlaying",(function(){return s.isPlaying})),(0,i.Z)(this,"getIsPause",(function(){return s.isPause}));var n=window.AudioContext||window.webkitAudioContext;this.support=!!n;try{this.audioContext=new n}catch(t){this.support=!1}this.audioData=null,this.playbackRate=1,this.playMultiple=!1,this.isPlaying=!1,this.isPause=!0,this.isMute=!0,this.isLoop=!0,this.volume=.5,this.setup(e)}return(0,n.Z)(t,[{key:"setup",value:function(t){this.support?(this.audioContext.decodeAudioData(t,this.saveData,this.onError),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=this.volume,this.gainNode.connect(this.audioContext.destination),this.sampleSize=1024,this.javascriptNode=this.audioContext.createScriptProcessor(this.sampleSize,1,1),this.analyserNode=this.audioContext.createAnalyser(),this.amplitudeArray=new Uint8Array(this.analyserNode.frequencyBinCount)):console.debug("No audio api support")}},{key:"play",value:function(){this.audioData&&(!this.playMultiple&&this.isPlaying&&this.stop(),this.sourceNode=this.audioContext.createBufferSource(),this.sourceNode.playbackRate.value=this.playbackRate,this.sourceNode.buffer=this.audioData,this.sourceNode.loop=this.isLoop,this.sourceNode.connect(this.gainNode),this.setupAnalyse(),this.sourceNode.addEventListener("ended",this.stop,!1),this.sourceNode.start(0),this.isPlaying=!0)}},{key:"setupAnalyse",value:function(){this.sourceNode.connect(this.analyserNode),this.analyserNode.connect(this.javascriptNode),this.javascriptNode.connect(this.audioContext.destination),this.javascriptNode.addEventListener("audioprocess",this.onAnalyse,!1)}},{key:"getSupport",value:function(){return this.support}}]),t}(),V=function(){function t(e){var s=this;(0,r.Z)(this,t),this.audios={},Object.keys(e).forEach((function(t){s.audios[t]=new G(e[t])}))}return(0,n.Z)(t,[{key:"get",value:function(t){return this.audios[t]}}]),t}(),q=s(2444),Y=function(){function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,r.Z)(this,t),this.fbos=[],this.currentFbo=0,this.fbos[0]=new q.Z(e,s,i,n,0),this.fbos[1]=new q.Z(e,s,i,n,1)}return(0,n.Z)(t,[{key:"start",value:function(){this.fbos[this.currentFbo].start()}},{key:"end",value:function(){this.fbos[this.currentFbo].end()}},{key:"swap",value:function(){this.currentFbo=0===this.currentFbo?1:0}},{key:"resize",value:function(t){this.fbos[0].resize(t),this.fbos[1].resize(t)}},{key:"getTexture",value:function(){return this.fbos[this.currentFbo].getTexture()}},{key:"getDepthTexture",value:function(){return this.fbos[this.currentFbo].getDepthTexture()}}]),t}(),W=s(21200),K=function(){function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,r.Z)(this,t),this.gl=e;var n=s.width,a=void 0===n?1024:n,o=s.height,h=void 0===o?1024:o,u=s.useDepth,c=void 0!==u&&u;this.ppb=new Y(e,a,h,c),this.screen=new W.Z(e),this.passCount=0,this.programs=i,this.viewportSize={width:a,height:h}}return(0,n.Z)(t,[{key:"start",value:function(){this.ppb.start(),this.passCount=0}},{key:"end",value:function(){this.ppb.end()}},{key:"resize",value:function(t){this.ppb.resize(t),this.viewportSize=t}},{key:"applyTexToProg",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=null===e;this.passCount=s?this.passCount+1:0;var i=this.passCount+1,r=s?this.ppb.getTexture().get():e;return t.setTexture(i,r,"textureMap"),t.setFloat("flipY",-1),t}},{key:"setBrightContrast",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.applyTexToProg(this.programs.brightcontrast,s);i.setFloat("brightness",t),i.setFloat("contrast",e),this.renderToPingPong(i)}},{key:"setFxaa",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.fxaa,t);this.renderToPingPong(e)}},{key:"setFxaa2",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.fxaa2,t);this.renderToPingPong(e)}},{key:"renderToPingPong",value:function(t){this.ppb.swap(),this.ppb.start(),this.screen.render(t.get()),this.ppb.end()}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=this.applyTexToProg(this.programs[e?"debug":"screen"],t);this.gl.viewport(0,0,this.viewportSize.width,this.viewportSize.height),this.screen.render(s.get())}},{key:"renderInverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=this.applyTexToProg(this.programs[e?"debug":"screen"],t);s.setFloat("flipY",1),this.gl.viewport(0,0,this.viewportSize.width,this.viewportSize.height),this.screen.render(s.get())}},{key:"getTexture",value:function(){return this.ppb.getTexture()}}]),t}();function H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,A.Z)(t);if(e){var r=(0,A.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,R.Z)(this,s)}}var J=function(t){(0,O.Z)(s,t);var e=H(s);function s(){return(0,r.Z)(this,s),e.apply(this,arguments)}return(0,n.Z)(s,[{key:"create",value:function(){for(var t=new ArrayBuffer(this.size.width*this.size.height*4),e=new Uint8Array(t),s=0,i=0;i<this.size.height;i+=1)for(var r=0;r<this.size.width;r+=1)e[s]=255*Math.random(),e[s+1]=255*Math.random(),e[s+2]=0,e[s+3]=255,s+=4;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.height,this.size.width,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}}]),s}(s(72710).Z);function Q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,A.Z)(t);if(e){var r=(0,A.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,R.Z)(this,s)}}var $=function(t){(0,O.Z)(s,t);var e=Q(s);function s(t,i){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,r.Z)(this,s),(n=e.call(this,t,i,a)).textures={},Object.keys(n.programs).forEach((function(t){switch(t){case"watercolor2":case"watercolor3":n.textures[t]=new J(n.gl,512,512)}})),n}return(0,n.Z)(s,[{key:"setDOF",value:function(t,e,s,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=this.applyTexToProg(this.programs.dof,r);n.setFloat("focusDistance",s),n.setFloat("blur",e),n.setFloat("ppm",i),n.setVector("range",t),n.setTexture(2,this.ppb.getDepthTexture().get(),"depthMap"),this.renderToPingPong(n)}},{key:"mergeBloom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.applyTexToProg(this.programs.mergeBloom,i);r.setFloat("gamma",e),r.setFloat("exposure",s),r.setTexture(3,t.get(),"bloomMap"),this.renderToPingPong(r)}},{key:"setKuwahara",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.kuwahara,t);this.renderToPingPong(e)}},{key:"setWatercolor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.watercolor,t);this.renderToPingPong(e)}},{key:"setWatercolor2",value:function(t,e,s,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=this.applyTexToProg(this.programs.watercolor2,r);n.setFloat("gradientStep",t),n.setFloat("advectStep",e),n.setFloat("flipHeightMap",s),n.setFloat("time",i),n.setTexture(2,this.textures.watercolor2.get(),"heightMap"),this.renderToPingPong(n)}},{key:"setWatercolor3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.watercolor3,t);e.setTexture(2,this.textures.watercolor3.get(),"noiseMap"),this.renderToPingPong(e)}},{key:"setWatercolorMoving",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.applyTexToProg(this.programs.watercolorMoving,i);r.setFloat("time",t),r.setVector("mouse",e),r.setFloat("scale",s),this.renderToPingPong(r)}},{key:"setSobel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.sobel,t);this.renderToPingPong(e)}},{key:"setGamma",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.applyTexToProg(this.programs.gamma,e);s.setFloat("gamma",t),this.renderToPingPong(s)}},{key:"setRGB",value:function(t,e,s,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=this.applyTexToProg(this.programs.rgb,r);n.setVector("center",[s,i]),n.setVector("delta",[t,e]),this.renderToPingPong(n)}},{key:"setVortex",value:function(t,e,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.applyTexToProg(this.programs.vortex,i);r.setVector("center",t),r.setFloat("radius",e),r.setFloat("angle",s),this.renderToPingPong(r)}},{key:"setOil",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.applyTexToProg(this.programs.oil,e);s.setFloat("radius",t),this.renderToPingPong(s)}},{key:"setSketch",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.applyTexToProg(this.programs.sketch,e);s.setFloat("delta",t),this.renderToPingPong(s)}},{key:"setPixel",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.applyTexToProg(this.programs.pixel,s);i.setVector("delta",[t,e]),this.renderToPingPong(i)}},{key:"setWave",value:function(t,e,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.applyTexToProg(this.programs.wave,i);r.setFloat("time",t),r.setFloat("radius",e),r.setVector("center",s),this.renderToPingPong(r)}},{key:"setSepia",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.applyTexToProg(this.programs.sepia,e);s.setFloat("delta",t),this.renderToPingPong(s)}},{key:"setGlitch",value:function(t,e,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.applyTexToProg(this.programs.glitch,i);r.setFloat("delta",e),r.setFloat("time",t),r.setFloat("speed",s),this.renderToPingPong(r)}},{key:"setGlitch2",value:function(t,e,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.applyTexToProg(this.programs.glitch2,i);r.setFloat("delta",e),r.setFloat("time",t),r.setFloat("speed",s),this.renderToPingPong(r)}},{key:"setGlitch3",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.applyTexToProg(this.programs.glitch3,s);i.setFloat("delta",e),i.setFloat("time",t),this.renderToPingPong(i)}},{key:"setGlitch4",value:function(t,e,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.applyTexToProg(this.programs.glitch4,i);r.setFloat("delta",e),r.setFloat("time",t),r.setFloat("rate",s),this.renderToPingPong(r)}},{key:"setSignature",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.applyTexToProg(this.programs.signature,s);i.setFloat("delta",e),i.setFloat("time",t),this.renderToPingPong(i)}},{key:"setCompose",value:function(t,e,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.applyTexToProg(this.programs.compose,i);r.setTexture(6,t,"ssaoMap"),r.setTexture(7,e,"shadowMap"),r.setTexture(4,s,"depthMap"),this.renderToPingPong(r)}},{key:"setComposeShadow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.applyTexToProg(this.programs.composeShadow,e);s.setTexture(4,t,"shadowMap"),this.renderToPingPong(s)}}]),s}(K);function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,A.Z)(t);if(e){var r=(0,A.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,R.Z)(this,s)}}var et=function(t){(0,O.Z)(s,t);var e=tt(s);function s(t,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,r.Z)(this,s),a=e.call(this,t,n,o),(0,i.Z)((0,j.Z)(a),"setBlurIntensity",(function(t){a.blurIntensity=t})),(0,i.Z)((0,j.Z)(a),"setBlurSize",(function(t){a.blurSize=t}));var h=n.blur||{};return a.blurSize=void 0!==h.size?h.size:.6,a.blurIntensity=void 0!==h.intensity?h.intensity:1,a}return(0,n.Z)(s,[{key:"setBlur",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.blurOnePass,t);e.setFloat("size",this.blurSize),e.setFloat("intensity",this.blurIntensity),this.renderToPingPong(e)}}]),s}(K);function st(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,A.Z)(t);if(e){var r=(0,A.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,R.Z)(this,s)}}var it=function(t){(0,O.Z)(s,t);var e=st(s);function s(t,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,r.Z)(this,s),a=e.call(this,t,n,o),(0,i.Z)((0,j.Z)(a),"setNbPass",(function(t){a.blurNbPass=t})),a.scale=void 0!==n.scale?n.scale:1,a.threshold=void 0!==n.threshold?n.threshold:.1,a}return(0,n.Z)(s,[{key:"end",value:function(){(0,N.Z)((0,A.Z)(s.prototype),"end",this).call(this),this.process()}},{key:"process",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.applyTexToProg(this.programs.bloom,t);e.setFloat("scale",this.scale),e.setFloat("threshold",this.threshold),this.renderToPingPong(e),this.setBlur()}}]),s}(et),rt=s(25773);function nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,A.Z)(t);if(e){var r=(0,A.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,R.Z)(this,s)}}var at=function(t){(0,O.Z)(s,t);var e=nt(s);function s(t,i){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,r.Z)(this,s),(n=e.call(this,t,i,a)).near=i.near||1,n.far=i.far||100,n.radius=i.radius||5,n.strength=i.strength||1;var o=n.programs.ssao;return o.setFloat("radius",n.radius),o.setFloat("near",n.near),o.setFloat("far",n.far),o.setFloat("strength",n.strength),n}return(0,n.Z)(s,[{key:"generateSsaoSamples",value:function(t,e){for(var s=0;s<e;s+=1){var i=s/e;i=F(i*i,.1,1);var r=new rt.Z((0,D.MX)(-1,1),(0,D.MX)(-1,1),(0,D.MX)(0,1)).normalise().multiplyNumber((0,D.MX)(0,1)).multiplyNumber(i);this.programs[t].setVector("samples[".concat(s,"]"),r.get())}}},{key:"compute",value:function(t){var e=this.applyTexToProg(this.programs.ssao,t);e.setFloat("flipY",-1),this.renderToPingPong(e)}}]),s}(et);function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var s,i=(0,A.Z)(t);if(e){var r=(0,A.Z)(this).constructor;s=Reflect.construct(i,arguments,r)}else s=i.apply(this,arguments);return(0,R.Z)(this,s)}}var ht=function(t){(0,O.Z)(s,t);var e=ot(s);function s(t,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,r.Z)(this,s),a=e.call(this,t,n,o),(0,i.Z)((0,j.Z)(a),"getProgram",(function(){return a.programs.shadow}));var h=a.programs.shadow;return h.setFloat("shadowEpsilon",n.epsilon||.01),h.setFloat("lighten",n.lighten||0),a}return(0,n.Z)(s,[{key:"start",value:function(t){var e=this.programs.shadow;t.setShadowProgram(e),(0,N.Z)((0,A.Z)(s.prototype),"start",this).call(this)}}]),s}(et);function ut(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function ct(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(s),!0).forEach((function(e){(0,i.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ut(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var lt=function(){function t(e,s,i){(0,r.Z)(this,t),this.gl=e,this.config=s,this.time=0;var n=this.config.canvas,a=n.width,h=n.height;if(this.containerSize={width:a,height:h},this.config.useDrawBuffer&&!this.config.support.drawBuffers&&document.querySelector("#".concat(this.config.slug)).parentNode.remove(),i){if(i.shaders&&(this.mngProg=new v(this.gl,i.shaders,s.canvas),s.postprocess)){var u={width:a,height:h,useDepth:this.canUseDepth()},c=this.mngProg.getAll();this.postProcess=new $(this.gl,u,c),s.postprocess.bloom&&(this.bloom=new it(this.gl,ct(ct({},u),s.postprocess.bloom),c)),s.postprocess.ssao&&(this.ssao=new at(this.gl,ct(ct(ct({},u),s.postprocess.ssao),{},{near:s.camera.near,far:s.camera.far}),c)),s.postprocess.shadow&&(this.shadow=new ht(this.gl,ct(ct({},u),s.postprocess.shadow),c))}i.textures&&(this.mngTex=new o(this.gl,i.textures,s.textures)),i.objets&&(this.mngObj=new f(this.gl,i.objets,i.materials)),i.gltfs&&(this.mngGltf=new X(this.gl,i.gltfs)),i.sounds&&(this.mngSound=new V(i.sounds))}this.resizeViewport()}return(0,n.Z)(t,[{key:"canUseDepth",value:function(){return this.config.useDepthTexture&&this.config.support.depthTexture||!1}},{key:"resize",value:function(t){this.containerSize=t,this.postProcess&&this.postProcess.resize(t),this.bloom&&this.bloom.resize(t),this.ssao&&this.ssao.resize(t),this.shadow&&this.shadow.resize(t),this.mngProg.updateResolution(this.containerSize.width,this.containerSize.height),this.resizeViewport()}},{key:"update",value:function(t){this.time=t}},{key:"render",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"resizeViewport",value:function(){this.gl.viewport(0,0,this.containerSize.width,this.containerSize.height)}},{key:"getColorPixel",value:function(t,e){var s=new Uint8Array(4);return this.gl.readPixels(t,e,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),s}}]),t}()},72710:(t,e,s)=>{"use strict";s.d(e,{Z:()=>n});var i=s(15671),r=s(43144),n=function(){function t(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64;(0,i.Z)(this,t),this.gl=e,this.size={width:s,height:r},this.texture=e.createTexture(),this.filter=e.NEAREST,this.setup()}return(0,r.Z)(t,[{key:"setup",value:function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.create(),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"create",value:function(){for(var t=new ArrayBuffer(this.size.width*this.size.height),e=new Uint8Array(t),s=0,i=0;i<this.size.height;i+=1)for(var r=0;r<this.size.width;r+=1)e[s]=255*Math.random(),s+=1;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.ALPHA,this.size.width,this.size.height,0,this.gl.ALPHA,this.gl.UNSIGNED_BYTE,e)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}},{key:"get",value:function(){return this.texture}},{key:"setFiltre",value:function(t){this.filter=t}},{key:"delete",value:function(){this.gl.deleteTexture(this.texture)}}]),t}()},91215:(t,e,s)=>{"use strict";s.d(e,{Z:()=>n});var i=s(15671),r=s(43144),n=function(){function t(e,s){(0,i.Z)(this,t),this.gl=e;var r=Math.sqrt(s.length/4);this.size={width:r,height:r},this.texture=e.createTexture(),this.filter=e.NEAREST,this.setup(s)}return(0,r.Z)(t,[{key:"setup",value:function(t){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}},{key:"setFilters",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}},{key:"get",value:function(){return this.texture}}]),t}()},8983:(t,e,s)=>{"use strict";s.r(e),s.d(e,{capitalize:()=>r,chunkArray:()=>i,getEnvPath:()=>n});var i=function(t,e){return Array.from({length:Math.ceil(t.length/e)},(function(s,i){return t.slice(i*e,i*e+e)}))},r=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},n=function(t){return"".concat("/public").concat(t)}},68763:(t,e,s)=>{"use strict";s.d(e,{CD:()=>h,Id:()=>i,MX:()=>r,Yp:()=>n,ZI:()=>o,mK:()=>a});var i=function(t){return Math.PI*t/180},r=function(t,e){return Math.random()*(e-t)+t},n=function(t,e,s,i,r){var n=i+(t-e)*(r-i)/(s-e||1);return n<Math.min(i,r)&&(n=Math.min(i,r)),n>Math.max(i,r)&&(n=Math.max(i,r)),n},a=function(t){return 0===t?0:t>0?1:-1},o=function(t){return t-Math.floor(t)},h=function(t,e,s){return t*(1-s)+e*s}},35115:(t,e,s)=>{"use strict";s.d(e,{Z:()=>u});var i=s(15671),r=s(43144),n=s(4942),a=function(){function t(e,s){(0,i.Z)(this,t),this.gl=e,s&&this.create(s),this.extension=e.getExtension("ANGLE_instanced_arrays")}return(0,r.Z)(t,[{key:"create",value:function(t){var e=t.locationKey,s=t.type,i=t.values,r=t.count,n=t.componentType,a=t.size,o=t.modeCalcul,h=t.isInstancing,u=void 0!==h&&h,c="SCALAR"!==s?this.gl.ARRAY_BUFFER:this.gl.ELEMENT_ARRAY_BUFFER;this.vbo=this.gl.createBuffer(),this.gl.bindBuffer(c,this.vbo),this.gl.bufferData(c,i,o),this.gl.bindBuffer(c,null),this.size=a,this.count=r,this.componentType=n,this.bufferType=c,this.locationKey=e,this.isInstancing=u}},{key:"enable",value:function(t){var e=this.locationKey,s=this.vbo,i=this.componentType,r=this.size,n=this.bufferType,a=this.isInstancing,o=void 0!==a&&a;if("indices"===e)this.gl.bindBuffer(n,s);else{var h=t.locations[e];void 0!==h&&-1!==h&&(this.gl.bindBuffer(n,s),this.gl.enableVertexAttribArray(h),this.gl.vertexAttribPointer(h,r,i,!1,0,0),o&&this.extension.vertexAttribDivisorANGLE(h,1))}}},{key:"start",value:function(t){this.gl.useProgram(t)}},{key:"end",value:function(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}},{key:"update",value:function(t){this.gl.bindBuffer(this.bufferType,this.vbo),this.gl.bufferSubData(this.bufferType,0,new Float32Array(t)),this.gl.bindBuffer(this.bufferType,null)}},{key:"render",value:function(t,e){"indices"===this.locationKey?this.gl.drawElements(e,this.count,this.componentType,0):this.gl.drawArrays(e,0,this.count)}},{key:"renderInstancing",value:function(t,e,s){"indices"===this.locationKey?this.extension.drawElementsInstancedANGLE(e,this.count,this.gl.UNSIGNED_SHORT,0,s):this.extension.drawArraysInstancedANGLE(e,0,this.count,s)}},{key:"getCount",value:function(){return this.count}}]),t}();function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function h(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){(0,n.Z)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var u=function(){function t(e,s){var r=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,i.Z)(this,t),(0,n.Z)(this,"getActiveVbo",(function(){return r.vbos.indices||r.vbos.position||r.vbos.texture})),this.gl=e,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=o?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,this.vbos=Object.keys(s).reduce((function(t,i){return t[i]=new a(e,h({locationKey:i,modeCalcul:r.modeCalcul},s[i])),t}),{}),this.instanceCount=-1}return(0,r.Z)(t,[{key:"addInstancingVbos",value:function(t,e){var s=this,i=Object.keys(e).reduce((function(t,i){return t[i]=new a(s.gl,h({locationKey:i,modeCalcul:s.modeCalcul,isInstancing:!0},e[i])),t}),{});this.vbos=h(h({},this.vbos),i),this.instanceCount=t}},{key:"enable",value:function(t){var e=this;this.gl.useProgram(t),Object.keys(this.vbos).forEach((function(s){e.vbos[s].enable(t)}))}},{key:"update",value:function(t){var e=this;Object.keys(t).forEach((function(s){e.vbos[s].update(t[s])}))}},{key:"render",value:function(t){this.enable(t);var e=this.getActiveVbo();-1!==this.instanceCount?e.renderInstancing(t,this.modeDessin,this.instanceCount):e.render(t,this.modeDessin),e.end()}},{key:"setModeDessin",value:function(t){this.modeDessin=t}},{key:"setModeCalcul",value:function(t){this.modeCalcul=t}}]),t}()},46007:(t,e,s)=>{var i={"./shaders/camera/albedo":[30538,538],"./shaders/camera/albedo.js":[30538,538],"./shaders/camera/albedoPhong":[34931,4931],"./shaders/camera/albedoPhong.js":[34931,4931],"./shaders/camera/background":[8525,8525],"./shaders/camera/background.js":[8525,8525],"./shaders/camera/basicFrag":[78834,8834],"./shaders/camera/basicFrag.js":[78834,8834],"./shaders/camera/basicVertex":[94096,4096],"./shaders/camera/basicVertex.js":[94096,4096],"./shaders/camera/basique3d":[9965,9965],"./shaders/camera/basique3d.js":[9965,9965],"./shaders/camera/bone":[52041,2041],"./shaders/camera/bone.js":[52041,2041],"./shaders/camera/buffers":[74383,4383],"./shaders/camera/buffers.js":[74383,4383],"./shaders/camera/color":[86193,6193],"./shaders/camera/color.js":[86193,6193],"./shaders/camera/deform":[24142,4142],"./shaders/camera/deform.js":[24142,4142],"./shaders/camera/emissive":[65864,5864],"./shaders/camera/emissive.js":[65864,5864],"./shaders/camera/frequency":[28562,8562],"./shaders/camera/frequency.js":[28562,8562],"./shaders/camera/frequencyCircle":[165,165],"./shaders/camera/frequencyCircle.js":[165,165],"./shaders/camera/frequencyGrid":[69383,9383],"./shaders/camera/frequencyGrid.js":[69383,9383],"./shaders/camera/gltf":[28391,8391],"./shaders/camera/gltf.js":[28391,8391],"./shaders/camera/morph":[22099,2099],"./shaders/camera/morph.js":[22099,2099],"./shaders/camera/normale":[31307,1307],"./shaders/camera/normale.js":[31307,1307],"./shaders/camera/normaleMatrix":[61776,1776],"./shaders/camera/normaleMatrix.js":[61776,1776],"./shaders/camera/normalmapping":[95778,5778],"./shaders/camera/normalmapping.js":[95778,5778],"./shaders/camera/paysage":[14134,4134],"./shaders/camera/paysage.js":[14134,4134],"./shaders/camera/phong":[20557,557],"./shaders/camera/phong.js":[20557,557],"./shaders/camera/road":[94422,4422],"./shaders/camera/road.js":[94422,4422],"./shaders/camera/roadmountain":[43681,3681],"./shaders/camera/roadmountain.js":[43681,3681],"./shaders/camera/selected":[4035,4035],"./shaders/camera/selected.js":[4035,4035],"./shaders/camera/shadow":[68099,8099],"./shaders/camera/shadow.js":[68099,8099],"./shaders/camera/signature":[7402,7402],"./shaders/camera/signature.js":[7402,7402],"./shaders/camera/skin":[99904,9904],"./shaders/camera/skin.js":[99904,9904],"./shaders/camera/skinMat":[69948,9948],"./shaders/camera/skinMat.js":[69948,9948],"./shaders/camera/sprite":[4106,4106],"./shaders/camera/sprite.js":[4106,4106],"./shaders/camera/spritePhong":[72810,2810],"./shaders/camera/spritePhong.js":[72810,2810],"./shaders/camera/texture":[1056,1056],"./shaders/camera/texture.js":[1056,1056],"./shaders/camera/update":[45293,5293],"./shaders/camera/update.js":[45293,5293],"./shaders/camera/vertexColor":[96003,6003],"./shaders/camera/vertexColor.js":[96003,6003],"./shaders/diorama/instancing":[8225,8225],"./shaders/diorama/instancing.js":[8225,8225],"./shaders/diorama/instancingDepth":[36202,6202],"./shaders/diorama/instancingDepth.js":[36202,6202],"./shaders/diorama/shadow":[92581,2581],"./shaders/diorama/shadow.js":[92581,2581],"./shaders/diorama/terrain":[68614,8614],"./shaders/diorama/terrain.js":[68614,8614],"./shaders/diorama/terrainClip":[10075,75],"./shaders/diorama/terrainClip.js":[10075,75],"./shaders/diorama/terrainDepth":[24977,4977],"./shaders/diorama/terrainDepth.js":[24977,4977],"./shaders/diorama/water":[40409,409],"./shaders/diorama/water.js":[40409,409],"./shaders/diorama/waterFragment1":[89519,9519],"./shaders/diorama/waterFragment1.js":[89519,9519],"./shaders/diorama/waterFragment2":[84121,5550],"./shaders/diorama/waterFragment2.js":[84121,5550],"./shaders/particules/pass1":[4365,4365],"./shaders/particules/pass1.js":[4365,4365],"./shaders/particules/pass1Morph":[90263,263],"./shaders/particules/pass1Morph.js":[90263,263],"./shaders/particules/pass2":[96579,6579],"./shaders/particules/pass2.js":[96579,6579],"./shaders/particules/pass2Camera":[24307,4307],"./shaders/particules/pass2Camera.js":[24307,4307],"./shaders/screen/basicVertex":[57719,7719],"./shaders/screen/basicVertex.js":[57719,7719],"./shaders/screen/bloom":[8645,8645],"./shaders/screen/bloom.js":[8645,8645],"./shaders/screen/blur":[50654,654],"./shaders/screen/blur.js":[50654,654],"./shaders/screen/blurDirection":[4510,4510],"./shaders/screen/blurDirection.js":[4510,4510],"./shaders/screen/blurMultiPass":[88615,8615],"./shaders/screen/blurMultiPass.js":[88615,8615],"./shaders/screen/blurOnePass":[84002,4002],"./shaders/screen/blurOnePass.js":[84002,4002],"./shaders/screen/blurRadial":[76812,6812],"./shaders/screen/blurRadial.js":[76812,6812],"./shaders/screen/brightcontrast":[47540,7540],"./shaders/screen/brightcontrast.js":[47540,7540],"./shaders/screen/compose":[94121,4121],"./shaders/screen/compose.js":[94121,4121],"./shaders/screen/composeShadow":[55829,5829],"./shaders/screen/composeShadow.js":[55829,5829],"./shaders/screen/debug":[33459,3459],"./shaders/screen/debug.js":[33459,3459],"./shaders/screen/diffuse":[19442,9442],"./shaders/screen/diffuse.js":[19442,9442],"./shaders/screen/dof":[85931,5931],"./shaders/screen/dof.js":[85931,5931],"./shaders/screen/fxaa":[52587,2587],"./shaders/screen/fxaa.js":[52587,2587],"./shaders/screen/fxaa2":[73563,3563],"./shaders/screen/fxaa2.js":[73563,3563],"./shaders/screen/gamma":[64455,4455],"./shaders/screen/gamma.js":[64455,4455],"./shaders/screen/glitch":[59914,9914],"./shaders/screen/glitch.js":[59914,9914],"./shaders/screen/glitch2":[95040,5040],"./shaders/screen/glitch2.js":[95040,5040],"./shaders/screen/glitch3":[58081,8081],"./shaders/screen/glitch3.js":[58081,8081],"./shaders/screen/glitch4":[14018,4018],"./shaders/screen/glitch4.js":[14018,4018],"./shaders/screen/kuwahara":[57938,7938],"./shaders/screen/kuwahara.js":[57938,7938],"./shaders/screen/landscape":[84778,4778],"./shaders/screen/landscape.js":[84778,4778],"./shaders/screen/line":[66140,6140],"./shaders/screen/line.js":[66140,6140],"./shaders/screen/mergeBloom":[99452,9452],"./shaders/screen/mergeBloom.js":[99452,9452],"./shaders/screen/oil":[69081,9081],"./shaders/screen/oil.js":[69081,9081],"./shaders/screen/pixel":[26447,6447],"./shaders/screen/pixel.js":[26447,6447],"./shaders/screen/point":[34865,4865],"./shaders/screen/point.js":[34865,4865],"./shaders/screen/raymarch":[2806,2806],"./shaders/screen/raymarch.js":[2806,2806],"./shaders/screen/rgb":[58919,8919],"./shaders/screen/rgb.js":[58919,8919],"./shaders/screen/screen":[62605,2605],"./shaders/screen/screen.js":[62605,2605],"./shaders/screen/sepia":[27168,7168],"./shaders/screen/sepia.js":[27168,7168],"./shaders/screen/shader":[59219,9219],"./shaders/screen/shader.js":[59219,9219],"./shaders/screen/signature":[43100,3100],"./shaders/screen/signature.js":[43100,3100],"./shaders/screen/sketch":[37912,7912],"./shaders/screen/sketch.js":[37912,7912],"./shaders/screen/sobel":[22847,2847],"./shaders/screen/sobel.js":[22847,2847],"./shaders/screen/specular":[8379,8379],"./shaders/screen/specular.js":[8379,8379],"./shaders/screen/ssao":[2956,2956],"./shaders/screen/ssao-chapman":[63477,3477],"./shaders/screen/ssao-chapman.js":[63477,3477],"./shaders/screen/ssao.js":[2956,2956],"./shaders/screen/tunnelrace":[87052,7052],"./shaders/screen/tunnelrace.js":[87052,7052],"./shaders/screen/tunnelround":[31315,1315],"./shaders/screen/tunnelround.js":[31315,1315],"./shaders/screen/tunnelsquared":[28390,8390],"./shaders/screen/tunnelsquared.js":[28390,8390],"./shaders/screen/vortex":[4342,4342],"./shaders/screen/vortex.js":[4342,4342],"./shaders/screen/water":[35784,5784],"./shaders/screen/water.js":[35784,5784],"./shaders/screen/watercolor":[91360,1360],"./shaders/screen/watercolor.js":[91360,1360],"./shaders/screen/watercolor2":[43298,3298],"./shaders/screen/watercolor2.js":[43298,3298],"./shaders/screen/watercolor3":[17427,7427],"./shaders/screen/watercolor3.js":[17427,7427],"./shaders/screen/watercolorMoving":[88096,8096],"./shaders/screen/watercolorMoving.js":[88096,8096],"./shaders/screen/wave":[38514,8514],"./shaders/screen/wave.js":[38514,8514],"./shaders/sky/getClouds":[29044,9044],"./shaders/sky/getClouds.js":[29044,9044],"./shaders/sky/getSunSky":[36507,6507],"./shaders/sky/getSunSky.js":[36507,6507],"./shaders/sky/roadSky":[14472,4472],"./shaders/sky/roadSky.js":[14472,4472],"./shaders/sky/skyWithFloor":[93671,3671],"./shaders/sky/skyWithFloor.js":[93671,3671],"./shaders/sky/sunset":[70040,40],"./shaders/sky/sunset.js":[70040,40],"./shaders/sky/tunnel":[52344,2344],"./shaders/sky/tunnel.js":[52344,2344],"./shaders/utils":[20552,552],"./shaders/utils/":[20552,552],"./shaders/utils/blur":[29098,9098],"./shaders/utils/blur.js":[29098,9098],"./shaders/utils/fog":[58125,8125],"./shaders/utils/fog.js":[58125,8125],"./shaders/utils/index":[20552,552],"./shaders/utils/index.js":[20552,552],"./shaders/utils/instancing":[77873,7873],"./shaders/utils/instancing.js":[77873,7873],"./shaders/utils/light":[8735,8735],"./shaders/utils/light.js":[8735,8735],"./shaders/utils/noise":[96215,6215],"./shaders/utils/noise.js":[96215,6215],"./shaders/utils/pbr":[60568,568],"./shaders/utils/pbr.js":[60568,568],"./shaders/utils/random":[32362,2362],"./shaders/utils/random.js":[32362,2362],"./shaders/utils/roadDistortion":[74926,4926],"./shaders/utils/roadDistortion.js":[74926,4926],"./shaders/utils/shadow":[44956,4956],"./shaders/utils/shadow.js":[44956,4956],"./shaders/utils/shapes":[94960,4960],"./shaders/utils/shapes.js":[94960,4960],"./shaders/utils/terrain":[42235,2235],"./shaders/utils/terrain.js":[42235,2235],"./shaders/utils/toon":[99060,9060],"./shaders/utils/toon.js":[99060,9060]};function r(t){if(!s.o(i,t))return Promise.resolve().then((()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=i[t],r=e[0];return s.e(e[1]).then((()=>s(r)))}r.keys=()=>Object.keys(i),r.id=46007,t.exports=r},97326:(t,e,s)=>{"use strict";function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}s.d(e,{Z:()=>i})},15671:(t,e,s)=>{"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}s.d(e,{Z:()=>i})},92826:(t,e,s)=>{"use strict";s.d(e,{Z:()=>n});var i=s(89611);function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function n(t,e,s){return n=r()?Reflect.construct:function(t,e,s){var r=[null];r.push.apply(r,e);var n=new(Function.bind.apply(t,r));return s&&(0,i.Z)(n,s.prototype),n},n.apply(null,arguments)}},43144:(t,e,s)=>{"use strict";function i(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,s){return e&&i(t.prototype,e),s&&i(t,s),t}s.d(e,{Z:()=>r})},11752:(t,e,s)=>{"use strict";s.d(e,{Z:()=>n});var i=s(61120);function r(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=(0,i.Z)(t)););return t}function n(){return n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,s){var i=r(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(arguments.length<3?t:s):n.value}},n.apply(this,arguments)}},61120:(t,e,s)=>{"use strict";function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}s.d(e,{Z:()=>i})},60136:(t,e,s)=>{"use strict";s.d(e,{Z:()=>r});var i=s(89611);function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&(0,i.Z)(t,e)}},45987:(t,e,s)=>{"use strict";s.d(e,{Z:()=>r});var i=s(63366);function r(t,e){if(null==t)return{};var s,r,n=(0,i.Z)(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)s=a[r],e.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}},6215:(t,e,s)=>{"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}s.d(e,{Z:()=>n});var r=s(97326);function n(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return(0,r.Z)(t)}},89611:(t,e,s)=>{"use strict";function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}s.d(e,{Z:()=>i})},42982:(t,e,s)=>{"use strict";s.d(e,{Z:()=>n});var i=s(30907);var r=s(40181);function n(t){return function(t){if(Array.isArray(t))return(0,i.Z)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||(0,r.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);