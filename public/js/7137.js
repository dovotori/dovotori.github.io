(self.webpackChunkdovotori=self.webpackChunkdovotori||[]).push([[7137,8983],{59713:t=>{t.exports=function(t,s,e){return s in t?Object.defineProperty(t,s,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[s]=e,t}},35466:(t,s,e)=>{"use strict";e.d(s,{Z:()=>L});var i=e(59713),r=e.n(i);const h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256);for(let t=0;t<h.length;t++)n[h.charCodeAt(t)]=t;const a=(t,s,e,i,r)=>{const h=new Float32Array(s),n=r||Float32Array.BYTES_PER_ELEMENT*i;let a=0,o=0;for(let s=0;s<e;s++){for(let s=0;s<i;s++){const e=a+s*Float32Array.BYTES_PER_ELEMENT;h[o]=t.getFloat32(e,!0),o++}a+=n}return h},o=(t,s,e,i,r)=>{const h=new Uint16Array(s),n=r||Uint16Array.BYTES_PER_ELEMENT*i;let a=0,o=0;for(let s=0;s<e;s++){for(let s=0;s<i;s++){const e=a+s*Uint16Array.BYTES_PER_ELEMENT;h[o]=t.getUint16(e,!0),o++}a+=n}return h},l=(t,s)=>{const e=new Uint8Array(s);for(let i=0;i<s;i++)e[i]=t.getUint8(i,!0);return e};var d=e(8983);const c="VEC2",u="VEC3",g="VEC4",m="MAT2",p="MAT3",f="MAT4",b=t=>{switch(t){case c:return 2;case u:return 3;case g:case m:return 4;case p:return 9;case f:return 16;default:return 1}},v=(t,s,e)=>{const{bufferView:i,componentType:r,count:h,type:n,byteOffset:d=0}=e,{buffer:c,byteLength:u,byteOffset:g=0,byteStride:m}=s[i],p=new DataView(t[c],g+d,u-d),f=b(n),v=((t,s)=>b(t)*s)(n,h),y=(t=>{switch(t){case 5123:return o;case 5126:return a;case 5121:return l;default:return null}})(r);return y?y(p,v,h,f,m):null},y=t=>{switch(t){case"normal":return"normale";case"texcoord_0":return"texture";case"baseColorFactor":return"color";case"metallicFactor":return"metal";case"roughnessFactor":return"rough";case"joints_0":return"joint";case"weights_0":return"weight";default:return t}},x=["position","normale","texture","joint","weight","tangent"],E=(t,s)=>t.map((t=>{const{attributes:e,indices:i,material:r,targets:h}=t,n=((t,s,e,i)=>{const r=s[e];let h={indices:{...r,size:b(r.type)}},n=i?.map((t=>Object.keys(t).reduce(((e,i)=>{const r=s[t[i]];return{...e,[i]:{...r,size:b(r.type)}}}),{})));return n&&(n=n.reduce(((t,s,e)=>({...t,...Object.keys(s).reduce(((t,i)=>({...t,[`target${y(i.toLowerCase())}${e}`]:s[i]})),{})})),{}),h={...n,...h}),Object.keys(t).reduce(((e,i)=>{const r=y(i.toLowerCase());if(-1===x.indexOf(r))return e;const h=t[i],n=s[h];return{...e,[r]:{...n,size:b(n.type)}}}),h)})(e,s,i,h);let a={vbos:n};return void 0!==r&&(a={material:r,...a}),a})),T=(t,s)=>t.map((t=>{const e=s.findIndex((s=>s.id===t)),i=s.splice(e,1)[0];i.children&&(i.children=T(i.children,s));const{id:r,...h}=i;return h})),w=(t,s,e,i)=>t?t.map((t=>{let{bufferView:s,mimeType:r,name:h}=t;const n=i[s],a=((t,s)=>{const{buffer:e,byteOffset:i,byteLength:r}=s,h=new DataView(t[e],i,r);return l(h,r)})(e,n);return{mimeType:r,name:h,data:a}})):null,P=(t,s)=>{const{children:e}=t;if(e){const i=e.map((t=>P(s[t],s)));return{...t,children:i}}return t},A=t=>t.reduce(((t,s)=>{const{name:e,children:i}=s;return t[e]=s,i&&(t[e].children=A(i)),t}),{});class M{constructor(){this.assets={textures:{},objets:{},materials:{},levels:{},gltfs:{},sounds:{}}}static getInfo(t){const s=t.substring(t.lastIndexOf("/")+1,t.length).split(".");return{name:s[0],ext:s[1].toLowerCase()}}static loadMaterial(t,s){return fetch(t).then((t=>t.text())).then((t=>({data:new class{constructor(t){this.materials={},this.current="",this.readLines(t)}readLines(t){t.split("\n").forEach((t=>{const s=t.split(" "),e=s[0];switch(e){case"newmtl":this.createMaterial(s.slice(1));break;case"Ns":case"Ka":case"Kd":case"Ks":case"Ke":case"Ni":case"d":case"illum":this.addInfoToMaterial(e,s.slice(1))}}))}createMaterial(t){this.current=t,this.materials[this.current]={}}addInfoToMaterial(t,s){let e="";switch(t){case"Ka":e="ambiant";break;case"Kd":e="diffuse";break;case"Ks":e="specular";break;case"Ke":e="emissive";break;case"Ns":e="specDensity";break;case"d":e="opacity"}""!==e&&(this.materials[this.current][e]=s.map((t=>parseFloat(t,10))))}get(){return this.materials}}(t).get(),info:s})))}static loadImage(t,s){return new Promise(((e,i)=>{const r=new Image;r.onload=()=>e({data:r,info:s}),r.onerror=i,r.src=t}))}static loadSound(t,s){return fetch(t).then((t=>t.arrayBuffer())).then((t=>({data:t,info:s})))}get(t){const s=t.map((t=>{const s=M.getInfo(t);switch(s.ext){case"jpg":case"jpeg":case"png":case"bmp":return M.loadImage(t,s);case"obj":return M.load3dObj(t,s);case"gltf":return M.load3dGltf(t,s);case"mtl":return M.loadMaterial(t,s);case"mp3":return M.loadSound(t,s);default:return null}}));return Promise.all(s).then((t=>(t.forEach((t=>{switch(t.info.ext){case"jpg":case"jpeg":case"png":this.assets.textures[t.info.name]=t.data;break;case"bmp":this.assets.levels[t.info.name]=t.data;break;case"obj":this.assets.objets[t.info.name]=t.data;break;case"gltf":this.assets.gltfs[t.info.name]=t.data;break;case"mtl":this.assets.materials[t.info.name]=t.data;break;case"mp3":this.assets.sounds[t.info.name]=t.data}})),this.assets)))}}r()(M,"load3dObj",((t,s)=>fetch(t).then((t=>t.text())).then((t=>({data:new class{constructor(t){r()(this,"addFaceIndex",(t=>{const s=t.split("/");s[0]&&""!==s[0]&&this.obj.v.indices.push(parseInt(s[0],10)-1),s[1]&&""!==s[1]&&this.obj.vt.indices.push(parseInt(s[1],10)-1),s[2]&&""!==s[2]&&this.obj.vn.indices.push(parseInt(s[2],10)-1)})),this.obj={v:{indices:[],points:[]},vt:{indices:[],points:[]},vn:{indices:[],points:[]}},this.mat={},this.faceCount=0,this.readLines(t)}readLines(t){t.split("\n").forEach((t=>{const s=t.split(" "),e=s[0];switch(e){case"f":this.addFace(s.slice(1));break;case"v":case"vn":case"vt":this.addPoints(e,s.slice(1));break;case"usemtl":this.addNewMaterial(s.slice(1)[0])}}))}addFace(t){t.forEach(this.addFaceIndex),this.faceCount+=1}addPoints(t,s){("vt"===t&&3===s.length?s.slice(0,2):s).forEach((s=>this.obj[t].points.push(parseFloat(s,10))))}addNewMaterial(t){this.mat[3*this.faceCount]=t}get(){return{...this.obj,mat:this.mat}}}(t).get(),info:s}))))),r()(M,"load3dGltf",((t,s)=>fetch(t).then((t=>t.text())).then((t=>{const e=new class{constructor(t){const s=JSON.parse(t),{animations:e,buffers:i,bufferViews:r,accessors:h,skins:a,nodes:o,meshes:l,materials:c,images:u}=s,g=i?.map((t=>(t=>{const s=t.split(",")[1];let e=.75*s.length;const i=s.length;let r,h,a,o,l,d=0;"="===s[s.length-1]&&(e--,"="===s[s.length-2]&&e--);const c=new ArrayBuffer(e),u=new Uint8Array(c);for(r=0;r<i;r+=4)h=n[s.charCodeAt(r)],a=n[s.charCodeAt(r+1)],o=n[s.charCodeAt(r+2)],l=n[s.charCodeAt(r+3)],u[d++]=h<<2|a>>4,u[d++]=(15&a)<<4|o>>2,u[d++]=(3&o)<<6|63&l;return c})(t.uri))),m=h?.map((t=>({...t,values:v(g,r,t)}))),p=a?.reduce(((t,s)=>t.concat(s.joints)),[]),f=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.map(((t,e)=>{let i=t.name||`node-${e}`,r="node";return-1!==s.indexOf(e)&&(i=t.name||`joint-${e}`,r="joint"),{...t,name:i,customType:r}}))}(o,p),x=((t,s,e,i)=>{const r={};return t&&t.forEach((t=>{let{channels:h,samplers:n}=t;h.forEach((t=>{let{target:h,sampler:a}=t;const{input:o,output:l,interpolation:c}=n[a],u=e[o],g=e[l],{node:m,path:p}=h,f=s[m];let v=b(g.type);f[p]?v=f[p].length:f.mesh&&i[f.mesh][p]?v=i[f.mesh][p].length:"scale"===p&&(v=3);const y=(0,d.chunkArray)(g.values,v),x={path:p,times:u.values,output:y,interpolation:c};r[m]=r[m]?[...r[m],x]:[x]}))})),r})(e,f,m,l);Object.keys(x).forEach((t=>{f[t].animations=x[t]}));const M=((t,s,e)=>{let i=null;if(t){const r=s.map(((t,s)=>({...t,id:s})));i=t.map((t=>{let{inverseBindMatrices:s,joints:i}=t,h=[];if(s){const t=e[s].values;h=(0,d.chunkArray)(t,16)}if(i){const t=i.map(((t,s)=>({...r[t],invMatrix:h[s]}))).slice(),s=[];for(;0!==t.length;){const e=t.shift();e.children&&(e.children=T(e.children,t));const{id:i,...r}=e;s.push(r)}return{joints:s}}return null})).filter((t=>t))}return i})(a,f,m),F=l.map((t=>{let{primitives:s,weights:e}=t,i={primitives:E(s,m)};return e&&(i={weights:e,...i}),i})),k=w(u,0,g,r),R=c&&c.map((t=>((t,s)=>{let e={};if(t&&(e={...(i=t.pbrMetallicRoughness,Object.keys(i).reduce(((t,s)=>({...t,[y(s)]:i[s]})),[])),name:t.name},t.normalTexture)){const i=s[t.normalTexture.index];e.normalMap=i||void 0}var i;return Object.keys(e).length>0?e:void 0})(t,k)));let j=(t=>{const s={};return t.forEach((t=>{let{children:e}=t;return e&&e.forEach((t=>{s[t]=!0}))})),t.map((s=>P(s,t))).filter(((t,e)=>void 0===s[e]))})(f);j=A(j),this.data={},F&&(this.data.meshes=F),j&&(this.data.nodes=j),M&&(this.data.skins=M),R&&(this.data.materials=R)}get(){return this.data}}(t);return{data:e.get(),info:s}}))));const F=M;class k{constructor(){this.shaders={}}static getInfos(t){const s=t.substring(t.lastIndexOf("/")+1,t.length).split(".");return{name:s[0],ext:s[1].toLowerCase()}}get(t){const s=t.map((t=>{let s={};const{name:i}=k.getInfos(t);try{s=e(46007)(`./shaders${t}`).then((t=>({name:i,js:t})))}catch(t){}return s}));return Promise.all(s).then((t=>(t.forEach((t=>{let{name:s,js:e}=t;this.shaders[s]=e.default})),this.shaders)))}}const R=k;class j{static checkWebGl(t){const s=["webgl","experimental-webgl","webkit-3d","moz-webgl"];let e;for(let i=0;i<s.length;i+=1){try{e=t.getContext(s[i],{preserveDrawingBuffer:!0})}catch(t){}if(e)break}return e}constructor(t){this.gl=j.checkWebGl(t),this.support={webgl:!1,depthTexture:!1},this.gl&&(this.support.webgl=!0,this.gl.enable(this.gl.DEPTH_TEST),this.gl.clearDepth(1),this.gl.depthFunc(this.gl.LESS),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.clearColor(0,0,0,0),this.support.depthTexture=!!this.gl.getExtension("WEBGL_depth_texture"),this.support.instancedArrays=!!this.gl.getExtension("ANGLE_instanced_arrays"),this.support.drawBuffers=!!this.gl.getExtension("WEBGL_draw_buffers")||!!this.gl.getExtension("GL_EXT_draw_buffers")||!!this.gl.getExtension("EXT_draw_buffers")),this.support.pixelRatio=window.devicePixelRatio||1}get(){return this.gl}getSupport(){return this.support}}const C=j;class D{constructor(t){r()(this,"enter",(()=>{this.support&&(this.isFullscreen=!0,this.domItem.requestFullscreen?this.domItem.requestFullscreen():this.domItem.msRequestFullscreen?this.domItem.msRequestFullscreen():this.domItem.mozRequestFullScreen?this.domItem.mozRequestFullScreen():this.domItem.webkitRequestFullscreen&&this.domItem.webkitRequestFullscreen())})),r()(this,"exit",(()=>{this.support&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())})),r()(this,"listen",(()=>{this.support&&(document.exitFullscreen?document.addEventListener("fullscreenchange",this.onChange,!1):document.msExitFullscreen?document.addEventListener("MSFullscreenChange",this.onChange,!1):document.mozCancelFullScreen?document.addEventListener("mozfullscreenchange",this.onChange,!1):document.webkitExitFullscreen&&document.addEventListener("webkitfullscreenchange",this.onChange,!1))})),r()(this,"onChange",(()=>{this.domItem&&(D.isOnFullscreen()?(this.domItem.setAttribute("data-fullscreen",!0),this.isFullscreen=!0):(this.domItem.removeAttribute("data-fullscreen"),this.isFullscreen=!1))})),r()(this,"toggle",(()=>{this.isFullscreen?this.exit():this.enter()})),r()(this,"getButton",(()=>this.button)),this.domItem=t,this.isFullscreen=!1,this.support=!!(document.exitFullscreen||document.msExitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen),this.button=document.createElement("button"),this.button.id="fullscreen-toggle-btn",this.button.innerHTML='\n<svg viewbox="0 0 100 100">\n  <path d="M 0 40 L 0 0 L 40 0 L 40 10 L 10 10 L 10 40 Z"></path>\n  <path d="M 60 100 L 100 100 L 100 60 L 90 60 L 90 90 L 60 90 Z"></path>\n</svg>\n    ',this.button.addEventListener("click",this.toggle,!1),this.listen()}destroy(){this.button&&this.button.removeEventListener("click",this.toggle,!1),this.support&&(document.exitFullscreen?document.removeEventListener("fullscreenchange",this.onExit,!1):document.msExitFullscreen?document.removeEventListener("MSFullscreenChange",this.onExit,!1):document.mozCancelFullScreen?document.removeEventListener("mozfullscreenchange",this.onExit,!1):document.webkitExitFullscreen&&document.removeEventListener("webkitfullscreenchange",this.onExit,!1))}get(){return this.isFullscreen}getSupport(){return this.support}}r()(D,"isOnFullscreen",(()=>!!document.fullscreenElement));const _=D;var z=e(68763);const S=class{constructor(t,s){let{callbackDrag:e,callbackDown:i,callbackUp:h,callbackMove:n,callbackWheel:a,callbackClick:o}=s;r()(this,"onMove",(t=>{const s=this.computeInfos(t);this.oldPos=this.getPos(t),null!==this.callbackMove&&this.callbackMove(s),this.isDragging&&null!==this.callbackDrag&&this.callbackDrag(s)})),r()(this,"onDown",(t=>{if(this.isDragging=!0,this.startDraggingMousePos=this.getPos(t),null!==this.callbackDown){const s=this.computeInfos(t);this.callbackDown(s)}this.oldPos=this.getPos(t)})),r()(this,"onUp",(t=>{if(this.onMove(t),this.isDragging=!1,null!==this.callbackUp){const s=this.computeInfos(t);this.callbackUp(s)}})),r()(this,"onWheel",(t=>{const{deltaY:s}=t;null!==this.callbackWheel&&this.callbackWheel({deltaY:s})})),r()(this,"onClick",(t=>{null!==this.callbackClick&&this.callbackClick(this.computeInfos(t))})),this.div=t,this.callbackDrag=e||null,this.callbackDown=i||null,this.callbackUp=h||null,this.callbackMove=n||null,this.callbackWheel=a||null,this.callbackClick=o||null,this.isDragging=!1,this.startDraggingMousePos={x:0,y:0},this.oldPos={x:0,y:0},this.options={capture:!1,passive:!0},this.setup()}setup(){this.div&&(this.callbackClick&&this.div.addEventListener("click",this.onClick,!1),(this.callbackDrag||this.callbackMove)&&(this.div.addEventListener("mousemove",this.onMove,this.options),this.div.addEventListener("touchmove",this.onMove,this.options)),(this.callbackDrag||this.callbackDown||this.callbackUp)&&(window.addEventListener("mouseup",this.onUp,this.options),this.div.addEventListener("mousedown",this.onDown,this.options),this.div.addEventListener("touchstart",this.onDown,this.options),this.div.addEventListener("touchend",this.onUp,this.options)),this.callbackWheel&&this.div.addEventListener("wheel",this.onWheel,this.options))}cancel(){this.div&&(this.callbackClick&&this.div.removeEventListener("click",this.onClick,!1),(this.callbackDrag||this.callbackMove)&&(this.div.removeEventListener("mousemove",this.onMove,this.options),this.div.removeEventListener("touchmove",this.onMove,this.options)),this.callbackDrag&&(window.removeEventListener("mouseup",this.onUp,this.options),this.div.removeEventListener("mousedown",this.onDown,this.options),this.div.removeEventListener("touchstart",this.onDown,this.options),this.div.removeEventListener("touchend",this.onUp,this.options)),this.callbackWheel&&this.div.removeEventListener("wheel",this.onWheel,this.options))}getPos(t){return t.touches?.length>=0?{x:0===t.touches.length?this.oldPos.x:t.touches[0].clientX,y:0===t.touches.length?this.oldPos.y:t.touches[0].clientY}:{x:t.clientX,y:t.clientY}}computeInfos(t){const s=this.getPos(t),e=this.div.getBoundingClientRect(),i=s.x-e.x,r=s.y-e.y,h={x:this.oldPos.x-s.x,y:this.oldPos.y-s.y};return{size:e,pos:{x:i,y:r},rel:{x:(0,z.Yp)(i,0,e.width,-1,1),y:(0,z.Yp)(r,0,e.height,1,-1)},relScroll:{x:t.pageX-e.left+window.scrollX,y:t.pageY-e.top+window.scrollY},relDown:{x:this.startDraggingMousePos.x-s.x,y:this.startDraggingMousePos.y-s.y},relPrevious:h,speed:Math.max(Math.abs(h.x),Math.abs(h.x))}}get(){return this.infos}};class I{constructor(){r()(this,"resize",(t=>{const s=t[0].target;s&&this.adaptCanvas(s)})),r()(this,"adaptCanvas",(t=>{const{width:s,height:e}=this.getCurrentSize(t);this.canvas.resize({width:s,height:e}),this.scene.resize({width:s,height:e})})),r()(this,"getCurrentSize",(t=>{const s=window.devicePixelRatio||1,e=(t?.offsetWidth||1024)*s;return{width:e,height:e*this.configRatio}})),r()(this,"render",(t=>{this.keyboard&&(this.keyboard.start(),this.scene.setKeyboardInteraction(this.keyboard)),this.scene.update(t),this.scene.render(),this.keyboard&&this.keyboard.end()})),this.keyboard=null,this.mouse=null,this.scene=null,this.loop=null,this.configRatio=null,this.resizeObserver=null}async setup(t,s){const e=document.querySelector(`#${s.slug}`);if(!e)return;this.configRatio=window.innerHeight/document.body.offsetWidth;let i={};if(s){if(this.configRatio=s.canvas.height/s.canvas.width,s.assets){const t=new F;i=await t.get(s.assets.map((t=>(0,d.getEnvPath)(t))))}if(s.shaders){const t=new R;i.shaders=await t.get(s.shaders)}}this.canvas=new class{constructor(){r()(this,"resize",(t=>{this.canvas.setAttribute("width",t.width),this.canvas.setAttribute("height",t.height)})),this.canvas=document.createElement("canvas"),this.context=new C(this.canvas)}get(){return this.canvas}getContext(){return this.context.get()}getSupport(){return this.context.getSupport()}};const{width:h,height:n}=this.getCurrentSize(e),a=this.canvas.getSupport(),o={...s,canvas:{...s.canvas,width:h,height:n},support:a};if(s.useDrawBuffer&&!a.drawBuffers){const t=document.createElement("p");return t.innerHTML="\n      <b>ご迷惑おかけして申し訳ありません。</b>\n      <br/>Sorry. Webgl draw buffers extension support problem occured.\n      <br/>Please try on a more recent device.\n      ",t.style.textAlign="center",t.style.margin="20px auto",void e.appendChild(t)}if(this.scene=new t(this.canvas.getContext(),o),await this.scene.setupAssets(i),this.scene.setup&&this.scene.setup(),this.resizeObserver=new ResizeObserver(this.resize),this.resizeObserver.observe(e),s){if(s.keyboard&&(this.keyboard=new class{constructor(t){r()(this,"onKeyPress",(t=>{void 0!==this.keysPressed[t.keyCode]&&(t.preventDefault(),this.keysPressed[t.keyCode]=!0,this.oneKeysPressed[t.keyCode]=!0)})),r()(this,"onKeyUp",(t=>{void 0!==this.keysPressed[t.keyCode]&&(t.preventDefault(),this.keysUp[t.keyCode]=!0)})),this.keys=t,this.oneKeysPressed={},this.keysPressed={},this.keysUp={},this.charges={},Object.keys(this.keys).forEach((t=>{this.keysPressed[this.keys[t]]=!1,this.keysUp[this.keys[t]]=!1,this.oneKeysPressed[this.keys[t]]=!1,this.charges[this.keys[t]]=0})),document.addEventListener("keydown",this.onKeyPress,!1),document.addEventListener("keyup",this.onKeyUp,!1)}cancel(){document.removeEventListener("keydown",this.onKeyPress,!1),document.removeEventListener("keyup",this.onKeyUp,!1)}start(){Object.keys(this.keys).forEach((t=>{this.keysPressed[this.keys[t]]&&(this.charges[this.keys[t]]+=1)}))}end(){Object.keys(this.keys).forEach((t=>{this.keysPressed[this.keys[t]]&&this.keysUp[this.keys[t]]&&(this.charges[this.keys[t]]=0,this.keysPressed[this.keys[t]]=!1,this.keysUp[this.keys[t]]=!1)}))}getCharge(t){return this.charges[t]}resetCharge(t){this.charges[t]=0}isPressed(t){return this.charges[t]>0}isPressedOne(t){return 1===this.charges[t]}isUp(t){return this.keysUp[t]}}(s.keyboard)),s.mouse){const{events:t,domId:i}=s.mouse,r=t.reduce(((t,s)=>({...t,[`callback${(0,d.capitalize)(s)}`]:this.scene[`onMouse${(0,d.capitalize)(s)}`]})),{}),h=i?document.querySelector(`#${i}`):e;this.mouse=new S(h,r)}s.controls&&(this.controls=new class{constructor(t,s){r()(this,"getDomItem",(()=>this.controlsDomItem)),r()(this,"getRanges",(()=>this.ranges)),this.controlsDomItem=document.createElement("div"),this.controlsDomItem.id="controls",this.controlsDomItem.style.opacity=0;const{fullscreen:e,ranges:i}=s;i&&(this.ranges=Object.keys(i).reduce(((t,s)=>{const{min:e=0,max:r=100,value:h=0,label:n=null}=i[s],a=document.createElement("div"),o=document.createElement("input");if(o.setAttribute("type","range"),o.setAttribute("id",s),o.setAttribute("min",e),o.setAttribute("max",r),o.setAttribute("value",h),o.setAttribute("name",s),n){const t=document.createElement("label");t.setAttribute("for",s),t.innerHTML=n,a.appendChild(t)}return a.appendChild(o),this.controlsDomItem.appendChild(a),{...t,[s]:{id:s,min:e,max:r,value:h,dom:o}}}),{})),e&&(this.fullscreen=new _(t),this.controlsDomItem.appendChild(this.fullscreen.getButton()))}destroy(){this.fullscreen&&this.fullscreen.destroy()}}(e,s.controls),e.appendChild(this.controls.getDomItem()),s.controls.ranges&&this.scene.setupControls&&this.scene.setupControls({ranges:this.controls.getRanges()}))}I.revealAfterLoaded(e),this.loop=new class{constructor(){r()(this,"start",(()=>{const t=(new Date).getTime(),s=t-this.lastFrame;this.callbackNoFps&&this.callbackNoFps(),s>this.fps&&(this.callback(t-this.firstFrame),this.lastFrame=t),this.ref=window.requestAnimationFrame(this.start)})),this.fps=25,this.firstFrame=(new Date).getTime(),this.lastFrame=this.firstFrame,this.ref=null}setCallback(t){this.callback=t}setCallbackNoFps(t){this.callbackNoFps=t}setFps(t){this.fps=t}stop(){window.cancelAnimationFrame(this.ref)}},this.loop.setCallback(this.render),this.loop.start(),e.appendChild(this.canvas.get())}stop(){this.loop&&this.loop.stop(),this.mouse&&this.mouse.cancel()}getCanvas(){return this.canvas&&this.canvas.get()}destroy(){this.stop(),this.scene&&this.scene.destroy&&this.scene.destroy(),this.controls&&this.controls.destroy(),this.controls&&this.resizeObserver.disconnect()}}r()(I,"revealAfterLoaded",(t=>{if(t){t.querySelectorAll("[style]").forEach((t=>t.removeAttribute("style")))}}));const L=I},39966:(t,s,e)=>{"use strict";e.d(s,{I:()=>i});const i=1e-6},2444:(t,s,e)=>{"use strict";e.d(s,{Z:()=>n});var i=e(72710);const r=class extends i.Z{create(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}},h=class extends i.Z{create(){this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.DEPTH_COMPONENT,this.size.width,this.size.height,0,this.gl.DEPTH_COMPONENT,this.gl.UNSIGNED_INT,null)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}},n=class{constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.gl=t,this.buffer=this.gl.createFramebuffer(),this.buffer.width=s,this.buffer.height=e,this.clearColor=[0,0,0,0],this.useDepth=i,this.setup(r)}setup(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer);const s=this.gl.getExtension("WEBGL_draw_buffers")||this.gl.getExtension("GL_EXT_draw_buffers")||this.gl.getExtension("EXT_draw_buffers"),e=null!==s?s.COLOR_ATTACHMENT0_WEBGL+t:this.gl.COLOR_ATTACHMENT0;this.texture=new r(this.gl,this.buffer.width,this.buffer.height),this.texture.setup(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,e,this.gl.TEXTURE_2D,this.texture.get(),0),this.useDepth&&(this.depthTexture=new h(this.gl,this.buffer.width,this.buffer.height),this.depthTexture.setup(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.get(),0)),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}resize(t){this.end(),this.texture&&this.texture.delete(),this.depthTexture&&this.depthTexture.delete(),this.destroy(),this.buffer=this.gl.createFramebuffer(),this.buffer.width=t.width,this.buffer.height=t.height,this.setup()}start(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer),this.gl.viewport(0,0,this.buffer.width,this.buffer.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}end(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}get(){return this.buffer}getTexture(){return this.texture}getDepthTexture(){return this.depthTexture}setClearColor(t,s,e,i){this.clearColor=[t,s,e,i]}destroy(){this.buffer&&this.gl.deleteFramebuffer(this.buffer)}}},80602:(t,s,e)=>{"use strict";e.d(s,{Z:()=>r});var i=e(35115);const r=class extends i.Z{constructor(t,s){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=((t,s)=>Object.keys(s).reduce(((e,i)=>{const r=s[i];let h,n,a,o;switch(i){case"color":n="VEC4",a=4,h=t.FLOAT,o=new Float32Array(r);break;case"texture":n="VEC2",a=2,h=t.FLOAT,o=new Float32Array(r);break;case"indices":n="SCALAR",a=1,h=t.UNSIGNED_SHORT,o=new Uint16Array(r);break;case"side":case"index":case"random":n="FLOAT",a=1,h=t.FLOAT,o=new Float32Array(r);break;default:n="VEC3",a=3,h=t.FLOAT,o=new Float32Array(r)}return e[i]={locationKey:i,type:n,values:o,count:r.length/a,componentType:h,size:a},e}),{}))(t,s);super(t,i,e)}}},21200:(t,s,e)=>{"use strict";e.d(s,{Z:()=>h});var i=e(80602),r=e(31073);const h=class{constructor(t){this.gl=t,this.objet=new i.Z(t,r.Z)}render(t){this.gl.disable(this.gl.CULL_FACE),this.objet.render(t),this.gl.enable(this.gl.CULL_FACE)}}},79475:(t,s,e)=>{"use strict";e.d(s,{Z:()=>h});var i=e(25773);class r{constructor(){this.d=new Array(9),this.sauvegardePrecedente=[],this.empilement=0,this.init()}init(){for(let t=0;t<9;t+=1)this.d[t]=0;return this.sauvegardePrecedente=[],this.empilement=0,this}get(){return this.d}set(t,s,e,i,r,h,n,a,o){return this.d[0]=t,this.d[1]=s,this.d[2]=e,this.d[3]=i,this.d[4]=r,this.d[5]=h,this.d[6]=n,this.d[7]=a,this.d[8]=o,this}setFromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}setOneValue(t){for(let s=0;s<9;s+=1)this.d[s]=t[s]}multiply(t){const s=new r;for(let e=0;e<3;e+=1)for(let i=0;i<3;i+=1)for(let r=0;r<3;r+=1)s.d[3*i+e]+=this.d[3*i+r]*t.d[3*r+e];for(let t=0;t<9;t+=1)this.d[t]=s.d[t];return this}equal(t){for(let s=0;s<9;s+=1)this.d[s]=t.d[s],this.sauvegardePrecedente[s]=t.sauvegardePrecedente[s];return this}push(){this.empilement+=1;let t=0;for(let s=9*(this.empilement-1);s<9*this.empilement;s+=1)this.sauvegardePrecedente[s]=this.d[t],t+=1;return this}pop(){if(this.empilement>0){let t=0;for(let s=9*(this.empilement-1);s<9*this.empilement;s+=1)this.d[t]=this.sauvegardePrecedente[s],this.sauvegardePrecedente[s]=null,t+=1;this.empilement-=1}return this}identity(){return this.init(),this.d[0]=1,this.d[4]=1,this.d[8]=1,this}transpose(){return this.setFromArray(r.transpose(this.d))}static transpose(t){const s=new Float32Array(9);let e=0;for(let i=0;i<3;i+=1)for(let r=0;r<3;r+=1)s[e]=t[3*r+i],e+=1;return s}inverse(){const t=new Array(9),s=this.getDeterminant();if(0===s)return this.identity(),null;t[0]=this.d[4]*this.d[8]-this.d[5]*this.d[7]/s,t[1]=-(this.d[1]*this.d[8]-this.d[7]*this.d[2])/s,t[2]=this.d[1]*this.d[5]-this.d[4]*this.d[2]/s,t[3]=-(this.d[3]*this.d[8]-this.d[5]*this.d[6])/s,t[4]=this.d[0]*this.d[8]-this.d[6]*this.d[2]/s,t[5]=-(this.d[0]*this.d[5]-this.d[3]*this.d[2])/s,t[6]=this.d[3]*this.d[7]-this.d[6]*this.d[4]/s,t[7]=-(this.d[0]*this.d[7]-this.d[6]*this.d[1])/s,t[8]=this.d[0]*this.d[4]-this.d[1]*this.d[3]/s;for(let s=0;s<9;s+=1)this.d[s]=t[s];return this}getDeterminant(){return this.d[0]*(this.d[4]*this.d[8]-this.d[7]*this.d[5])+this.d[1]*(this.d[5]*this.d[6]-this.d[3]*this.d[8])+this.d[2]*(this.d[3]*this.d[7]-this.d[6]*this.d[4])}rotate(t,s,e,h){const n=new r,a=t*(Math.PI/180),o=new i.Z(s,e,h);return o.normalise(),n.d[0]=o.x*o.x*(1-Math.cos(a))+Math.cos(a),n.d[1]=o.x*o.y*(1-Math.cos(a))-o.z*Math.sin(a),n.d[2]=o.x*o.z*(1-Math.cos(a))+o.y*Math.sin(a),n.d[3]=o.x*o.y*(1-Math.cos(a))+o.z*Math.sin(a),n.d[4]=o.y*o.y*(1-Math.cos(a))+Math.cos(a),n.d[5]=o.y*o.z*(1-Math.cos(a))-o.x*Math.sin(a),n.d[6]=o.x*o.z*(1-Math.cos(a))-o.y*Math.sin(a),n.d[7]=o.y*o.z*(1-Math.cos(a))+o.x*Math.sin(a),n.d[8]=o.z*o.z*(1-Math.cos(a))+Math.cos(a),this.multiply(n),this}}const h=r},21969:(t,s,e)=>{"use strict";e.d(s,{Z:()=>a});var i=e(39966),r=e(25773),h=e(79475);class n{constructor(){this.d=new Array(16),this.sauvegardePrecedente=[],this.empilement=0,this.init()}init(){return this.reset(),this.sauvegardePrecedente=[],this.empilement=0,this}reset(){for(let t=0;t<16;t+=1)this.d[t]=0;return this}get(){return this.d}setRaw(t){this.d=t}set(t,s,e,i,r,h,n,a,o,l,d,c,u,g,m,p){return this.d[0]=t,this.d[1]=s,this.d[2]=e,this.d[3]=i,this.d[4]=r,this.d[5]=h,this.d[6]=n,this.d[7]=a,this.d[8]=o,this.d[9]=l,this.d[10]=d,this.d[11]=c,this.d[12]=u,this.d[13]=g,this.d[14]=m,this.d[15]=p,this}setFromArray(t){return this.set(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}getMatrice3x3(){const t=new h.Z;return t.set(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),t}multiplyArray(t){const s=new n;return s.setFromArray(t),this.multiply(s)}multiply(t){const s=new n;for(let e=0;e<4;e+=1)for(let i=0;i<4;i+=1)for(let r=0;r<4;r+=1)s.d[4*i+e]+=this.d[4*i+r]*t.d[4*r+e];return this.d=s.d,this}equal(t){for(let s=0;s<16;s+=1)this.d[s]=t.d[s],this.sauvegardePrecedente[s]=t.sauvegardePrecedente[s];return this}push(){this.empilement+=1;let t=0;for(let s=16*(this.empilement-1);s<16*this.empilement;s+=1)this.sauvegardePrecedente[s]=this.d[t],t+=1;return this}pop(){if(this.empilement>0){let t=0;for(let s=16*(this.empilement-1);s<16*this.empilement;s+=1)this.d[t]=this.sauvegardePrecedente[s],this.sauvegardePrecedente[s]=null,t+=1;this.empilement-=1}return this}translate(t,s,e){const i=new n;return i.identity(),i.d[12]=t,i.d[13]=s,i.d[14]=e,this.multiply(i),this}scale(t,s,e){const i=new n;return i.d[0]=t,i.d[5]=void 0===s?t:s,i.d[10]=void 0===e?t:e,i.d[15]=1,this.multiply(i),this}resetScale(){return this.d[0]=1,this.d[5]=1,this.d[10]=1,this}resetTranslate(){return this.d[12]=0,this.d[13]=0,this.d[14]=0,this}rotate(t,s,e,i){const h=new n,a=t*(Math.PI/180),o=new r.Z(s,e,i);return o.normalise(),h.d[0]=o.d[0]*o.d[0]*(1-Math.cos(a))+Math.cos(a),h.d[1]=o.d[0]*o.d[1]*(1-Math.cos(a))-o.d[2]*Math.sin(a),h.d[2]=o.d[0]*o.d[2]*(1-Math.cos(a))+o.d[1]*Math.sin(a),h.d[4]=o.d[0]*o.d[1]*(1-Math.cos(a))+o.d[2]*Math.sin(a),h.d[5]=o.d[1]*o.d[1]*(1-Math.cos(a))+Math.cos(a),h.d[6]=o.d[1]*o.d[2]*(1-Math.cos(a))-o.d[0]*Math.sin(a),h.d[8]=o.d[0]*o.d[2]*(1-Math.cos(a))-o.d[1]*Math.sin(a),h.d[9]=o.d[1]*o.d[2]*(1-Math.cos(a))+o.d[0]*Math.sin(a),h.d[10]=o.d[2]*o.d[2]*(1-Math.cos(a))+Math.cos(a),h.d[15]=1,this.multiply(h),this}identity(){return this.init(),this.d[0]=1,this.d[5]=1,this.d[10]=1,this.d[15]=1,this}perspective(t,s,e,i){const r=t*(Math.PI/180),h=1/Math.tan(r/2),n=1/(e-i);return this.set(h/s,0,0,0,0,h,0,0,0,0,(e+i)*n,-1,0,0,e*i*n*2,0),this}ortho(t,s,e,i,r,h){return this.set(2/(s-t),0,0,0,0,2/(i-e),0,0,0,0,-2/(h-r),0,-(s+t)/(s-t),-(i+e)/(i-e),-(h+r)/(h-r),1),this}lookAt(t,s,e,r,h,n,a,o,l){let d,c,u,g,m,p,f,b,v,y;const x=t,E=s,T=e,w=a,P=o,A=l,M=r,F=h,k=n;return Math.abs(x-M)<i.I&&Math.abs(E-F)<i.I&&Math.abs(T-k)<i.I?(this.identity(),this):(f=x-M,b=E-F,v=T-k,y=1/Math.sqrt(f*f+b*b+v*v),f*=y,b*=y,v*=y,d=P*v-A*b,c=A*f-w*v,u=w*b-P*f,y=Math.sqrt(d*d+c*c+u*u),y?(y=1/y,d*=y,c*=y,u*=y):(d=0,c=0,u=0),g=b*u-v*c,m=v*d-f*u,p=f*c-b*d,y=Math.sqrt(g*g+m*m+p*p),y?(y=1/y,g*=y,m*=y,p*=y):(g=0,m=0,p=0),this.set(d,g,f,0,c,m,b,0,u,p,v,0,-(d*x+c*E+u*T),-(g*x+m*E+p*T),-(f*x+b*E+v*T),1),this)}transpose(){return this.setFromArray(n.transpose(this.d))}static transpose(t){const s=new Float32Array(16);let e=0;for(let i=0;i<4;i+=1)for(let r=0;r<4;r+=1)s[e]=t[4*r+i],e+=1;return s}inverse(){const t=n.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),s=n.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),e=n.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),i=n.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),r=this.d[0]*t-this.d[1]*s+this.d[2]*e-this.d[3]*i,h=n.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15]),a=n.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15]),o=n.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15]),l=n.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14]),d=n.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[13],this.d[14],this.d[15]),c=n.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[12],this.d[14],this.d[15]),u=n.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[12],this.d[13],this.d[15]),g=n.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[12],this.d[13],this.d[14]),m=n.getCofacteur(this.d[1],this.d[2],this.d[3],this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11]),p=n.getCofacteur(this.d[0],this.d[2],this.d[3],this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11]),f=n.getCofacteur(this.d[0],this.d[1],this.d[3],this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11]),b=n.getCofacteur(this.d[0],this.d[1],this.d[2],this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10]),v=1/r;return this.d[0]=v*t,this.d[1]=-v*h,this.d[2]=v*d,this.d[3]=-v*m,this.d[4]=-v*s,this.d[5]=v*a,this.d[6]=-v*c,this.d[7]=v*p,this.d[8]=v*e,this.d[9]=-v*o,this.d[10]=v*u,this.d[11]=-v*f,this.d[12]=-v*i,this.d[13]=v*l,this.d[14]=-v*g,this.d[15]=v*b,this}getDeterminant(){return this.d[0]*n.getCofacteur(this.d[5],this.d[6],this.d[7],this.d[9],this.d[10],this.d[11],this.d[13],this.d[14],this.d[15])-this.d[1]*n.getCofacteur(this.d[4],this.d[6],this.d[7],this.d[8],this.d[10],this.d[11],this.d[12],this.d[14],this.d[15])+this.d[2]*n.getCofacteur(this.d[4],this.d[5],this.d[7],this.d[8],this.d[9],this.d[11],this.d[12],this.d[13],this.d[15])-this.d[3]*n.getCofacteur(this.d[4],this.d[5],this.d[6],this.d[8],this.d[9],this.d[10],this.d[12],this.d[13],this.d[14])}static getCofacteur(t,s,e,i,r,h,n,a,o){return t*(r*o-h*a)-s*(i*o-h*n)+e*(i*a-r*n)}}const a=n},17968:(t,s,e)=>{"use strict";e.d(s,{Z:()=>a});var i=e(25773),r=e(21969),h=e(39966);class n{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.x=t,this.y=s,this.z=e,this.w=i}set(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}setFromAxeAndAngle(t,s){const[e,i,r]=t;return this.x=e,this.y=i,this.z=r,this.w=s,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}approx(t,s){return Math.abs(this.x-t.x)<=s&&Math.abs(this.y-t.y)<=s&&Math.abs(this.z-t.z)<=s&&Math.abs(this.w-t.w)<=s}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}multiplyArray(t){const s=this.x,e=this.y,i=this.z,r=this.w,h=t[0],n=t[1],a=t[2],o=t[3];return this.x=s*o+r*h+e*a-i*n,this.y=e*o+r*n+i*h-s*a,this.z=i*o+r*a+s*n-e*h,this.w=r*o-s*h-e*n-i*a,this}multiply(t){const s=this.x,e=this.y,i=this.z,r=this.w,h=t.x,n=t.y,a=t.z,o=t.w;return this.x=s*o+r*h+e*a-i*n,this.y=e*o+r*n+i*h-s*a,this.z=i*o+r*a+s*n-e*h,this.w=r*o-s*h-e*n-i*a,this}multiplyVector(t){const s=this.w*t.x+this.y*t.z-this.z*t.y,e=this.w*t.y+this.z*t.x-this.x*t.z,r=this.w*t.z+this.x*t.y-this.y*t.x,h=-this.x*t.x-this.y*t.y-this.z*t.z,n=s*this.w+h*-this.x+e*-this.z-r*-this.y,a=e*this.w+h*-this.y+r*-this.x-s*-this.z,o=r*this.w+h*-this.z+s*-this.y-e*-this.x;return new i.Z(n,a,o)}normalize(){let t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return 0!==t&&1!==t&&(t=1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}rotateX(t){const s=.5*t,e=this.x,i=this.y,r=this.z,h=this.w,n=Math.sin(s),a=Math.cos(s);return this.x=e*a+h*n,this.y=i*a+r*n,this.z=r*a-i*n,this.w=h*a-e*n,this}rotateY(t){const s=.5*t,e=this.x,i=this.y,r=this.z,h=this.w,n=Math.sin(s),a=Math.cos(s);return this.x=e*a-r*n,this.y=i*a+h*n,this.z=r*a+e*n,this.w=h*a-i*n,this}rotateZ(t){const s=.5*t,e=this.x,i=this.y,r=this.z,h=this.w,n=Math.sin(s),a=Math.cos(s);return this.x=e*a+i*n,this.y=i*a-e*n,this.z=r*a+h*n,this.w=h*a-r*n,this}scale(t){let s=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return 0===s?this:1===s?(this.x*=t,this.y*=t,this.z*=t,this.w*=t,this):(s=t/Math.sqrt(s),this.x*=s,this.y*=s,this.z*=s,this.w*=s,this)}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}static slerpArray(t,s,e){const i=new n(t[0],t[1],t[2],t[3]),r=new n(s[0],s[1],s[2],s[3]);return new n(0,0,0,1).slerp(i,r,e)}slerp(t,s,e){const i=t.x,r=t.y,n=t.z,a=t.w;let o,l,d,c,u,g=s.x,m=s.y,p=s.z,f=s.w;return l=i*g+r*m+n*p+a*f,l<0&&(l=-l,g=-g,m=-m,p=-p,f=-f),1-l>h.I?(o=Math.acos(l),d=Math.sin(o),c=Math.sin((1-e)*o)/d,u=Math.sin(e*o)/d):(c=1-e,u=e),this.x=c*i+u*g,this.y=c*r+u*m,this.z=c*n+u*p,this.w=c*a+u*f,this}toMatrix4(){const t=this.w*this.w,s=this.x*this.x,e=this.y*this.y,i=this.z*this.z,h=1/(s+e+i+t),n=(s-e-i+t)*h,a=(-s+e-i+t)*h,o=(-s-e+i+t)*h;let l=this.x*this.y,d=this.z*this.w;const c=2*(l+d)*h,u=2*(l-d)*h;l=this.x*this.z,d=this.y*this.w;const g=2*(l-d)*h,m=2*(l+d)*h;l=this.y*this.z,d=this.x*this.w;const p=2*(l+d)*h,f=2*(l-d)*h;return(new r.Z).set(n,c,g,0,u,a,p,0,m,f,o,0,0,0,0,1)}setFromMat3(t){const s=t.get(),e=s[0],i=s[1],r=s[2],h=s[3],n=s[4],a=s[5],o=s[6],l=s[7],d=s[8];return this.w=.5*Math.sqrt(Math.max(0,1+e+n+d)),this.x=.5*Math.sqrt(Math.max(0,1+e-n-d)),this.y=.5*Math.sqrt(Math.max(0,1-e+n-d)),this.z=.5*Math.sqrt(Math.max(0,1-e-n+d)),this.x*=Math.sign(a-l),this.y*=Math.sign(o-r),this.z*=Math.sign(i-h),this}get(){return[this.x,this.y,this.z,this.w]}getX(){return this.x}getY(){return this.y}getZ(){return this.z}getW(){return this.w}}const a=n},25773:(t,s,e)=>{"use strict";e.d(s,{Z:()=>h});var i=e(68763);class r{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.d=[0,0,0],this.set(t,s,e)}normalise(){const t=this.length();return 0!==t&&(this.d[0]/=t,this.d[1]/=t,this.d[2]/=t),this}get(){return this.d}getX(){return this.d[0]}getY(){return this.d[1]}getZ(){return this.d[2]}set(t,s,e){return null!==t&&(this.d[0]=t),null!==s?this.d[1]=s:null!==t&&(this.d[1]=t),null!==e?this.d[2]=e:null!==t&&(this.d[2]=t),this}setX(t){this.d[0]=t}setY(t){this.d[1]=t}setZ(t){this.d[2]=t}addXYZ(t,s,e){return this.d[0]+=t,this.d[1]+=s,this.d[2]+=e,this}addX(t){return this.d[0]+=t,this}addY(t){return this.d[1]+=t,this}addZ(t){return this.d[2]+=t,this}multiplyX(t){return this.d[0]*=t,this}multiplyY(t){return this.d[1]*=t,this}multiplyZ(t){return this.d[2]*=t,this}limiter(t){const s=this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2];if(s>t*t&&s>0){const e=t/Math.sqrt(s);this.d[0]*=e,this.d[1]*=e,this.d[2]*=e}return this}cross(t){return new r(this.d[1]*t.d[2]-this.d[2]*t.d[1],this.d[2]*t.d[0]-this.d[0]*t.d[2],this.d[0]*t.d[1]-this.d[1]*t.d[0])}dot(t){return this.d[0]*t.d[0]+this.d[1]*t.d[1]+this.d[2]*t.d[2]}length(){return Math.sqrt(this.d[0]*this.d[0]+this.d[1]*this.d[1]+this.d[2]*this.d[2])}directionVers(t){return this.d[0]=t.d[0]-this.d[0],this.d[1]=t.d[1]-this.d[1],this.d[2]=t.d[2]-this.d[2],this}equal(t){return this.d=[t.d[0],t.d[1],t.d[2]],this}add(t){return this.d[0]+=t.d[0],this.d[1]+=t.d[1],this.d[2]+=t.d[2],this}addNumber(t){return this.d[0]+=t,this.d[1]+=t,this.d[2]+=t,this}minus(t){return this.d[0]-=t.d[0],this.d[1]-=t.d[1],this.d[2]-=t.d[2],this}minusNumber(t){return this.d[0]-=t,this.d[1]-=t,this.d[2]-=t,this}multiplyNumber(t){return this.d[0]*=t,this.d[1]*=t,this.d[2]*=t,this}multiplyMatrix(t){return this.set(t.d[0]*this.d[0]+t.d[1]*this.d[1]+t.d[2]*this.d[2],t.d[3]*this.d[0]+t.d[4]*this.d[1]+t.d[5]*this.d[2],t.d[6]*this.d[0]+t.d[7]*this.d[1]+t.d[8]*this.d[2]),this}multiply(t){return this.d[0]*=t.d[0],this.d[1]*=t.d[1],this.d[2]*=t.d[2],this}divideNumber(t){return this.d[0]/=t,this.d[1]/=t,this.d[2]/=t,this}divide(t){return this.d[0]/=t.d[0],this.d[1]/=t.d[1],this.d[2]/=t.d[2],this}fract(){return this.d[0]=(0,i.ZI)(this.d[0]),this.d[1]=(0,i.ZI)(this.d[1]),this.d[2]=(0,i.ZI)(this.d[2]),this}distance(t){return Math.sqrt((t.d[0]-this.d[0])*(t.d[0]-this.d[0])+(t.d[1]-this.d[1])*(t.d[1]-this.d[1])+(t.d[2]-this.d[2])*(t.d[2]-this.d[2]))}angleDegree(t){const s=this.dot(t)/(this.length()*t.length());return 180*Math.acos(s)/Math.PI*-(0,i.mK)(this.d[0]*t.d[1]+this.d[1]*t.d[0])}computeNormal(t,s,e){const i=new r,h=new r,n=new r;return h.equal(t.minus(this)),n.equal(s.minus(this)),e?i.equal(n.cross(h)):i.equal(h.cross(n)),i.normalise(),i}static getBarycentre(t,s,e,i){const r=(s.d[2]-e.d[2])*(t.d[0]-e.d[0])+(e.d[0]-s.d[0])*(t.d[2]-e.d[2]),h=((s.d[2]-e.d[2])*(i[0]-e.d[0])+(e.d[0]-s.d[0])*(i[1]-e.d[2]))/r,n=((e.d[2]-t.d[2])*(i[0]-e.d[0])+(t.d[0]-e.d[0])*(i[1]-e.d[2]))/r,a=1-h-n;return h*t.d[1]+n*s.d[1]+a*e.d[1]}static lerp(t,s,e){const i=t.d[0],h=t.d[1],n=t.d[2],a=i+e*(s.d[0]-i),o=h+e*(s.d[1]-h),l=n+e*(s.d[2]-n);return new r(a,o,l)}}const h=r},31073:(t,s,e)=>{"use strict";e.d(s,{Z:()=>i});const i={position:[-1,1,0,1,1,0,-1,-1,0,1,-1,0],indices:[0,1,2,1,3,2],texture:[0,0,1,0,0,1,1,1]}},35551:(t,s,e)=>{"use strict";e.d(s,{Z:()=>S});const i={ambiant:[0,0,0],diffuse:[.5,.5,.5],specular:[1,1,1],emissive:[0,0,0],specDensity:[1],opacity:1};var r=e(59713),h=e.n(r);const n=class{constructor(t,s){h()(this,"getLocation",(t=>this.program.locations[t]||null)),this.gl=t,this.program=this.gl.createProgram(),this.setup(s)}setup(t){this.creerShader("vertex",t.vertex),this.creerShader("fragment",t.fragment),this.gl.linkProgram(this.program),this.gl.useProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)?(this.createLocations(t),this.gl.useProgram(null)):this.gl.deleteProgram(this.program)}creerShader(t,s){const e=this.gl.createShader("vertex"===t?this.gl.VERTEX_SHADER:this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,s),this.gl.compileShader(e),this.gl.getShaderParameter(e,this.gl.COMPILE_STATUS)?(this.gl.attachShader(this.program,e),this.gl.deleteShader(e)):this.gl.deleteShader(e)}createLocations(t){this.program.locations={},t.uniforms.forEach((t=>{this.program.locations[t]=this.gl.getUniformLocation(this.program,t)})),t.attributes.forEach((t=>{this.program.locations[t]=this.gl.getAttribLocation(this.program,t)}))}setProjectionView(t){this.setMatrix("projection",t.getProjection().get()),this.setMatrix("view",t.getView().get())}setMatrix(t,s){const e=this.getLocation(t);null!==e&&(this.gl.useProgram(this.program),16===s.length?this.gl.uniformMatrix4fv(e,!1,s):this.gl.uniformMatrix3fv(e,!1,s),this.gl.useProgram(null))}setInt(t,s){const e=this.getLocation(t);null!==e&&(this.gl.useProgram(this.program),this.gl.uniform1i(e,s),this.gl.useProgram(null))}setTexture(t,s,e){const i=this.getLocation(e);null!==i&&(this.gl.useProgram(this.program),this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(i,t),this.gl.useProgram(null))}setFloat(t,s){const e=this.getLocation(t);null!==e&&(this.gl.useProgram(this.program),this.gl.uniform1f(e,s),this.gl.useProgram(null))}setVector(t,s){const e=this.getLocation(t);if(null!==e){switch(this.gl.useProgram(this.program),s.length){case 3:this.gl.uniform3fv(e,s);break;case 4:this.gl.uniform4fv(e,s);break;default:this.gl.uniform2fv(e,s)}this.gl.useProgram(null)}}enable(){this.gl.useProgram(this.program)}disable(){this.gl.useProgram(null)}get(){return this.program}getLocations(){return this.program.locations}};var a=e(50967);var o=e(35115),l=e(91215);var d=e(17968),c=e(21969);class u{constructor(t,s){h()(this,"renderNodesAndChildren",((t,s,e)=>{Object.keys(t).forEach((i=>{const r=t[i];this.renderNodeAndChildren(r,s,e)}))})),h()(this,"renderNodeAndChildren",((t,s,e)=>{let i=e;"joint"!==t.customType&&(i=u.setNodeModel(t,s,e),this.renderNode(t,s)),t.children&&this.renderNodesAndChildren(t.children,s,i)}));const{nodes:e,meshes:i,materials:r}=s;this.meshes=i.map((s=>{let{primitives:e,name:i="",weights:h}=s;const n=e.map((t=>void 0!==t.material?{...t,material:r[t.material]}:t));return{name:i,primitives:u.formatPrimitives(t,n),weights:h}})),this.nodes=e}addInstancingVbos(t,s){Object.keys(this.nodes).forEach((e=>{const i=this.nodes[e],{mesh:r}=i,{primitives:h}=this.meshes[r];h.forEach((e=>e.addInstancing(t,s)))}))}render(t,s){this.renderNodesAndChildren(this.nodes,t,s)}renderOnly(t,s,e){t.forEach((t=>{const i=this.nodes[t];this.renderNodeAndChildren(i,s,e)}))}renderExcept(t,s,e){Object.keys(this.nodes).forEach((i=>{if(-1===t.indexOf(i)){const t=this.nodes[i];this.renderNodeAndChildren(t,s,e)}}))}renderNode(t,s){if(void 0!==t.mesh){const{mesh:e}=t,{primitives:i}=this.meshes[e];i.forEach((t=>t.render(s)))}}}h()(u,"setNodeModel",((t,s,e)=>{const i=u.handleLocalTransform(t);i.multiply(e),s.setMatrix("model",i.get());const r=i.getMatrice3x3();return r.inverse(),r.transpose(),s.setMatrix("normalMatrix",r.get()),i})),h()(u,"formatPrimitives",((t,s)=>s.map((s=>{const{vbos:e,material:i}=s;return new class{constructor(t,s){let{vbos:e,material:i={}}=s;h()(this,"addInstancing",((t,s)=>{this.vbos.addInstancingVbos(t,s)})),this.material=i,this.vbos=new o.Z(t,e),i.normalMap&&(this.normalMap=new l.Z(t,i.normalMap.data))}render(t){const{color:s,metal:e,rough:i,ao:r}=this.material;t.setVector("color",s||[1,1,1,1]),t.setFloat("metal",void 0!==e?e:0),t.setFloat("rough",void 0!==i?i:.5),t.setFloat("ao",void 0!==r?r:1),this.vbos.render(t.get())}setModeDessin(t){this.vbos.setModeDessin(t)}setModeCalcul(t){this.vbos.setModeCalcul(t)}}(t,{vbos:e,material:i})})))),h()(u,"handleLocalTransform",(t=>{const{translation:s,rotation:e,scale:i,matrix:r}=t,h=new c.Z;return h.identity(),i&&h.scale(...i),e&&h.multiply(new d.Z(...e).toMatrix4()),s&&h.translate(...s),r&&h.multiplyArray(r),h}));const g=u,m=class{constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LINEAR",e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;h()(this,"findIndex",(t=>{let s=0,e=this.timeSteps[s];for(0===e&&(s++,e=this.timeSteps[s]);e&&t>e;)s++,e=this.timeSteps[s];this.index=s})),h()(this,"setTimes",(t=>{this.timeSteps=this.times.map((s=>s*t)),this.index=0,this.interpolationValue=0})),this.times=t,this.setTimes(e),this.interpolationType=s}update(t){if(this.findIndex(t),0===this.index)this.interpolationValue=0;else if(this.index===this.times.length)this.interpolationValue=this.timeSteps[this.times.length-1];else{const s=this.timeSteps[this.index],e=this.timeSteps[this.index-1];this.interpolationValue=(t-e)/(s-e)}}setSpeed(t){this.setTimes(t)}getIndex(){return this.index}get(){return this.interpolationValue}},p=(t,s,e)=>(1-t)*s+t*e;var f=e(68763);class b extends g{constructor(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(t,s),h()(this,"addAllAnimations",((t,s)=>Object.keys(t).reduce(((e,i)=>{let r=e;const{animations:h,name:n,children:a}=t[i];return h&&(r[n]=this.addAnimations(h,s)),a&&(r={...e,...this.addAllAnimations(a,s)}),r}),{}))),h()(this,"addAnimations",((t,s)=>{const e={};return t.forEach((t=>{let{path:i,times:r,output:h,interpolation:n}=t,a=null!==s?h[s]:h[0];"rotation"===i&&(a=new d.Z(...a).toMatrix4()),this.animationInterval[1]=Math.max(...r,this.animationInterval[1]),e[i]={output:h,sample:new m(r,n,this.speedAnimation),customStep:s,value:a}})),e})),h()(this,"removeNodesAnimations",(t=>Object.keys(t).reduce(((s,e)=>{let i=s;const r=t[e];return i[r.name]=b.removeNodeAnim(r),r.children&&(i={...i,...this.removeNodesAnimations(r.children)}),s}),{}))),h()(this,"update",(t=>{const s=t-this.lastFrame;s>this.animationInterval[1]*this.speedAnimation&&(this.lastFrame=t),this.updateAnimations(s)})),h()(this,"updateAnimations",(t=>{Object.keys(this.animations).forEach((s=>{const e=this.animations[s];Object.keys(e).forEach((s=>{e[s]="rotation"===s?b.updateQuat(e[s],t):b.updateVector(e[s],t)}))}))})),h()(this,"handleLocalTransform",(t=>{const{translation:s,rotation:e,scale:i,matrix:r,name:h}=t,n=this.animations[h],a=n&&n.rotation||null,o=n&&n.translation||null,l=n&&n.scale||null,d=new c.Z;return d.identity(),(i||l)&&d.scale(...b.getVector(i,l)),(e||a)&&d.multiply(b.getRotationMat(e,a)),(s||o)&&d.translate(...b.getVector(s,o)),r&&d.multiplyArray(r),d})),h()(this,"setAnimationStep",((t,s,e)=>{const i=this.animations[t][s],r=i.output.length,h=(0,f.Yp)(e,0,1,0,r-1);i.customStep=Math.round(h)})),h()(this,"setAnimationSpeed",((t,s,e)=>{this.animations[t][s].sample.setSpeed(e)}));const{nodes:i}=s;this.speedAnimation=2e3,this.animationInterval=[0,0],this.animations=this.addAllAnimations(i,e),this.nodes=this.removeNodesAnimations(i),this.lastFrame=0}}h()(b,"removeNodeAnim",(t=>{const{animations:s,...e}=t;return e})),h()(b,"getAnimationInterval",(t=>{let s=0;return t.forEach((t=>{const{animations:e}=t;e&&e.forEach((t=>{const{times:e}=t;s=Math.max(...e,s)}))})),[0,s]})),h()(b,"updateVector",((t,s)=>{const e=t,{sample:i,customStep:r,output:h}=e;if(null===r){i.update(s);const t=i.getIndex();if(0===t)[e.value]=h;else if(t>h.length-1)e.value=h[h.length-1];else{const s=h[t-1],r=h[t],n=i.get();e.value=s.map(((t,s)=>p(n,t,r[s])))}}else e.value=h[r];return e})),h()(b,"updateQuat",((t,s)=>{const e=t,{sample:i,customStep:r,output:h}=e;if(null===r){i.update(s);const t=i.getIndex();if(0===t)e.value=new d.Z(...h[0]).toMatrix4();else if(t>h.length-1)e.value=new d.Z(...h[h.length-1]).toMatrix4();else{const s=h[t-1],r=h[t],n=i.get();e.value=d.Z.slerpArray(s,r,n).toMatrix4()}}else e.value=new d.Z(...h[r]).toMatrix4();return e})),h()(b,"getVector",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return s&&s.value?s.value:t})),h()(b,"getRotationMat",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,1],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return s&&s.value?s.value:new d.Z(...t).toMatrix4()}));const v=b;const y=class extends v{constructor(t,s){var e;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(t,s),e=this,h()(this,"removeAnimations",(t=>t.map((t=>{const s=t;return s.children&&(s.children=this.removeAnimations(s.children)),v.removeNodeAnim(s)})))),h()(this,"addJointsAnimations",((t,s)=>{t.forEach((t=>{const{animations:e,name:i,children:r}=t;e&&(this.animations[i]=this.addAnimations(e,s)),r&&this.addJointsAnimations(r,s)}))})),h()(this,"setProgramSkin",((t,s)=>{if(void 0!==t){const e=new c.Z;e.identity();const{joints:i}=this.skins[t];this.setProgramJoints(i,s,e)}})),h()(this,"setProgramJoints",(function(t,s,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t.forEach((t=>{const{invMatrix:h,children:n}=t,a=e.handleLocalTransform(t);a.multiply(i);const o=new c.Z;o.identity();const l=new c.Z;l.setFromArray(h),o.multiply(l),o.multiply(a),s.setMatrix(`jointMat[${r}]`,o.get()),n&&e.setProgramJoints(n,s,a,r+1)}))}));const{skins:r}=s;r&&(r.forEach((t=>{let{joints:s}=t;this.addJointsAnimations(s,i)})),this.skins=r.map((t=>{let{joints:s}=t;return{joints:this.removeAnimations(s)}})))}renderNode(t,s,e){const{skin:i}=t;void 0!==i&&this.setProgramSkin(i,s),super.renderNode(t,s,e)}};class x{constructor(t,s){this.gltfs={},Object.keys(s).forEach((e=>{s[e].skins?this.gltfs[e]=new y(t,s[e]):x.hasAnimation(s[e].nodes)?this.gltfs[e]=new v(t,s[e]):this.gltfs[e]=new g(t,s[e])}))}get(t){return this.gltfs[t]}}h()(x,"hasAnimation",(t=>{let s=!1;return Object.keys(t).forEach((e=>{const i=t[e];!s&&i.animations&&(s=!0)})),s}));const E=x;class T{constructor(t){h()(this,"saveData",(t=>{this.audioData=t})),h()(this,"togglePause",(()=>{this.isPlaying?this.isPause?(this.audioContext.resume(),this.isPause=!1):(this.audioContext.suspend(),this.isPause=!0):(this.play(),this.isPause=!1)})),h()(this,"stop",(()=>{this.clearAnalyse(),this.sourceNode&&(this.sourceNode.removeEventListener("ended",this.stop,!1),this.sourceNode.disconnect(),this.sourceNode.stop(0)),this.isPlaying=!1})),h()(this,"toggle",(()=>{this.isPlaying?this.stop():this.play()})),h()(this,"clearAnalyse",(()=>{this.amplitudeArray.fill(0),this.javascriptNode&&(this.analyserNode.disconnect(),this.javascriptNode.disconnect(),this.javascriptNode.removeEventListener("audioprocess",this.onAnalyse,!1))})),h()(this,"onAnalyse",(()=>{this.analyserNode.getByteFrequencyData(this.amplitudeArray)})),h()(this,"setPlaybackRate",(t=>{this.playbackRate=t,this.sourceNode&&(this.sourceNode.playbackRate.value=this.playbackRate)})),h()(this,"setVolume",(t=>{this.volume=t,this.gainNode&&(this.gainNode.gain.value=this.volume)})),h()(this,"getAmplitudes",(()=>this.amplitudeArray)),h()(this,"getFrequencyLength",(()=>this.analyserNode.frequencyBinCount)),h()(this,"getIsPlaying",(()=>this.isPlaying)),h()(this,"getIsPause",(()=>this.isPause));const s=window.AudioContext||window.webkitAudioContext;this.support=!!s;try{this.audioContext=new s}catch(t){this.support=!1}this.audioData=null,this.playbackRate=1,this.playMultiple=!1,this.isPlaying=!1,this.isPause=!0,this.isMute=!0,this.isLoop=!0,this.volume=.5,this.setup(t)}setup(t){this.support&&(this.audioContext.decodeAudioData(t,this.saveData,this.onError),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=this.volume,this.gainNode.connect(this.audioContext.destination),this.sampleSize=2048,this.javascriptNode=this.audioContext.createScriptProcessor(this.sampleSize,1,1),this.analyserNode=this.audioContext.createAnalyser(),this.analyserNode.minDecibels=-90,this.analyserNode.maxDecibels=-30,this.analyserNode.fftSize=this.sampleSize,this.amplitudeArray=new Uint8Array(this.analyserNode.frequencyBinCount))}play(){this.audioData&&(!this.playMultiple&&this.isPlaying&&this.stop(),this.sourceNode=this.audioContext.createBufferSource(),this.sourceNode.playbackRate.value=this.playbackRate,this.sourceNode.buffer=this.audioData,this.sourceNode.loop=this.isLoop,this.sourceNode.connect(this.gainNode),this.setupAnalyse(),this.sourceNode.addEventListener("ended",this.stop,!1),this.sourceNode.start(0),this.isPlaying=!0)}setupAnalyse(){this.sourceNode.connect(this.analyserNode),this.analyserNode.connect(this.javascriptNode),this.javascriptNode.connect(this.audioContext.destination),this.javascriptNode.addEventListener("audioprocess",this.onAnalyse,!1)}getSupport(){return this.support}}h()(T,"onError",(t=>{}));const w=T;var P=e(2444);var A=e(21200);const M=class{constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.gl=t;const{width:i=1024,height:r=1024,useDepth:h=!1}=s;this.ppb=new class{constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.fbos=[],this.currentFbo=0,this.fbos[0]=new P.Z(t,s,e,i,0),this.fbos[1]=new P.Z(t,s,e,i,1)}start(){this.fbos[this.currentFbo].start()}end(){this.fbos[this.currentFbo].end()}swap(){this.currentFbo=0===this.currentFbo?1:0}resize(t){this.fbos[0].resize(t),this.fbos[1].resize(t)}getTexture(){return this.fbos[this.currentFbo].getTexture()}getDepthTexture(){return this.fbos[this.currentFbo].getDepthTexture()}}(t,i,r,h),this.screen=new A.Z(t),this.passCount=0,this.programs=e,this.viewportSize={width:i,height:r}}start(){this.ppb.start(),this.passCount=0}end(){this.ppb.end()}resize(t){this.ppb.resize(t),this.viewportSize=t}applyTexToProg(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e=null===s;this.passCount=e?this.passCount+1:0;const i=this.passCount+1,r=e?this.ppb.getTexture().get():s;return t.setTexture(i,r,"textureMap"),t.setFloat("flipY",-1),t}setBrightContrast(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.applyTexToProg(this.programs.brightcontrast,e);i.setFloat("brightness",t),i.setFloat("contrast",s),this.renderToPingPong(i)}setFxaa(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=this.applyTexToProg(this.programs.fxaa,t);this.renderToPingPong(s)}setFxaa2(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=this.applyTexToProg(this.programs.fxaa2,t);this.renderToPingPong(s)}renderToPingPong(t){this.ppb.swap(),this.ppb.start(),this.screen.render(t.get()),this.ppb.end()}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=this.applyTexToProg(this.programs[s?"debug":"screen"],t);this.gl.viewport(0,0,this.viewportSize.width,this.viewportSize.height),this.screen.render(e.get())}renderInverse(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const e=this.applyTexToProg(this.programs[s?"debug":"screen"],t);e.setFloat("flipY",1),this.gl.viewport(0,0,this.viewportSize.width,this.viewportSize.height),this.screen.render(e.get())}getTexture(){return this.ppb.getTexture()}};var F=e(72710);const k=class extends F.Z{create(){const t=new ArrayBuffer(this.size.width*this.size.height*4),s=new Uint8Array(t);let e=0;for(let t=0;t<this.size.height;t+=1)for(let t=0;t<this.size.width;t+=1)s[e]=255*Math.random(),s[e+1]=255*Math.random(),s[e+2]=0,s[e+3]=255,e+=4;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.height,this.size.width,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}},R=class extends M{constructor(t,s){super(t,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.textures={},Object.keys(this.programs).forEach((t=>{switch(t){case"watercolor2":case"watercolor3":this.textures[t]=new k(this.gl,512,512)}}))}setDOF(t,s,e,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const h=this.applyTexToProg(this.programs.dof,r);h.setFloat("focusDistance",e),h.setFloat("blur",s),h.setFloat("ppm",i),h.setVector("range",t),h.setTexture(2,this.ppb.getDepthTexture().get(),"depthMap"),this.renderToPingPong(h)}mergeBloom(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.applyTexToProg(this.programs.mergeBloom,i);r.setFloat("gamma",s),r.setFloat("exposure",e),r.setTexture(3,t.get(),"bloomMap"),this.renderToPingPong(r)}setKuwahara(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=this.applyTexToProg(this.programs.kuwahara,t);this.renderToPingPong(s)}setWatercolor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=this.applyTexToProg(this.programs.watercolor,t);this.renderToPingPong(s)}setWatercolor2(t,s,e,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const h=this.applyTexToProg(this.programs.watercolor2,r);h.setFloat("gradientStep",t),h.setFloat("advectStep",s),h.setFloat("flipHeightMap",e),h.setFloat("time",i),h.setTexture(2,this.textures.watercolor2.get(),"heightMap"),this.renderToPingPong(h)}setWatercolor3(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=this.applyTexToProg(this.programs.watercolor3,t);s.setTexture(2,this.textures.watercolor3.get(),"noiseMap"),this.renderToPingPong(s)}setWatercolorMoving(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.applyTexToProg(this.programs.watercolorMoving,i);r.setFloat("time",t),r.setVector("mouse",s),r.setFloat("scale",e),this.renderToPingPong(r)}setSobel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=this.applyTexToProg(this.programs.sobel,t);this.renderToPingPong(s)}setGamma(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e=this.applyTexToProg(this.programs.gamma,s);e.setFloat("gamma",t),this.renderToPingPong(e)}setRGB(t,s,e,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const h=this.applyTexToProg(this.programs.rgb,r);h.setVector("center",[e,i]),h.setVector("delta",[t,s]),this.renderToPingPong(h)}setVortex(t,s,e){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.applyTexToProg(this.programs.vortex,i);r.setVector("center",t),r.setFloat("radius",s),r.setFloat("angle",e),this.renderToPingPong(r)}setOil(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e=this.applyTexToProg(this.programs.oil,s);e.setFloat("radius",t),this.renderToPingPong(e)}setSketch(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e=this.applyTexToProg(this.programs.sketch,s);e.setFloat("delta",t),this.renderToPingPong(e)}setPixel(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.applyTexToProg(this.programs.pixel,e);i.setVector("delta",[t,s]),this.renderToPingPong(i)}setWave(t,s,e){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.applyTexToProg(this.programs.wave,i);r.setFloat("time",t),r.setFloat("radius",s),r.setVector("center",e),this.renderToPingPong(r)}setSepia(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e=this.applyTexToProg(this.programs.sepia,s);e.setFloat("delta",t),this.renderToPingPong(e)}setGlitch(t,s,e){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.applyTexToProg(this.programs.glitch,i);r.setFloat("delta",s),r.setFloat("time",t),r.setFloat("speed",e),this.renderToPingPong(r)}setGlitch2(t,s,e){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.applyTexToProg(this.programs.glitch2,i);r.setFloat("delta",s),r.setFloat("time",t),r.setFloat("speed",e),this.renderToPingPong(r)}setGlitch3(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.applyTexToProg(this.programs.glitch3,e);i.setFloat("delta",s),i.setFloat("time",t),this.renderToPingPong(i)}setGlitch4(t,s,e){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.applyTexToProg(this.programs.glitch4,i);r.setFloat("delta",s),r.setFloat("time",t),r.setFloat("rate",e),this.renderToPingPong(r)}setSignature(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.applyTexToProg(this.programs.signature,e);i.setFloat("delta",s),i.setFloat("time",t),this.renderToPingPong(i)}setCompose(t,s,e){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.applyTexToProg(this.programs.compose,i);r.setTexture(6,t,"ssaoMap"),r.setTexture(7,s,"shadowMap"),r.setTexture(4,e,"depthMap"),this.renderToPingPong(r)}setComposeShadow(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e=this.applyTexToProg(this.programs.composeShadow,s);e.setTexture(4,t,"shadowMap"),this.renderToPingPong(e)}},j=class extends M{constructor(t,s){super(t,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),h()(this,"setBlurIntensity",(t=>{this.blurIntensity=t})),h()(this,"setBlurSize",(t=>{this.blurSize=t}));const e=s.blur||{};this.blurSize=void 0!==e.size?e.size:.6,this.blurIntensity=void 0!==e.intensity?e.intensity:1}setBlur(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=this.applyTexToProg(this.programs.blurOnePass,t);s.setFloat("size",this.blurSize),s.setFloat("intensity",this.blurIntensity),this.renderToPingPong(s)}},C=class extends j{constructor(t,s){super(t,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),h()(this,"setNbPass",(t=>{this.blurNbPass=t})),this.scale=void 0!==s.scale?s.scale:1,this.threshold=void 0!==s.threshold?s.threshold:.1}end(){super.end(),this.process()}process(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=this.applyTexToProg(this.programs.bloom,t);s.setFloat("scale",this.scale),s.setFloat("threshold",this.threshold),this.renderToPingPong(s),this.setBlur()}};var D=e(25773);const _=class extends j{constructor(t,s){super(t,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.near=s.near||1,this.far=s.far||100,this.radius=s.radius||5,this.strength=s.strength||1;const e=this.programs.ssao;e.setFloat("radius",this.radius),e.setFloat("near",this.near),e.setFloat("far",this.far),e.setFloat("strength",this.strength)}generateSsaoSamples(t,s){for(let e=0;e<s;e+=1){let i=e/s;i=p(i*i,.1,1);const r=new D.Z((0,f.MX)(-1,1),(0,f.MX)(-1,1),(0,f.MX)(0,1)).normalise().multiplyNumber((0,f.MX)(0,1)).multiplyNumber(i);this.programs[t].setVector(`samples[${e}]`,r.get())}}compute(t){const s=this.applyTexToProg(this.programs.ssao,t);s.setFloat("flipY",-1),this.renderToPingPong(s)}},z=class extends j{constructor(t,s){super(t,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),h()(this,"getProgram",(()=>this.programs.shadow));const e=this.programs.shadow;e.setFloat("shadowEpsilon",s.epsilon||.01),e.setFloat("lighten",s.lighten||0)}start(t){const s=this.programs.shadow;t.setShadowProgram(s),super.start()}},S=class{constructor(t,s){this.gl=t,this.config=s,this.time=0;const{width:e,height:i}=this.config.canvas;this.containerSize={width:e,height:i}}async setupAssets(t){const{config:s,gl:e}=this,{width:r,height:o}=s.canvas;if(t?.shaders&&(this.mngProg=new class{constructor(){h()(this,"updateResolution",((t,s)=>{Object.keys(this.programs).forEach((e=>{this.programs[e].setVector("resolution",[t,s])}))})),h()(this,"getAll",(()=>this.programs)),this.programs={}}async setup(t,s,e){performance.now();const i=function*(){const e=Object.keys(s);for(let i=0;i<e.length;i++){const r=e[i],h=s[r];yield{prog:new n(t,h),name:r}}}();for(const t of i)await(0,a.Wq)(),this.programs[t.name]=t.prog;this.updateResolution(e.width,e.height)}setCameraMatrix(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(this.programs).forEach((e=>{this.programs[e].setMatrix("view",t.getView().get());const i=s?t.getOrtho():t.getProjection();this.programs[e].setMatrix("projection",i.get())}))}get(t){return this.programs[t]}},await this.mngProg.setup(e,t.shaders,s.canvas),s.postprocess)){const t={width:r,height:o,useDepth:this.canUseDepth()},i=this.mngProg.getAll();this.postProcess=new R(e,t,i),s.postprocess.bloom&&(this.bloom=new C(e,{...t,...s.postprocess.bloom},i)),s.postprocess.ssao&&(this.ssao=new _(e,{...t,...s.postprocess.ssao,near:s.camera.near,far:s.camera.far},i)),s.postprocess.shadow&&(this.shadow=new z(e,{...t,...s.postprocess.shadow},i))}t?.textures&&(this.mngTex=new class{constructor(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.textures={},Object.keys(s).forEach((i=>{this.textures[i]=new class{constructor(t,s,e){this.gl=t,this.texture=t.createTexture(),this.filter=e?t[e]:t.NEAREST,this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}get(){return this.texture}}(t,s[i],e[i])}))}get(t){return this.textures[t]}}(e,t.textures,s.textures)),t?.objets&&(this.mngObj=new class{constructor(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.objets={},Object.keys(s).forEach((r=>{this.objets[r]=new class{constructor(t,s){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.gl=t,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=this.gl.STATIC_DRAW,this.materialProps={},this.steps=this.getSteps(s,e);const i=this.getPoints(s,e);this.stride=0,Object.entries(this.steps).forEach((t=>{null!==t[1]&&(this.stride+=t[1])})),this.vbo=this.gl.createBuffer(),this.count=i.length/this.stride,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(i),this.modeCalcul),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}enable(t){this.gl.useProgram(t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo);let s=0;Object.entries(this.steps).forEach((e=>{const[i,r]=e;void 0!==t.locations[i]&&-1!==t.locations[i]&&(this.gl.enableVertexAttribArray(t.locations[i]),this.gl.vertexAttribPointer(t.locations[i],r,this.gl.FLOAT,!1,4*this.stride,4*s)),null!==this.steps[i]&&(s+=this.steps[i])}))}render(t){this.enable(t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.drawArrays(this.modeDessin,0,this.count),this.end()}end(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}setModeDessin(t){this.modeDessin=t}setModeCalcul(t){this.modeCalcul=t}getSteps(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e={position:3};return t.vt.indices.length>0&&(e.texture=2),t.vn.indices.length>0&&(e.normale=3),s&&t.mat&&Object.keys(t.mat).forEach((e=>{const i=t.mat[e],r=s[i];r&&Object.keys(r).forEach((t=>{void 0===this.materialProps[t]&&(this.materialProps[t]=r[t].length)}))})),{...e,...this.materialProps}}getPoints(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const e=[];return t.v.indices.forEach(((r,h)=>{const n=3*r;if(e.push(t.v.points[n]),e.push(t.v.points[n+1]),e.push(t.v.points[n+2]),t.vt.indices.length>0){const s=2*t.vt.indices[h];e.push(t.vt.points[s]),e.push(t.vt.points[s+1])}if(t.vn.indices.length>0){const s=3*t.vn.indices[h];e.push(t.vn.points[s]),e.push(t.vn.points[s+1]),e.push(t.vn.points[s+2])}if(s&&t.mat){const r=Object.keys(t.mat).findIndex(((s,e)=>{const i=Object.keys(t.mat)[e+1];return!i||h>=s&&h<i})),n=t.mat[Object.keys(t.mat)[r]];Object.keys(this.materialProps).forEach((t=>{(s[n]&&s[n][t]||i[t]).forEach((t=>e.push(t)))}))}})),e}}(t,s[r],e&&e[r])}))}get(t){return this.objets[t]}}(e,t.objets,t.materials)),t?.gltfs&&(this.mngGltf=new E(e,t.gltfs)),t?.sounds&&(this.mngSound=new class{constructor(t){this.audios={},Object.keys(t).forEach((s=>{this.audios[s]=new w(t[s])}))}get(t){return this.audios[t]}}(t.sounds)),this.resizeViewport()}canUseDepth(){return this.config.useDepthTexture&&this.config.support.depthTexture||!1}resize(t){this.containerSize=t,this.postProcess&&this.postProcess.resize(t),this.bloom&&this.bloom.resize(t),this.ssao&&this.ssao.resize(t),this.shadow&&this.shadow.resize(t),this.mngProg.updateResolution(this.containerSize.width,this.containerSize.height),this.resizeViewport()}update(t){this.time=t}render(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}resizeViewport(){this.gl.viewport(0,0,this.containerSize.width,this.containerSize.height)}getColorPixel(t,s){const e=new Uint8Array(4);return this.gl.readPixels(t,s,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),e}}},72710:(t,s,e)=>{"use strict";e.d(s,{Z:()=>i});const i=class{constructor(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64;this.gl=t,this.size={width:s,height:e},this.texture=t.createTexture(),this.filter=t.NEAREST,this.setup()}setup(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.create(),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}create(){const t=new ArrayBuffer(this.size.width*this.size.height),s=new Uint8Array(t);let e=0;for(let t=0;t<this.size.height;t+=1)for(let t=0;t<this.size.width;t+=1)s[e]=255*Math.random(),e+=1;this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.ALPHA,this.size.width,this.size.height,0,this.gl.ALPHA,this.gl.UNSIGNED_BYTE,s)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}get(){return this.texture}setFiltre(t){this.filter=t}delete(){this.gl.deleteTexture(this.texture)}}},91215:(t,s,e)=>{"use strict";e.d(s,{Z:()=>i});const i=class{constructor(t,s){this.gl=t;const e=Math.sqrt(s.length/4);this.size={width:e,height:e},this.texture=t.createTexture(),this.filter=t.NEAREST,this.setup(s)}setup(t){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.size.width,this.size.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.setFilters(),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}setFilters(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT)}get(){return this.texture}}},8983:(t,s,e)=>{"use strict";e.r(s),e.d(s,{capitalize:()=>r,chunkArray:()=>i,getEnvPath:()=>h});const i=(t,s)=>Array.from({length:Math.ceil(t.length/s)},((e,i)=>t.slice(i*s,i*s+s))),r=t=>t.charAt(0).toUpperCase()+t.slice(1),h=t=>`/public${t}`},68763:(t,s,e)=>{"use strict";e.d(s,{CD:()=>o,Id:()=>i,MX:()=>r,Yp:()=>h,ZI:()=>a,mK:()=>n});const i=t=>Math.PI*t/180,r=(t,s)=>Math.random()*(s-t)+t,h=(t,s,e,i,r)=>{let h=i+(t-s)*(r-i)/(e-s||1);return h<Math.min(i,r)&&(h=Math.min(i,r)),h>Math.max(i,r)&&(h=Math.max(i,r)),h},n=t=>0===t?0:t>0?1:-1,a=t=>t-Math.floor(t),o=(t,s,e)=>t*(1-e)+s*e;Math.PI,Math.PI},35115:(t,s,e)=>{"use strict";e.d(s,{Z:()=>n});var i=e(59713),r=e.n(i);const h=class{constructor(t,s){this.gl=t,s&&this.create(s),this.extension=t.getExtension("ANGLE_instanced_arrays")}create(t){const{locationKey:s,type:e,values:i,count:r,componentType:h,size:n,modeCalcul:a,isInstancing:o=!1}=t,l="SCALAR"!==e?this.gl.ARRAY_BUFFER:this.gl.ELEMENT_ARRAY_BUFFER;this.vbo=this.gl.createBuffer(),this.gl.bindBuffer(l,this.vbo),this.gl.bufferData(l,i,a),this.gl.bindBuffer(l,null),this.size=n,this.count=r,this.componentType=h,this.bufferType=l,this.locationKey=s,this.isInstancing=o}enable(t){const{locationKey:s,vbo:e,componentType:i,size:r,bufferType:h,isInstancing:n=!1}=this;if("indices"===s)this.gl.bindBuffer(h,e);else{const a=t.locations[s];void 0!==a&&-1!==a&&(this.gl.bindBuffer(h,e),this.gl.enableVertexAttribArray(a),this.gl.vertexAttribPointer(a,r,i,!1,0,0),n&&this.extension.vertexAttribDivisorANGLE(a,1))}}start(t){this.gl.useProgram(t)}end(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}update(t){this.gl.bindBuffer(this.bufferType,this.vbo),this.gl.bufferSubData(this.bufferType,0,new Float32Array(t)),this.gl.bindBuffer(this.bufferType,null)}render(t,s){"indices"===this.locationKey?this.gl.drawElements(s,this.count,this.componentType,0):this.gl.drawArrays(s,0,this.count)}renderInstancing(t,s,e){"indices"===this.locationKey?this.extension.drawElementsInstancedANGLE(s,this.count,this.gl.UNSIGNED_SHORT,0,e):this.extension.drawArraysInstancedANGLE(s,0,this.count,e)}getCount(){return this.count}},n=class{constructor(t,s){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r()(this,"getActiveVbo",(()=>this.vbos.indices||this.vbos.position||this.vbos.texture||this.vbos.index)),this.gl=t,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=e?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,this.vbos=Object.keys(s).reduce(((e,i)=>(e[i]=new h(t,{locationKey:i,modeCalcul:this.modeCalcul,...s[i]}),e)),{}),this.instanceCount=-1}addInstancingVbos(t,s){const e=Object.keys(s).reduce(((t,e)=>(t[e]=new h(this.gl,{locationKey:e,modeCalcul:this.modeCalcul,isInstancing:!0,...s[e]}),t)),{});this.vbos={...this.vbos,...e},this.instanceCount=t}enable(t){this.gl.useProgram(t),Object.keys(this.vbos).forEach((s=>{this.vbos[s].enable(t)}))}update(t){Object.keys(t).forEach((s=>{this.vbos[s].update(t[s])}))}render(t){this.enable(t);const s=this.getActiveVbo();-1!==this.instanceCount?s.renderInstancing(t,this.modeDessin,this.instanceCount):s.render(t,this.modeDessin),s.end()}setModeDessin(t){this.modeDessin=t}setModeCalcul(t){this.modeCalcul=t}}},50967:(t,s,e)=>{"use strict";e.d(s,{Sw:()=>i,Wq:()=>r});const i=(t,s,e)=>{const i=document.querySelector(s);i.download=`${e}${Date.now()}.svg`;let r=(new XMLSerializer).serializeToString(t);r=`<?xml version="1.0" standalone="no"?>\r\n${r}`;const h=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(r)}`;i.href=h},r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return new Promise((s=>{setTimeout(s,t)}))}},46007:(t,s,e)=>{var i={"./shaders/camera/albedo":[30538,538],"./shaders/camera/albedo.js":[30538,538],"./shaders/camera/albedoPhong":[34931,4931],"./shaders/camera/albedoPhong.js":[34931,4931],"./shaders/camera/background":[8525,8525],"./shaders/camera/background.js":[8525,8525],"./shaders/camera/basicFrag":[78834,8834],"./shaders/camera/basicFrag.js":[78834,8834],"./shaders/camera/basicVertex":[94096,4096],"./shaders/camera/basicVertex.js":[94096,4096],"./shaders/camera/basique3d":[9965,9965],"./shaders/camera/basique3d.js":[9965,9965],"./shaders/camera/bone":[52041,2041],"./shaders/camera/bone.js":[52041,2041],"./shaders/camera/buffers":[74383,4383],"./shaders/camera/buffers.js":[74383,4383],"./shaders/camera/color":[86193,6193],"./shaders/camera/color.js":[86193,6193],"./shaders/camera/deform":[24142,4142],"./shaders/camera/deform.js":[24142,4142],"./shaders/camera/emissive":[65864,5864],"./shaders/camera/emissive.js":[65864,5864],"./shaders/camera/frequency":[28562,8562],"./shaders/camera/frequency.js":[28562,8562],"./shaders/camera/frequencyCircle":[165,165],"./shaders/camera/frequencyCircle.js":[165,165],"./shaders/camera/frequencyGrid":[69383,9383],"./shaders/camera/frequencyGrid.js":[69383,9383],"./shaders/camera/gltf":[28391,8391],"./shaders/camera/gltf.js":[28391,8391],"./shaders/camera/morph":[22099,2099],"./shaders/camera/morph.js":[22099,2099],"./shaders/camera/movingCircle":[74516,4302],"./shaders/camera/movingCircle.js":[74516,4302],"./shaders/camera/normale":[31307,1307],"./shaders/camera/normale.js":[31307,1307],"./shaders/camera/normaleMatrix":[61776,1776],"./shaders/camera/normaleMatrix.js":[61776,1776],"./shaders/camera/normalmapping":[95778,5778],"./shaders/camera/normalmapping.js":[95778,5778],"./shaders/camera/paysage":[14134,4134],"./shaders/camera/paysage.js":[14134,4134],"./shaders/camera/phong":[20557,557],"./shaders/camera/phong.js":[20557,557],"./shaders/camera/road":[94422,4422],"./shaders/camera/road.js":[94422,4422],"./shaders/camera/roadmountain":[43681,3681],"./shaders/camera/roadmountain.js":[43681,3681],"./shaders/camera/selected":[4035,4035],"./shaders/camera/selected.js":[4035,4035],"./shaders/camera/shadow":[68099,8099],"./shaders/camera/shadow.js":[68099,8099],"./shaders/camera/signature":[7402,7402],"./shaders/camera/signature.js":[7402,7402],"./shaders/camera/skin":[99904,9904],"./shaders/camera/skin.js":[99904,9904],"./shaders/camera/skinMat":[69948,9948],"./shaders/camera/skinMat.js":[69948,9948],"./shaders/camera/sprite":[4106,4106],"./shaders/camera/sprite.js":[4106,4106],"./shaders/camera/spritePhong":[72810,2810],"./shaders/camera/spritePhong.js":[72810,2810],"./shaders/camera/texture":[1056,1056],"./shaders/camera/texture.js":[1056,1056],"./shaders/camera/update":[45293,5293],"./shaders/camera/update.js":[45293,5293],"./shaders/camera/vertexColor":[96003,6003],"./shaders/camera/vertexColor.js":[96003,6003],"./shaders/diorama/instancing":[8225,8225],"./shaders/diorama/instancing.js":[8225,8225],"./shaders/diorama/instancingDepth":[36202,6202],"./shaders/diorama/instancingDepth.js":[36202,6202],"./shaders/diorama/shadow":[92581,2581],"./shaders/diorama/shadow.js":[92581,2581],"./shaders/diorama/terrain":[68614,8614],"./shaders/diorama/terrain.js":[68614,8614],"./shaders/diorama/terrainClip":[10075,75],"./shaders/diorama/terrainClip.js":[10075,75],"./shaders/diorama/terrainDepth":[24977,4977],"./shaders/diorama/terrainDepth.js":[24977,4977],"./shaders/diorama/water":[40409,409],"./shaders/diorama/water.js":[40409,409],"./shaders/diorama/waterFragment1":[89519,9519],"./shaders/diorama/waterFragment1.js":[89519,9519],"./shaders/diorama/waterFragment2":[84121,5550],"./shaders/diorama/waterFragment2.js":[84121,5550],"./shaders/particules/pass1":[4365,4365],"./shaders/particules/pass1.js":[4365,4365],"./shaders/particules/pass1Morph":[90263,263],"./shaders/particules/pass1Morph.js":[90263,263],"./shaders/particules/pass2":[96579,6579],"./shaders/particules/pass2.js":[96579,6579],"./shaders/particules/pass2Camera":[24307,4307],"./shaders/particules/pass2Camera.js":[24307,4307],"./shaders/screen/basicVertex":[57719,7719],"./shaders/screen/basicVertex.js":[57719,7719],"./shaders/screen/bloom":[8645,8645],"./shaders/screen/bloom.js":[8645,8645],"./shaders/screen/blur":[50654,654],"./shaders/screen/blur.js":[50654,654],"./shaders/screen/blurDirection":[4510,4510],"./shaders/screen/blurDirection.js":[4510,4510],"./shaders/screen/blurMultiPass":[88615,8615],"./shaders/screen/blurMultiPass.js":[88615,8615],"./shaders/screen/blurOnePass":[84002,4002],"./shaders/screen/blurOnePass.js":[84002,4002],"./shaders/screen/blurRadial":[76812,6812],"./shaders/screen/blurRadial.js":[76812,6812],"./shaders/screen/brightcontrast":[47540,7540],"./shaders/screen/brightcontrast.js":[47540,7540],"./shaders/screen/compose":[94121,4121],"./shaders/screen/compose.js":[94121,4121],"./shaders/screen/composeShadow":[55829,5829],"./shaders/screen/composeShadow.js":[55829,5829],"./shaders/screen/debug":[33459,3459],"./shaders/screen/debug.js":[33459,3459],"./shaders/screen/diffuse":[19442,9442],"./shaders/screen/diffuse.js":[19442,9442],"./shaders/screen/dof":[85931,5931],"./shaders/screen/dof.js":[85931,5931],"./shaders/screen/fxaa":[52587,2587],"./shaders/screen/fxaa.js":[52587,2587],"./shaders/screen/fxaa2":[73563,3563],"./shaders/screen/fxaa2.js":[73563,3563],"./shaders/screen/gamma":[64455,4455],"./shaders/screen/gamma.js":[64455,4455],"./shaders/screen/glitch":[59914,9914],"./shaders/screen/glitch.js":[59914,9914],"./shaders/screen/glitch2":[95040,5040],"./shaders/screen/glitch2.js":[95040,5040],"./shaders/screen/glitch3":[58081,8081],"./shaders/screen/glitch3.js":[58081,8081],"./shaders/screen/glitch4":[14018,4018],"./shaders/screen/glitch4.js":[14018,4018],"./shaders/screen/kuwahara":[57938,7938],"./shaders/screen/kuwahara.js":[57938,7938],"./shaders/screen/landscape":[84778,4778],"./shaders/screen/landscape.js":[84778,4778],"./shaders/screen/line":[66140,6140],"./shaders/screen/line.js":[66140,6140],"./shaders/screen/mergeBloom":[99452,9452],"./shaders/screen/mergeBloom.js":[99452,9452],"./shaders/screen/oil":[69081,9081],"./shaders/screen/oil.js":[69081,9081],"./shaders/screen/pixel":[26447,6447],"./shaders/screen/pixel.js":[26447,6447],"./shaders/screen/point":[34865,4865],"./shaders/screen/point.js":[34865,4865],"./shaders/screen/raymarch":[2806,2806],"./shaders/screen/raymarch.js":[2806,2806],"./shaders/screen/rgb":[58919,8919],"./shaders/screen/rgb.js":[58919,8919],"./shaders/screen/screen":[62605,2605],"./shaders/screen/screen.js":[62605,2605],"./shaders/screen/sepia":[27168,7168],"./shaders/screen/sepia.js":[27168,7168],"./shaders/screen/shader":[59219,9219],"./shaders/screen/shader.js":[59219,9219],"./shaders/screen/signature":[43100,3100],"./shaders/screen/signature.js":[43100,3100],"./shaders/screen/sketch":[37912,7912],"./shaders/screen/sketch.js":[37912,7912],"./shaders/screen/sobel":[22847,2847],"./shaders/screen/sobel.js":[22847,2847],"./shaders/screen/specular":[8379,8379],"./shaders/screen/specular.js":[8379,8379],"./shaders/screen/ssao":[2956,2956],"./shaders/screen/ssao-chapman":[63477,3477],"./shaders/screen/ssao-chapman.js":[63477,3477],"./shaders/screen/ssao.js":[2956,2956],"./shaders/screen/tunnelrace":[87052,7052],"./shaders/screen/tunnelrace.js":[87052,7052],"./shaders/screen/tunnelround":[31315,1315],"./shaders/screen/tunnelround.js":[31315,1315],"./shaders/screen/tunnelsquared":[28390,8390],"./shaders/screen/tunnelsquared.js":[28390,8390],"./shaders/screen/vortex":[4342,4342],"./shaders/screen/vortex.js":[4342,4342],"./shaders/screen/water":[35784,5784],"./shaders/screen/water.js":[35784,5784],"./shaders/screen/watercolor":[91360,1360],"./shaders/screen/watercolor.js":[91360,1360],"./shaders/screen/watercolor2":[43298,3298],"./shaders/screen/watercolor2.js":[43298,3298],"./shaders/screen/watercolor3":[17427,7427],"./shaders/screen/watercolor3.js":[17427,7427],"./shaders/screen/watercolorMoving":[88096,8096],"./shaders/screen/watercolorMoving.js":[88096,8096],"./shaders/screen/wave":[38514,8514],"./shaders/screen/wave.js":[38514,8514],"./shaders/sky/getClouds":[29044,9044],"./shaders/sky/getClouds.js":[29044,9044],"./shaders/sky/getSunSky":[36507,6507],"./shaders/sky/getSunSky.js":[36507,6507],"./shaders/sky/roadSky":[14472,4472],"./shaders/sky/roadSky.js":[14472,4472],"./shaders/sky/skyWithFloor":[93671,3671],"./shaders/sky/skyWithFloor.js":[93671,3671],"./shaders/sky/sunset":[70040,40],"./shaders/sky/sunset.js":[70040,40],"./shaders/sky/tunnel":[52344,2344],"./shaders/sky/tunnel.js":[52344,2344],"./shaders/utils":[20552,552],"./shaders/utils/":[20552,552],"./shaders/utils/blur":[29098,9098],"./shaders/utils/blur.js":[29098,9098],"./shaders/utils/fog":[58125,8125],"./shaders/utils/fog.js":[58125,8125],"./shaders/utils/index":[20552,552],"./shaders/utils/index.js":[20552,552],"./shaders/utils/instancing":[77873,7873],"./shaders/utils/instancing.js":[77873,7873],"./shaders/utils/light":[8735,8735],"./shaders/utils/light.js":[8735,8735],"./shaders/utils/noise":[96215,6215],"./shaders/utils/noise.js":[96215,6215],"./shaders/utils/pbr":[60568,568],"./shaders/utils/pbr.js":[60568,568],"./shaders/utils/random":[32362,2362],"./shaders/utils/random.js":[32362,2362],"./shaders/utils/roadDistortion":[74926,4926],"./shaders/utils/roadDistortion.js":[74926,4926],"./shaders/utils/shadow":[44956,4956],"./shaders/utils/shadow.js":[44956,4956],"./shaders/utils/shapes":[94960,4960],"./shaders/utils/shapes.js":[94960,4960],"./shaders/utils/terrain":[42235,2235],"./shaders/utils/terrain.js":[42235,2235],"./shaders/utils/toon":[99060,9060],"./shaders/utils/toon.js":[99060,9060]};function r(t){if(!e.o(i,t))return Promise.resolve().then((()=>{var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}));var s=i[t],r=s[0];return e.e(s[1]).then((()=>e(r)))}r.keys=()=>Object.keys(i),r.id=46007,t.exports=r}}]);