(self.webpackChunkdovotori_portfolio=self.webpackChunkdovotori_portfolio||[]).push([[9326],{3957:(n,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>T});var i=e(87757),r=e.n(i),s=e(48926),o=e.n(s);e(68117);var c=e(34575),a=e.n(c),u=e(59713),f=e.n(u),l=e(35615),h=function n(){var t=this;a()(this,n),f()(this,"on",(function(){var n;return(n=t.socket).on.apply(n,arguments)})),f()(this,"emit",(function(){var n;return(n=t.socket).emit.apply(n,arguments)})),f()(this,"reconnect",(function(){return t.close(),new Promise((function(n,e){t.socket.connect(),t.socket.on("connect_error",(function(n){t.socket.close(),e(n)})),t.socket.on("connect",(function(){n(t)}))}))})),f()(this,"close",(function(){t.socket.connected&&t.socket.disconnect()})),f()(this,"isConnected",(function(){return t.socket.connected}));return this.socket=null,new Promise((function(n,e){t.socket=(0,l.Z)("http://localhost:8083"),t.socket.on("connect_error",(function(n){t.socket.disconnect(),e(n)})),t.socket.on("connect",(function(){n(t)}))}))},p=e(93913),d=e.n(p),k=e(38853),w=e.n(k),m=function(){function n(){var t=this;a()(this,n),f()(this,"setSignal",(function(n){t.peer.signal(n)})),f()(this,"setAsk",(function(n){t.ask=n})),f()(this,"setStream",(function(n){t.stream=n,t.isCreated&&t.peer.addStream(t.stream)})),f()(this,"setAnswer",(function(n){t.answer=n,t.isInitiator&&t.isCreated&&t.peer.signal(t.answer)})),f()(this,"setOffer",(function(n){t.offer=n,t.tryToCreate()})),f()(this,"setIsInitiator",(function(n){t.isInitiator=n,t.tryToCreate()})),this.isInitiator=null,this.isConnected=!1,this.peer=null,this.stream=null,this.answer=null,this.offer=null,this.ask=null,this.isCreated=!1}return d()(n,[{key:"tryToCreate",value:function(){this.isCreated||null===this.isInitiator||(this.isInitiator||!this.isInitiator&&this.offer)&&this.create()}},{key:"create",value:function(){var n=this;this.peer=new(w())({initiator:this.isInitiator,trickle:!1,stream:this.stream}),this.peer.on("error",(function(n){})),this.peer.on("signal",(function(t){n.isConnected||(n.isInitiator&&t.type&&"offer"===t.type?n.ask("question offer",t):!n.isInitiator&&t.type&&"answer"===t.type&&n.ask("question answer",t))})),this.peer.on("stream",(function(n){var t=document.querySelector("#emitter");t.srcObject=n,t.play()})),this.peer.on("connect",(function(){n.isConnected=!0})),this.isInitiator||this.setSignal(this.offer),this.isCreated=!0}},{key:"getIsInitiator",value:function(){return this.isInitiator}}]),n}(),v=e(93379),y=e.n(v),g=e(80668),I={insert:"head",singleton:!1};y()(g.Z,I);g.Z.locals;var C=document.querySelector("#btn"),b=function(){var n=o()(r().mark((function n(t){var e,i;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((function(n){return n})).catch((function(n){}));case 2:(e=n.sent)?(t.setStream(e),(i=document.querySelector("#own")).srcObject=e,i.play()):C.innerHTML="Can't access your webcam. Retry";case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),x=function(){var n=o()(r().mark((function n(t){var e,i;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new h;case 2:return e=n.sent,i=function(){return e.emit.apply(e,arguments)},t.setAsk(i),e.on("answer initiator",t.setIsInitiator),e.on("answer offer",t.setOffer),e.on("answer answer",t.setAnswer),e.emit("question initiator"),n.abrupt("return",e);case 10:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}();const T=function(){var n=null;C&&C.addEventListener("click",o()(r().mark((function t(){var e;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(C.innerHTML="Loading",t.prev=1,null!==n){t.next=14;break}return C.innerHTML="Please allow webcam access",e=new m,t.next=8,b(e);case 8:return t.next=10,x(e);case 10:n=t.sent,C.innerHTML=e.getIsInitiator()?"Connected (wait for another connection)":"Wait you will join someone",t.next=17;break;case 14:n.close(),n=null,C.innerHTML="Join";case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(1),C.innerHTML="Retry";case 23:case"end":return t.stop()}}),t,null,[[1,19]])}))),!1)}},80668:(n,t,e)=>{"use strict";e.d(t,{Z:()=>s});var i=e(23645),r=e.n(i)()((function(n){return n[1]}));r.push([n.id,"#labo {\n  position: relative;\n  width: 100%;\n  height: auto;\n  background-color: #222;\n  text-align: center;\n}\nvideo {\n  width: 50%;\n}\n.flex {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n#status {\n  width: 80%;\n  color: #fff;\n  margin: 0 auto;\n  padding: 1em;\n}\n#btn {\n  background: #fff;\n  width: 80%;\n  margin: 0 auto;\n  padding: 1em;\n  text-transform: uppercase;\n  letter-spacing: 0.2em;\n}\n",""]);const s=r},61758:()=>{}}]);