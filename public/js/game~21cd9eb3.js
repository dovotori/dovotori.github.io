(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{116:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(73),u=i(118),l=function(){function t(e){s()(this,t),this.gl=e,this.objet=new a.a(e,u.a)}return o()(t,[{key:"render",value:function(t){this.gl.disable(this.gl.CULL_FACE),this.objet.render(t),this.gl.enable(this.gl.CULL_FACE)}}]),t}()},125:function(t,e,i){"use strict";i.d(e,"h",(function(){return n})),i.d(e,"a",(function(){return s})),i.d(e,"d",(function(){return r})),i.d(e,"e",(function(){return o})),i.d(e,"g",(function(){return a})),i.d(e,"f",(function(){return u})),i.d(e,"j",(function(){return l})),i.d(e,"i",(function(){return h})),i.d(e,"c",(function(){return c})),i.d(e,"b",(function(){return f}));var n=38,s=40,r=37,o=39,a=32,u=16,l=88,h=87,c=13,f=27},137:function(t,e,i){"use strict";i.d(e,"a",(function(){return S}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(22),u=i.n(a),l=i(7),h=i.n(l),c=i(8),f=i.n(c),v=i(3),p=i.n(v),d=i(25),g=i(19);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var m=function(t){h()(i,t);var e=y(i);function i(t){var n;return s()(this,i),(n=e.call(this,t)).target=new d.a(t.target.x,t.target.y,t.target.z),n.matIdentity=new g.a,n.projection=new g.a,n.projection.identity(),n.near=t.near||1,n.far=t.far||100,n.angle=t.angle||50,n.matIdentity.identity(),n.lookAt(),n}return o()(i,[{key:"update",value:function(){this.lookAt()}},{key:"perspective",value:function(t,e){this.projection.identity().perspective(this.angle,t/e,this.near,this.far)}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.position.set(this.position.getX(),Math.sin(.02*t)*(2+e),this.position.getZ()),this.lookAt()}},{key:"setNearFar",value:function(t,e){this.near=t,this.far=e}},{key:"setAngle",value:function(t){this.angle=t}},{key:"getProjection",value:function(){return this.projection}},{key:"getIdentity",value:function(){return this.matIdentity}},{key:"getNearFar",value:function(){return[this.near,this.far]}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getAngle",value:function(){return this.angle}}]),i}(i(85).a),k=i(135);function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var b=function(t){h()(i,t);var e=x(i);function i(){return s()(this,i),e.apply(this,arguments)}return o()(i,[{key:"get2dTexturePoint",value:function(t){var e=t.getX(),i=t.getY(),n=t.getZ(),s=new k.a(e,i,n,1),r=new g.a;r.equal(this.view).multiply(this.projection),s.multiplyMatrix(r);var o=s.getX()/s.getW(),a=s.getY()/s.getW();return[o=.5*(o+1),a=.5*(a+1)]}},{key:"get2dScreenPoint",value:function(t,e){var i=this.get2dTexturePoint(t);return[i[0]*e.width,i[1]*e.height]}}]),i}(m),w=i(52);function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var S=function(t){h()(i,t);var e=A(i);function i(t){var n;return s()(this,i),(n=e.call(this,t)).options=t,n.rotationX=new w.a,n.targetX=new w.a,n.zoomZ=new w.a(.7,.1),n}return o()(i,[{key:"update",value:function(){u()(p()(i.prototype),"update",this).call(this),this.rotationX.update(),this.zoomZ.update(),this.targetX.update(),this.position.set(this.options.position.x+this.targetX.get()+Math.sin(this.rotationX.get())*(this.options.position.z*this.zoomZ.get()),this.options.position.y,Math.cos(this.rotationX.get())*(this.options.position.z*this.zoomZ.get())),this.target.set(this.options.target.x,this.options.target.y,this.options.target.z)}},{key:"setSmoothTarget",value:function(t){this.targetX.set(t)}},{key:"setSmoothRotation",value:function(t){this.rotationX.set(t)}},{key:"setSmoothZoom",value:function(t){this.zoomZ.set(t)}},{key:"getZoom",value:function(){return this.zoomZ.get()}},{key:"followPos2D",value:function(t,e){this.options.position.x=t,this.options.position.y=e,this.options.target.x=t,this.options.target.y=e}},{key:"followPosY",value:function(t){this.options.position.y=t,this.options.target.y=t}}]),i}(b)},143:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n=i(0),s=i.n(n),r=i(48),o=i.n(r),a=i(1),u=i.n(a),l=i(2),h=i.n(l);function c(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?c(Object(i),!0).forEach((function(e){s()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var v={ambiant:[0,0,0],diffuse:[.5,.5,.5],specular:[1,1,1],emissive:[0,0,0],specDensity:[1],opacity:1},p=function(){function t(e,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;u()(this,t),this.gl=e,this.modeDessin=this.gl.TRIANGLES,this.modeCalcul=this.gl.STATIC_DRAW,this.materialProps={},this.steps=this.getSteps(i,s);var r=this.getPoints(i,s);this.stride=0,Object.entries(this.steps).forEach((function(t){null!==t[1]&&(n.stride+=t[1])})),this.vbo=this.gl.createBuffer(),this.count=r.length/this.stride,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(r),this.modeCalcul),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}return h()(t,[{key:"enable",value:function(t){var e=this;this.gl.useProgram(t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo);var i=0;Object.entries(this.steps).forEach((function(n){var s=o()(n,2),r=s[0],a=s[1];void 0!==t.locations[r]&&-1!==t.locations[r]&&(e.gl.enableVertexAttribArray(t.locations[r]),e.gl.vertexAttribPointer(t.locations[r],a,e.gl.FLOAT,!1,4*e.stride,4*i)),null!==e.steps[r]&&(i+=e.steps[r])}))}},{key:"render",value:function(t){this.enable(t),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.drawArrays(this.modeDessin,0,this.count),this.end()}},{key:"end",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.useProgram(null)}},{key:"setModeDessin",value:function(t){this.modeDessin=t}},{key:"setModeCalcul",value:function(t){this.modeCalcul=t}},{key:"getSteps",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={position:3};return t.vt.indices.length>0&&(n.texture=2),t.vn.indices.length>0&&(n.normale=3),i&&t.mat&&Object.keys(t.mat).forEach((function(n){var s=t.mat[n],r=i[s];r&&Object.keys(r).forEach((function(t){void 0===e.materialProps[t]&&(e.materialProps[t]=r[t].length)}))})),f(f({},n),this.materialProps)}},{key:"getPoints",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];return t.v.indices.forEach((function(s,r){var o=3*s;if(n.push(t.v.points[o]),n.push(t.v.points[o+1]),n.push(t.v.points[o+2]),t.vt.indices.length>0){var a=2*t.vt.indices[r];n.push(t.vt.points[a]),n.push(t.vt.points[a+1])}if(t.vn.indices.length>0){var u=3*t.vn.indices[r];n.push(t.vn.points[u]),n.push(t.vn.points[u+1]),n.push(t.vn.points[u+2])}if(i&&t.mat){var l=Object.keys(t.mat).findIndex((function(e,i){var n=Object.keys(t.mat)[i+1];return!n||r>=e&&r<n})),h=t.mat[Object.keys(t.mat)[l]];Object.keys(e.materialProps).forEach((function(t){(i[h]&&i[h][t]||v[t]).forEach((function(t){return n.push(t)}))}))}})),n}}]),t}()},144:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=function(){function t(e,i){s()(this,t),this.gl=e,this.program=this.gl.createProgram(),this.setup(i)}return o()(t,[{key:"setup",value:function(t){this.creerShader("vertex",t.vertex),this.creerShader("fragment",t.fragment),this.gl.linkProgram(this.program),this.gl.useProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)?(this.createLocations(t),this.gl.useProgram(null)):this.gl.deleteProgram(this.program)}},{key:"creerShader",value:function(t,e){var i=this.gl.createShader("vertex"===t?this.gl.VERTEX_SHADER:this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,e),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?(this.gl.attachShader(this.program,i),this.gl.deleteShader(i)):this.gl.deleteShader(i)}},{key:"createLocations",value:function(t){var e=this;this.program.locations={},t.uniforms.forEach((function(t){e.program.locations[t]=e.gl.getUniformLocation(e.program,t)})),t.attributes.forEach((function(t){e.program.locations[t]=e.gl.getAttribLocation(e.program,t)}))}},{key:"setProjectionView",value:function(t){this.setMatrix("projection",t.getProjection().get()),this.setMatrix("view",t.getView().get())}},{key:"setMatrix",value:function(t,e){this.gl.useProgram(this.program),16===e.length?this.gl.uniformMatrix4fv(this.program.locations[t],!1,e):this.gl.uniformMatrix3fv(this.program.locations[t],!1,e),this.gl.useProgram(null)}},{key:"setInt",value:function(t,e){this.gl.useProgram(this.program),this.gl.uniform1i(this.program.locations[t],e),this.gl.useProgram(null)}},{key:"setTexture",value:function(t,e,i){this.gl.useProgram(this.program),this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.uniform1i(this.program.locations[i],t),this.gl.useProgram(null)}},{key:"setFloat",value:function(t,e){this.gl.useProgram(this.program),this.gl.uniform1f(this.program.locations[t],e),this.gl.useProgram(null)}},{key:"setVector",value:function(t,e){switch(this.gl.useProgram(this.program),e.length){default:case 2:this.gl.uniform2fv(this.program.locations[t],e);break;case 3:this.gl.uniform3fv(this.program.locations[t],e);break;case 4:this.gl.uniform4fv(this.program.locations[t],e)}this.gl.useProgram(null)}},{key:"enable",value:function(){this.gl.useProgram(this.program)}},{key:"disable",value:function(){this.gl.useProgram(null)}},{key:"get",value:function(){return this.program}},{key:"getLocations",value:function(){return this.program.locations}}]),t}()},146:function(t,e,i){"use strict";i.d(e,"a",(function(){return w}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(10),u=i.n(a),l=i(22),h=i.n(l),c=i(7),f=i.n(c),v=i(8),p=i.n(v),d=i(3),g=i.n(d),y=i(0),m=i.n(y),k=i(86),x=i(19);function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=g()(t);if(e){var s=g()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return p()(this,i)}}var w=function(t){f()(i,t);var e=b(i);function i(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s()(this,i),r=e.call(this,t,n),m()(u()(r),"removeAnimations",(function(t){return t.map((function(t){var e=t;return e.children&&(e.children=r.removeAnimations(e.children)),r.removeAnim(e)}))})),m()(u()(r),"addJointsAnimations",(function(t,e){t.forEach((function(t){var i=t.animations,n=t.name,s=t.children;i&&(r.animations[n]=r.addAnimations(i,e)),s&&r.addJointsAnimations(s,e)}))})),m()(u()(r),"setProgramSkin",(function(t,e){if(void 0!==t){var i=new x.a;i.identity();var n=r.skins[t].joints;r.setProgramJoints(n,e,i)}})),m()(u()(r),"setProgramJoints",(function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t.forEach((function(t){var s=t.invMatrix,o=t.children,a=r.handleLocalTransform(t);a.multiply(i);var u=new x.a;u.identity();var l=new x.a;l.setFromArray(s),l.resetScale(),u.multiply(l),u.multiply(a),e.setMatrix("jointMat[".concat(n,"]"),u.get()),o&&r.setProgramJoints(o,e,a,n+1)}))}));var a=n.skins;return a&&(a.forEach((function(t){var e=t.joints;r.addJointsAnimations(e,o)})),r.skins=a.map((function(t){var e=t.joints;return{joints:r.removeAnimations(e)}}))),r}return o()(i,[{key:"renderNode",value:function(t,e,n){var s=this.nodes[t].skin;void 0!==s&&this.setProgramSkin(s,e),h()(g()(i.prototype),"renderNode",this).call(this,t,e,n)}}]),i}(k.a)},149:function(t,e,i){"use strict";i.d(e,"a",(function(){return m}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(7),u=i.n(a),l=i(8),h=i.n(l),c=i(3),f=i.n(c),v=i(85),p=i(65),d=i(150),g=i(25);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=f()(t);if(e){var s=f()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return h()(this,i)}}var m=function(t){u()(i,t);var e=y(i);function i(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1024,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return s()(this,i),(r=e.call(this,n)).gl=t,r.fbo=new p.a(r.gl,o,a,u),r.sizeRepere=new g.a(.05,.05,.05),r.repere=new d.a(r.gl),r.repere.update(r.position,r.sizeRepere),r.lookAt(),r}return o()(i,[{key:"start",value:function(){this.fbo.start()}},{key:"end",value:function(){this.fbo.end()}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.position.set(Math.cos(.002*t)*(4+e),this.position.getY(),Math.sin(.002*t)*(4+e)),this.lookAt(),this.repere.update(this.position,this.sizeRepere)}},{key:"renderRepere",value:function(t){this.repere.render(t)}},{key:"getDepthTexture",value:function(){return this.fbo.getDepthTexture()}}]),i}(v.a)},152:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(0),u=i.n(a),l=function(){function t(e){s()(this,t),this.gl=t.checkWebGl(e),this.support={webgl:!1,depthTexture:!1},this.gl&&(this.support.webgl=!0,this.gl.enable(this.gl.DEPTH_TEST),this.gl.clearDepth(1),this.gl.depthFunc(this.gl.LESS),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.clearColor(0,0,0,0),this.support.depthTexture=!!this.gl.getExtension("WEBGL_depth_texture"),this.support.drawBuffers=!!this.gl.getExtension("WEBGL_draw_buffers")||!!this.gl.getExtension("GL_EXT_draw_buffers")||!!this.gl.getExtension("EXT_draw_buffers"))}return o()(t,null,[{key:"checkWebGl",value:function(t){for(var e,i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],n=0;n<i.length;n+=1){try{e=t.getContext(i[n],{preserveDrawingBuffer:!0})}catch(t){}if(e)break}return e}}]),o()(t,[{key:"get",value:function(){return this.gl}},{key:"getSupport",value:function(){return this.support}}]),t}(),h=function(){function t(){var e=this;s()(this,t),u()(this,"resize",(function(t){e.canvas.setAttribute("width",t.width),e.canvas.setAttribute("height",t.height)})),this.canvas=document.createElement("canvas"),this.context=new l(this.canvas)}return o()(t,[{key:"get",value:function(){return this.canvas}},{key:"getContext",value:function(){return this.context.get()}},{key:"getSupport",value:function(){return this.context.getSupport()}}]),t}()},345:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=function(){function t(){s()(this,t),this.value=null,this.isMin=!1,this.ownerId=null}return o()(t,[{key:"setup",value:function(t,e){this.isMin=t,this.ownerId=e}},{key:"set",value:function(t){this.value=t}},{key:"get",value:function(){return this.value}},{key:"getID",value:function(){return this.ownerId}},{key:"isMinimum",value:function(){return this.isMin}}]),t}()},393:function(t,e,i){"use strict";i.d(e,"a",(function(){return g}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(22),u=i.n(a),l=i(7),h=i.n(l),c=i(8),f=i.n(c),v=i(3),p=i.n(v);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var g=function(t){h()(i,t);var e=d(i);function i(){return s()(this,i),e.apply(this,arguments)}return o()(i,[{key:"update",value:function(t,e){var n=u()(p()(i.prototype),"update",this).call(this,t,e);return n&&this.updateSpeed(),n}},{key:"updateSpeed",value:function(){this.setDamping(),this.setGravity(),this.setClamping()}},{key:"setGravity",value:function(){var t=this.constants.physics.gravity;this.isCollision.bottom||this.speed.addY(-t)}},{key:"setDamping",value:function(){var t=this.constants.physics.damping;Math.abs(this.speed.getX())>.01?this.speed.multiplyX(t.x):this.speed.setX(0)}},{key:"setClamping",value:function(){var t=this.constants.physics.clamp;this.speed.getX()>t.x&&this.speed.setX(t.x),this.speed.getX()<-t.x&&this.speed.setX(-t.x),this.speed.getY()>t.y&&this.speed.setY(t.y),this.speed.getY()<-t.y&&this.speed.setY(-t.y)}}]),i}(i(395).a)},395:function(t,e,i){"use strict";var n=i(1),s=i.n(n),r=i(22),o=i.n(r),a=i(2),u=i.n(a),l=i(7),h=i.n(l),c=i(8),f=i.n(c),v=i(3),p=i.n(v),d=i(0),g=i.n(d),y=i(25);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var k=1e-6,x=function(t){h()(i,t);var e=m(i);function i(t,n,r){var o;return s()(this,i),(o=e.call(this,t,n)).isCollision={left:!1,right:!1,bottom:!1,top:!1},o.testPoints=o.determineTestPoints(r),o}return u()(i,null,[{key:"getNearCollisionPoint",value:function(t,e){for(var n=0;n<e.length;n+=1)if(i.isCollisionTile(t,e[n].x,e[n].y))return{x:e[n].x,y:e[n].y};return null}},{key:"isCollisionTile",value:function(t,e,i){var n=t.getImageData(Math.floor(e),Math.floor(i),1,1);return 255!==n.data[0]&&n.data[0]===n.data[1]&&n.data[1]===n.data[2]}},{key:"determineStep",value:function(t,e){for(var i=t,n=1;Math.abs(i)>=e;)i/=2,n+=1;return{value:i,step:n}}}]),u()(i,[{key:"determineTestPoints",value:function(t){var e=this.constants,n=e.w,s=e.h,r=i.determineStep(n,t.w),o=r.value,a=r.step,u=i.determineStep(s,t.h),l=u.value,h=u.step,c=[];c.push({x:k,y:-1e-6});for(var f=1;f<a;f+=1)c.push({x:o*f,y:-1e-6});c.push({x:n-k,y:-1e-6});var v=[];v.push({x:k,y:s+k});for(var p=1;p<a;p+=1)v.push({x:o*p,y:s+k});v.push({x:n-k,y:s+k});var d=[];d.push({x:-1e-6,y:k});for(var g=1;g<h;g+=1)d.push({x:-1e-6,y:l*g});d.push({x:-1e-6,y:s-k});var y=[];y.push({x:n+k,y:k});for(var m=1;m<h;m+=1)y.push({x:n+k,y:l*m});return y.push({x:n+k,y:s-k}),{left:d,right:y,bottom:c,top:v}}},{key:"update",value:function(t,e){var n=o()(p()(i.prototype),"update",this).call(this);return n&&this.setCollision(t,e),n}},{key:"defineNextStatus",value:function(){o()(p()(i.prototype),"defineNextStatus",this).call(this);var t=this.constants.states,e=t.STAND,n=t.RUN;this.isLock()||this.isCollision.bottom&&(this.status=e,Math.abs(this.speed.getX())>0&&(this.status=n))}},{key:"setCollision",value:function(t,e){var i=this;Object.keys(this.isCollision).forEach((function(n){i.setDirectionCollision(t,n,e)})),(this.isCollision.top||this.isCollision.bottom)&&this.speed.setY(0),(this.isCollision.left||this.isCollision.right)&&this.speed.setX(0)}},{key:"setDirectionCollision",value:function(t,e,n){var s=!1,r="left"===e||"right"===e;switch(e){case"bottom":s=this.speed.getY()<0;break;case"top":s=this.speed.getY()>0;break;case"left":s=this.speed.getX()<0;break;case"right":s=this.speed.getX()>0}if(!this.isCollision[e]&&s){for(var o=i.determineStep(r?this.speed.getX():this.speed.getY(),r?n.w:n.h),a=o.value,u=o.step,l=[],h=this.testPoints[e],c=0;c<=u;c+=1)for(var f=0;f<h.length;f+=1){var v=this.position.getX()+h[f].x,p=this.position.getY()+h[f].y;r?v+=a*c:p+=a*c,l.push({x:v,y:p})}var d=i.getNearCollisionPoint(t,l);if(d){var g=this.constants,y=g.w,m=g.h;switch(e){case"bottom":this.position.setY(Math.ceil(d.y));break;case"top":this.position.setY(Math.floor(d.y)-m);break;case"left":this.position.setX(Math.ceil(d.x));break;case"right":this.position.setX(Math.floor(d.x)-y)}this.isCollision[e]=!0}else r?this.position.addX(this.speed.getX()):this.position.addY(this.speed.getY())}else this.isStillCollide(t,e)||(this.isCollision[e]=!1)}},{key:"isStillCollide",value:function(t,e){var n=this,s=this.testPoints[e].map((function(t){return{x:n.position.getX()+t.x,y:n.position.getY()+t.y}}));return null!==i.getNearCollisionPoint(t,s)}},{key:"getCollision",value:function(t){return this.isCollision[t]}},{key:"getCollisionAxeX",value:function(){return this.isCollision.left||this.isCollision.right}}]),i}(function(){function t(e,i){var n=this;s()(this,t),g()(this,"shoudContinue",(function(){var t=n.constants.states.DIE;return n.status!==t})),g()(this,"setEndOfAnimation",(function(t){t&&(n.status=t)})),g()(this,"reset",(function(){var t=n.constants,e=t.x,i=t.y,s=t.z,r=t.states;n.position.set(e||0,i||0,s||0),n.status=r[Object.keys(r)[0]],n.speed.set(0,0,0)})),this.constants=e,this.updateState=i,this.position=new y.a,this.status=null,this.speed=new y.a,this.size=new y.a(e.w||1,e.h||1,1),this.inverseSprite=!1,this.statusChanged=!1,this.reset()}return u()(t,[{key:"update",value:function(){var t=this.shoudContinue();if(t){this.statusChanged=!1;var e=this.status;this.defineNextStatus(),this.updateState&&this.updateState(this.status,this.inverseSprite),e!==this.status&&(this.statusChanged=!0)}return t}},{key:"isLock",value:function(){var t=this.constants.lockStates;return t&&-1!==t.indexOf(this.status)}},{key:"defineNextStatus",value:function(){var t=this.constants.states,e=t.JUMP_DOWN,i=t.RUN_JUMP_DOWN;this.isLock()||this.speed.getY()<0&&(this.status=e,Math.abs(this.speed.getX())>0&&(this.status=i))}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.position.set(t,e,i)}},{key:"setSize",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.size.set(t,e,i)}},{key:"setStatus",value:function(t){this.status=t}},{key:"getPosition",value:function(){return this.position}},{key:"getStatus",value:function(){return this.status}},{key:"getSize",value:function(){return this.size}},{key:"getX",value:function(){return this.position.getX()}},{key:"getY",value:function(){return this.position.getY()}},{key:"getZ",value:function(){return this.position.getZ()}},{key:"getSpeed",value:function(){return this.speed.get()}},{key:"getSpeedX",value:function(){return this.speed.getX()}},{key:"getSpeedY",value:function(){return this.speed.getY()}},{key:"addToSpeed",value:function(t){this.speed.add(t)}},{key:"isStatusChanged",value:function(){return this.statusChanged}}]),t}());e.a=x},472:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(408),u=i(29),l=function(){function t(e,i){s()(this,t),this.screen=new a.a,this.cpt=0,this.mountains=new Array(4);for(var n=0;n<this.mountains.length;n+=1)this.mountains[n]=new a.a;this.clouds=new Array(4),this.cloudData=[],this.viewBox=e,this.levelSize=i;for(var r=0;r<this.clouds.length;r+=1)this.clouds[r]=new a.a,this.cloudData[r]=this.setCloud()}return o()(t,[{key:"update",value:function(t){this.updateMountains(t),this.updateClouds(t)}},{key:"updateScreens",value:function(t){this.screen.update(),this.screen.setScale(20,10,0),this.screen.setTranslate(0,10,t)}},{key:"updateMountains",value:function(t){var e=this;this.mountains.forEach((function(i,n){var s=e.mountains.length-n,r=Object(u.b)(n,0,e.mountains.length,4,40),o=Object(u.b)(t[0],0,e.levelSize.w,e.viewBox.w+10*s,10*-s),a=10+r/2,l=Object(u.b)(n,0,e.mountains.length,255,100),h=Object(u.b)(n,0,e.mountains.length,-2,-20);i.update(),i.setScale(r,r,r),i.setRotate(45,0,0,1),i.setTranslate(o,a,h),i.setColor(l,l,l,1)}))}},{key:"updateClouds",value:function(){var t=this;this.clouds.forEach((function(e,i){var n=t.cloudData[i].scale;t.cloudData[i].x<-n?t.cloudData[i]=t.setCloud(t.viewBox.w+n):t.cloudData[i].x-=t.cloudData[i].speed,e.update(),e.setScale(n,n,n),e.setRotate(45,0,0,1),e.setTranslate(t.cloudData[i].x,t.cloudData[i].y,t.cloudData[i].z),e.setColor(255,255,255,.4)}))}},{key:"renderScreen",value:function(t,e,i,n){e.setFloat("offset",i*n),this.screen.render(t,e)}},{key:"renderMountains",value:function(t,e){this.mountains.forEach((function(i){return i.render(t,e)}))}},{key:"renderCloudsFront",value:function(t,e){var i=this;this.clouds.forEach((function(n,s){i.cloudData[s].z>0&&n.render(t,e)}))}},{key:"renderCloudsBack",value:function(t,e){var i=this;this.clouds.forEach((function(n,s){i.cloudData[s].z<0&&n.render(t,e)}))}},{key:"setCloud",value:function(t){return{x:t||10*Math.random(),y:Object(u.b)(Math.random(),0,1,0,this.levelSize.h),z:10*Object(u.b)(Math.random(),0,1,-4,2),scale:1+2*Math.random(),speed:.1+.1*Math.random()}}}]),t}()},473:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(345),u=function(){function t(){s()(this,t),this.min=Array(3),this.max=Array(3),this.id=0}return o()(t,[{key:"setup",value:function(t){this.id=t;for(var e=0;e<3;e+=1)this.min[e]=new a.a,this.max[e]=new a.a,this.min[e].setup(!0,this.id),this.max[e].setup(!1,this.id)}},{key:"update",value:function(t,e,i,n,s){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.setMinMax(t,e,i,t+n,e+s,i+r)}},{key:"setMinMax",value:function(t,e,i,n,s,r){this.min[0].set(t),this.min[1].set(e),this.min[2].set(i),this.max[0].set(n),this.max[1].set(s),this.max[2].set(r)}},{key:"getID",value:function(){return this.id}},{key:"getMinMax",value:function(t,e){return t?this.min[e].get():this.max[e].get()}},{key:"getMin",value:function(t){return this.min[t]}},{key:"getMax",value:function(t){return this.max[t]}}]),t}()},474:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(475),u=function(){function t(e,i,n){s()(this,t),this.bullets=[],this.isAiming=!1,this.viewBox=n,this.callbackShoot=null,this.callbackCollide=null,this.sprites=i,this.constants=e,this.recoil=e.physics.recoil,this.numero=0}return o()(t,[{key:"update",value:function(t,e,i,n,s){var r=this;!this.isAiming&&n?this.createNewOne(i,s,e):this.isAiming&&!n&&this.shootOne();var o=[];this.bullets.forEach((function(s,a){s.update(t,e,i,n),s.isCollide()&&(o.push(a),r.callbackCollide&&r.callbackCollide(s.getId()))})),o.length>0&&(this.bullets=this.bullets.filter((function(t,e){return-1===o.indexOf(e)}))),this.isAiming=n}},{key:"createNewOne",value:function(t,e,i){this.bullets.push(new a.a({id:"".concat(this.constants.id).concat(this.numero),constants:this.constants,sprites:this.sprites,viewBox:this.viewBox,tileSize:i,startPos:t,goLeft:e})),this.numero+=1}},{key:"shootOne",value:function(){if(this.bullets.length>0){var t=this.bullets[this.bullets.length-1];t.shoot(this.constants.states.BULLET),this.callbackShoot&&this.callbackShoot(t.getId(),t.getCollisionBox(),this.recoil)}}},{key:"removeOne",value:function(t){this.bullets=this.bullets.filter((function(e){return e.getId()!==t}))}},{key:"render",value:function(t,e,i){this.bullets.forEach((function(n){n.render(t,e,i)}))}},{key:"setCallbackShoot",value:function(t){this.callbackShoot=t}},{key:"setCallbackCollide",value:function(t){this.callbackCollide=t}},{key:"get",value:function(){return this.bullets.map((function(t){return t.getPosition()}))}},{key:"getConstants",value:function(){return this.constants}}]),t}()},476:function(t,e,i){"use strict";i.d(e,"a",(function(){return g}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(22),u=i.n(a),l=i(7),h=i.n(l),c=i(8),f=i.n(c),v=i(3),p=i.n(v);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var g=function(t){h()(i,t);var e=d(i);function i(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0;return s()(this,i),(n=e.call(this,t,r,o)).isAiming=!0,n.goLeft=u,n.position.setX(a.getX()),n.position.setY(a.getY()),n.startPos=a,n}return o()(i,[{key:"update",value:function(t,e){this.isAiming?(this.position.setX(this.startPos.getX()),this.position.setY(this.startPos.getY())):u()(p()(i.prototype),"update",this).call(this,t,e)}},{key:"shoot",value:function(){this.isAiming=!1;var t=this.constants.physics.speed;this.speed.setX(this.goLeft?-t:t)}},{key:"setStartPos",value:function(t){this.startPos=t}}]),i}(i(395).a)},477:function(t,e,i){"use strict";i.d(e,"a",(function(){return k}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(22),u=i.n(a),l=i(7),h=i.n(l),c=i(8),f=i.n(c),v=i(3),p=i.n(v),d=i(393),g=i(29),y=i(25);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var k=function(t){h()(i,t);var e=m(i);function i(t,n,r){var o;return s()(this,i),(o=e.call(this,t,n,r)).isAnimating=!1,o.aimingStrength=0,o.inverseSprite=!1,o.oldInverseSprite=o.inverseSprite,o.jumpPosition=new y.a,o}return o()(i,[{key:"defineNextStatus",value:function(){u()(p()(i.prototype),"defineNextStatus",this).call(this);var t=this.constants.states,e=t.WALL,n=t.WALL_UP,s=t.JUMP_UP,r=t.RUN_JUMP_UP;this.isLock()||(this.speed.getY()>0&&(this.status=s,Math.abs(this.speed.getX())>0&&(this.status=r)),this.isCollision.bottom?(this.isCollision.left||this.isCollision.right)&&(this.status=e):(this.isCollision.left||this.isCollision.right)&&(this.status=n),this.isCollision.left?this.inverseSprite=!0:this.isCollision.right&&(this.inverseSprite=!1))}},{key:"setInteraction",value:function(t){var e=this.constants,i=e.physics,n=e.states,s=t.keys,r=n.DASH,o=n.AIM,a=n.SLASH,u=n.JUMP_UP,l=n.DIE;if(this.status!==l){this.status===o&&(this.aimingStrength=Object(g.b)(t.getCharge(s.W),0,40,.2,1));var h=this.isCollision.bottom?i.run:i.aircontrol;!this.isCollision.right&&t.isPressed(s.RIGHT)&&(this.speed.addX(h),this.inverseSprite=!1),!this.isCollision.left&&t.isPressed(s.LEFT)&&(this.speed.addX(-h),this.inverseSprite=!0),this.isLock()||this.isCollision.bottom&&(t.isPressedOne(s.SPACE)&&(this.jumpPosition.set(this.position.getX(),this.position.getY(),0),this.speed.addY(i.jump),this.status=u,this.isCollision.bottom=!1),t.isPressedOne(s.SHIFT)&&(this.speed.addX(this.inverseSprite?-i.dash:i.dash),this.status=r),t.isPressed(s.W)&&(this.status=o),t.isPressedOne(s.X)&&(this.status=a)),this.resetValues(t)}}},{key:"resetValues",value:function(t){var e=this.constants.states,i=t.keys,n=e.STAND,s=e.AIM;this.status,this.status!==s||t.isPressed(i.W)||(this.aimingStrength=0,this.status=n)}},{key:"getLastJumpingPosition",value:function(){return this.jumpPosition}},{key:"isAiming",value:function(){return this.aimingStrength}},{key:"getDashing",value:function(){var t=this.constants.states.DASH;return this.status===t}}]),i}(d.a)},478:function(t,e,i){"use strict";i.d(e,"a",(function(){return g}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(22),u=i.n(a),l=i(7),h=i.n(l),c=i(8),f=i.n(c),v=i(3),p=i.n(v);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var g=function(t){h()(i,t);var e=d(i);function i(){return s()(this,i),e.apply(this,arguments)}return o()(i,[{key:"updateSpeed",value:function(){u()(p()(i.prototype),"updateSpeed",this).call(this),this.isCollision.left?this.inverseSprite=!1:this.isCollision.right&&(this.inverseSprite=!0),this.isCollision.bottom&&this.speed.addX((this.inverseSprite?-1:1)*this.constants.physics.run)}}]),i}(i(393).a)},479:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(0),u=i.n(a),l=function(){function t(){var e=this;s()(this,t),u()(this,"showRestart",(function(){e.instructions&&(e.title.innerHTML="G a m e O v e r",e.instructions.innerHTML="Pressed Enter to restart"),e.show()})),u()(this,"showVictory",(function(){e.instructions&&(e.title.innerHTML="V i c t o r y",e.instructions.innerHTML=""),e.show()})),u()(this,"showReady",(function(){e.instructions&&e.instructions&&(e.instructions.style.display="block")})),this.div=document.querySelector("#splash"),this.instructions=this.div&&this.div.querySelector("#instructions"),this.title=this.div&&this.div.querySelector("#title")}return o()(t,[{key:"show",value:function(){this.div&&(this.div.style.opacity=1)}},{key:"hide",value:function(){this.div&&(this.div.style.opacity=0)}},{key:"showPause",value:function(){this.title&&(this.title.innerHTML="T h e G a m e"),this.show()}}]),t}()},486:function(t,e,i){"use strict";var n=i(27),s=i.n(n),r=i(48),o=i.n(r),a=i(1),u=i.n(a),l=i(2),h=i.n(l),c=i(0),f=i.n(c),v=i(345),p=function(){function t(){u()(this,t),this.listesAxe=Array(3),this.resetPairesAxes()}return h()(t,null,[{key:"compareListes",value:function(t,e){for(var i=[],n=0;n<t.length;n+=1)for(var s=0;s<e.length;s+=1)(t[n][0]===e[s][0]&&t[n][1]===e[s][1]||t[n][1]===e[s][0]&&t[n][0]===e[s][1])&&i.push([t[n][0],t[n][1]]);return i}}]),h()(t,[{key:"resetPairesAxes",value:function(){for(var t=0;t<this.listesAxe.length;t+=1)this.listesAxe[t]=[]}},{key:"addPaireOnAxe",value:function(t,e){for(var i=!1,n=0;n<this.listesAxe[e].length;n+=1)if(t[0]===this.listesAxe[e][n][0]&&t[1]===this.listesAxe[e][n][1]||t[1]===this.listesAxe[e][n][0]&&t[0]===this.listesAxe[e][n][1]){i=!0;break}i||this.listesAxe[e].push(t)}},{key:"getPaires",value:function(e,i,n){var s=null;e&&(s=o()(this.listesAxe,1)[0],i&&(s=t.compareListes(s,this.listesAxe[1]),n&&(s=t.compareListes(s,this.listesAxe[2]))));return s}}]),t}(),d=function(){function t(){u()(this,t),this.listeAxe=Array(3),this.listeAxe[0]=[],this.listeAxe[1]=[],this.listeAxe[2]=[],this.pm=new p,this.cptEndpointPlace=0,this.endpointAplacer=null,this.activeList=[]}return h()(t,null,[{key:"addEndpointDecroissant",value:function(t,e,i){var n=t,s=new v.a;s.set(-9999),t.push(s),t.push(s);for(var r=e,o=0,a=t.length-1;a>=0;a-=1){var u=t[a-(2-o)];if(u?u.get()>r.get()?(n[a]=r,o+=1,r=i):n[a]=u:(n[a]=r,o+=1,r=i),2===o)break}return n}}]),h()(t,[{key:"setup",value:function(t){this.addBoxes(t)}},{key:"addBoxes",value:function(e){for(var i=[],n=[],s=0;s<e.length;s+=1)i=t.addEndpointDecroissant(i,e[s].getMin(0),e[s].getMax(0)),n=t.addEndpointDecroissant(n,e[s].getMin(1),e[s].getMax(1));var r=0;this.addEndPointsOnListe(r,i),r+=1,this.addEndPointsOnListe(r,n)}},{key:"addEndPointsOnListe",value:function(t,e){var i=new v.a;i.set(9999);for(var n=0;n<e.length;n+=1)this.listeAxe[t].push(i);this.cptEndpointPlace=0,this.endpointAplacer=e[this.cptEndpointPlace],this.activeList=[];for(var s=this.listeAxe[t].length-1;s>=0;s-=1)this.loopTri(t,e,s),this.loopCheckCollision(t,s)}},{key:"loopTri",value:function(t,e,i){if(this.cptEndpointPlace<e.length){var n=this.listeAxe[t][i-(e.length-this.cptEndpointPlace)];n?this.endpointAplacer.get()>n.get()?(this.listeAxe[t][i]=this.endpointAplacer,this.cptEndpointPlace+=1,this.endpointAplacer=e[this.cptEndpointPlace]):this.listeAxe[t][i]=n:(this.listeAxe[t][i]=this.endpointAplacer,this.cptEndpointPlace+=1,this.endpointAplacer=e[this.cptEndpointPlace])}}},{key:"loopCheckCollision",value:function(t,e){var i=this.listeAxe[t][e].getID();if(this.listeAxe[t][e].isMinimum()){for(var n=0;n<this.activeList.length;n+=1)if(this.activeList[n]===i){this.activeList.splice(n,1);break}}else{for(var s=0;s<this.activeList.length;s+=1)this.pm.addPaireOnAxe([this.activeList[s],i],t);this.activeList.push(i)}}},{key:"update",value:function(t,e,i){this.pm.resetPairesAxes(),this.activeList=[],t&&this.updateAxe(0),e&&this.updateAxe(1),i&&this.updateAxe(2)}},{key:"updateAxe",value:function(t){this.listeAxe[t].sort((function(t,e){return t.value<e.value?-1:1}));for(var e=this.listeAxe[0].length-1;e>=0;e-=1)this.loopCheckCollision(t,e)}},{key:"getPaires",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.update(t,e,i),this.pm.getPaires(t,e,i)}},{key:"removeBox",value:function(t){this.listeAxe=this.listeAxe.map((function(e){return e.filter((function(e){return e.ownerId!==t}))}))}},{key:"clear",value:function(){this.listeAxe[0]=[],this.listeAxe[1]=[],this.listeAxe[2]=[]}}]),t}(),g=function(){function t(e){var i=this;u()(this,t),f()(this,"addBoxes",(function(t){i.collision.addBoxes(t)})),f()(this,"clear",(function(){i.collision.clear()})),f()(this,"removeBox",(function(t){i.collision.removeBox(t)})),this.collision=new d,this.collision.addBoxes(e)}return h()(t,[{key:"get",value:function(){return this.collision.getPaires().reduce((function(t,e){var i="SIMPLE";e.sort();var n=e[0],r=e[1],a=null,u=-1!==n.indexOf("bullet"),l=-1!==r.indexOf("bullet");if(u&&l)return t;if(u){i="SHOOT",a=n;var h=n.split("-")[0];n=r,r=h}else if(l){i="SHOOT",a=r;var c=r.split("-");r=o()(c,1)[0]}return"SHOOT"===i&&n===r?t:[].concat(s()(t),[{type:i,from:r,on:n,bulletId:a}])}),[])}}]),t}();e.a=g},487:function(t,e,i){"use strict";var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(22),u=i.n(a),l=i(7),h=i.n(l),c=i(8),f=i.n(c),v=i(3),p=i.n(v),d=i(337);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=p()(t);if(e){var s=p()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return f()(this,i)}}var y=function(t){h()(i,t);var e=g(i);function i(t){var n;return s()(this,i),(n=e.call(this)).state=new d.a(t),n.state.set(t.colors["000"].pattern),n}return o()(i,[{key:"render",value:function(t,e,n){e.setTexture(0,n.get()),this.setSprite(this.state.get()),u()(p()(i.prototype),"render",this).call(this,t,e)}},{key:"setState",value:function(t){this.state.set(t)}},{key:"getState",value:function(){return this.state.get()}}]),i}(i(488).a),m=function(){function t(e,i){s()(this,t),this.context=t.setupContext(e),this.levelSize={w:e.width,h:e.height};var n=i.viewBox;this.viewBox={x:0,y:0,w:n.w||20,h:n.h||20},this.scrollBox={w:this.viewBox.w/2,h:this.viewBox.h/2},this.smoothTilePos={x:0,y:0},this.tile=new y(i.sprites),this.sprites=i.sprites,this.tileSize=i.tileSize,this.map=this.getData()}return o()(t,null,[{key:"setupContext",value:function(t){var e=document.createElement("canvas"),i=e.getContext("2d");return e.width=t.width,e.height=t.height,i.drawImage(t,0,0),i}}]),o()(t,[{key:"getData",value:function(){return this.context.getImageData(this.viewBox.x,this.viewBox.y,this.viewBox.w,this.viewBox.h)}},{key:"update",value:function(t){this.tile.setNormalMatrix(t)}},{key:"render",value:function(t,e,i,n){for(var s=0;s<this.map.height;s+=1)for(var r=0;r<this.map.width;r+=1){var o=s*this.map.width+r,a=this.map.data[4*o],u=this.map.data[4*o+1],l=this.map.data[4*o+2],h="".concat(a).concat(u).concat(l);if(this.tile.reset(),this.sprites.colors[h]){var c={x:r-this.smoothTilePos.x,y:s-this.smoothTilePos.y},f=this.sprites.colors[h],v=f.objType,p=f.pattern,d=f.scale,g=f.z;if(this.tile.setState(p),d){var y=this.tile.getState(),m=y.w,k=y.refSize;this.tile.setScale(d.x,d.y,1);var x=m/k*d.x;this.tile.setTranslate(c.x-.5*(x-1),c.y-(1-d.y),g||0)}else this.tile.setTranslate(c.x,c.y,g||0);this.tile.render(0===v?i:n,t,e)}}}},{key:"follow",value:function(t){var e=t[0]-this.scrollBox.w;e<0&&(e=0),e>this.levelSize.w-this.viewBox.w&&(e=this.levelSize.w-this.viewBox.w);var i=t[1]-this.scrollBox.h;i<0&&(i=0),i>this.levelSize.h-this.viewBox.h&&(i=this.levelSize.h-this.viewBox.h),this.viewBox.x===e&&this.viewBox.y===i||(this.viewBox.x=e,this.viewBox.y=i,this.map=this.getData(),this.smoothTilePos.x=e-Math.floor(e),this.smoothTilePos.y=i-Math.floor(i))}},{key:"getViewBox",value:function(){return this.viewBox}},{key:"getLevelSize",value:function(){return this.levelSize}},{key:"getTileSize",value:function(){return this.tileSize}},{key:"get",value:function(){return this.context}},{key:"getSmoothTilePos",value:function(){return this.smoothTilePos}}]),t}();e.a=m},489:function(t,e,i){"use strict";i.d(e,"a",(function(){return w}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(0),u=i.n(a),l=i(22),h=i.n(l),c=i(7),f=i.n(c),v=i(8),p=i.n(v),d=i(3),g=i.n(d),y=i(337),m=i(392),k=i(25);function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=g()(t);if(e){var s=g()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return p()(this,i)}}var b=function(t){f()(i,t);var e=x(i);function i(t,n,r,o,a,u){var l;return s()(this,i),(l=e.call(this)).inverseX=!1,l.stateSprite=new y.a(n,u),l.stateSprite.set(t.states[Object.keys(t.states)[0]]),l.viewBox=r,l.constants=t,l.sprites=n,l.position=new k.a(o.getX()||t.x||0,o.getY()||t.y||0,o.getZ()||t.z||0),l.stateSprite.reload(a),l}return o()(i,[{key:"update",value:function(t){h()(g()(i.prototype),"update",this).call(this,t),this.stateSprite.update()}},{key:"render",value:function(t,e,n){var s=this.stateSprite.getRelSize(),r=s.w,o=s.h,a=s.px,u=s.py,l=0;null!==a&&(l=this.inverseX?-r-a:r-(r-a)),this.setScale(r,o,1),this.setTranslate(this.position.getX()-this.viewBox.x+l,this.position.getY()-this.viewBox.y-(1-o)+(u||0),this.position.getZ()),t.setTexture(0,e.get()),t.setInt("inverseX",this.inverseX?1:0),h()(g()(i.prototype),"render",this).call(this,n,t),this.setSprite(this.stateSprite.get())}},{key:"setInverseX",value:function(t){this.inverseX=t}}]),i}(m.a),w=function(){function t(e,i,n){var r=this;s()(this,t),u()(this,"endOfAnimation",(function(t){return function(){delete r.fxs[t]}})),this.fxs={},this.isAiming=!1,this.viewBox=n,this.sprites=i,this.constants=e,this.cpt=0}return o()(t,[{key:"update",value:function(){var t=this;Object.keys(this.fxs).forEach((function(e){t.fxs[e].update()}))}},{key:"createNewOne",value:function(t,e){this.fxs[this.cpt]=new b(this.constants,this.sprites,this.viewBox,t,e,this.endOfAnimation(this.cpt)),this.cpt+=1}},{key:"render",value:function(t,e,i){var n=this;Object.keys(this.fxs).forEach((function(s){n.fxs[s].render(t,e,i)}))}},{key:"getConstants",value:function(){return this.constants}}]),t}()},53:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=1e-6},65:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(147),u=i(148),l=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;s()(this,t),this.gl=e,this.buffer=this.gl.createFramebuffer(),this.buffer.width=i,this.buffer.height=n,this.clearColor=[0,0,0,0],this.setup(r,o,a)}return o()(t,[{key:"setup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer);var n=null!==e?e.COLOR_ATTACHMENT0_WEBGL+i:this.gl.COLOR_ATTACHMENT0;this.texture=new a.a(this.gl,this.buffer.width,this.buffer.height),this.texture.setup(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,n,this.gl.TEXTURE_2D,this.texture.get(),0),t&&(this.depthTexture=new u.a(this.gl,this.buffer.width,this.buffer.height),this.depthTexture.setup(),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.TEXTURE_2D,this.depthTexture.get(),0)),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}},{key:"resize",value:function(t){this.buffer.width=t.width,this.buffer.height=t.height,this.setup()}},{key:"start",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer),this.gl.viewport(0,0,this.buffer.width,this.buffer.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"end",value:function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)}},{key:"get",value:function(){return this.buffer}},{key:"getTexture",value:function(){return this.texture}},{key:"getDepthTexture",value:function(){return this.depthTexture}},{key:"setClearColor",value:function(t,e,i,n){this.clearColor=[t,e,i,n]}}]),t}()},73:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n=i(1),s=i.n(n),r=i(7),o=i.n(r),a=i(8),u=i.n(a),l=i(3),h=i.n(l),c=i(88);function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=h()(t);if(e){var s=h()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return u()(this,i)}}var v=function(t,e){return Object.keys(e).reduce((function(i,n){var s,r,o,a,u=e[n];switch(n){default:case"position":case"next":case"previous":case"normale":case"color":r="VEC3",o=3,s=t.FLOAT,a=new Float32Array(u);break;case"texture":r="VEC2",o=2,s=t.FLOAT,a=new Float32Array(u);break;case"indices":r="SCALAR",o=1,s=t.UNSIGNED_SHORT,a=new Uint16Array(u);break;case"side":r="FLOAT",o=1,s=t.FLOAT,a=new Float32Array(u)}return i[n]={locationKey:n,type:r,values:a,count:u.length/o,componentType:s,size:o},i}),{})},p=function(t){o()(i,t);var e=f(i);function i(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s()(this,i);var o=v(t,n);return e.call(this,t,o,r)}return i}(c.a)},85:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i(1),s=i.n(n),r=i(2),o=i.n(r),a=i(25),u=i(19),l=function(){function t(e){if(s()(this,t),this.position=new a.a(e.position.x,e.position.y,e.position.z),this.target=new a.a(0,0,0),this.view=new u.a,e.ortho){var i=e.ortho,n=i.left,r=i.right,o=i.bottom,l=i.top,h=e.near,c=e.far;this.ortho=new u.a,this.ortho.ortho(n,r,o,l,h,c)}}return o()(t,[{key:"lookAt",value:function(){this.view.identity().lookAt(this.position.getX(),this.position.getY(),this.position.getZ(),this.target.getX(),this.target.getY(),this.target.getZ(),0,1,0)}},{key:"getView",value:function(){return this.view}},{key:"getPosition",value:function(){return this.position.get()}},{key:"getPositionVec3",value:function(){return this.position}},{key:"getTarget",value:function(){return this.target.get()}},{key:"getModel",value:function(){return this.repere.getModel()}},{key:"getOrtho",value:function(){return this.ortho}},{key:"addToPosition",value:function(t,e,i){this.position.addXYZ(t,e,i),this.lookAt()}},{key:"setPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=null!==t?t:this.position.getX(),s=null!==e?e:this.position.getY(),r=null!==i?i:this.position.getZ();this.position.set(n,s,r),this.lookAt()}},{key:"setTarget",value:function(t,e,i){this.target.set(t,e,i)}},{key:"setTargetVec3",value:function(t){this.target.equal(t)}}]),t}()},86:function(t,e,i){"use strict";i.d(e,"a",(function(){return M}));var n=i(48),s=i.n(n),r=i(46),o=i.n(r),a=i(27),u=i.n(a),l=i(49),h=i.n(l),c=i(1),f=i.n(c),v=i(10),p=i.n(v),d=i(7),g=i.n(d),y=i(8),m=i.n(y),k=i(3),x=i.n(k),b=i(0),w=i.n(b),A=i(89),S=i(35),P=i(19),R=i(145),E=i(87),C=i(29);function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=x()(t);if(e){var s=x()(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return m()(this,i)}}var M=function(t){g()(i,t);var e=T(i);function i(t,n){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;f()(this,i),r=e.call(this,t,n),w()(p()(r),"removeAnim",(function(t){t.animations;return h()(t,["animations"])})),w()(p()(r),"addAnimations",(function(t,e){var i={};return t.forEach((function(t){var n=t.path,s=t.times,a=t.output,l=t.interpolation,h=null!==e?a[e]:a[0];"rotation"===n&&(h=o()(S.a,u()(h)).toMatrix4()),r.animationInterval[1]=Math.max.apply(Math,u()(s).concat([r.animationInterval[1]])),i[n]={output:a,sample:new R.a(s,l,r.speedAnimation),customStep:e,value:h}})),i})),w()(p()(r),"getAnimationInterval",(function(t){var e=0;return t.forEach((function(t){var i=t.animations;i&&i.forEach((function(t){var i=t.times;e=Math.max.apply(Math,u()(i).concat([e]))}))})),[0,e]})),w()(p()(r),"update",(function(t){var e=t-r.lastFrame;e>r.animationInterval[1]*r.speedAnimation&&(r.lastFrame=t),r.updateAnimations(e)})),w()(p()(r),"updateAnimations",(function(t){Object.keys(r.animations).forEach((function(e){var i=r.animations[e];Object.keys(i).forEach((function(e){i[e]="rotation"===e?r.updateQuat(i[e],t):r.updateVector(i[e],t)}))}))})),w()(p()(r),"updateVector",(function(t,e){var i=t,n=i.sample,r=i.customStep,o=i.output;if(null===r){n.update(e);var a=n.getIndex();if(0===a){var u=s()(o,1);i.value=u[0]}else if(a>o.length-1)i.value=o[o.length-1];else{var l=o[a-1],h=o[a],c=n.get();i.value=l.map((function(t,e){return Object(E.a)(c,t,h[e])}))}}else i.value=o[r];return i})),w()(p()(r),"updateQuat",(function(t,e){var i=t,n=i.sample,s=i.customStep,r=i.output;if(null===s){n.update(e);var a=n.getIndex();if(0===a)i.value=o()(S.a,u()(r[0])).toMatrix4();else if(a>r.length-1)i.value=o()(S.a,u()(r[r.length-1])).toMatrix4();else{var l=r[a-1],h=r[a],c=n.get();i.value=S.a.slerpArray(l,h,c).toMatrix4()}}else i.value=o()(S.a,u()(r[s])).toMatrix4();return i})),w()(p()(r),"handleLocalTransform",(function(t){var e=t.translation,i=t.rotation,n=t.scale,s=t.matrix,o=t.name,a=r.animations[o],l=a&&a.rotation||null,h=a&&a.translation||null,c=a&&a.scale||null,f=new P.a;return f.identity(),(n||c)&&f.scale.apply(f,u()(r.getVector(n,c))),(i||l)&&f.multiply(r.getRotationMat(i,l)),(e||h)&&f.translate.apply(f,u()(r.getVector(e,h))),s&&f.multiplyArray(s),f})),w()(p()(r),"setAnimationStep",(function(t,e,i){var n=r.animations[t][e],s=n.output.length,o=Object(C.b)(i,0,1,0,s-1);n.customStep=Math.round(o)})),w()(p()(r),"setAnimationSpeed",(function(t,e,i){r.animations[t][e].sample.setSpeed(i)})),w()(p()(r),"getVector",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&e.value?e.value:t})),w()(p()(r),"getRotationMat",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,1],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&e.value?e.value:o()(S.a,u()(t)).toMatrix4()}));var l=n.nodes;return r.speedAnimation=2e3,r.animationInterval=[0,0],r.animations=l.reduce((function(t,e){var i=e.animations,n=e.name;return i&&(t[n]=r.addAnimations(i,a)),t}),{}),r.nodes=l.reduce((function(t,e){return t[e.name]=r.removeAnim(e),t}),{}),r.lastFrame=0,r}return i}(A.a)},89:function(t,e,i){"use strict";i.d(e,"a",(function(){return x}));var n=i(46),s=i.n(n),r=i(27),o=i.n(r),a=i(1),u=i.n(a),l=i(2),h=i.n(l),c=i(0),f=i.n(c),v=i(88),p=i(138),d=function(){function t(e,i){var n=i.vbos,s=i.material,r=void 0===s?{}:s;u()(this,t),this.material=r,this.objet=new v.a(e,n),r.normalMap&&(this.normalMap=new p.a(e,r.normalMap.data))}return h()(t,[{key:"render",value:function(t){var e=this.material,i=e.color,n=e.metal,s=e.rough,r=e.ao;t.setVector("color",i||[1,1,1,1]),t.setFloat("metal",void 0!==n?n:0),t.setFloat("rough",void 0!==s?s:.5),t.setFloat("ao",void 0!==r?r:1),this.objet.render(t.get())}},{key:"setModeDessin",value:function(t){this.objet.setModeDessin(t)}},{key:"setModeCalcul",value:function(t){this.objet.setModeCalcul(t)}}]),t}(),g=i(35),y=i(19);function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function k(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){f()(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var x=function(){function t(e,i){var n=this;u()(this,t),f()(this,"formatPrimitives",(function(t,e){return e.map((function(e){var i=e.vbos,n=e.material;return new d(t,{vbos:i,material:n})}))})),f()(this,"handleLocalTransform",(function(t){var e=t.translation,i=t.rotation,n=t.scale,r=t.matrix,a=new y.a;return a.identity(),n&&a.scale.apply(a,o()(n)),i&&a.multiply(s()(g.a,o()(i)).toMatrix4()),e&&a.translate.apply(a,o()(e)),r&&a.multiplyArray(r),a}));var r=i.nodes,a=i.meshes,l=i.materials;this.meshes=a.map((function(t){var i=t.primitives,s=t.name,r=void 0===s?"":s,o=t.weights,a=i.map((function(t){return void 0!==t.material?k(k({},t),{},{material:l[t.material]}):t}));return{name:r,primitives:n.formatPrimitives(e,a),weights:o}})),this.nodes=r}return h()(t,[{key:"render",value:function(t,e){var i=this;Object.keys(this.nodes).forEach((function(n){i.renderNode(n,t,e)}))}},{key:"renderNode",value:function(t,e,i){var n=this.nodes[t],s=n.mesh,r=this.handleLocalTransform(n);r.multiply(i),e.setMatrix("model",r.get()),r.resetTranslate();var o=r.getMatrice3x3();o.inverse(),o.transpose(),e.setMatrix("normalMatrix",o.get()),this.meshes[s].primitives.forEach((function(t){return t.render(e)}))}}]),t}()}}]);